(function(K,Tt){typeof exports=="object"&&typeof module<"u"?Tt(exports):typeof define=="function"&&define.amd?define(["exports"],Tt):(K=typeof globalThis<"u"?globalThis:K||self,Tt(K["@walletconnect/core"]={}))})(this,function(K){"use strict";var Tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nf(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var lt={exports:{}},or=typeof Reflect=="object"?Reflect:null,rf=or&&typeof or.apply=="function"?or.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Ui;or&&typeof or.ownKeys=="function"?Ui=or.ownKeys:Object.getOwnPropertySymbols?Ui=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ui=function(t){return Object.getOwnPropertyNames(t)};function yp(e){console&&console.warn&&console.warn(e)}var sf=Number.isNaN||function(t){return t!==t};function ae(){ae.init.call(this)}lt.exports=ae,lt.exports.once=vp,ae.EventEmitter=ae,ae.prototype._events=void 0,ae.prototype._eventsCount=0,ae.prototype._maxListeners=void 0;var of=10;function Fi(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(ae,"defaultMaxListeners",{enumerable:!0,get:function(){return of},set:function(e){if(typeof e!="number"||e<0||sf(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");of=e}}),ae.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ae.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||sf(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function af(e){return e._maxListeners===void 0?ae.defaultMaxListeners:e._maxListeners}ae.prototype.getMaxListeners=function(){return af(this)},ae.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[t];if(c===void 0)return!1;if(typeof c=="function")rf(c,this,n);else for(var f=c.length,u=hf(c,f),r=0;r<f;++r)rf(u[r],this,n);return!0};function cf(e,t,n,r){var i,s,o;if(Fi(n),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),o===void 0)o=s[t]=n,++e._eventsCount;else if(typeof o=="function"?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=af(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,yp(a)}return e}ae.prototype.addListener=function(t,n){return cf(this,t,n,!1)},ae.prototype.on=ae.prototype.addListener,ae.prototype.prependListener=function(t,n){return cf(this,t,n,!0)};function wp(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ff(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=wp.bind(r);return i.listener=n,r.wrapFn=i,i}ae.prototype.once=function(t,n){return Fi(n),this.on(t,ff(this,t,n)),this},ae.prototype.prependOnceListener=function(t,n){return Fi(n),this.prependListener(t,ff(this,t,n)),this},ae.prototype.removeListener=function(t,n){var r,i,s,o,a;if(Fi(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():mp(r,s),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this},ae.prototype.off=ae.prototype.removeListener,ae.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function uf(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Ep(i):hf(i,i.length)}ae.prototype.listeners=function(t){return uf(this,t,!0)},ae.prototype.rawListeners=function(t){return uf(this,t,!1)},ae.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):lf.call(e,t)},ae.prototype.listenerCount=lf;function lf(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ae.prototype.eventNames=function(){return this._eventsCount>0?Ui(this._events):[]};function hf(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function mp(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Ep(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function vp(e,t){return new Promise(function(n,r){function i(o){e.removeListener(t,s),r(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}df(e,t,s,{once:!0}),t!=="error"&&_p(e,i,{once:!0})})}function _p(e,t,n){typeof e.on=="function"&&df(e,"error",t,n)}function df(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var W={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var fo=function(e,t){return fo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},fo(e,t)};function xp(e,t){fo(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var uo=function(){return uo=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},uo.apply(this,arguments)};function Sp(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Ip(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function Op(e,t){return function(n,r){t(n,r,e)}}function Bp(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Dp(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{f(r.next(u))}catch(d){o(d)}}function c(u){try{f(r.throw(u))}catch(d){o(d)}}function f(u){u.done?s(u.value):i(u.value).then(a,c)}f((r=r.apply(e,t||[])).next())})}function Ap(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(u){return c([f,u])}}function c(f){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,i=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){n.label=f[1];break}if(f[0]===6&&n.label<s[1]){n.label=s[1],s=f;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(f);break}s[2]&&n.ops.pop(),n.trys.pop();continue}f=t.call(e,n)}catch(u){f=[6,u],i=0}finally{r=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Tp(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}function Rp(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function lo(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gf(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function Np(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(gf(arguments[t]));return e}function Cp(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function Hr(e){return this instanceof Hr?(this.v=e,this):new Hr(e)}function Pp(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(l){return new Promise(function(b,w){s.push([h,l,b,w])>1||a(h,l)})})}function a(h,l){try{c(r[h](l))}catch(b){d(s[0][3],b)}}function c(h){h.value instanceof Hr?Promise.resolve(h.value.v).then(f,u):d(s[0][2],h)}function f(h){a("next",h)}function u(h){a("throw",h)}function d(h,l){h(l),s.shift(),s.length&&a(s[0][0],s[0][1])}}function $p(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(o){return(n=!n)?{value:Hr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function Lp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof lo=="function"?lo(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(f){s({value:f,done:a})},o)}}function Up(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Fp(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function jp(e){return e&&e.__esModule?e:{default:e}}function Mp(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function kp(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}var zp=Object.freeze({__proto__:null,__extends:xp,get __assign(){return uo},__rest:Sp,__decorate:Ip,__param:Op,__metadata:Bp,__awaiter:Dp,__generator:Ap,__createBinding:Tp,__exportStar:Rp,__values:lo,__read:gf,__spread:Np,__spreadArrays:Cp,__await:Hr,__asyncGenerator:Pp,__asyncDelegator:$p,__asyncValues:Lp,__makeTemplateObject:Up,__importStar:Fp,__importDefault:jp,__classPrivateFieldGet:Mp,__classPrivateFieldSet:kp}),ji=nf(zp),ho={},Kr={},pf;function qp(){if(pf)return Kr;pf=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.delay=void 0;function e(t){return new Promise(n=>{setTimeout(()=>{n(!0)},t)})}return Kr.delay=e,Kr}var Un={},go={},Fn={},bf;function Hp(){return bf||(bf=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.ONE_THOUSAND=Fn.ONE_HUNDRED=void 0,Fn.ONE_HUNDRED=100,Fn.ONE_THOUSAND=1e3),Fn}var po={},yf;function Kp(){return yf||(yf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(po)),po}var wf;function mf(){return wf||(wf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ji;t.__exportStar(Hp(),e),t.__exportStar(Kp(),e)}(go)),go}var Ef;function Vp(){if(Ef)return Un;Ef=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.fromMiliseconds=Un.toMiliseconds=void 0;const e=mf();function t(r){return r*e.ONE_THOUSAND}Un.toMiliseconds=t;function n(r){return Math.floor(r/e.ONE_THOUSAND)}return Un.fromMiliseconds=n,Un}var vf;function Gp(){return vf||(vf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ji;t.__exportStar(qp(),e),t.__exportStar(Vp(),e)}(ho)),ho}var ar={},_f;function Zp(){if(_f)return ar;_f=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const i=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:i})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return ar.Watch=e,ar.default=e,ar}var bo={},Vr={},xf;function Yp(){if(xf)return Vr;xf=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.IWatch=void 0;class e{}return Vr.IWatch=e,Vr}var Sf;function Wp(){return Sf||(Sf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),ji.__exportStar(Yp(),e)}(bo)),bo}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ji;t.__exportStar(Gp(),e),t.__exportStar(Zp(),e),t.__exportStar(Wp(),e),t.__exportStar(mf(),e)})(W);class jn{}class Xp extends jn{constructor(t){super()}}const If=W.FIVE_SECONDS,Mn={pulse:"heartbeat_pulse"};class yo extends Xp{constructor(t){super(t),this.events=new lt.exports.EventEmitter,this.interval=If,this.interval=t?.interval||If}static async init(t){const n=new yo(t);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),W.toMiliseconds(this.interval))}pulse(){this.events.emit(Mn.pulse)}}const Jp=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Qp=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,e1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function t1(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){n1(e);return}return t}function n1(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function Mi(e,t={}){if(typeof e!="string")return e;if(e[0]==='"'&&e[e.length-1]==='"'&&e.indexOf("\\")===-1)return e.slice(1,-1);const n=e.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!e1.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(Jp.test(e)||Qp.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,t1)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function r1(e){return!e||typeof e.then!="function"?Promise.resolve(e):e}function ve(e,...t){try{return r1(e(...t))}catch(n){return Promise.reject(n)}}function i1(e){const t=typeof e;return e===null||t!=="object"&&t!=="function"}function s1(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}function ki(e){if(i1(e))return String(e);if(s1(e)||Array.isArray(e))return JSON.stringify(e);if(typeof e.toJSON=="function")return ki(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const wo="base64:";function o1(e){return typeof e=="string"?e:wo+f1(e)}function a1(e){return typeof e!="string"||!e.startsWith(wo)?e:c1(e.slice(wo.length))}function c1(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),t=>t.codePointAt(0))}function f1(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e))}function Ve(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function u1(...e){return Ve(e.join(":"))}function zi(e){return e=Ve(e),e?e+":":""}function l1(e,t){if(t===void 0)return!0;let n=0,r=e.indexOf(":");for(;r>-1;)n++,r=e.indexOf(":",r+1);return n<=t}function h1(e,t){return t?e.startsWith(t)&&e[e.length-1]!=="$":e[e.length-1]!=="$"}function Mx(e){return e}const d1="memory",g1=()=>{const e=new Map;return{name:d1,getInstance:()=>e,hasItem(t){return e.has(t)},getItem(t){return e.get(t)??null},getItemRaw(t){return e.get(t)??null},setItem(t,n){e.set(t,n)},setItemRaw(t,n){e.set(t,n)},removeItem(t){e.delete(t)},getKeys(){return[...e.keys()]},clear(){e.clear()},dispose(){e.clear()}}};function p1(e={}){const t={mounts:{"":e.driver||g1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=f=>{for(const u of t.mountpoints)if(f.startsWith(u))return{base:u,relativeKey:f.slice(u.length),driver:t.mounts[u]};return{base:"",relativeKey:f,driver:t.mounts[""]}},r=(f,u)=>t.mountpoints.filter(d=>d.startsWith(f)||u&&f.startsWith(d)).map(d=>({relativeBase:f.length>d.length?f.slice(d.length):void 0,mountpoint:d,driver:t.mounts[d]})),i=(f,u)=>{if(t.watching){u=Ve(u);for(const d of t.watchListeners)d(f,u)}},s=async()=>{if(!t.watching){t.watching=!0;for(const f in t.mounts)t.unwatch[f]=await Of(t.mounts[f],i,f)}},o=async()=>{if(t.watching){for(const f in t.unwatch)await t.unwatch[f]();t.unwatch={},t.watching=!1}},a=(f,u,d)=>{const h=new Map,l=b=>{let w=h.get(b.base);return w||(w={driver:b.driver,base:b.base,items:[]},h.set(b.base,w)),w};for(const b of f){const w=typeof b=="string",v=Ve(w?b:b.key),D=w?void 0:b.value,C=w||!b.options?u:{...u,...b.options},x=n(v);l(x).items.push({key:v,value:D,relativeKey:x.relativeKey,options:C})}return Promise.all([...h.values()].map(b=>d(b))).then(b=>b.flat())},c={hasItem(f,u={}){f=Ve(f);const{relativeKey:d,driver:h}=n(f);return ve(h.hasItem,d,u)},getItem(f,u={}){f=Ve(f);const{relativeKey:d,driver:h}=n(f);return ve(h.getItem,d,u).then(l=>Mi(l))},getItems(f,u={}){return a(f,u,d=>d.driver.getItems?ve(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(l=>({key:u1(d.base,l.key),value:Mi(l.value)}))):Promise.all(d.items.map(h=>ve(d.driver.getItem,h.relativeKey,h.options).then(l=>({key:h.key,value:Mi(l)})))))},getItemRaw(f,u={}){f=Ve(f);const{relativeKey:d,driver:h}=n(f);return h.getItemRaw?ve(h.getItemRaw,d,u):ve(h.getItem,d,u).then(l=>a1(l))},async setItem(f,u,d={}){if(u===void 0)return c.removeItem(f);f=Ve(f);const{relativeKey:h,driver:l}=n(f);l.setItem&&(await ve(l.setItem,h,ki(u),d),l.watch||i("update",f))},async setItems(f,u){await a(f,u,async d=>{if(d.driver.setItems)return ve(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:ki(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>ve(d.driver.setItem,h.relativeKey,ki(h.value),h.options)))})},async setItemRaw(f,u,d={}){if(u===void 0)return c.removeItem(f,d);f=Ve(f);const{relativeKey:h,driver:l}=n(f);if(l.setItemRaw)await ve(l.setItemRaw,h,u,d);else if(l.setItem)await ve(l.setItem,h,o1(u),d);else return;l.watch||i("update",f)},async removeItem(f,u={}){typeof u=="boolean"&&(u={removeMeta:u}),f=Ve(f);const{relativeKey:d,driver:h}=n(f);h.removeItem&&(await ve(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await ve(h.removeItem,d+"$",u),h.watch||i("remove",f))},async getMeta(f,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),f=Ve(f);const{relativeKey:d,driver:h}=n(f),l=Object.create(null);if(h.getMeta&&Object.assign(l,await ve(h.getMeta,d,u)),!u.nativeOnly){const b=await ve(h.getItem,d+"$",u).then(w=>Mi(w));b&&typeof b=="object"&&(typeof b.atime=="string"&&(b.atime=new Date(b.atime)),typeof b.mtime=="string"&&(b.mtime=new Date(b.mtime)),Object.assign(l,b))}return l},setMeta(f,u,d={}){return this.setItem(f+"$",u,d)},removeMeta(f,u={}){return this.removeItem(f+"$",u)},async getKeys(f,u={}){f=zi(f);const d=r(f,!0);let h=[];const l=[];let b=!0;for(const v of d){v.driver.flags?.maxDepth||(b=!1);const D=await ve(v.driver.getKeys,v.relativeBase,u);for(const C of D){const x=v.mountpoint+Ve(C);h.some(_=>x.startsWith(_))||l.push(x)}h=[v.mountpoint,...h.filter(C=>!C.startsWith(v.mountpoint))]}const w=u.maxDepth!==void 0&&!b;return l.filter(v=>(!w||l1(v,u.maxDepth))&&h1(v,f))},async clear(f,u={}){f=zi(f),await Promise.all(r(f,!1).map(async d=>{if(d.driver.clear)return ve(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(l=>d.driver.removeItem(l,u)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(f=>Bf(f)))},async watch(f){return await s(),t.watchListeners.push(f),async()=>{t.watchListeners=t.watchListeners.filter(u=>u!==f),t.watchListeners.length===0&&await o()}},async unwatch(){t.watchListeners=[],await o()},mount(f,u){if(f=zi(f),f&&t.mounts[f])throw new Error(`already mounted at ${f}`);return f&&(t.mountpoints.push(f),t.mountpoints.sort((d,h)=>h.length-d.length)),t.mounts[f]=u,t.watching&&Promise.resolve(Of(u,i,f)).then(d=>{t.unwatch[f]=d}).catch(console.error),c},async unmount(f,u=!0){f=zi(f),!(!f||!t.mounts[f])&&(t.watching&&f in t.unwatch&&(t.unwatch[f]?.(),delete t.unwatch[f]),u&&await Bf(t.mounts[f]),t.mountpoints=t.mountpoints.filter(d=>d!==f),delete t.mounts[f])},getMount(f=""){f=Ve(f)+":";const u=n(f);return{driver:u.driver,base:u.base}},getMounts(f="",u={}){return f=Ve(f),r(f,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(f,u={})=>c.getKeys(f,u),get:(f,u={})=>c.getItem(f,u),set:(f,u,d={})=>c.setItem(f,u,d),has:(f,u={})=>c.hasItem(f,u),del:(f,u={})=>c.removeItem(f,u),remove:(f,u={})=>c.removeItem(f,u)};return c}function Of(e,t,n){return e.watch?e.watch((r,i)=>t(r,n+i)):()=>{}}async function Bf(e){typeof e.dispose=="function"&&await ve(e.dispose)}function kn(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function Df(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=kn(n);return(i,s)=>r.then(o=>s(o.transaction(t,i).objectStore(t)))}let mo;function Gr(){return mo||(mo=Df("keyval-store","keyval")),mo}function Af(e,t=Gr()){return t("readonly",n=>kn(n.get(e)))}function b1(e,t,n=Gr()){return n("readwrite",r=>(r.put(t,e),kn(r.transaction)))}function y1(e,t=Gr()){return t("readwrite",n=>(n.delete(e),kn(n.transaction)))}function w1(e=Gr()){return e("readwrite",t=>(t.clear(),kn(t.transaction)))}function m1(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},kn(e.transaction)}function E1(e=Gr()){return e("readonly",t=>{if(t.getAllKeys)return kn(t.getAllKeys());const n=[];return m1(t,r=>n.push(r.key)).then(()=>n)})}const v1=e=>JSON.stringify(e,(t,n)=>typeof n=="bigint"?n.toString()+"n":n),_1=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=e.replace(t,'$1"$2n"$3');return JSON.parse(n,(r,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function cr(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return _1(e)}catch{return e}}function Zr(e){return typeof e=="string"?e:v1(e)||""}const x1="idb-keyval";var S1=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",n=i=>t+i;let r;return e.dbName&&e.storeName&&(r=Df(e.dbName,e.storeName)),{name:x1,options:e,async hasItem(i){return!(typeof await Af(n(i),r)>"u")},async getItem(i){return await Af(n(i),r)??null},setItem(i,s){return b1(n(i),s,r)},removeItem(i){return y1(n(i),r)},getKeys(){return E1(r)},clear(){return w1(r)}}};const I1="WALLET_CONNECT_V2_INDEXED_DB",O1="keyvaluestorage";class B1{constructor(){this.indexedDb=p1({driver:S1({dbName:I1,storeName:O1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const n=await this.indexedDb.getItem(t);if(n!==null)return n}async setItem(t,n){await this.indexedDb.setItem(t,Zr(n))}async removeItem(t){await this.indexedDb.removeItem(t)}}var Eo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},qi={exports:{}};(function(){let e;function t(){}e=t,e.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},e.prototype.setItem=function(n,r){this[n]=String(r)},e.prototype.removeItem=function(n){delete this[n]},e.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},e.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Eo<"u"&&Eo.localStorage?qi.exports=Eo.localStorage:typeof window<"u"&&window.localStorage?qi.exports=window.localStorage:qi.exports=new t})();function D1(e){var t;return[e[0],cr((t=e[1])!=null?t:"")]}class A1{constructor(){this.localStorage=qi.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(D1)}async getItem(t){const n=this.localStorage.getItem(t);if(n!==null)return cr(n)}async setItem(t,n){this.localStorage.setItem(t,Zr(n))}async removeItem(t){this.localStorage.removeItem(t)}}const T1="wc_storage_version",Tf=1,R1=async(e,t,n)=>{const r=T1,i=await t.getItem(r);if(i&&i>=Tf){n(t);return}const s=await e.getKeys();if(!s.length){n(t);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const f=await e.getItem(a);await t.setItem(a,f),o.push(a)}}await t.setItem(r,Tf),n(t),N1(e,o)},N1=async(e,t)=>{t.length&&t.forEach(async n=>{await e.removeItem(n)})};class C1{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const t=new A1;this.storage=t;try{const n=new B1;R1(t,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,n){return await this.initialize(),this.storage.setItem(t,n)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),t())},20)})}}var Rt={exports:{}};function P1(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var $1=L1;function L1(e,t,n){var r=n&&n.stringify||P1,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var o=new Array(s);o[0]=r(e);for(var a=1;a<s;a++)o[a]=r(t[a]);return o.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var f="",u=1-i,d=-1,h=e&&e.length||0,l=0;l<h;){if(e.charCodeAt(l)===37&&l+1<h){switch(d=d>-1?d:0,e.charCodeAt(l+1)){case 100:case 102:if(u>=c||t[u]==null)break;d<l&&(f+=e.slice(d,l)),f+=Number(t[u]),d=l+2,l++;break;case 105:if(u>=c||t[u]==null)break;d<l&&(f+=e.slice(d,l)),f+=Math.floor(Number(t[u])),d=l+2,l++;break;case 79:case 111:case 106:if(u>=c||t[u]===void 0)break;d<l&&(f+=e.slice(d,l));var b=typeof t[u];if(b==="string"){f+="'"+t[u]+"'",d=l+2,l++;break}if(b==="function"){f+=t[u].name||"<anonymous>",d=l+2,l++;break}f+=r(t[u]),d=l+2,l++;break;case 115:if(u>=c)break;d<l&&(f+=e.slice(d,l)),f+=String(t[u]),d=l+2,l++;break;case 37:d<l&&(f+=e.slice(d,l)),f+="%",d=l+2,l++,u--;break}++u}++l}return d===-1?e:(d<h&&(f+=e.slice(d)),f)}const Rf=$1;Rt.exports=jt;const Yr=X1().console||{},U1={mapHttpRequest:Hi,mapHttpResponse:Hi,wrapRequestSerializer:Io,wrapResponseSerializer:Io,wrapErrorSerializer:Io,req:Hi,res:Hi,err:Cf,errWithCause:Cf};function un(e,t){return e==="silent"?1/0:t.levels.values[e]}const vo=Symbol("pino.logFuncs"),_o=Symbol("pino.hierarchy"),F1={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Nf(e,t){const n={logger:t,parent:e[_o]};t[_o]=n}function j1(e,t,n){const r={};t.forEach(i=>{r[i]=n[i]?n[i]:Yr[i]||Yr[F1[i]||"log"]||fr}),e[vo]=r}function M1(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function jt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const n=e.browser.write||Yr;e.browser.write&&(e.browser.asObject=!0);const r=e.serializers||{},i=M1(e.browser.serialize,r);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=Object.keys(e.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof n=="function"&&a.forEach(function(w){n[w]=n}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");const c=e.level||"info",f=Object.create(n);f.log||(f.log=fr),j1(f,a,n),Nf({},f),Object.defineProperty(f,"levelVal",{get:d}),Object.defineProperty(f,"level",{get:h,set:l});const u={transmit:t,serialize:i,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:a,timestamp:Z1(e),messageKey:e.messageKey||"msg",onChild:e.onChild||fr};f.levels=k1(e),f.level=c,f.isLevelEnabled=function(w){return this.levels.values[w]?this.levels.values[w]>=this.levels.values[this.level]:!1},f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=fr,f.serializers=r,f._serialize=i,f._stdErrSerialize=s,f.child=function(...w){return b.call(this,u,...w)},t&&(f._logEvent=So());function d(){return un(this.level,this)}function h(){return this._level}function l(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,zn(this,u,f,"error"),zn(this,u,f,"fatal"),zn(this,u,f,"warn"),zn(this,u,f,"info"),zn(this,u,f,"debug"),zn(this,u,f,"trace"),o.forEach(v=>{zn(this,u,f,v)})}function b(w,v,D){if(!v)throw new Error("missing bindings for child Pino");D=D||{},i&&v.serializers&&(D.serializers=v.serializers);const C=D.serializers;if(i&&C){var x=Object.assign({},r,C),_=e.browser.serialize===!0?Object.keys(x):i;delete v.serializers,xo([v],_,x,this._stdErrSerialize)}function R(F){this._childLevel=(F._childLevel|0)+1,this.bindings=v,x&&(this.serializers=x,this._serialize=_),t&&(this._logEvent=So([].concat(F._logEvent.bindings,v)))}R.prototype=this;const $=new R(this);return Nf(this,$),$.child=function(...F){return b.call(this,w,...F)},$.level=D.level||this.level,w.onChild($),$}return f}function k1(e){const t=e.customLevels||{},n=Object.assign({},jt.levels.values,t),r=Object.assign({},jt.levels.labels,z1(t));return{values:n,labels:r}}function z1(e){const t={};return Object.keys(e).forEach(function(n){t[e[n]]=n}),t}jt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},jt.stdSerializers=U1,jt.stdTimeFunctions=Object.assign({},{nullTime:Pf,epochTime:$f,unixTime:Y1,isoTime:W1});function q1(e){const t=[];e.bindings&&t.push(e.bindings);let n=e[_o];for(;n.parent;)n=n.parent,n.logger.bindings&&t.push(n.logger.bindings);return t.reverse()}function zn(e,t,n,r){if(Object.defineProperty(e,r,{value:un(e.level,n)>un(r,n)?fr:n[vo][r],writable:!0,enumerable:!0,configurable:!0}),e[r]===fr){if(!t.transmit)return;const s=t.transmit.level||e.level,o=un(s,n);if(un(r,n)<o)return}e[r]=K1(e,t,n,r);const i=q1(e);i.length!==0&&(e[r]=H1(i,e[r]))}function H1(e,t){return function(){return t.apply(this,[...e,...arguments])}}function K1(e,t,n,r){return function(i){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Yr?Yr:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var f=!1;if(t.serialize&&(xo(o,this._serialize,this.serializers,this._stdErrSerialize),f=!0),t.asObject||t.formatters?i.call(a,...V1(this,r,o,s,t)):i.apply(a,o),t.transmit){const u=t.transmit.level||e._level,d=un(u,n),h=un(r,n);if(h<d)return;G1(this,{ts:s,methodLevel:r,methodValue:h,transmitLevel:u,transmitValue:n.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:un(e._level,n)},o,f)}}}(e[vo][r])}function V1(e,t,n,r,i){const{level:s,log:o=d=>d}=i.formatters||{},a=n.slice();let c=a[0];const f={};let u=(e._childLevel|0)+1;if(u<1&&(u=1),r&&(f.time=r),s){const d=s(t,e.levels.values[t]);Object.assign(f,d)}else f.level=e.levels.values[t];if(i.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(f,a.shift());return[o(f),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(f,a.shift());c=a.length?Rf(a.shift(),a):void 0}else typeof c=="string"&&(c=Rf(a.shift(),a));return c!==void 0&&(f[i.messageKey]=c),[o(f)]}}function xo(e,t,n,r){for(const i in e)if(r&&e[i]instanceof Error)e[i]=jt.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i])&&t)for(const s in e[i])t.indexOf(s)>-1&&s in n&&(e[i][s]=n[s](e[i][s]))}function G1(e,t,n,r=!1){const i=t.send,s=t.ts,o=t.methodLevel,a=t.methodValue,c=t.val,f=e._logEvent.bindings;r||xo(n,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=n.filter(function(u){return f.indexOf(u)===-1}),e._logEvent.level.label=o,e._logEvent.level.value=a,i(o,e._logEvent,c),e._logEvent=So(f)}function So(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Cf(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const n in e)t[n]===void 0&&(t[n]=e[n]);return t}function Z1(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Pf:$f}function Hi(){return{}}function Io(e){return e}function fr(){}function Pf(){return!1}function $f(){return Date.now()}function Y1(){return Math.round(Date.now()/1e3)}function W1(){return new Date(Date.now()).toISOString()}function X1(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}Rt.exports.default=jt,Rt.exports.pino=jt;const J1={level:"info"},Ki="custom_context",Oo=1e3*1024;var Q1=Object.defineProperty,eb=(e,t,n)=>t in e?Q1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ln=(e,t,n)=>eb(e,typeof t!="symbol"?t+"":t,n);class tb{constructor(t){ln(this,"nodeValue"),ln(this,"sizeInBytes"),ln(this,"next"),this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class Lf{constructor(t){ln(this,"lengthInNodes"),ln(this,"sizeInBytes"),ln(this,"head"),ln(this,"tail"),ln(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const n=new tb(t);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let n=this.head;for(;n!==null;)t.push(n.value),n=n.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const n=t.value;return t=t.next,{done:!1,value:n}}}}}const nb=e=>JSON.stringify(e,(t,n)=>typeof n=="bigint"?n.toString()+"n":n);function Uf(e){return typeof e=="string"?e:nb(e)||""}var rb=Object.defineProperty,ib=(e,t,n)=>t in e?rb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vi=(e,t,n)=>ib(e,typeof t!="symbol"?t+"":t,n);class Ff{constructor(t,n=Oo){Vi(this,"logs"),Vi(this,"level"),Vi(this,"levelValue"),Vi(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=t??"error",this.levelValue=Rt.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new Lf(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,n){n===Rt.exports.levels.values.error?console.error(t):n===Rt.exports.levels.values.warn?console.warn(t):n===Rt.exports.levels.values.debug?console.debug(t):n===Rt.exports.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(Uf({timestamp:new Date().toISOString(),log:t}));const n=typeof t=="string"?JSON.parse(t).level:t.level;n>=this.levelValue&&this.forwardToConsole(t,n)}getLogs(){return this.logs}clearLogs(){this.logs=new Lf(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const n=this.getLogArray();return n.push(Uf({extraMetadata:t})),new Blob(n,{type:"application/json"})}}var sb=Object.defineProperty,ob=(e,t,n)=>t in e?sb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ab=(e,t,n)=>ob(e,typeof t!="symbol"?t+"":t,n);class cb{constructor(t,n=Oo){ab(this,"baseChunkLogger"),this.baseChunkLogger=new Ff(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const n=URL.createObjectURL(this.logsToBlob(t)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}}var fb=Object.defineProperty,ub=(e,t,n)=>t in e?fb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lb=(e,t,n)=>ub(e,typeof t!="symbol"?t+"":t,n);class hb{constructor(t,n=Oo){lb(this,"baseChunkLogger"),this.baseChunkLogger=new Ff(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}}var db=Object.defineProperty,gb=Object.defineProperties,pb=Object.getOwnPropertyDescriptors,jf=Object.getOwnPropertySymbols,bb=Object.prototype.hasOwnProperty,yb=Object.prototype.propertyIsEnumerable,Mf=(e,t,n)=>t in e?db(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Gi=(e,t)=>{for(var n in t||(t={}))bb.call(t,n)&&Mf(e,n,t[n]);if(jf)for(var n of jf(t))yb.call(t,n)&&Mf(e,n,t[n]);return e},Zi=(e,t)=>gb(e,pb(t));function wb(e){return Zi(Gi({},e),{level:e?.level||J1.level})}function mb(e,t,n=Ki){return e[n]=t,e}function rt(e,t=Ki){return e[t]||""}function Eb(e,t,n=Ki){const r=rt(e,n);return r.trim()?`${r}/${t}`:t}function it(e,t,n=Ki){const r=Eb(e,t,n),i=e.child({context:r});return mb(i,r,n)}function vb(e){var t,n;const r=new cb((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Rt.exports(Zi(Gi({},e.opts),{level:"trace",browser:Zi(Gi({},(n=e.opts)==null?void 0:n.browser),{write:i=>r.write(i)})})),chunkLoggerController:r}}function _b(e){var t;const n=new hb((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Rt.exports(Zi(Gi({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}function kf(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?vb(e):_b(e)}var xb=Object.defineProperty,Sb=(e,t,n)=>t in e?xb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zf=(e,t,n)=>Sb(e,typeof t!="symbol"?t+"":t,n);class Ib extends jn{constructor(t){super(),this.opts=t,zf(this,"protocol","wc"),zf(this,"version",2)}}var Ob=Object.defineProperty,Bb=(e,t,n)=>t in e?Ob(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Db=(e,t,n)=>Bb(e,typeof t!="symbol"?t+"":t,n);class Ab extends jn{constructor(t,n){super(),this.core=t,this.logger=n,Db(this,"records",new Map)}}class Tb{constructor(t,n){this.logger=t,this.core=n}}class Rb extends jn{constructor(t,n){super(),this.relayer=t,this.logger=n}}class Nb extends jn{constructor(t){super()}}class Cb{constructor(t,n,r,i){this.core=t,this.logger=n,this.name=r}}class Pb extends jn{constructor(t,n){super(),this.relayer=t,this.logger=n}}class $b extends jn{constructor(t,n){super(),this.core=t,this.logger=n}}class Lb{constructor(t,n,r){this.core=t,this.logger=n,this.store=r}}class Ub{constructor(t,n){this.projectId=t,this.logger=n}}class Fb{constructor(t,n,r){this.core=t,this.logger=n,this.telemetryEnabled=r}}const Bo="wc",Do=2,Wr="core",Et=`${Bo}@2:${Wr}:`,qf={name:Wr,logger:"error"},Hf={database:":memory:"},Kf="crypto",Ao="client_ed25519_seed",Vf=W.ONE_DAY,Gf="keychain",Zf="0.3",Yf="messages",Wf="0.3",Xf=W.SIX_HOURS,Jf="publisher",Qf="irn",eu="error",To="wss://relay.walletconnect.org",tu="relayer",be={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},nu="_subscription",st={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ru=.1,jb={database:":memory:"},Yi="2.23.1",Mb=1e4,qn={link_mode:"link_mode",relay:"relay"},Xr={inbound:"inbound",outbound:"outbound"},iu="0.3",su="WALLETCONNECT_CLIENT_ID",Ro="WALLETCONNECT_LINK_MODE_APPS",Ge={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},kb=W.THIRTY_DAYS,ou="subscription",au="0.3",zb=W.FIVE_SECONDS*1e3,cu="pairing",fu="0.3",qb=W.THIRTY_DAYS,ur={wc_pairingDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:W.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:W.ONE_DAY,prompt:!1,tag:0},res:{ttl:W.ONE_DAY,prompt:!1,tag:0}}},lr={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ht={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},uu="history",lu="0.3",hu="expirer",dt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},du="0.3",Hb=W.ONE_DAY,gu="verify-api",Kb="https://verify.walletconnect.com",pu="https://verify.walletconnect.org",Jr=pu,bu=`${Jr}/v3`,yu=[Kb,pu],wu="echo",mu="https://echo.walletconnect.com",Vb="event-client",Nt={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Mt={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Gb={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Zb={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Yb={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Wb={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},Eu=.1,vu="event-client",_u=86400,xu="https://pulse.walletconnect.org/batch";function Xb(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Su(e,...t){if(!Xb(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Iu(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Jb(e,t){Su(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const hr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const No=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function Qb(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Ou(e){return typeof e=="string"&&(e=Qb(e)),Su(e),e}class ey{clone(){return this._cloneInto()}}function ty(e){const t=r=>e().update(Ou(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Bu(e=32){if(hr&&typeof hr.getRandomValues=="function")return hr.getRandomValues(new Uint8Array(e));if(hr&&typeof hr.randomBytes=="function")return hr.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function ny(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,f=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+f,a,r)}class ry extends ey{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=No(this.buffer)}update(t){Iu(this);const{view:n,buffer:r,blockLen:i}=this;t=Ou(t);const s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=No(t);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Iu(this),Jb(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;ny(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=No(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<f;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%n&&t.buffer.set(r),t}}const Wi=BigInt(2**32-1),Co=BigInt(32);function Du(e,t=!1){return t?{h:Number(e&Wi),l:Number(e>>Co&Wi)}:{h:Number(e>>Co&Wi)|0,l:Number(e&Wi)|0}}function iy(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:o}=Du(e[i],t);[n[i],r[i]]=[s,o]}return[n,r]}const sy=(e,t)=>BigInt(e>>>0)<<Co|BigInt(t>>>0),oy=(e,t,n)=>e>>>n,ay=(e,t,n)=>e<<32-n|t>>>n,cy=(e,t,n)=>e>>>n|t<<32-n,fy=(e,t,n)=>e<<32-n|t>>>n,uy=(e,t,n)=>e<<64-n|t>>>n-32,ly=(e,t,n)=>e>>>n-32|t<<64-n,hy=(e,t)=>t,dy=(e,t)=>e,gy=(e,t,n)=>e<<n|t>>>32-n,py=(e,t,n)=>t<<n|e>>>32-n,by=(e,t,n)=>t<<n-32|e>>>64-n,yy=(e,t,n)=>e<<n-32|t>>>64-n;function wy(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const my=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Ey=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,vy=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),_y=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,xy=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),Sy=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,Q={fromBig:Du,split:iy,toBig:sy,shrSH:oy,shrSL:ay,rotrSH:cy,rotrSL:fy,rotrBH:uy,rotrBL:ly,rotr32H:hy,rotr32L:dy,rotlSH:gy,rotlSL:py,rotlBH:by,rotlBL:yy,add:wy,add3L:my,add3H:Ey,add4L:vy,add4H:_y,add5H:Sy,add5L:xy},[Iy,Oy]=Q.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),hn=new Uint32Array(80),dn=new Uint32Array(80);class By extends ry{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:f,El:u,Fh:d,Fl:h,Gh:l,Gl:b,Hh:w,Hl:v}=this;return[t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v]}set(t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=l|0,this.Gl=b|0,this.Hh=w|0,this.Hl=v|0}process(t,n){for(let x=0;x<16;x++,n+=4)hn[x]=t.getUint32(n),dn[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){const _=hn[x-15]|0,R=dn[x-15]|0,$=Q.rotrSH(_,R,1)^Q.rotrSH(_,R,8)^Q.shrSH(_,R,7),F=Q.rotrSL(_,R,1)^Q.rotrSL(_,R,8)^Q.shrSL(_,R,7),U=hn[x-2]|0,A=dn[x-2]|0,q=Q.rotrSH(U,A,19)^Q.rotrBH(U,A,61)^Q.shrSH(U,A,6),k=Q.rotrSL(U,A,19)^Q.rotrBL(U,A,61)^Q.shrSL(U,A,6),E=Q.add4L(F,k,dn[x-7],dn[x-16]),p=Q.add4H(E,$,q,hn[x-7],hn[x-16]);hn[x]=p|0,dn[x]=E|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:d,El:h,Fh:l,Fl:b,Gh:w,Gl:v,Hh:D,Hl:C}=this;for(let x=0;x<80;x++){const _=Q.rotrSH(d,h,14)^Q.rotrSH(d,h,18)^Q.rotrBH(d,h,41),R=Q.rotrSL(d,h,14)^Q.rotrSL(d,h,18)^Q.rotrBL(d,h,41),$=d&l^~d&w,F=h&b^~h&v,U=Q.add5L(C,R,F,Oy[x],dn[x]),A=Q.add5H(U,D,_,$,Iy[x],hn[x]),q=U|0,k=Q.rotrSH(r,i,28)^Q.rotrBH(r,i,34)^Q.rotrBH(r,i,39),E=Q.rotrSL(r,i,28)^Q.rotrBL(r,i,34)^Q.rotrBL(r,i,39),p=r&s^r&a^s&a,m=i&o^i&c^o&c;D=w|0,C=v|0,w=l|0,v=b|0,l=d|0,b=h|0,{h:d,l:h}=Q.add(f|0,u|0,A|0,q|0),f=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;const g=Q.add3L(q,E,m);r=Q.add3H(g,A,k,p),i=g|0}({h:r,l:i}=Q.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Q.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Q.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=Q.add(this.Dh|0,this.Dl|0,f|0,u|0),{h:d,l:h}=Q.add(this.Eh|0,this.El|0,d|0,h|0),{h:l,l:b}=Q.add(this.Fh|0,this.Fl|0,l|0,b|0),{h:w,l:v}=Q.add(this.Gh|0,this.Gl|0,w|0,v|0),{h:D,l:C}=Q.add(this.Hh|0,this.Hl|0,D|0,C|0),this.set(r,i,s,o,a,c,f,u,d,h,l,b,w,v,D,C)}roundClean(){hn.fill(0),dn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Dy=ty(()=>new By);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Po=BigInt(0),Au=BigInt(1),Ay=BigInt(2);function $o(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Lo(e){if(!$o(e))throw new Error("Uint8Array expected")}function Uo(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}const Ty=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Fo(e){Lo(e);let t="";for(let n=0;n<e.length;n++)t+=Ty[e[n]];return t}function Tu(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Po:BigInt("0x"+e)}const kt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ru(e){if(e>=kt._0&&e<=kt._9)return e-kt._0;if(e>=kt.A&&e<=kt.F)return e-(kt.A-10);if(e>=kt.a&&e<=kt.f)return e-(kt.a-10)}function Nu(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=Ru(e.charCodeAt(s)),a=Ru(e.charCodeAt(s+1));if(o===void 0||a===void 0){const c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=o*16+a}return r}function Ry(e){return Tu(Fo(e))}function Xi(e){return Lo(e),Tu(Fo(Uint8Array.from(e).reverse()))}function Cu(e,t){return Nu(e.toString(16).padStart(t*2,"0"))}function jo(e,t){return Cu(e,t).reverse()}function zt(e,t,n){let r;if(typeof t=="string")try{r=Nu(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if($o(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function Pu(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];Lo(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}const Mo=e=>typeof e=="bigint"&&Po<=e;function Ny(e,t,n){return Mo(e)&&Mo(t)&&Mo(n)&&t<=e&&e<n}function Qr(e,t,n,r){if(!Ny(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Cy(e){let t;for(t=0;e>Po;e>>=Au,t+=1);return t}const Py=e=>(Ay<<BigInt(e-1))-Au,$y={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||$o(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function ko(e,t,n={}){const r=(i,s,o)=>{const a=$y[s];if(typeof a!="function")throw new Error("invalid validator function");const c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(t))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return e}function $u(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}const _e=BigInt(0),ge=BigInt(1),Hn=BigInt(2),Ly=BigInt(3),zo=BigInt(4),Lu=BigInt(5),Uu=BigInt(8);function we(e,t){const n=e%t;return n>=_e?n:t+n}function Uy(e,t,n){if(t<_e)throw new Error("invalid exponent, negatives unsupported");if(n<=_e)throw new Error("invalid modulus");if(n===ge)return _e;let r=ge;for(;t>_e;)t&ge&&(r=r*e%n),e=e*e%n,t>>=ge;return r}function Ct(e,t,n){let r=e;for(;t-- >_e;)r*=r,r%=n;return r}function Fu(e,t){if(e===_e)throw new Error("invert: expected non-zero number");if(t<=_e)throw new Error("invert: expected positive modulus, got "+t);let n=we(e,t),r=t,i=_e,s=ge;for(;n!==_e;){const o=r/n,a=r%n,c=i-s*o;r=n,n=a,i=s,s=c}if(r!==ge)throw new Error("invert: does not exist");return we(i,t)}function Fy(e){const t=(e-ge)/Hn;let n,r,i;for(n=e-ge,r=0;n%Hn===_e;n/=Hn,r++);for(i=Hn;i<e&&Uy(i,t,e)!==e-ge;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(e+ge)/zo;return function(a,c){const f=a.pow(c,o);if(!a.eql(a.sqr(f),c))throw new Error("Cannot find square root");return f}}const s=(n+ge)/Hn;return function(o,a){if(o.pow(a,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,f=o.pow(o.mul(o.ONE,i),n),u=o.pow(a,s),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let b=o.sqr(d);h<c&&!o.eql(b,o.ONE);h++)b=o.sqr(b);const l=o.pow(f,ge<<BigInt(c-h-1));f=o.sqr(l),u=o.mul(u,l),d=o.mul(d,f),c=h}return u}}function jy(e){if(e%zo===Ly){const t=(e+ge)/zo;return function(n,r){const i=n.pow(r,t);if(!n.eql(n.sqr(i),r))throw new Error("Cannot find square root");return i}}if(e%Uu===Lu){const t=(e-Lu)/Uu;return function(n,r){const i=n.mul(r,Hn),s=n.pow(i,t),o=n.mul(r,s),a=n.mul(n.mul(o,Hn),s),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return Fy(e)}const My=(e,t)=>(we(e,t)&ge)===ge,ky=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function zy(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=ky.reduce((r,i)=>(r[i]="function",r),t);return ko(e,n)}function qy(e,t,n){if(n<_e)throw new Error("invalid exponent, negatives unsupported");if(n===_e)return e.ONE;if(n===ge)return t;let r=e.ONE,i=t;for(;n>_e;)n&ge&&(r=e.mul(r,i)),i=e.sqr(i),n>>=ge;return r}function Hy(e,t){const n=new Array(t.length),r=t.reduce((s,o,a)=>e.is0(o)?s:(n[a]=s,e.mul(s,o)),e.ONE),i=e.inv(r);return t.reduceRight((s,o,a)=>e.is0(o)?s:(n[a]=e.mul(s,n[a]),e.mul(s,o)),i),n}function ju(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Mu(e,t,n=!1,r={}){if(e<=_e)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=ju(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:s,MASK:Py(i),ZERO:_e,ONE:ge,create:c=>we(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return _e<=c&&c<e},is0:c=>c===_e,isOdd:c=>(c&ge)===ge,neg:c=>we(-c,e),eql:(c,f)=>c===f,sqr:c=>we(c*c,e),add:(c,f)=>we(c+f,e),sub:(c,f)=>we(c-f,e),mul:(c,f)=>we(c*f,e),pow:(c,f)=>qy(a,c,f),div:(c,f)=>we(c*Fu(f,e),e),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>Fu(c,e),sqrt:r.sqrt||(c=>(o||(o=jy(e)),o(a,c))),invertBatch:c=>Hy(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>n?jo(c,s):Cu(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return n?Xi(c):Ry(c)}});return Object.freeze(a)}const ku=BigInt(0),Ji=BigInt(1);function qo(e,t){const n=t.negate();return e?n:t}function zu(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ho(e,t){zu(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1);return{windows:n,windowSize:r}}function Ky(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function Vy(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Ko=new WeakMap,qu=new WeakMap;function Vo(e){return qu.get(e)||1}function Gy(e,t){return{constTimeNegate:qo,hasPrecomputes(n){return Vo(n)!==1},unsafeLadder(n,r,i=e.ZERO){let s=n;for(;r>ku;)r&Ji&&(i=i.add(s)),s=s.double(),r>>=Ji;return i},precomputeWindow(n,r){const{windows:i,windowSize:s}=Ho(r,t),o=[];let a=n,c=a;for(let f=0;f<i;f++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,i){const{windows:s,windowSize:o}=Ho(n,t);let a=e.ZERO,c=e.BASE;const f=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<s;h++){const l=h*o;let b=Number(i&f);i>>=d,b>o&&(b-=u,i+=Ji);const w=l,v=l+Math.abs(b)-1,D=h%2!==0,C=b<0;b===0?c=c.add(qo(D,r[w])):a=a.add(qo(C,r[v]))}return{p:a,f:c}},wNAFUnsafe(n,r,i,s=e.ZERO){const{windows:o,windowSize:a}=Ho(n,t),c=BigInt(2**n-1),f=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(i===ku)break;let l=Number(i&c);if(i>>=u,l>a&&(l-=f,i+=Ji),l===0)continue;let b=r[h+Math.abs(l)-1];l<0&&(b=b.negate()),s=s.add(b)}return s},getPrecomputes(n,r,i){let s=Ko.get(r);return s||(s=this.precomputeWindow(r,n),n!==1&&Ko.set(r,i(s))),s},wNAFCached(n,r,i){const s=Vo(n);return this.wNAF(s,this.getPrecomputes(s,n,i),r)},wNAFCachedUnsafe(n,r,i,s){const o=Vo(n);return o===1?this.unsafeLadder(n,r,s):this.wNAFUnsafe(o,this.getPrecomputes(o,n,i),r,s)},setWindowSize(n,r){zu(r,t),qu.set(n,r),Ko.delete(n)}}}function Zy(e,t,n,r){if(Ky(n,e),Vy(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,s=Cy(BigInt(n.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),f=Math.floor((t.BITS-1)/o)*o;let u=i;for(let d=f;d>=0;d-=o){c.fill(i);for(let l=0;l<r.length;l++){const b=r[l],w=Number(b>>BigInt(d)&BigInt(a));c[w]=c[w].add(n[l])}let h=i;for(let l=c.length-1,b=i;l>0;l--)b=b.add(c[l]),h=h.add(b);if(u=u.add(h),d!==0)for(let l=0;l<o;l++)u=u.double()}return u}function Yy(e){return zy(e.Fp),ko(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ju(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const vt=BigInt(0),Ze=BigInt(1),Qi=BigInt(2),Wy=BigInt(8),Xy={zip215:!0};function Jy(e){const t=Yy(e);return ko(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Qy(e){const t=Jy(e),{Fp:n,n:r,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=t,f=Qi<<BigInt(a*8)-Ze,u=n.create,d=Mu(t.n,t.nBitLength),h=t.uvRatio||((g,y)=>{try{return{isValid:!0,value:n.sqrt(g*n.inv(y))}}catch{return{isValid:!1,value:vt}}}),l=t.adjustScalarBytes||(g=>g),b=t.domain||((g,y,S)=>{if(Uo("phflag",S),y.length||S)throw new Error("Contexts/pre-hash are not supported");return g});function w(g,y){Qr("coordinate "+g,y,vt,f)}function v(g){if(!(g instanceof x))throw new Error("ExtendedPoint expected")}const D=$u((g,y)=>{const{ex:S,ey:I,ez:O}=g,B=g.is0();y==null&&(y=B?Wy:n.inv(O));const T=u(S*y),L=u(I*y),P=u(O*y);if(B)return{x:vt,y:Ze};if(P!==Ze)throw new Error("invZ was invalid");return{x:T,y:L}}),C=$u(g=>{const{a:y,d:S}=t;if(g.is0())throw new Error("bad point: ZERO");const{ex:I,ey:O,ez:B,et:T}=g,L=u(I*I),P=u(O*O),j=u(B*B),N=u(j*j),M=u(L*y),z=u(j*u(M+P)),G=u(N+u(S*u(L*P)));if(z!==G)throw new Error("bad point: equation left != right (1)");const H=u(I*O),V=u(B*T);if(H!==V)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(y,S,I,O){this.ex=y,this.ey=S,this.ez=I,this.et=O,w("x",y),w("y",S),w("z",I),w("t",O),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(y){if(y instanceof x)throw new Error("extended point not allowed");const{x:S,y:I}=y||{};return w("x",S),w("y",I),new x(S,I,Ze,u(S*I))}static normalizeZ(y){const S=n.invertBatch(y.map(I=>I.ez));return y.map((I,O)=>I.toAffine(S[O])).map(x.fromAffine)}static msm(y,S){return Zy(x,d,y,S)}_setWindowSize(y){$.setWindowSize(this,y)}assertValidity(){C(this)}equals(y){v(y);const{ex:S,ey:I,ez:O}=this,{ex:B,ey:T,ez:L}=y,P=u(S*L),j=u(B*O),N=u(I*L),M=u(T*O);return P===j&&N===M}is0(){return this.equals(x.ZERO)}negate(){return new x(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:y}=t,{ex:S,ey:I,ez:O}=this,B=u(S*S),T=u(I*I),L=u(Qi*u(O*O)),P=u(y*B),j=S+I,N=u(u(j*j)-B-T),M=P+T,z=M-L,G=P-T,H=u(N*z),V=u(M*G),J=u(N*G),ee=u(z*M);return new x(H,V,ee,J)}add(y){v(y);const{a:S,d:I}=t,{ex:O,ey:B,ez:T,et:L}=this,{ex:P,ey:j,ez:N,et:M}=y;if(S===BigInt(-1)){const up=u((B-O)*(j+P)),lp=u((B+O)*(j-P)),tf=u(lp-up);if(tf===vt)return this.double();const hp=u(T*Qi*M),dp=u(L*Qi*N),gp=dp+hp,pp=lp+up,bp=dp-hp,Lx=u(gp*tf),Ux=u(pp*bp),Fx=u(gp*bp),jx=u(tf*pp);return new x(Lx,Ux,jx,Fx)}const z=u(O*P),G=u(B*j),H=u(L*I*M),V=u(T*N),J=u((O+B)*(P+j)-z-G),ee=V-H,re=V+H,he=u(G-S*z),de=u(J*ee),fn=u(re*he),co=u(J*he),$x=u(ee*re);return new x(de,fn,$x,co)}subtract(y){return this.add(y.negate())}wNAF(y){return $.wNAFCached(this,y,x.normalizeZ)}multiply(y){const S=y;Qr("scalar",S,Ze,r);const{p:I,f:O}=this.wNAF(S);return x.normalizeZ([I,O])[0]}multiplyUnsafe(y,S=x.ZERO){const I=y;return Qr("scalar",I,vt,r),I===vt?R:this.is0()||I===Ze?this:$.wNAFCachedUnsafe(this,I,x.normalizeZ,S)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return $.unsafeLadder(this,r).is0()}toAffine(y){return D(this,y)}clearCofactor(){const{h:y}=t;return y===Ze?this:this.multiplyUnsafe(y)}static fromHex(y,S=!1){const{d:I,a:O}=t,B=n.BYTES;y=zt("pointHex",y,B),Uo("zip215",S);const T=y.slice(),L=y[B-1];T[B-1]=L&-129;const P=Xi(T),j=S?f:n.ORDER;Qr("pointHex.y",P,vt,j);const N=u(P*P),M=u(N-Ze),z=u(I*N-O);let{isValid:G,value:H}=h(M,z);if(!G)throw new Error("Point.fromHex: invalid y coordinate");const V=(H&Ze)===Ze,J=(L&128)!==0;if(!S&&H===vt&&J)throw new Error("Point.fromHex: x=0 and x_0=1");return J!==V&&(H=u(-H)),x.fromAffine({x:H,y:P})}static fromPrivateKey(y){return A(y).point}toRawBytes(){const{x:y,y:S}=this.toAffine(),I=jo(S,n.BYTES);return I[I.length-1]|=y&Ze?128:0,I}toHex(){return Fo(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,Ze,u(t.Gx*t.Gy)),x.ZERO=new x(vt,Ze,Ze,vt);const{BASE:_,ZERO:R}=x,$=Gy(x,a*8);function F(g){return we(g,r)}function U(g){return F(Xi(g))}function A(g){const y=n.BYTES;g=zt("private key",g,y);const S=zt("hashed private key",s(g),2*y),I=l(S.slice(0,y)),O=S.slice(y,2*y),B=U(I),T=_.multiply(B),L=T.toRawBytes();return{head:I,prefix:O,scalar:B,point:T,pointBytes:L}}function q(g){return A(g).pointBytes}function k(g=new Uint8Array,...y){const S=Pu(...y);return U(s(b(S,zt("context",g),!!i)))}function E(g,y,S={}){g=zt("message",g),i&&(g=i(g));const{prefix:I,scalar:O,pointBytes:B}=A(y),T=k(S.context,I,g),L=_.multiply(T).toRawBytes(),P=k(S.context,L,B,g),j=F(T+P*O);Qr("signature.s",j,vt,r);const N=Pu(L,jo(j,n.BYTES));return zt("result",N,n.BYTES*2)}const p=Xy;function m(g,y,S,I=p){const{context:O,zip215:B}=I,T=n.BYTES;g=zt("signature",g,2*T),y=zt("message",y),S=zt("publicKey",S,T),B!==void 0&&Uo("zip215",B),i&&(y=i(y));const L=Xi(g.slice(T,2*T));let P,j,N;try{P=x.fromHex(S,B),j=x.fromHex(g.slice(0,T),B),N=_.multiplyUnsafe(L)}catch{return!1}if(!B&&P.isSmallOrder())return!1;const M=k(O,j.toRawBytes(),P.toRawBytes(),y);return j.add(P.multiplyUnsafe(M)).subtract(N).clearCofactor().equals(x.ZERO)}return _._setWindowSize(8),{CURVE:t,getPublicKey:q,sign:E,verify:m,ExtendedPoint:x,utils:{getExtendedPublicKey:A,randomPrivateKey:()=>o(n.BYTES),precompute(g=8,y=x.BASE){return y._setWindowSize(g),y.multiply(BigInt(3)),y}}}}BigInt(0),BigInt(1);const Go=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Hu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const ew=BigInt(1),Ku=BigInt(2);BigInt(3);const tw=BigInt(5),nw=BigInt(8);function rw(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),s=Go,o=e*e%s*e%s,a=Ct(o,Ku,s)*o%s,c=Ct(a,ew,s)*e%s,f=Ct(c,tw,s)*c%s,u=Ct(f,t,s)*f%s,d=Ct(u,n,s)*u%s,h=Ct(d,r,s)*d%s,l=Ct(h,i,s)*h%s,b=Ct(l,i,s)*h%s,w=Ct(b,t,s)*f%s;return{pow_p_5_8:Ct(w,Ku,s)*e%s,b2:o}}function iw(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function sw(e,t){const n=Go,r=we(t*t*t,n),i=we(r*r*t,n),s=rw(e*i).pow_p_5_8;let o=we(e*r*s,n);const a=we(t*o*o,n),c=o,f=we(o*Hu,n),u=a===e,d=a===we(-e,n),h=a===we(-e*Hu,n);return u&&(o=c),(d||h)&&(o=f),My(o,n)&&(o=we(-o,n)),{isValid:u||d,value:o}}const ow=Mu(Go,void 0,!0),aw={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ow,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:nw,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Dy,randomBytes:Bu,adjustScalarBytes:iw,uvRatio:sw},Vu=Qy(aw),cw="EdDSA",fw="JWT",es=".",ts="base64url",Gu="utf8",Zu="utf8",uw=":",lw="did",hw="key",Yu="base58btc",dw="z",gw="K36",pw=32;function Zo(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Wu(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zo(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Xu(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const n=Wu(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return Zo(n)}function bw(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(n[o]!==255)throw new TypeError(s+" is ambiguous");n[o]=i}var a=e.length,c=e.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var w=0,v=0,D=0,C=b.length;D!==C&&b[D]===0;)D++,w++;for(var x=(C-D)*u+1>>>0,_=new Uint8Array(x);D!==C;){for(var R=b[D],$=0,F=x-1;(R!==0||$<v)&&F!==-1;F--,$++)R+=256*_[F]>>>0,_[F]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");v=$,D++}for(var U=x-v;U!==x&&_[U]===0;)U++;for(var A=c.repeat(w);U<x;++U)A+=e.charAt(_[U]);return A}function h(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;var w=0;if(b[w]!==" "){for(var v=0,D=0;b[w]===c;)v++,w++;for(var C=(b.length-w)*f+1>>>0,x=new Uint8Array(C);b[w];){var _=n[b.charCodeAt(w)];if(_===255)return;for(var R=0,$=C-1;(_!==0||R<D)&&$!==-1;$--,R++)_+=a*x[$]>>>0,x[$]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");D=R,w++}if(b[w]!==" "){for(var F=C-D;F!==C&&x[F]===0;)F++;for(var U=new Uint8Array(v+(C-F)),A=v;F!==C;)U[A++]=x[F++];return U}}}function l(b){var w=h(b);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:l}}var yw=bw,ww=yw;const Ju=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},mw=e=>new TextEncoder().encode(e),Ew=e=>new TextDecoder().decode(e);class vw{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class _w{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Qu(this,t)}}class xw{constructor(t){this.decoders=t}or(t){return Qu(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Qu=(e,t)=>new xw({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Sw{constructor(t,n,r,i){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new vw(t,n,r),this.decoder=new _w(t,n,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ns=({name:e,prefix:t,encode:n,decode:r})=>new Sw(e,t,n,r),ei=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=ww(n,t);return ns({prefix:e,name:t,encode:r,decode:s=>Ju(i(s))})},Iw=(e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*n/8|0);let a=0,c=0,f=0;for(let u=0;u<s;++u){const d=i[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ow=(e,t,n)=>{const r=t[t.length-1]==="=",i=(1<<n)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,s+=t[i&a>>o];if(o&&(s+=t[i&a<<n-o]),r)for(;s.length*n&7;)s+="=";return s},Oe=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>ns({prefix:t,name:e,encode(i){return Ow(i,r,n)},decode(i){return Iw(i,r,n,e)}}),Bw=ns({prefix:"\0",name:"identity",encode:e=>Ew(e),decode:e=>mw(e)});var Dw=Object.freeze({__proto__:null,identity:Bw});const Aw=Oe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Tw=Object.freeze({__proto__:null,base2:Aw});const Rw=Oe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Nw=Object.freeze({__proto__:null,base8:Rw});const Cw=ei({prefix:"9",name:"base10",alphabet:"0123456789"});var Pw=Object.freeze({__proto__:null,base10:Cw});const $w=Oe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Lw=Oe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Uw=Object.freeze({__proto__:null,base16:$w,base16upper:Lw});const Fw=Oe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jw=Oe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Mw=Oe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kw=Oe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zw=Oe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qw=Oe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hw=Oe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kw=Oe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Vw=Oe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Gw=Object.freeze({__proto__:null,base32:Fw,base32upper:jw,base32pad:Mw,base32padupper:kw,base32hex:zw,base32hexupper:qw,base32hexpad:Hw,base32hexpadupper:Kw,base32z:Vw});const Zw=ei({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Yw=ei({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ww=Object.freeze({__proto__:null,base36:Zw,base36upper:Yw});const Xw=ei({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Jw=ei({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Qw=Object.freeze({__proto__:null,base58btc:Xw,base58flickr:Jw});const em=Oe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tm=Oe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),nm=Oe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rm=Oe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var im=Object.freeze({__proto__:null,base64:em,base64pad:tm,base64url:nm,base64urlpad:rm});const el=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),sm=el.reduce((e,t,n)=>(e[n]=t,e),[]),om=el.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function am(e){return e.reduce((t,n)=>(t+=sm[n],t),"")}function cm(e){const t=[];for(const n of e){const r=om[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const fm=ns({prefix:"\u{1F680}",name:"base256emoji",encode:am,decode:cm});var um=Object.freeze({__proto__:null,base256emoji:fm}),lm=nl,tl=128,hm=127,dm=~hm,gm=Math.pow(2,31);function nl(e,t,n){t=t||[],n=n||0;for(var r=n;e>=gm;)t[n++]=e&255|tl,e/=128;for(;e&dm;)t[n++]=e&255|tl,e>>>=7;return t[n]=e|0,nl.bytes=n-r+1,t}var pm=Yo,bm=128,rl=127;function Yo(e,r){var n=0,r=r||0,i=0,s=r,o,a=e.length;do{if(s>=a)throw Yo.bytes=0,new RangeError("Could not decode varint");o=e[s++],n+=i<28?(o&rl)<<i:(o&rl)*Math.pow(2,i),i+=7}while(o>=bm);return Yo.bytes=s-r,n}var ym=Math.pow(2,7),wm=Math.pow(2,14),mm=Math.pow(2,21),Em=Math.pow(2,28),vm=Math.pow(2,35),_m=Math.pow(2,42),xm=Math.pow(2,49),Sm=Math.pow(2,56),Im=Math.pow(2,63),Om=function(e){return e<ym?1:e<wm?2:e<mm?3:e<Em?4:e<vm?5:e<_m?6:e<xm?7:e<Sm?8:e<Im?9:10},Bm={encode:lm,decode:pm,encodingLength:Om},il=Bm;const sl=(e,t,n=0)=>(il.encode(e,t,n),t),ol=e=>il.encodingLength(e),Wo=(e,t)=>{const n=t.byteLength,r=ol(e),i=r+ol(n),s=new Uint8Array(i+n);return sl(e,s,0),sl(n,s,r),s.set(t,i),new Dm(e,n,t,s)};class Dm{constructor(t,n,r,i){this.code=t,this.size=n,this.digest=r,this.bytes=i}}const al=({name:e,code:t,encode:n})=>new Am(e,t,n);class Am{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?Wo(this.code,n):n.then(r=>Wo(this.code,r))}else throw Error("Unknown type, must be binary type")}}const cl=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Tm=al({name:"sha2-256",code:18,encode:cl("SHA-256")}),Rm=al({name:"sha2-512",code:19,encode:cl("SHA-512")});var Nm=Object.freeze({__proto__:null,sha256:Tm,sha512:Rm});const fl=0,Cm="identity",ul=Ju;var Pm=Object.freeze({__proto__:null,identity:{code:fl,name:Cm,encode:ul,digest:e=>Wo(fl,ul(e))}});new TextEncoder,new TextDecoder;const ll={...Dw,...Tw,...Nw,...Pw,...Uw,...Gw,...Ww,...Qw,...im,...um};({...Nm,...Pm});function hl(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const dl=hl("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Xo=hl("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=Wu(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),gl={utf8:dl,"utf-8":dl,hex:ll.base16,latin1:Xo,ascii:Xo,binary:Xo,...ll};function rs(e,t="utf8"){const n=gl[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}function dr(e,t="utf8"){const n=gl[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zo(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}function pl(e){return cr(rs(dr(e,ts),Gu))}function is(e){return rs(dr(Zr(e),Gu),ts)}function bl(e){const t=dr(gw,Yu),n=dw+rs(Xu([t,e]),Yu);return[lw,hw,n].join(uw)}function $m(e){return rs(e,ts)}function Lm(e){return dr(e,ts)}function Um(e){return dr([is(e.header),is(e.payload)].join(es),Zu)}function Fm(e){return[is(e.header),is(e.payload),$m(e.signature)].join(es)}function Jo(e){const t=e.split(es),n=pl(t[0]),r=pl(t[1]),i=Lm(t[2]),s=dr(t.slice(0,2).join(es),Zu);return{header:n,payload:r,signature:i,data:s}}function yl(e=Bu(pw)){const t=Vu.getPublicKey(e);return{secretKey:Xu([e,t]),publicKey:t}}async function jm(e,t,n,r,i=W.fromMiliseconds(Date.now())){const s={alg:cw,typ:fw},o=bl(r.publicKey),a=i+n,c={iss:o,sub:e,aud:t,iat:i,exp:a},f=Um({header:s,payload:c}),u=Vu.sign(f,r.secretKey.slice(0,32));return Fm({header:s,payload:c,signature:u})}function Mm(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(n[o]!==255)throw new TypeError(s+" is ambiguous");n[o]=i}var a=e.length,c=e.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var w=0,v=0,D=0,C=b.length;D!==C&&b[D]===0;)D++,w++;for(var x=(C-D)*u+1>>>0,_=new Uint8Array(x);D!==C;){for(var R=b[D],$=0,F=x-1;(R!==0||$<v)&&F!==-1;F--,$++)R+=256*_[F]>>>0,_[F]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");v=$,D++}for(var U=x-v;U!==x&&_[U]===0;)U++;for(var A=c.repeat(w);U<x;++U)A+=e.charAt(_[U]);return A}function h(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;var w=0;if(b[w]!==" "){for(var v=0,D=0;b[w]===c;)v++,w++;for(var C=(b.length-w)*f+1>>>0,x=new Uint8Array(C);b[w];){var _=n[b.charCodeAt(w)];if(_===255)return;for(var R=0,$=C-1;(_!==0||R<D)&&$!==-1;$--,R++)_+=a*x[$]>>>0,x[$]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");D=R,w++}if(b[w]!==" "){for(var F=C-D;F!==C&&x[F]===0;)F++;for(var U=new Uint8Array(v+(C-F)),A=v;F!==C;)U[A++]=x[F++];return U}}}function l(b){var w=h(b);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:l}}var km=Mm,zm=km;const wl=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},qm=e=>new TextEncoder().encode(e),Hm=e=>new TextDecoder().decode(e);class Km{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Vm{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ml(this,t)}}class Gm{constructor(t){this.decoders=t}or(t){return ml(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ml=(e,t)=>new Gm({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Zm{constructor(t,n,r,i){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new Km(t,n,r),this.decoder=new Vm(t,n,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ss=({name:e,prefix:t,encode:n,decode:r})=>new Zm(e,t,n,r),ti=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=zm(n,t);return ss({prefix:e,name:t,encode:r,decode:s=>wl(i(s))})},Ym=(e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*n/8|0);let a=0,c=0,f=0;for(let u=0;u<s;++u){const d=i[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Wm=(e,t,n)=>{const r=t[t.length-1]==="=",i=(1<<n)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,s+=t[i&a>>o];if(o&&(s+=t[i&a<<n-o]),r)for(;s.length*n&7;)s+="=";return s},Be=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>ss({prefix:t,name:e,encode(i){return Wm(i,r,n)},decode(i){return Ym(i,r,n,e)}}),Xm=ss({prefix:"\0",name:"identity",encode:e=>Hm(e),decode:e=>qm(e)});var Jm=Object.freeze({__proto__:null,identity:Xm});const Qm=Be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var e2=Object.freeze({__proto__:null,base2:Qm});const t2=Be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var n2=Object.freeze({__proto__:null,base8:t2});const r2=ti({prefix:"9",name:"base10",alphabet:"0123456789"});var i2=Object.freeze({__proto__:null,base10:r2});const s2=Be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),o2=Be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var a2=Object.freeze({__proto__:null,base16:s2,base16upper:o2});const c2=Be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),f2=Be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),u2=Be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),l2=Be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),h2=Be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),d2=Be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),g2=Be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),p2=Be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),b2=Be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var y2=Object.freeze({__proto__:null,base32:c2,base32upper:f2,base32pad:u2,base32padupper:l2,base32hex:h2,base32hexupper:d2,base32hexpad:g2,base32hexpadupper:p2,base32z:b2});const w2=ti({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),m2=ti({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var E2=Object.freeze({__proto__:null,base36:w2,base36upper:m2});const v2=ti({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_2=ti({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var x2=Object.freeze({__proto__:null,base58btc:v2,base58flickr:_2});const S2=Be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),I2=Be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),O2=Be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),B2=Be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var D2=Object.freeze({__proto__:null,base64:S2,base64pad:I2,base64url:O2,base64urlpad:B2});const El=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),A2=El.reduce((e,t,n)=>(e[n]=t,e),[]),T2=El.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function R2(e){return e.reduce((t,n)=>(t+=A2[n],t),"")}function N2(e){const t=[];for(const n of e){const r=T2[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const C2=ss({prefix:"\u{1F680}",name:"base256emoji",encode:R2,decode:N2});var P2=Object.freeze({__proto__:null,base256emoji:C2}),$2=_l,vl=128,L2=127,U2=~L2,F2=Math.pow(2,31);function _l(e,t,n){t=t||[],n=n||0;for(var r=n;e>=F2;)t[n++]=e&255|vl,e/=128;for(;e&U2;)t[n++]=e&255|vl,e>>>=7;return t[n]=e|0,_l.bytes=n-r+1,t}var j2=Qo,M2=128,xl=127;function Qo(e,r){var n=0,r=r||0,i=0,s=r,o,a=e.length;do{if(s>=a)throw Qo.bytes=0,new RangeError("Could not decode varint");o=e[s++],n+=i<28?(o&xl)<<i:(o&xl)*Math.pow(2,i),i+=7}while(o>=M2);return Qo.bytes=s-r,n}var k2=Math.pow(2,7),z2=Math.pow(2,14),q2=Math.pow(2,21),H2=Math.pow(2,28),K2=Math.pow(2,35),V2=Math.pow(2,42),G2=Math.pow(2,49),Z2=Math.pow(2,56),Y2=Math.pow(2,63),W2=function(e){return e<k2?1:e<z2?2:e<q2?3:e<H2?4:e<K2?5:e<V2?6:e<G2?7:e<Z2?8:e<Y2?9:10},X2={encode:$2,decode:j2,encodingLength:W2},Sl=X2;const Il=(e,t,n=0)=>(Sl.encode(e,t,n),t),Ol=e=>Sl.encodingLength(e),ea=(e,t)=>{const n=t.byteLength,r=Ol(e),i=r+Ol(n),s=new Uint8Array(i+n);return Il(e,s,0),Il(n,s,r),s.set(t,i),new J2(e,n,t,s)};class J2{constructor(t,n,r,i){this.code=t,this.size=n,this.digest=r,this.bytes=i}}const Bl=({name:e,code:t,encode:n})=>new Q2(e,t,n);class Q2{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?ea(this.code,n):n.then(r=>ea(this.code,r))}else throw Error("Unknown type, must be binary type")}}const Dl=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),eE=Bl({name:"sha2-256",code:18,encode:Dl("SHA-256")}),tE=Bl({name:"sha2-512",code:19,encode:Dl("SHA-512")});var nE=Object.freeze({__proto__:null,sha256:eE,sha512:tE});const Al=0,rE="identity",Tl=wl;var iE=Object.freeze({__proto__:null,identity:{code:Al,name:rE,encode:Tl,digest:e=>ea(Al,Tl(e))}});new TextEncoder,new TextDecoder;const Rl={...Jm,...e2,...n2,...i2,...a2,...y2,...E2,...x2,...D2,...P2};({...nE,...iE});function ta(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Nl(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ta(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Cl(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Pl=Cl("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),na=Cl("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=Nl(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),$l={utf8:Pl,"utf-8":Pl,hex:Rl.base16,latin1:na,ascii:na,binary:na,...Rl};function ot(e,t="utf8"){const n=$l[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ta(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}var Ll=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},sE=function(){function e(t,n,r){this.name=t,this.version=n,this.os=r,this.type="browser"}return e}(),oE=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),aE=function(){function e(t,n,r,i){this.name=t,this.version=n,this.os=r,this.bot=i,this.type="bot-device"}return e}(),cE=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),fE=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),uE=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,lE=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ul=3,hE=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",uE]],Fl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function dE(e){return e?jl(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new fE:typeof navigator<"u"?jl(navigator.userAgent):bE()}function gE(e){return e!==""&&hE.reduce(function(t,n){var r=n[0],i=n[1];if(t)return t;var s=i.exec(e);return!!s&&[r,s]},!1)}function jl(e){var t=gE(e);if(!t)return null;var n=t[0],r=t[1];if(n==="searchbot")return new cE;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ul&&(i=Ll(Ll([],i,!0),yE(Ul-i.length),!0)):i=[];var s=i.join("."),o=pE(e),a=lE.exec(e);return a&&a[1]?new aE(n,s,o,a[1]):new sE(n,s,o)}function pE(e){for(var t=0,n=Fl.length;t<n;t++){var r=Fl[t],i=r[0],s=r[1],o=s.exec(e);if(o)return i}return null}function bE(){var e=typeof process<"u"&&process.version;return e?new oE(process.version.slice(1)):null}function yE(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}var ue={};Object.defineProperty(ue,"__esModule",{value:!0}),ue.getLocalStorage=ue.getLocalStorageOrThrow=ue.getCrypto=ue.getCryptoOrThrow=Ml=ue.getLocation=ue.getLocationOrThrow=ra=ue.getNavigator=ue.getNavigatorOrThrow=pr=ue.getDocument=ue.getDocumentOrThrow=ue.getFromWindowOrThrow=ue.getFromWindow=void 0;function Kn(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}ue.getFromWindow=Kn;function gr(e){const t=Kn(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}ue.getFromWindowOrThrow=gr;function wE(){return gr("document")}ue.getDocumentOrThrow=wE;function mE(){return Kn("document")}var pr=ue.getDocument=mE;function EE(){return gr("navigator")}ue.getNavigatorOrThrow=EE;function vE(){return Kn("navigator")}var ra=ue.getNavigator=vE;function _E(){return gr("location")}ue.getLocationOrThrow=_E;function xE(){return Kn("location")}var Ml=ue.getLocation=xE;function SE(){return gr("crypto")}ue.getCryptoOrThrow=SE;function IE(){return Kn("crypto")}ue.getCrypto=IE;function OE(){return gr("localStorage")}ue.getLocalStorageOrThrow=OE;function BE(){return Kn("localStorage")}ue.getLocalStorage=BE;var ia={};Object.defineProperty(ia,"__esModule",{value:!0});var kl=ia.getWindowMetadata=void 0;const zl=ue;function DE(){let e,t;try{e=zl.getDocumentOrThrow(),t=zl.getLocationOrThrow()}catch{return null}function n(){const d=e.getElementsByTagName("link"),h=[];for(let l=0;l<d.length;l++){const b=d[l],w=b.getAttribute("rel");if(w&&w.toLowerCase().indexOf("icon")>-1){const v=b.getAttribute("href");if(v)if(v.toLowerCase().indexOf("https:")===-1&&v.toLowerCase().indexOf("http:")===-1&&v.indexOf("//")!==0){let D=t.protocol+"//"+t.host;if(v.indexOf("/")===0)D+=v;else{const C=t.pathname.split("/");C.pop();const x=C.join("/");D+=x+"/"+v}h.push(D)}else if(v.indexOf("//")===0){const D=t.protocol+v;h.push(D)}else h.push(v)}}return h}function r(...d){const h=e.getElementsByTagName("meta");for(let l=0;l<h.length;l++){const b=h[l],w=["itemprop","property","name"].map(v=>b.getAttribute(v)).filter(v=>v?d.includes(v):!1);if(w.length&&w){const v=b.getAttribute("content");if(v)return v}}return""}function i(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=e.title),d}function s(){return r("description","og:description","twitter:description","keywords")}const o=i(),a=s(),c=t.origin,f=n();return{description:a,url:c,icons:f,name:o}}kl=ia.getWindowMetadata=DE;const AE="0.1.1";function TE(){return AE}class Fe extends Error{constructor(t,n={}){const r=(()=>{if(n.cause instanceof Fe){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),i=n.cause instanceof Fe&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${i??""}`,a=[t||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||i?["",r?`Details: ${r}`:void 0,i?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${TE()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=i,this.shortMessage=t}walk(t){return ql(this,t)}}function ql(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause?ql(e.cause,t):t?null:e}const br=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function os(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function yr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function qt(e,...t){if(!os(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Hl(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");yr(e.outputLen),yr(e.blockLen)}function wr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Kl(e,t){qt(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function RE(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function gn(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function sa(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pt(e,t){return e<<32-t|e>>>t}const NE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function CE(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function PE(e){for(let t=0;t<e.length;t++)e[t]=CE(e[t]);return e}const Vl=NE?e=>e:PE,Gl=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",$E=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function mr(e){if(qt(e),Gl)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=$E[e[n]];return t}const Ht={_0:48,_9:57,A:65,F:70,a:97,f:102};function Zl(e){if(e>=Ht._0&&e<=Ht._9)return e-Ht._0;if(e>=Ht.A&&e<=Ht.F)return e-(Ht.A-10);if(e>=Ht.a&&e<=Ht.f)return e-(Ht.a-10)}function as(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Gl)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=Zl(e.charCodeAt(s)),a=Zl(e.charCodeAt(s+1));if(o===void 0||a===void 0){const c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=o*16+a}return r}function oa(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function cs(e){return typeof e=="string"&&(e=oa(e)),qt(e),e}function Kt(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];qt(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}class aa{}function fs(e){const t=r=>e().update(cs(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function us(e=32){if(br&&typeof br.getRandomValues=="function")return br.getRandomValues(new Uint8Array(e));if(br&&typeof br.randomBytes=="function")return Uint8Array.from(br.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function LE(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,f=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+f,a,r)}function UE(e,t,n){return e&t^~e&n}function FE(e,t,n){return e&t^e&n^t&n}class Yl extends aa{constructor(t,n,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(t),this.view=sa(this.buffer)}update(t){wr(this),t=cs(t),qt(t);const{view:n,buffer:r,blockLen:i}=this,s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=sa(t);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){wr(this),Kl(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,gn(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;LE(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=sa(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<f;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=s,t.length=i,t.pos=a,i%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const Vt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Te=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Re=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),ls=BigInt(2**32-1),Wl=BigInt(32);function jE(e,t=!1){return t?{h:Number(e&ls),l:Number(e>>Wl&ls)}:{h:Number(e>>Wl&ls)|0,l:Number(e&ls)|0}}function Xl(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let s=0;s<n;s++){const{h:o,l:a}=jE(e[s],t);[r[s],i[s]]=[o,a]}return[r,i]}const Jl=(e,t,n)=>e>>>n,Ql=(e,t,n)=>e<<32-n|t>>>n,Er=(e,t,n)=>e>>>n|t<<32-n,vr=(e,t,n)=>e<<32-n|t>>>n,hs=(e,t,n)=>e<<64-n|t>>>n-32,ds=(e,t,n)=>e>>>n-32|t<<64-n,ME=(e,t,n)=>e<<n|t>>>32-n,kE=(e,t,n)=>t<<n|e>>>32-n,zE=(e,t,n)=>t<<n-32|e>>>64-n,qE=(e,t,n)=>e<<n-32|t>>>64-n;function Gt(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const HE=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),KE=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,VE=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),GE=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,ZE=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),YE=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,WE=BigInt(0),ni=BigInt(1),XE=BigInt(2),JE=BigInt(7),QE=BigInt(256),ev=BigInt(113),eh=[],th=[],nh=[];for(let e=0,t=ni,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],eh.push(2*(5*r+n)),th.push((e+1)*(e+2)/2%64);let i=WE;for(let s=0;s<7;s++)t=(t<<ni^(t>>JE)*ev)%QE,t&XE&&(i^=ni<<(ni<<BigInt(s))-ni);nh.push(i)}const rh=Xl(nh,!0),tv=rh[0],nv=rh[1],ih=(e,t,n)=>n>32?zE(e,t,n):ME(e,t,n),sh=(e,t,n)=>n>32?qE(e,t,n):kE(e,t,n);function rv(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,f=n[c],u=n[c+1],d=ih(f,u,1)^n[a],h=sh(f,u,1)^n[a+1];for(let l=0;l<50;l+=10)e[o+l]^=d,e[o+l+1]^=h}let i=e[2],s=e[3];for(let o=0;o<24;o++){const a=th[o],c=ih(i,s,a),f=sh(i,s,a),u=eh[o];i=e[u],s=e[u+1],e[u]=c,e[u+1]=f}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=tv[r],e[1]^=nv[r]}gn(n)}class ca extends aa{constructor(t,n,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=i,this.rounds=s,yr(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=RE(this.state)}clone(){return this._cloneInto()}keccak(){Vl(this.state32),rv(this.state32,this.rounds),Vl(this.state32),this.posOut=0,this.pos=0}update(t){wr(this),t=cs(t),qt(t);const{blockLen:n,state:r}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:i}=this;t[r]^=n,(n&128)!==0&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){wr(this,!1),qt(t),this.finish();const n=this.state,{blockLen:r}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return yr(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Kl(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,gn(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new ca(n,r,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}}const iv=(e,t,n)=>fs(()=>new ca(t,e,n)),sv=iv(1,136,256/8),ov=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),pn=new Uint32Array(64);class av extends Yl{constructor(t=32){super(64,t,8,!1),this.A=Vt[0]|0,this.B=Vt[1]|0,this.C=Vt[2]|0,this.D=Vt[3]|0,this.E=Vt[4]|0,this.F=Vt[5]|0,this.G=Vt[6]|0,this.H=Vt[7]|0}get(){const{A:t,B:n,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[t,n,r,i,s,o,a,c]}set(t,n,r,i,s,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)pn[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=pn[d-15],l=pn[d-2],b=Pt(h,7)^Pt(h,18)^h>>>3,w=Pt(l,17)^Pt(l,19)^l>>>10;pn[d]=w+pn[d-7]+b+pn[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:f,H:u}=this;for(let d=0;d<64;d++){const h=Pt(a,6)^Pt(a,11)^Pt(a,25),l=u+h+UE(a,c,f)+ov[d]+pn[d]|0,w=(Pt(r,2)^Pt(r,13)^Pt(r,22))+FE(r,i,s)|0;u=f,f=c,c=a,a=o+l|0,o=s,s=i,i=r,r=l+w|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,f,u)}roundClean(){gn(pn)}destroy(){this.set(0,0,0,0,0,0,0,0),gn(this.buffer)}}const oh=Xl(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),cv=oh[0],fv=oh[1],bn=new Uint32Array(80),yn=new Uint32Array(80);class ah extends Yl{constructor(t=64){super(128,t,16,!1),this.Ah=Re[0]|0,this.Al=Re[1]|0,this.Bh=Re[2]|0,this.Bl=Re[3]|0,this.Ch=Re[4]|0,this.Cl=Re[5]|0,this.Dh=Re[6]|0,this.Dl=Re[7]|0,this.Eh=Re[8]|0,this.El=Re[9]|0,this.Fh=Re[10]|0,this.Fl=Re[11]|0,this.Gh=Re[12]|0,this.Gl=Re[13]|0,this.Hh=Re[14]|0,this.Hl=Re[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:f,El:u,Fh:d,Fl:h,Gh:l,Gl:b,Hh:w,Hl:v}=this;return[t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v]}set(t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=l|0,this.Gl=b|0,this.Hh=w|0,this.Hl=v|0}process(t,n){for(let x=0;x<16;x++,n+=4)bn[x]=t.getUint32(n),yn[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){const _=bn[x-15]|0,R=yn[x-15]|0,$=Er(_,R,1)^Er(_,R,8)^Jl(_,R,7),F=vr(_,R,1)^vr(_,R,8)^Ql(_,R,7),U=bn[x-2]|0,A=yn[x-2]|0,q=Er(U,A,19)^hs(U,A,61)^Jl(U,A,6),k=vr(U,A,19)^ds(U,A,61)^Ql(U,A,6),E=VE(F,k,yn[x-7],yn[x-16]),p=GE(E,$,q,bn[x-7],bn[x-16]);bn[x]=p|0,yn[x]=E|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:d,El:h,Fh:l,Fl:b,Gh:w,Gl:v,Hh:D,Hl:C}=this;for(let x=0;x<80;x++){const _=Er(d,h,14)^Er(d,h,18)^hs(d,h,41),R=vr(d,h,14)^vr(d,h,18)^ds(d,h,41),$=d&l^~d&w,F=h&b^~h&v,U=ZE(C,R,F,fv[x],yn[x]),A=YE(U,D,_,$,cv[x],bn[x]),q=U|0,k=Er(r,i,28)^hs(r,i,34)^hs(r,i,39),E=vr(r,i,28)^ds(r,i,34)^ds(r,i,39),p=r&s^r&a^s&a,m=i&o^i&c^o&c;D=w|0,C=v|0,w=l|0,v=b|0,l=d|0,b=h|0,{h:d,l:h}=Gt(f|0,u|0,A|0,q|0),f=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;const g=HE(q,E,m);r=KE(g,A,k,p),i=g|0}({h:r,l:i}=Gt(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Gt(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Gt(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=Gt(this.Dh|0,this.Dl|0,f|0,u|0),{h:d,l:h}=Gt(this.Eh|0,this.El|0,d|0,h|0),{h:l,l:b}=Gt(this.Fh|0,this.Fl|0,l|0,b|0),{h:w,l:v}=Gt(this.Gh|0,this.Gl|0,w|0,v|0),{h:D,l:C}=Gt(this.Hh|0,this.Hl|0,D|0,C|0),this.set(r,i,s,o,a,c,f,u,d,h,l,b,w,v,D,C)}roundClean(){gn(bn,yn)}destroy(){gn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class uv extends ah{constructor(){super(48),this.Ah=Te[0]|0,this.Al=Te[1]|0,this.Bh=Te[2]|0,this.Bl=Te[3]|0,this.Ch=Te[4]|0,this.Cl=Te[5]|0,this.Dh=Te[6]|0,this.Dl=Te[7]|0,this.Eh=Te[8]|0,this.El=Te[9]|0,this.Fh=Te[10]|0,this.Fl=Te[11]|0,this.Gh=Te[12]|0,this.Gl=Te[13]|0,this.Hh=Te[14]|0,this.Hl=Te[15]|0}}const _r=fs(()=>new av),lv=fs(()=>new ah),hv=fs(()=>new uv);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fa=BigInt(0),gs=BigInt(1);function ri(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function wn(e){if(!ri(e))throw new Error("Uint8Array expected")}function ii(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function ps(e){const t=e.toString(16);return t.length&1?"0"+t:t}function ch(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?fa:BigInt("0x"+e)}const fh=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",dv=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Vn(e){if(wn(e),fh)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=dv[e[n]];return t}const Zt={_0:48,_9:57,A:65,F:70,a:97,f:102};function uh(e){if(e>=Zt._0&&e<=Zt._9)return e-Zt._0;if(e>=Zt.A&&e<=Zt.F)return e-(Zt.A-10);if(e>=Zt.a&&e<=Zt.f)return e-(Zt.a-10)}function bs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(fh)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=uh(e.charCodeAt(s)),a=uh(e.charCodeAt(s+1));if(o===void 0||a===void 0){const c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=o*16+a}return r}function je(e){return ch(Vn(e))}function lh(e){return wn(e),ch(Vn(Uint8Array.from(e).reverse()))}function me(e,t){return bs(e.toString(16).padStart(t*2,"0"))}function hh(e,t){return me(e,t).reverse()}function Ne(e,t,n){let r;if(typeof t=="string")try{r=bs(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(ri(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function pe(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];wn(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}function ua(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}const la=e=>typeof e=="bigint"&&fa<=e;function ha(e,t,n){return la(e)&&la(t)&&la(n)&&t<=e&&e<n}function xr(e,t,n,r){if(!ha(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function si(e){let t;for(t=0;e>fa;e>>=gs,t+=1);return t}function gv(e,t){return e>>BigInt(t)&gs}const Gn=e=>(gs<<BigInt(e))-gs,da=e=>new Uint8Array(e),dh=e=>Uint8Array.from(e);function pv(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=da(e),i=da(e),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...d)=>n(i,r,...d),c=(d=da(0))=>{i=a(dh([0]),d),r=a(),d.length!==0&&(i=a(dh([1]),d),r=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<t;){r=a();const l=r.slice();h.push(l),d+=r.length}return pe(...h)};return(d,h)=>{o(),c(d);let l;for(;!(l=h(f()));)c();return o(),l}}const bv={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||ri(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function oi(e,t,n={}){const r=(i,s,o)=>{const a=bv[s];if(typeof a!="function")throw new Error("invalid validator function");const c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(t))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return e}const gh=()=>{throw new Error("not implemented")};function ga(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}function yv(e,t){if(mh(e)>t)throw new Cv({givenSize:mh(e),maxSize:t})}const Yt={zero:48,nine:57,A:65,F:70,a:97,f:102};function ph(e){if(e>=Yt.zero&&e<=Yt.nine)return e-Yt.zero;if(e>=Yt.A&&e<=Yt.F)return e-(Yt.A-10);if(e>=Yt.a&&e<=Yt.f)return e-(Yt.a-10)}function wv(e,t={}){const{dir:n,size:r=32}=t;if(r===0)return e;if(e.length>r)throw new Pv({size:e.length,targetSize:r,type:"Bytes"});const i=new Uint8Array(r);for(let s=0;s<r;s++){const o=n==="right";i[o?s:r-s-1]=e[o?s:e.length-s-1]}return i}function pa(e,t){if(ya(e)>t)throw new Iv({givenSize:ya(e),maxSize:t})}function bh(e,t={}){const{dir:n,size:r=32}=t;if(r===0)return e;const i=e.replace("0x","");if(i.length>r*2)throw new Ov({size:Math.ceil(i.length/2),targetSize:r,type:"Hex"});return`0x${i[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const mv=new TextEncoder,Ev=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function yh(...e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function vv(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(pa(n,t.size),ys(n,t.size)):n}function wh(e,t={}){let n="";for(let i=0;i<e.length;i++)n+=Ev[e[i]];const r=`0x${n}`;return typeof t.size=="number"?(pa(r,t.size),ba(r,t.size)):r}function _v(e,t={}){const{signed:n,size:r}=t,i=BigInt(e);let s;r?n?s=(1n<<BigInt(r)*8n-1n)-1n:s=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&n?-s-1n:0;if(s&&i>s||i<o){const f=typeof e=="bigint"?"n":"";throw new Sv({max:s?`${s}${f}`:void 0,min:`${o}${f}`,signed:n,size:r,value:`${e}${f}`})}const c=`0x${(n&&i<0?(1n<<BigInt(r*8))+BigInt(i):i).toString(16)}`;return r?ys(c,r):c}function xv(e,t={}){return wh(mv.encode(e),t)}function ys(e,t){return bh(e,{dir:"left",size:t})}function ba(e,t){return bh(e,{dir:"right",size:t})}function ya(e){return Math.ceil((e.length-2)/2)}class Sv extends Fe{constructor({max:t,min:n,signed:r,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${i*8}-bit`:""}${r?" signed":" unsigned"} integer range ${t?`(\`${n}\` to \`${t}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Iv extends Fe{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class Ov extends Fe{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}const Bv=new TextEncoder;function Dv(e){return e instanceof Uint8Array?e:typeof e=="string"?Tv(e):Av(e)}function Av(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function Tv(e,t={}){const{size:n}=t;let r=e;n&&(pa(e,n),r=ba(e,n));let i=r.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const f=ph(i.charCodeAt(c++)),u=ph(i.charCodeAt(c++));if(f===void 0||u===void 0)throw new Fe(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);o[a]=f*16+u}return o}function Rv(e,t={}){const{size:n}=t,r=Bv.encode(e);return typeof n=="number"?(yv(r,n),Nv(r,n)):r}function Nv(e,t){return wv(e,{dir:"right",size:t})}function mh(e){return e.length}class Cv extends Fe{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class Pv extends Fe{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function $v(e,t={}){const{as:n=typeof e=="string"?"Hex":"Bytes"}=t,r=sv(Dv(e));return n==="Bytes"?r:wh(r)}class Lv extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const wa={checksum:new Lv(8192)}.checksum,Uv=/^0x[a-fA-F0-9]{40}$/;function Eh(e,t={}){const{strict:n=!0}=t;if(!Uv.test(e))throw new vh({address:e,cause:new jv});if(n){if(e.toLowerCase()===e)return;if(Fv(e)!==e)throw new vh({address:e,cause:new Mv})}}function Fv(e){if(wa.has(e))return wa.get(e);Eh(e,{strict:!1});const t=e.substring(2).toLowerCase(),n=$v(Rv(t),{as:"Bytes"}),r=t.split("");for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&r[s]&&(r[s]=r[s].toUpperCase()),(n[s>>1]&15)>=8&&r[s+1]&&(r[s+1]=r[s+1].toUpperCase());const i=`0x${r.join("")}`;return wa.set(e,i),i}class vh extends Fe{constructor({address:t,cause:n}){super(`Address "${t}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class jv extends Fe{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class Mv extends Fe{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const kv=/^(.*)\[([0-9]*)\]$/,zv=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,qv=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function ma(e,t){if(e.length!==t.length)throw new Kv({expectedLength:e.length,givenLength:t.length});const n=[];for(let r=0;r<e.length;r++){const i=e[r],s=t[r];n.push(ma.encode(i,s))}return yh(...n)}(function(e){function t(n,r,i=!1){if(n==="address"){const c=r;return Eh(c),ys(c.toLowerCase(),i?32:0)}if(n==="string")return xv(r);if(n==="bytes")return r;if(n==="bool")return ys(vv(r),i?32:1);const s=n.match(qv);if(s){const[c,f,u="256"]=s,d=Number.parseInt(u,10)/8;return _v(r,{size:i?32:d,signed:f==="int"})}const o=n.match(zv);if(o){const[c,f]=o;if(Number.parseInt(f,10)!==(r.length-2)/2)throw new Hv({expectedSize:Number.parseInt(f,10),value:r});return ba(r,i?32:0)}const a=n.match(kv);if(a&&Array.isArray(r)){const[c,f]=a,u=[];for(let d=0;d<r.length;d++)u.push(t(f,r[d],!0));return u.length===0?"0x":yh(...u)}throw new Vv(n)}e.encode=t})(ma||(ma={}));class Hv extends Fe{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${ya(n)}) does not match expected size (bytes${t}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class Kv extends Fe{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${t}`,`Given length (values): ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class Vv extends Fe{constructor(t){super(`Type \`${t}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class _h extends aa{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Hl(t);const r=cs(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?t.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),gn(s)}update(t){return wr(this),this.iHash.update(t),this}digestInto(t){wr(this),qt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ea=(e,t,n)=>new _h(e,t).update(n).digest();Ea.create=(e,t)=>new _h(e,t);const Ye=BigInt(0),Me=BigInt(1),Zn=BigInt(2),Gv=BigInt(3),xh=BigInt(4),Sh=BigInt(5),Ih=BigInt(8);function ke(e,t){const n=e%t;return n>=Ye?n:t+n}function gt(e,t,n){let r=e;for(;t-- >Ye;)r*=r,r%=n;return r}function va(e,t){if(e===Ye)throw new Error("invert: expected non-zero number");if(t<=Ye)throw new Error("invert: expected positive modulus, got "+t);let n=ke(e,t),r=t,i=Ye,s=Me;for(;n!==Ye;){const a=r/n,c=r%n,f=i-s*a;r=n,n=c,i=s,s=f}if(r!==Me)throw new Error("invert: does not exist");return ke(i,t)}function Oh(e,t){const n=(e.ORDER+Me)/xh,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function Zv(e,t){const n=(e.ORDER-Sh)/Ih,r=e.mul(t,Zn),i=e.pow(r,n),s=e.mul(t,i),o=e.mul(e.mul(s,Zn),i),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function Yv(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Me,n=0;for(;t%Zn===Ye;)t/=Zn,n++;let r=Zn;const i=mn(e);for(;ms(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Oh;let s=i.pow(r,t);const o=(t+Me)/Zn;return function(c,f){if(c.is0(f))return f;if(ms(c,f)!==1)throw new Error("Cannot find square root");let u=n,d=c.mul(c.ONE,s),h=c.pow(f,t),l=c.pow(f,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let b=1,w=c.sqr(h);for(;!c.eql(w,c.ONE);)if(b++,w=c.sqr(w),b===u)throw new Error("Cannot find square root");const v=Me<<BigInt(u-b-1),D=c.pow(d,v);u=b,d=c.sqr(D),h=c.mul(h,d),l=c.mul(l,D)}return l}}function Wv(e){return e%xh===Gv?Oh:e%Ih===Sh?Zv:Yv(e)}const Xv=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Bh(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Xv.reduce((r,i)=>(r[i]="function",r),t);return oi(e,n)}function ws(e,t,n){if(n<Ye)throw new Error("invalid exponent, negatives unsupported");if(n===Ye)return e.ONE;if(n===Me)return t;let r=e.ONE,i=t;for(;n>Ye;)n&Me&&(r=e.mul(r,i)),i=e.sqr(i),n>>=Me;return r}function Yn(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((o,a,c)=>e.is0(a)?o:(r[c]=o,e.mul(o,a)),e.ONE),s=e.inv(i);return t.reduceRight((o,a,c)=>e.is0(a)?o:(r[c]=e.mul(o,r[c]),e.mul(o,a)),s),r}function ms(e,t){const n=(e.ORDER-Me)/Zn,r=e.pow(t,n),i=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function Dh(e,t){t!==void 0&&yr(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function mn(e,t,n=!1,r={}){if(e<=Ye)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=Dh(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:s,MASK:Gn(i),ZERO:Ye,ONE:Me,create:c=>ke(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ye<=c&&c<e},is0:c=>c===Ye,isOdd:c=>(c&Me)===Me,neg:c=>ke(-c,e),eql:(c,f)=>c===f,sqr:c=>ke(c*c,e),add:(c,f)=>ke(c+f,e),sub:(c,f)=>ke(c-f,e),mul:(c,f)=>ke(c*f,e),pow:(c,f)=>ws(a,c,f),div:(c,f)=>ke(c*va(f,e),e),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>va(c,e),sqrt:r.sqrt||(c=>(o||(o=Wv(e)),o(a,c))),toBytes:c=>n?hh(c,s):me(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return n?lh(c):je(c)},invertBatch:c=>Yn(a,c),cmov:(c,f,u)=>u?f:c});return Object.freeze(a)}function Ah(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function _a(e){const t=Ah(e);return t+Math.ceil(t/2)}function Th(e,t,n=!1){const r=e.length,i=Ah(t),s=_a(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=n?lh(e):je(e),a=ke(o,t-Me)+Me;return n?hh(a,i):me(a,i)}const Rh=BigInt(0),xa=BigInt(1);function Sa(e,t){const n=t.negate();return e?n:t}function Nh(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ia(e,t){Nh(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,s=Gn(e),o=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function Ch(e,t,n){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=n;let a=Number(e&i),c=e>>o;a>r&&(a-=s,c+=xa);const f=t*r,u=f+Math.abs(a)-1,d=a===0,h=a<0,l=t%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:f}}function Jv(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function Qv(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Oa=new WeakMap,Ph=new WeakMap;function Ba(e){return Ph.get(e)||1}function e3(e,t){return{constTimeNegate:Sa,hasPrecomputes(n){return Ba(n)!==1},unsafeLadder(n,r,i=e.ZERO){let s=n;for(;r>Rh;)r&xa&&(i=i.add(s)),s=s.double(),r>>=xa;return i},precomputeWindow(n,r){const{windows:i,windowSize:s}=Ia(r,t),o=[];let a=n,c=a;for(let f=0;f<i;f++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,i){let s=e.ZERO,o=e.BASE;const a=Ia(n,t);for(let c=0;c<a.windows;c++){const{nextN:f,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:b}=Ch(i,c,a);i=f,d?o=o.add(Sa(l,r[b])):s=s.add(Sa(h,r[u]))}return{p:s,f:o}},wNAFUnsafe(n,r,i,s=e.ZERO){const o=Ia(n,t);for(let a=0;a<o.windows&&i!==Rh;a++){const{nextN:c,offset:f,isZero:u,isNeg:d}=Ch(i,a,o);if(i=c,!u){const h=r[f];s=s.add(d?h.negate():h)}}return s},getPrecomputes(n,r,i){let s=Oa.get(r);return s||(s=this.precomputeWindow(r,n),n!==1&&Oa.set(r,i(s))),s},wNAFCached(n,r,i){const s=Ba(n);return this.wNAF(s,this.getPrecomputes(s,n,i),r)},wNAFCachedUnsafe(n,r,i,s){const o=Ba(n);return o===1?this.unsafeLadder(n,r,s):this.wNAFUnsafe(o,this.getPrecomputes(o,n,i),r,s)},setWindowSize(n,r){Nh(r,t),Ph.set(n,r),Oa.delete(n)}}}function t3(e,t,n,r){Jv(n,e),Qv(r,t);const i=n.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=si(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const f=Gn(c),u=new Array(Number(f)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let h=o;for(let l=d;l>=0;l-=c){u.fill(o);for(let w=0;w<s;w++){const v=r[w],D=Number(v>>BigInt(l)&f);u[D]=u[D].add(n[w])}let b=o;for(let w=u.length-1,v=o;w>0;w--)v=v.add(u[w]),b=b.add(v);if(h=h.add(b),l!==0)for(let w=0;w<c;w++)h=h.double()}return h}function $h(e){return Bh(e.Fp),oi(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Dh(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Lh(e){e.lowS!==void 0&&ii("lowS",e.lowS),e.prehash!==void 0&&ii("prehash",e.prehash)}function n3(e){const t=$h(e);oi(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}class r3 extends Error{constructor(t=""){super(t)}}const Wt={Err:r3,_tlv:{encode:(e,t)=>{const{Err:n}=Wt;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=ps(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?ps(i.length/2|128):"";return ps(e)+s+i+t},decode(e,t){const{Err:n}=Wt;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const f=t.subarray(r,r+c);if(f.length!==c)throw new n("tlv.decode: length bytes not complete");if(f[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of f)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=Wt;if(e<_t)throw new t("integer: negative integers are not allowed");let n=ps(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Wt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return je(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Wt,i=Ne("signature",e),{v:s,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,s),{v:f,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(f)}},hexFromSig(e){const{_tlv:t,_int:n}=Wt,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),s=r+i;return t.encode(48,s)}};function Da(e,t){return Vn(me(e,t))}const _t=BigInt(0),ce=BigInt(1),En=BigInt(2),ai=BigInt(3),Aa=BigInt(4);function Ta(e){const t=n3(e),{Fp:n}=t,r=mn(t.n,t.nBitLength),i=t.toBytes||((x,_,R)=>{const $=_.toAffine();return pe(Uint8Array.from([4]),n.toBytes($.x),n.toBytes($.y))}),s=t.fromBytes||(x=>{const _=x.subarray(1),R=n.fromBytes(_.subarray(0,n.BYTES)),$=n.fromBytes(_.subarray(n.BYTES,2*n.BYTES));return{x:R,y:$}});function o(x){const{a:_,b:R}=t,$=n.sqr(x),F=n.mul($,x);return n.add(n.add(F,n.mul(x,_)),R)}function a(x,_){const R=n.sqr(_),$=o(x);return n.eql(R,$)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(t.a,ai),Aa),f=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(c,f)))throw new Error("bad curve params: a or b");function u(x){return ha(x,ce,t.n)}function d(x){const{allowedPrivateKeyLengths:_,nByteLength:R,wrapPrivateKey:$,n:F}=t;if(_&&typeof x!="bigint"){if(ri(x)&&(x=Vn(x)),typeof x!="string"||!_.includes(x.length))throw new Error("invalid private key");x=x.padStart(R*2,"0")}let U;try{U=typeof x=="bigint"?x:je(Ne("private key",x,R))}catch{throw new Error("invalid private key, expected hex or "+R+" bytes, got "+typeof x)}return $&&(U=ke(U,F)),xr("private key",U,ce,F),U}function h(x){if(!(x instanceof w))throw new Error("ProjectivePoint expected")}const l=ga((x,_)=>{const{px:R,py:$,pz:F}=x;if(n.eql(F,n.ONE))return{x:R,y:$};const U=x.is0();_==null&&(_=U?n.ONE:n.inv(F));const A=n.mul(R,_),q=n.mul($,_),k=n.mul(F,_);if(U)return{x:n.ZERO,y:n.ZERO};if(!n.eql(k,n.ONE))throw new Error("invZ was invalid");return{x:A,y:q}}),b=ga(x=>{if(x.is0()){if(t.allowInfinityPoint&&!n.is0(x.py))return;throw new Error("bad point: ZERO")}const{x:_,y:R}=x.toAffine();if(!n.isValid(_)||!n.isValid(R))throw new Error("bad point: x or y not FE");if(!a(_,R))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class w{constructor(_,R,$){if(_==null||!n.isValid(_))throw new Error("x required");if(R==null||!n.isValid(R)||n.is0(R))throw new Error("y required");if($==null||!n.isValid($))throw new Error("z required");this.px=_,this.py=R,this.pz=$,Object.freeze(this)}static fromAffine(_){const{x:R,y:$}=_||{};if(!_||!n.isValid(R)||!n.isValid($))throw new Error("invalid affine point");if(_ instanceof w)throw new Error("projective point not allowed");const F=U=>n.eql(U,n.ZERO);return F(R)&&F($)?w.ZERO:new w(R,$,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const R=Yn(n,_.map($=>$.pz));return _.map(($,F)=>$.toAffine(R[F])).map(w.fromAffine)}static fromHex(_){const R=w.fromAffine(s(Ne("pointHex",_)));return R.assertValidity(),R}static fromPrivateKey(_){return w.BASE.multiply(d(_))}static msm(_,R){return t3(w,r,_,R)}_setWindowSize(_){C.setWindowSize(this,_)}assertValidity(){b(this)}hasEvenY(){const{y:_}=this.toAffine();if(n.isOdd)return!n.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){h(_);const{px:R,py:$,pz:F}=this,{px:U,py:A,pz:q}=_,k=n.eql(n.mul(R,q),n.mul(U,F)),E=n.eql(n.mul($,q),n.mul(A,F));return k&&E}negate(){return new w(this.px,n.neg(this.py),this.pz)}double(){const{a:_,b:R}=t,$=n.mul(R,ai),{px:F,py:U,pz:A}=this;let q=n.ZERO,k=n.ZERO,E=n.ZERO,p=n.mul(F,F),m=n.mul(U,U),g=n.mul(A,A),y=n.mul(F,U);return y=n.add(y,y),E=n.mul(F,A),E=n.add(E,E),q=n.mul(_,E),k=n.mul($,g),k=n.add(q,k),q=n.sub(m,k),k=n.add(m,k),k=n.mul(q,k),q=n.mul(y,q),E=n.mul($,E),g=n.mul(_,g),y=n.sub(p,g),y=n.mul(_,y),y=n.add(y,E),E=n.add(p,p),p=n.add(E,p),p=n.add(p,g),p=n.mul(p,y),k=n.add(k,p),g=n.mul(U,A),g=n.add(g,g),p=n.mul(g,y),q=n.sub(q,p),E=n.mul(g,m),E=n.add(E,E),E=n.add(E,E),new w(q,k,E)}add(_){h(_);const{px:R,py:$,pz:F}=this,{px:U,py:A,pz:q}=_;let k=n.ZERO,E=n.ZERO,p=n.ZERO;const m=t.a,g=n.mul(t.b,ai);let y=n.mul(R,U),S=n.mul($,A),I=n.mul(F,q),O=n.add(R,$),B=n.add(U,A);O=n.mul(O,B),B=n.add(y,S),O=n.sub(O,B),B=n.add(R,F);let T=n.add(U,q);return B=n.mul(B,T),T=n.add(y,I),B=n.sub(B,T),T=n.add($,F),k=n.add(A,q),T=n.mul(T,k),k=n.add(S,I),T=n.sub(T,k),p=n.mul(m,B),k=n.mul(g,I),p=n.add(k,p),k=n.sub(S,p),p=n.add(S,p),E=n.mul(k,p),S=n.add(y,y),S=n.add(S,y),I=n.mul(m,I),B=n.mul(g,B),S=n.add(S,I),I=n.sub(y,I),I=n.mul(m,I),B=n.add(B,I),y=n.mul(S,B),E=n.add(E,y),y=n.mul(T,B),k=n.mul(O,k),k=n.sub(k,y),y=n.mul(O,S),p=n.mul(T,p),p=n.add(p,y),new w(k,E,p)}subtract(_){return this.add(_.negate())}is0(){return this.equals(w.ZERO)}wNAF(_){return C.wNAFCached(this,_,w.normalizeZ)}multiplyUnsafe(_){const{endo:R,n:$}=t;xr("scalar",_,_t,$);const F=w.ZERO;if(_===_t)return F;if(this.is0()||_===ce)return this;if(!R||C.hasPrecomputes(this))return C.wNAFCachedUnsafe(this,_,w.normalizeZ);let{k1neg:U,k1:A,k2neg:q,k2:k}=R.splitScalar(_),E=F,p=F,m=this;for(;A>_t||k>_t;)A&ce&&(E=E.add(m)),k&ce&&(p=p.add(m)),m=m.double(),A>>=ce,k>>=ce;return U&&(E=E.negate()),q&&(p=p.negate()),p=new w(n.mul(p.px,R.beta),p.py,p.pz),E.add(p)}multiply(_){const{endo:R,n:$}=t;xr("scalar",_,ce,$);let F,U;if(R){const{k1neg:A,k1:q,k2neg:k,k2:E}=R.splitScalar(_);let{p,f:m}=this.wNAF(q),{p:g,f:y}=this.wNAF(E);p=C.constTimeNegate(A,p),g=C.constTimeNegate(k,g),g=new w(n.mul(g.px,R.beta),g.py,g.pz),F=p.add(g),U=m.add(y)}else{const{p:A,f:q}=this.wNAF(_);F=A,U=q}return w.normalizeZ([F,U])[0]}multiplyAndAddUnsafe(_,R,$){const F=w.BASE,U=(q,k)=>k===_t||k===ce||!q.equals(F)?q.multiplyUnsafe(k):q.multiply(k),A=U(this,R).add(U(_,$));return A.is0()?void 0:A}toAffine(_){return l(this,_)}isTorsionFree(){const{h:_,isTorsionFree:R}=t;if(_===ce)return!0;if(R)return R(w,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:R}=t;return _===ce?this:R?R(w,this):this.multiplyUnsafe(t.h)}toRawBytes(_=!0){return ii("isCompressed",_),this.assertValidity(),i(w,this,_)}toHex(_=!0){return ii("isCompressed",_),Vn(this.toRawBytes(_))}}w.BASE=new w(t.Gx,t.Gy,n.ONE),w.ZERO=new w(n.ZERO,n.ONE,n.ZERO);const{endo:v,nBitLength:D}=t,C=e3(w,v?Math.ceil(D/2):D);return{CURVE:t,ProjectivePoint:w,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function i3(e){const t=$h(e);return oi(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function s3(e){const t=i3(e),{Fp:n,n:r,nByteLength:i,nBitLength:s}=t,o=n.BYTES+1,a=2*n.BYTES+1;function c(g){return ke(g,r)}function f(g){return va(g,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:l}=Ta({...t,toBytes(g,y,S){const I=y.toAffine(),O=n.toBytes(I.x),B=pe;return ii("isCompressed",S),S?B(Uint8Array.from([y.hasEvenY()?2:3]),O):B(Uint8Array.from([4]),O,n.toBytes(I.y))},fromBytes(g){const y=g.length,S=g[0],I=g.subarray(1);if(y===o&&(S===2||S===3)){const O=je(I);if(!ha(O,ce,n.ORDER))throw new Error("Point is not on curve");const B=h(O);let T;try{T=n.sqrt(B)}catch(j){const N=j instanceof Error?": "+j.message:"";throw new Error("Point is not on curve"+N)}const L=(T&ce)===ce;return(S&1)===1!==L&&(T=n.neg(T)),{x:O,y:T}}else if(y===a&&S===4){const O=n.fromBytes(I.subarray(0,n.BYTES)),B=n.fromBytes(I.subarray(n.BYTES,2*n.BYTES));return{x:O,y:B}}else{const O=o,B=a;throw new Error("invalid Point, expected length of "+O+", or uncompressed "+B+", got "+y)}}});function b(g){const y=r>>ce;return g>y}function w(g){return b(g)?c(-g):g}const v=(g,y,S)=>je(g.slice(y,S));class D{constructor(y,S,I){xr("r",y,ce,r),xr("s",S,ce,r),this.r=y,this.s=S,I!=null&&(this.recovery=I),Object.freeze(this)}static fromCompact(y){const S=i;return y=Ne("compactSignature",y,S*2),new D(v(y,0,S),v(y,S,2*S))}static fromDER(y){const{r:S,s:I}=Wt.toSig(Ne("DER",y));return new D(S,I)}assertValidity(){}addRecoveryBit(y){return new D(this.r,this.s,y)}recoverPublicKey(y){const{r:S,s:I,recovery:O}=this,B=F(Ne("msgHash",y));if(O==null||![0,1,2,3].includes(O))throw new Error("recovery id invalid");const T=O===2||O===3?S+t.n:S;if(T>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const L=(O&1)===0?"02":"03",P=u.fromHex(L+Da(T,n.BYTES)),j=f(T),N=c(-B*j),M=c(I*j),z=u.BASE.multiplyAndAddUnsafe(P,N,M);if(!z)throw new Error("point at infinify");return z.assertValidity(),z}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new D(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return bs(this.toDERHex())}toDERHex(){return Wt.hexFromSig(this)}toCompactRawBytes(){return bs(this.toCompactHex())}toCompactHex(){const y=i;return Da(this.r,y)+Da(this.s,y)}}const C={isValidPrivateKey(g){try{return d(g),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const g=_a(t.n);return Th(t.randomBytes(g),t.n)},precompute(g=8,y=u.BASE){return y._setWindowSize(g),y.multiply(BigInt(3)),y}};function x(g,y=!0){return u.fromPrivateKey(g).toRawBytes(y)}function _(g){if(typeof g=="bigint")return!1;if(g instanceof u)return!0;const S=Ne("key",g).length,I=n.BYTES,O=I+1,B=2*I+1;if(!(t.allowedPrivateKeyLengths||i===O))return S===O||S===B}function R(g,y,S=!0){if(_(g)===!0)throw new Error("first arg must be private key");if(_(y)===!1)throw new Error("second arg must be public key");return u.fromHex(y).multiply(d(g)).toRawBytes(S)}const $=t.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const y=je(g),S=g.length*8-s;return S>0?y>>BigInt(S):y},F=t.bits2int_modN||function(g){return c($(g))},U=Gn(s);function A(g){return xr("num < 2^"+s,g,_t,U),me(g,i)}function q(g,y,S=k){if(["recovered","canonical"].some(H=>H in S))throw new Error("sign() legacy options not supported");const{hash:I,randomBytes:O}=t;let{lowS:B,prehash:T,extraEntropy:L}=S;B==null&&(B=!0),g=Ne("msgHash",g),Lh(S),T&&(g=Ne("prehashed msgHash",I(g)));const P=F(g),j=d(y),N=[A(j),A(P)];if(L!=null&&L!==!1){const H=L===!0?O(n.BYTES):L;N.push(Ne("extraEntropy",H))}const M=pe(...N),z=P;function G(H){const V=$(H);if(!l(V))return;const J=f(V),ee=u.BASE.multiply(V).toAffine(),re=c(ee.x);if(re===_t)return;const he=c(J*c(z+re*j));if(he===_t)return;let de=(ee.x===re?0:2)|Number(ee.y&ce),fn=he;return B&&b(he)&&(fn=w(he),de^=1),new D(re,fn,de)}return{seed:M,k2sig:G}}const k={lowS:t.lowS,prehash:!1},E={lowS:t.lowS,prehash:!1};function p(g,y,S=k){const{seed:I,k2sig:O}=q(g,y,S),B=t;return pv(B.hash.outputLen,B.nByteLength,B.hmac)(I,O)}u.BASE._setWindowSize(8);function m(g,y,S,I=E){const O=g;y=Ne("msgHash",y),S=Ne("publicKey",S);const{lowS:B,prehash:T,format:L}=I;if(Lh(I),"strict"in I)throw new Error("options.strict was renamed to lowS");if(L!==void 0&&L!=="compact"&&L!=="der")throw new Error("format must be compact or der");const P=typeof O=="string"||ri(O),j=!P&&!L&&typeof O=="object"&&O!==null&&typeof O.r=="bigint"&&typeof O.s=="bigint";if(!P&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let N,M;try{if(j&&(N=new D(O.r,O.s)),P){try{L!=="compact"&&(N=D.fromDER(O))}catch(de){if(!(de instanceof Wt.Err))throw de}!N&&L!=="der"&&(N=D.fromCompact(O))}M=u.fromHex(S)}catch{return!1}if(!N||B&&N.hasHighS())return!1;T&&(y=t.hash(y));const{r:z,s:G}=N,H=F(y),V=f(G),J=c(H*V),ee=c(z*V),re=u.BASE.multiplyAndAddUnsafe(M,J,ee)?.toAffine();return re?c(re.x)===z:!1}return{CURVE:t,getPublicKey:x,getSharedSecret:R,sign:p,verify:m,ProjectivePoint:u,Signature:D,utils:C}}function o3(e,t){const n=e.ORDER;let r=_t;for(let b=n-ce;b%En===_t;b/=En)r+=ce;const i=r,s=En<<i-ce-ce,o=s*En,a=(n-ce)/o,c=(a-ce)/En,f=o-ce,u=s,d=e.pow(t,a),h=e.pow(t,(a+ce)/En);let l=(b,w)=>{let v=d,D=e.pow(w,f),C=e.sqr(D);C=e.mul(C,w);let x=e.mul(b,C);x=e.pow(x,c),x=e.mul(x,D),D=e.mul(x,w),C=e.mul(x,b);let _=e.mul(C,D);x=e.pow(_,u);let R=e.eql(x,e.ONE);D=e.mul(C,h),x=e.mul(_,v),C=e.cmov(D,C,R),_=e.cmov(x,_,R);for(let $=i;$>ce;$--){let F=$-En;F=En<<F-ce;let U=e.pow(_,F);const A=e.eql(U,e.ONE);D=e.mul(C,v),v=e.mul(v,v),U=e.mul(_,v),C=e.cmov(D,C,A),_=e.cmov(U,_,A)}return{isValid:R,value:C}};if(e.ORDER%Aa===ai){const b=(e.ORDER-ai)/Aa,w=e.sqrt(e.neg(t));l=(v,D)=>{let C=e.sqr(D);const x=e.mul(v,D);C=e.mul(C,x);let _=e.pow(C,b);_=e.mul(_,x);const R=e.mul(_,w),$=e.mul(e.sqr(_),D),F=e.eql($,v);let U=e.cmov(R,_,F);return{isValid:F,value:U}}}return l}function Uh(e,t){if(Bh(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=o3(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,s,o,a,c,f,u,d;i=e.sqr(r),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),f=e.sqr(a),c=e.mul(f,t.A),s=e.add(s,c),s=e.mul(s,o),f=e.mul(f,a),c=e.mul(f,t.B),s=e.add(s,c),u=e.mul(i,o);const{isValid:h,value:l}=n(s,f);d=e.mul(i,r),d=e.mul(d,l),u=e.cmov(u,o,h),d=e.cmov(d,l,h);const b=e.isOdd(r)===e.isOdd(d);d=e.cmov(e.neg(d),d,b);const w=Yn(e,[a],!0)[0];return u=e.mul(u,w),{x:u,y:d}}}function a3(e){return{hash:e,hmac:(t,...n)=>Ea(e,t,Kt(...n)),randomBytes:us}}function Es(e,t){const n=r=>s3({...e,...a3(r)});return{...n(t),create:n}}const c3=je;function vn(e,t){if(ci(e),ci(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}function f3(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function ci(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function u3(e,t,n,r){wn(e),wn(t),ci(n),t.length>255&&(t=r(pe(ua("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:s}=r,o=Math.ceil(n/i);if(n>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=pe(t,vn(t.length,1)),c=vn(0,s),f=vn(n,2),u=new Array(o),d=r(pe(c,e,f,vn(0,1),a));u[0]=r(pe(d,vn(1,1),a));for(let l=1;l<=o;l++){const b=[f3(d,u[l-1]),vn(l+1,1),a];u[l]=r(pe(...b))}return pe(...u).slice(0,n)}function l3(e,t,n,r,i){if(wn(e),wn(t),ci(n),t.length>255){const s=Math.ceil(2*r/8);t=i.create({dkLen:s}).update(ua("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(e).update(vn(n,2)).update(t).update(vn(t.length,1)).digest()}function Fh(e,t,n){oi(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:s,hash:o,expand:a,DST:c}=n;wn(e),ci(t);const f=typeof c=="string"?ua(c):c,u=r.toString(2).length,d=Math.ceil((u+i)/8),h=t*s*d;let l;if(a==="xmd")l=u3(e,f,h,o);else if(a==="xof")l=l3(e,f,h,i,o);else if(a==="_internal_pass")l=e;else throw new Error('expand must be "xmd" or "xof"');const b=new Array(t);for(let w=0;w<t;w++){const v=new Array(s);for(let D=0;D<s;D++){const C=d*(D+w*s),x=l.subarray(C,C+d);v[D]=ke(c3(x),r)}b[w]=v}return b}function jh(e,t){const n=t.map(r=>Array.from(r).reverse());return(r,i)=>{const[s,o,a,c]=n.map(d=>d.reduce((h,l)=>e.add(e.mul(h,r),l))),[f,u]=Yn(e,[o,c],!0);return r=e.mul(s,f),i=e.mul(i,e.mul(a,u)),{x:r,y:i}}}function Mh(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function r(s){return e.fromAffine(t(s))}function i(s){const o=s.clearCofactor();return o.equals(e.ZERO)?e.ZERO:(o.assertValidity(),o)}return{defaults:n,hashToCurve(s,o){const a=Fh(s,2,{...n,DST:n.DST,...o}),c=r(a[0]),f=r(a[1]);return i(c.add(f))},encodeToCurve(s,o){const a=Fh(s,1,{...n,DST:n.encodeDST,...o});return i(r(a[0]))},mapToCurve(s){if(!Array.isArray(s))throw new Error("expected array of bigints");for(const o of s)if(typeof o!="bigint")throw new Error("expected array of bigints");return i(r(s))}}}const kh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),zh=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h3=BigInt(0),d3=BigInt(1),Ra=BigInt(2),qh=(e,t)=>(e+t/Ra)/t;function g3(e){const t=kh,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),f=e*e*e%t,u=f*f*e%t,d=gt(u,n,t)*u%t,h=gt(d,n,t)*u%t,l=gt(h,Ra,t)*f%t,b=gt(l,i,t)*l%t,w=gt(b,s,t)*b%t,v=gt(w,a,t)*w%t,D=gt(v,c,t)*v%t,C=gt(D,a,t)*w%t,x=gt(C,n,t)*u%t,_=gt(x,o,t)*b%t,R=gt(_,r,t)*f%t,$=gt(R,Ra,t);if(!Na.eql(Na.sqr($),e))throw new Error("Cannot find square root");return $}const Na=mn(kh,void 0,void 0,{sqrt:g3});Es({a:h3,b:BigInt(7),Fp:Na,n:zh,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=zh,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-d3*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,o=BigInt("0x100000000000000000000000000000000"),a=qh(s*e,t),c=qh(-r*e,t);let f=ke(e-a*n-c*i,t),u=ke(-a*r-c*s,t);const d=f>o,h=u>o;if(d&&(f=t-f),h&&(u=t-u),f>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:f,k2neg:h,k2:u}}}},_r),Object.freeze({1:0n,2:1n,3:2n,4:3n,5:4n,6:5n,7:6n,8:7n,9:8n,A:9n,B:10n,C:11n,D:12n,E:13n,F:14n,G:15n,H:16n,J:17n,K:18n,L:19n,M:20n,N:21n,P:22n,Q:23n,R:24n,S:25n,T:26n,U:27n,V:28n,W:29n,X:30n,Y:31n,Z:32n,a:33n,b:34n,c:35n,d:36n,e:37n,f:38n,g:39n,h:40n,i:41n,j:42n,k:43n,m:44n,n:45n,o:46n,p:47n,q:48n,r:49n,s:50n,t:51n,u:52n,v:53n,w:54n,x:55n,y:56n,z:57n}),Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[t,e.charCodeAt(0)]),{...Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[e.charCodeAt(0),t]))},Vt.slice();const p3=BigInt(0),vs=BigInt(1),Hh=BigInt(2),Sr=BigInt(3);function b3(e){const t=[];for(;e>vs;e>>=vs)(e&vs)===p3?t.unshift(0):(e&Sr)===Sr?(t.unshift(-1),e+=vs):t.unshift(1);return t}function y3(e){const{Fp:t,Fr:n,Fp2:r,Fp6:i,Fp12:s}=e.fields,o=e.params.xNegative,a=e.params.twistType,c=Ta({n:n.ORDER,...e.G1}),f=Object.assign(c,Mh(c.ProjectivePoint,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),u=Ta({n:n.ORDER,...e.G2}),d=Object.assign(u,Mh(u.ProjectivePoint,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));let h;if(a==="multiplicative")h=(P,j,N,M,z,G)=>s.mul014(M,P,r.mul(j,z),r.mul(N,G));else if(a==="divisive")h=(P,j,N,M,z,G)=>s.mul034(M,r.mul(N,G),r.mul(j,z),P);else throw new Error("bls: unknown twist type");const l=r.div(r.ONE,r.mul(r.ONE,Hh));function b(P,j,N,M){const z=r.sqr(N),G=r.sqr(M),H=r.mulByB(r.mul(G,Sr)),V=r.mul(H,Sr),J=r.sub(r.sub(r.sqr(r.add(N,M)),G),z),ee=r.sub(H,z),re=r.mul(r.sqr(j),Sr),he=r.neg(J);return P.push([ee,re,he]),j=r.mul(r.mul(r.mul(r.sub(z,V),j),N),l),N=r.sub(r.sqr(r.mul(r.add(z,V),l)),r.mul(r.sqr(H),Sr)),M=r.mul(z,J),{Rx:j,Ry:N,Rz:M}}function w(P,j,N,M,z,G){const H=r.sub(N,r.mul(G,M)),V=r.sub(j,r.mul(z,M)),J=r.sub(r.mul(H,z),r.mul(V,G)),ee=r.neg(H),re=V;P.push([J,ee,re]);const he=r.sqr(V),de=r.mul(he,V),fn=r.mul(he,j),co=r.add(r.sub(de,r.mul(fn,Hh)),r.mul(r.sqr(H),M));return j=r.mul(V,co),N=r.sub(r.mul(r.sub(fn,co),H),r.mul(de,N)),M=r.mul(M,de),{Rx:j,Ry:N,Rz:M}}const v=b3(e.params.ateLoopSize),D=ga(P=>{const j=P,{x:N,y:M}=j.toAffine(),z=N,G=M,H=r.neg(M);let V=z,J=G,ee=r.ONE;const re=[];for(const he of v){const de=[];({Rx:V,Ry:J,Rz:ee}=b(de,V,J,ee)),he&&({Rx:V,Ry:J,Rz:ee}=w(de,V,J,ee,z,he===-1?H:G)),re.push(de)}if(e.postPrecompute){const he=re[re.length-1];e.postPrecompute(V,J,ee,z,G,w.bind(null,he))}return re});function C(P,j=!1){let N=s.ONE;if(P.length){const M=P[0][0].length;for(let z=0;z<M;z++){N=s.sqr(N);for(const[G,H,V]of P)for(const[J,ee,re]of G[z])N=h(J,ee,re,N,H,V)}}return o&&(N=s.conjugate(N)),j?s.finalExponentiate(N):N}function x(P,j=!0){const N=[];f.ProjectivePoint.normalizeZ(P.map(({g1:M})=>M)),d.ProjectivePoint.normalizeZ(P.map(({g2:M})=>M));for(const{g1:M,g2:z}of P){if(M.equals(f.ProjectivePoint.ZERO)||z.equals(d.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");M.assertValidity(),z.assertValidity();const G=M.toAffine();N.push([D(z),G.x,G.y])}return C(N,j)}function _(P,j,N=!0){return x([{g1:P,g2:j}],N)}const R={randomPrivateKey:()=>{const P=_a(n.ORDER);return Th(e.randomBytes(P),n.ORDER)},calcPairingPrecomputes:D},{ShortSignature:$}=e.G1,{Signature:F}=e.G2;function U(P){return P instanceof f.ProjectivePoint?P:f.ProjectivePoint.fromHex(P)}function A(P,j){return P instanceof f.ProjectivePoint?P:f.hashToCurve(Ne("point",P),j)}function q(P){return P instanceof d.ProjectivePoint?P:F.fromHex(P)}function k(P,j){return P instanceof d.ProjectivePoint?P:d.hashToCurve(Ne("point",P),j)}function E(P){return f.ProjectivePoint.fromPrivateKey(P).toRawBytes(!0)}function p(P){return d.ProjectivePoint.fromPrivateKey(P).toRawBytes(!0)}function m(P,j,N){const M=k(P,N);M.assertValidity();const z=M.multiply(f.normPrivateKeyToScalar(j));return P instanceof d.ProjectivePoint?z:F.toRawBytes(z)}function g(P,j,N){const M=A(P,N);M.assertValidity();const z=M.multiply(f.normPrivateKeyToScalar(j));return P instanceof f.ProjectivePoint?z:$.toRawBytes(z)}function y(P,j,N,M){const z=U(N),G=k(j,M),H=f.ProjectivePoint.BASE,V=q(P),J=x([{g1:z.negate(),g2:G},{g1:H,g2:V}]);return s.eql(J,s.ONE)}function S(P,j,N,M){const z=q(N),G=A(j,M),H=d.ProjectivePoint.BASE,V=U(P),J=x([{g1:G,g2:z},{g1:V,g2:H.negate()}]);return s.eql(J,s.ONE)}function I(P){if(!Array.isArray(P)||P.length===0)throw new Error("expected non-empty array")}function O(P){I(P);const N=P.map(U).reduce((M,z)=>M.add(z),f.ProjectivePoint.ZERO);return P[0]instanceof f.ProjectivePoint?(N.assertValidity(),N):N.toRawBytes(!0)}function B(P){I(P);const N=P.map(q).reduce((M,z)=>M.add(z),d.ProjectivePoint.ZERO);return P[0]instanceof d.ProjectivePoint?(N.assertValidity(),N):F.toRawBytes(N)}function T(P){I(P);const N=P.map(U).reduce((M,z)=>M.add(z),f.ProjectivePoint.ZERO);return P[0]instanceof f.ProjectivePoint?(N.assertValidity(),N):$.toRawBytes(N)}function L(P,j,N,M){if(I(j),N.length!==j.length)throw new Error("amount of public keys and messages should be equal");const z=q(P),G=j.map(ee=>k(ee,M)),H=N.map(U),V=new Map;for(let ee=0;ee<H.length;ee++){const re=H[ee],he=G[ee];let de=V.get(he);de===void 0&&(de=[],V.set(he,de)),de.push(re)}const J=[];try{for(const[ee,re]of V){const he=re.reduce((de,fn)=>de.add(fn));J.push({g1:he,g2:ee})}return J.push({g1:f.ProjectivePoint.BASE.negate(),g2:z}),s.eql(x(J),s.ONE)}catch{return!1}}return f.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:E,getPublicKeyForShortSignatures:p,sign:m,signShortSignature:g,verify:y,verifyBatch:L,verifyShortSignature:S,aggregatePublicKeys:O,aggregateSignatures:B,aggregateShortSignatures:T,millerLoopBatch:C,pairing:_,pairingBatch:x,G1:f,G2:d,Signature:F,ShortSignature:$,fields:{Fr:n,Fp:t,Fp2:r,Fp6:i,Fp12:s},params:{ateLoopSize:e.params.ateLoopSize,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:R}}const w3=BigInt(0),Ir=BigInt(1),Xt=BigInt(2),Kh=BigInt(3);function Ca(e,t,n,r,i=1,s){const o=BigInt(s===void 0?r:s),a=n**BigInt(r),c=[];for(let f=0;f<i;f++){const u=BigInt(f+1),d=[];for(let h=0,l=Ir;h<r;h++){const b=(u*l-u)/o%a;d.push(e.pow(t,b)),l*=n}c.push(d)}return c}function m3(e,t,n){const r=t.pow(n,(e.ORDER-Ir)/Kh),i=t.pow(n,(e.ORDER-Ir)/Xt);function s(h,l){const b=t.mul(t.frobeniusMap(h,1),r),w=t.mul(t.frobeniusMap(l,1),i);return[b,w]}const o=t.pow(n,(e.ORDER**Xt-Ir)/Kh),a=t.pow(n,(e.ORDER**Xt-Ir)/Xt);if(!t.eql(a,t.neg(t.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(h,l){return[t.mul(h,o),t.neg(l)]}const f=h=>(l,b)=>{const w=b.toAffine(),v=h(w.x,w.y);return l.fromAffine({x:v[0],y:v[1]})},u=f(s),d=f(c);return{psi:s,psi2:c,G2psi:u,G2psi2:d,PSI_X:r,PSI_Y:i,PSI2_X:o,PSI2_Y:a}}function E3(e){const{ORDER:t}=e,n=mn(t),r=n.create(e.NONRESIDUE||BigInt(-1)),i=n.div(n.ONE,Xt),s=Ca(n,r,n.ORDER,2)[0],o=({c0:E,c1:p},{c0:m,c1:g})=>({c0:n.add(E,m),c1:n.add(p,g)}),a=({c0:E,c1:p},{c0:m,c1:g})=>({c0:n.sub(E,m),c1:n.sub(p,g)}),c=({c0:E,c1:p},m)=>{if(typeof m=="bigint")return{c0:n.mul(E,m),c1:n.mul(p,m)};const{c0:g,c1:y}=m;let S=n.mul(E,g),I=n.mul(p,y);const O=n.sub(S,I),B=n.sub(n.mul(n.add(E,p),n.add(g,y)),n.add(S,I));return{c0:O,c1:B}},f=({c0:E,c1:p})=>{const m=n.add(E,p),g=n.sub(E,p),y=n.add(E,E);return{c0:n.mul(m,g),c1:n.mul(y,p)}},u=E=>{if(E.length!==2)throw new Error("invalid tuple");const p=E.map(m=>n.create(m));return{c0:p[0],c1:p[1]}},d=t*t,h=u(e.FP2_NONRESIDUE),l={ORDER:d,isLE:n.isLE,NONRESIDUE:h,BITS:si(d),BYTES:Math.ceil(si(d)/8),MASK:Gn(si(d)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:E=>E,isValid:({c0:E,c1:p})=>typeof E=="bigint"&&typeof p=="bigint",is0:({c0:E,c1:p})=>n.is0(E)&&n.is0(p),eql:({c0:E,c1:p},{c0:m,c1:g})=>n.eql(E,m)&&n.eql(p,g),neg:({c0:E,c1:p})=>({c0:n.neg(E),c1:n.neg(p)}),pow:(E,p)=>ws(l,E,p),invertBatch:E=>Yn(l,E),add:o,sub:a,mul:c,sqr:f,addN:o,subN:a,mulN:c,sqrN:f,div:(E,p)=>l.mul(E,typeof p=="bigint"?n.inv(n.create(p)):l.inv(p)),inv:({c0:E,c1:p})=>{const m=n.inv(n.create(E*E+p*p));return{c0:n.mul(m,n.create(E)),c1:n.mul(m,n.create(-p))}},sqrt:E=>{if(e.Fp2sqrt)return e.Fp2sqrt(E);const{c0:p,c1:m}=E;if(n.is0(m))return ms(n,p)===1?l.create({c0:n.sqrt(p),c1:n.ZERO}):l.create({c0:n.ZERO,c1:n.sqrt(n.div(p,r))});const g=n.sqrt(n.sub(n.sqr(p),n.mul(n.sqr(m),r)));let y=n.mul(n.add(g,p),i);ms(n,y)===-1&&(y=n.sub(y,g));const I=n.sqrt(y),O=l.create({c0:I,c1:n.div(n.mul(m,i),I)});if(!l.eql(l.sqr(O),E))throw new Error("Cannot find square root");const B=O,T=l.neg(B),{re:L,im:P}=l.reim(B),{re:j,im:N}=l.reim(T);return P>N||P===N&&L>j?B:T},isOdd:E=>{const{re:p,im:m}=l.reim(E),g=p%Xt,y=p===w3,S=m%Xt;return BigInt(g||y&&S)==Ir},fromBytes(E){if(E.length!==l.BYTES)throw new Error("fromBytes invalid length="+E.length);return{c0:n.fromBytes(E.subarray(0,n.BYTES)),c1:n.fromBytes(E.subarray(n.BYTES))}},toBytes:({c0:E,c1:p})=>pe(n.toBytes(E),n.toBytes(p)),cmov:({c0:E,c1:p},{c0:m,c1:g},y)=>({c0:n.cmov(E,m,y),c1:n.cmov(p,g,y)}),reim:({c0:E,c1:p})=>({re:E,im:p}),mulByNonresidue:({c0:E,c1:p})=>l.mul({c0:E,c1:p},h),mulByB:e.Fp2mulByB,fromBigTuple:u,frobeniusMap:({c0:E,c1:p},m)=>({c0:E,c1:n.mul(p,s[m%2])})},b=({c0:E,c1:p,c2:m},{c0:g,c1:y,c2:S})=>({c0:l.add(E,g),c1:l.add(p,y),c2:l.add(m,S)}),w=({c0:E,c1:p,c2:m},{c0:g,c1:y,c2:S})=>({c0:l.sub(E,g),c1:l.sub(p,y),c2:l.sub(m,S)}),v=({c0:E,c1:p,c2:m},g)=>{if(typeof g=="bigint")return{c0:l.mul(E,g),c1:l.mul(p,g),c2:l.mul(m,g)};const{c0:y,c1:S,c2:I}=g,O=l.mul(E,y),B=l.mul(p,S),T=l.mul(m,I);return{c0:l.add(O,l.mulByNonresidue(l.sub(l.mul(l.add(p,m),l.add(S,I)),l.add(B,T)))),c1:l.add(l.sub(l.mul(l.add(E,p),l.add(y,S)),l.add(O,B)),l.mulByNonresidue(T)),c2:l.sub(l.add(B,l.mul(l.add(E,m),l.add(y,I))),l.add(O,T))}},D=({c0:E,c1:p,c2:m})=>{let g=l.sqr(E),y=l.mul(l.mul(E,p),Xt),S=l.mul(l.mul(p,m),Xt),I=l.sqr(m);return{c0:l.add(l.mulByNonresidue(S),g),c1:l.add(l.mulByNonresidue(I),y),c2:l.sub(l.sub(l.add(l.add(y,l.sqr(l.add(l.sub(E,p),m))),S),g),I)}},[C,x]=Ca(l,h,n.ORDER,6,2,3),_={ORDER:l.ORDER,isLE:l.isLE,BITS:3*l.BITS,BYTES:3*l.BYTES,MASK:Gn(3*l.BITS),ZERO:{c0:l.ZERO,c1:l.ZERO,c2:l.ZERO},ONE:{c0:l.ONE,c1:l.ZERO,c2:l.ZERO},create:E=>E,isValid:({c0:E,c1:p,c2:m})=>l.isValid(E)&&l.isValid(p)&&l.isValid(m),is0:({c0:E,c1:p,c2:m})=>l.is0(E)&&l.is0(p)&&l.is0(m),neg:({c0:E,c1:p,c2:m})=>({c0:l.neg(E),c1:l.neg(p),c2:l.neg(m)}),eql:({c0:E,c1:p,c2:m},{c0:g,c1:y,c2:S})=>l.eql(E,g)&&l.eql(p,y)&&l.eql(m,S),sqrt:gh,div:(E,p)=>_.mul(E,typeof p=="bigint"?n.inv(n.create(p)):_.inv(p)),pow:(E,p)=>ws(_,E,p),invertBatch:E=>Yn(_,E),add:b,sub:w,mul:v,sqr:D,addN:b,subN:w,mulN:v,sqrN:D,inv:({c0:E,c1:p,c2:m})=>{let g=l.sub(l.sqr(E),l.mulByNonresidue(l.mul(m,p))),y=l.sub(l.mulByNonresidue(l.sqr(m)),l.mul(E,p)),S=l.sub(l.sqr(p),l.mul(E,m)),I=l.inv(l.add(l.mulByNonresidue(l.add(l.mul(m,y),l.mul(p,S))),l.mul(E,g)));return{c0:l.mul(I,g),c1:l.mul(I,y),c2:l.mul(I,S)}},fromBytes:E=>{if(E.length!==_.BYTES)throw new Error("fromBytes invalid length="+E.length);return{c0:l.fromBytes(E.subarray(0,l.BYTES)),c1:l.fromBytes(E.subarray(l.BYTES,2*l.BYTES)),c2:l.fromBytes(E.subarray(2*l.BYTES))}},toBytes:({c0:E,c1:p,c2:m})=>pe(l.toBytes(E),l.toBytes(p),l.toBytes(m)),cmov:({c0:E,c1:p,c2:m},{c0:g,c1:y,c2:S},I)=>({c0:l.cmov(E,g,I),c1:l.cmov(p,y,I),c2:l.cmov(m,S,I)}),fromBigSix:E=>{if(!Array.isArray(E)||E.length!==6)throw new Error("invalid Fp6 usage");return{c0:l.fromBigTuple(E.slice(0,2)),c1:l.fromBigTuple(E.slice(2,4)),c2:l.fromBigTuple(E.slice(4,6))}},frobeniusMap:({c0:E,c1:p,c2:m},g)=>({c0:l.frobeniusMap(E,g),c1:l.mul(l.frobeniusMap(p,g),C[g%6]),c2:l.mul(l.frobeniusMap(m,g),x[g%6])}),mulByFp2:({c0:E,c1:p,c2:m},g)=>({c0:l.mul(E,g),c1:l.mul(p,g),c2:l.mul(m,g)}),mulByNonresidue:({c0:E,c1:p,c2:m})=>({c0:l.mulByNonresidue(m),c1:E,c2:p}),mul1:({c0:E,c1:p,c2:m},g)=>({c0:l.mulByNonresidue(l.mul(m,g)),c1:l.mul(E,g),c2:l.mul(p,g)}),mul01({c0:E,c1:p,c2:m},g,y){let S=l.mul(E,g),I=l.mul(p,y);return{c0:l.add(l.mulByNonresidue(l.sub(l.mul(l.add(p,m),y),I)),S),c1:l.sub(l.sub(l.mul(l.add(g,y),l.add(E,p)),S),I),c2:l.add(l.sub(l.mul(l.add(E,m),g),S),I)}}},R=Ca(l,h,n.ORDER,12,1,6)[0],$=({c0:E,c1:p},{c0:m,c1:g})=>({c0:_.add(E,m),c1:_.add(p,g)}),F=({c0:E,c1:p},{c0:m,c1:g})=>({c0:_.sub(E,m),c1:_.sub(p,g)}),U=({c0:E,c1:p},m)=>{if(typeof m=="bigint")return{c0:_.mul(E,m),c1:_.mul(p,m)};let{c0:g,c1:y}=m,S=_.mul(E,g),I=_.mul(p,y);return{c0:_.add(S,_.mulByNonresidue(I)),c1:_.sub(_.mul(_.add(E,p),_.add(g,y)),_.add(S,I))}},A=({c0:E,c1:p})=>{let m=_.mul(E,p);return{c0:_.sub(_.sub(_.mul(_.add(_.mulByNonresidue(p),E),_.add(E,p)),m),_.mulByNonresidue(m)),c1:_.add(m,m)}};function q(E,p){const m=l.sqr(E),g=l.sqr(p);return{first:l.add(l.mulByNonresidue(g),m),second:l.sub(l.sub(l.sqr(l.add(E,p)),m),g)}}const k={ORDER:l.ORDER,isLE:_.isLE,BITS:2*_.BITS,BYTES:2*_.BYTES,MASK:Gn(2*_.BITS),ZERO:{c0:_.ZERO,c1:_.ZERO},ONE:{c0:_.ONE,c1:_.ZERO},create:E=>E,isValid:({c0:E,c1:p})=>_.isValid(E)&&_.isValid(p),is0:({c0:E,c1:p})=>_.is0(E)&&_.is0(p),neg:({c0:E,c1:p})=>({c0:_.neg(E),c1:_.neg(p)}),eql:({c0:E,c1:p},{c0:m,c1:g})=>_.eql(E,m)&&_.eql(p,g),sqrt:gh,inv:({c0:E,c1:p})=>{let m=_.inv(_.sub(_.sqr(E),_.mulByNonresidue(_.sqr(p))));return{c0:_.mul(E,m),c1:_.neg(_.mul(p,m))}},div:(E,p)=>k.mul(E,typeof p=="bigint"?n.inv(n.create(p)):k.inv(p)),pow:(E,p)=>ws(k,E,p),invertBatch:E=>Yn(k,E),add:$,sub:F,mul:U,sqr:A,addN:$,subN:F,mulN:U,sqrN:A,fromBytes:E=>{if(E.length!==k.BYTES)throw new Error("fromBytes invalid length="+E.length);return{c0:_.fromBytes(E.subarray(0,_.BYTES)),c1:_.fromBytes(E.subarray(_.BYTES))}},toBytes:({c0:E,c1:p})=>pe(_.toBytes(E),_.toBytes(p)),cmov:({c0:E,c1:p},{c0:m,c1:g},y)=>({c0:_.cmov(E,m,y),c1:_.cmov(p,g,y)}),fromBigTwelve:E=>({c0:_.fromBigSix(E.slice(0,6)),c1:_.fromBigSix(E.slice(6,12))}),frobeniusMap(E,p){const{c0:m,c1:g,c2:y}=_.frobeniusMap(E.c1,p),S=R[p%12];return{c0:_.frobeniusMap(E.c0,p),c1:_.create({c0:l.mul(m,S),c1:l.mul(g,S),c2:l.mul(y,S)})}},mulByFp2:({c0:E,c1:p},m)=>({c0:_.mulByFp2(E,m),c1:_.mulByFp2(p,m)}),conjugate:({c0:E,c1:p})=>({c0:E,c1:_.neg(p)}),mul014:({c0:E,c1:p},m,g,y)=>{let S=_.mul01(E,m,g),I=_.mul1(p,y);return{c0:_.add(_.mulByNonresidue(I),S),c1:_.sub(_.sub(_.mul01(_.add(p,E),m,l.add(g,y)),S),I)}},mul034:({c0:E,c1:p},m,g,y)=>{const S=_.create({c0:l.mul(E.c0,m),c1:l.mul(E.c1,m),c2:l.mul(E.c2,m)}),I=_.mul01(p,g,y),O=_.mul01(_.add(E,p),l.add(m,g),y);return{c0:_.add(_.mulByNonresidue(I),S),c1:_.sub(O,_.add(S,I))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:n,Fp2:l,Fp6:_,Fp4Square:q,Fp12:k}}const ze=BigInt(0),_s=BigInt(1),xe=BigInt(2),xs=BigInt(3),fi=BigInt(4),_n=BigInt("0xd201000000010000"),v3=si(_n),{Fp:Y,Fp2:X,Fp6:Pa,Fp4Square:$a,Fp12:te}=E3({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[_s,_s],Fp2mulByB:({c0:e,c1:t})=>{const n=Y.mul(e,fi),r=Y.mul(t,fi);return{c0:Y.sub(n,r),c1:Y.add(n,r)}},Fp12cyclotomicSquare:({c0:e,c1:t})=>{const{c0:n,c1:r,c2:i}=e,{c0:s,c1:o,c2:a}=t,{first:c,second:f}=$a(n,o),{first:u,second:d}=$a(s,i),{first:h,second:l}=$a(r,a),b=X.mulByNonresidue(l);return{c0:Pa.create({c0:X.add(X.mul(X.sub(c,n),xe),c),c1:X.add(X.mul(X.sub(u,r),xe),u),c2:X.add(X.mul(X.sub(h,i),xe),h)}),c1:Pa.create({c0:X.add(X.mul(X.add(b,s),xe),b),c1:X.add(X.mul(X.add(f,o),xe),f),c2:X.add(X.mul(X.add(d,a),xe),d)})}},Fp12cyclotomicExp(e,t){let n=te.ONE;for(let r=v3-1;r>=0;r--)n=te._cyclotomicSquare(n),gv(t,r)&&(n=te.mul(n,e));return n},Fp12finalExponentiate:e=>{const t=_n,n=te.div(te.frobeniusMap(e,6),e),r=te.mul(te.frobeniusMap(n,2),n),i=te.conjugate(te._cyclotomicExp(r,t)),s=te.mul(te.conjugate(te._cyclotomicSquare(r)),i),o=te.conjugate(te._cyclotomicExp(s,t)),a=te.conjugate(te._cyclotomicExp(o,t)),c=te.mul(te.conjugate(te._cyclotomicExp(a,t)),te._cyclotomicSquare(i)),f=te.conjugate(te._cyclotomicExp(c,t)),u=te.frobeniusMap(te.mul(i,a),2),d=te.frobeniusMap(te.mul(o,r),3),h=te.frobeniusMap(te.mul(c,te.conjugate(r)),1),l=te.mul(te.mul(f,te.conjugate(s)),r);return te.mul(te.mul(te.mul(u,d),h),l)}}),Vh=mn(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),_3=jh(X,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(e=>e.map(t=>X.fromBigTuple(t.map(BigInt))))),x3=jh(Y,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),S3=Uh(X,{A:X.create({c0:Y.create(ze),c1:Y.create(BigInt(240))}),B:X.create({c0:Y.create(BigInt(1012)),c1:Y.create(BigInt(1012))}),Z:X.create({c0:Y.create(BigInt(-2)),c1:Y.create(BigInt(-1))})}),I3=Uh(Y,{A:Y.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:Y.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:Y.create(BigInt(11))}),{G2psi:Gh,G2psi2:O3}=m3(Y,X,X.div(X.ONE,X.NONRESIDUE)),La=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:Y.ORDER,m:2,k:128,expand:"xmd",hash:_r}),Ss=ui(Y.toBytes(ze),{infinity:!0,compressed:!0});function Is(e){e=e.slice();const t=e[0]&224,n=!!(t>>7&1),r=!!(t>>6&1),i=!!(t>>5&1);return e[0]&=31,{compressed:n,infinity:r,sort:i,value:e}}function ui(e,t){if(e[0]&224)throw new Error("setMask: non-empty mask");return t.compressed&&(e[0]|=128),t.infinity&&(e[0]|=64),t.sort&&(e[0]|=32),e}function Zh(e){e.assertValidity();const t=e.equals(xt.G1.ProjectivePoint.ZERO),{x:n,y:r}=e.toAffine();if(t)return Ss.slice();const i=Y.ORDER,s=!!(r*xe/i);return ui(me(n,Y.BYTES),{compressed:!0,sort:s})}function Yh(e){e.assertValidity();const t=Y.BYTES;if(e.equals(xt.G2.ProjectivePoint.ZERO))return pe(Ss,me(ze,t));const{x:n,y:r}=e.toAffine(),{re:i,im:s}=X.reim(n),{re:o,im:a}=X.reim(r),f=!!((a>ze?a*xe:o*xe)/Y.ORDER&_s),u=i;return pe(ui(me(s,t),{sort:f,compressed:!0}),me(u,t))}const xt=y3({fields:{Fp:Y,Fp2:X,Fp6:Pa,Fp12:te,Fr:Vh},G1:{Fp:Y,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:Y.ZERO,b:fi,htfDefaults:{...La,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new e(Y.mul(t.px,n),t.py,t.pz);return t.multiplyUnsafe(_n).negate().multiplyUnsafe(_n).equals(r)},clearCofactor:(e,t)=>t.multiplyUnsafe(_n).add(t),mapToCurve:e=>{const{x:t,y:n}=I3(Y.create(e[0]));return x3(t,n)},fromBytes:e=>{const{compressed:t,infinity:n,sort:r,value:i}=Is(e);if(i.length===48&&t){const s=Y.ORDER,o=je(i),a=Y.create(o&Y.MASK);if(n){if(a!==ze)throw new Error("G1: non-empty compressed point at infinity");return{x:ze,y:ze}}const c=Y.add(Y.pow(a,xs),Y.create(xt.params.G1b));let f=Y.sqrt(c);if(!f)throw new Error("invalid compressed G1 point");return f*xe/s!==BigInt(r)&&(f=Y.neg(f)),{x:Y.create(a),y:Y.create(f)}}else if(i.length===96&&!t){const s=je(i.subarray(0,Y.BYTES)),o=je(i.subarray(Y.BYTES));if(n){if(s!==ze||o!==ze)throw new Error("G1: non-empty point at infinity");return xt.G1.ProjectivePoint.ZERO.toAffine()}return{x:Y.create(s),y:Y.create(o)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(e,t,n)=>{const r=t.equals(e.ZERO),{x:i,y:s}=t.toAffine();if(n){if(r)return Ss.slice();const o=Y.ORDER,a=!!(s*xe/o);return ui(me(i,Y.BYTES),{compressed:!0,sort:a})}else return r?pe(new Uint8Array([64]),new Uint8Array(2*Y.BYTES-1)):pe(me(i,Y.BYTES),me(s,Y.BYTES))},ShortSignature:{fromHex(e){const{infinity:t,sort:n,value:r}=Is(Ne("signatureHex",e,48)),i=Y.ORDER,s=je(r);if(t)return xt.G1.ProjectivePoint.ZERO;const o=Y.create(s&Y.MASK),a=Y.add(Y.pow(o,xs),Y.create(xt.params.G1b));let c=Y.sqrt(a);if(!c)throw new Error("invalid compressed G1 point");const f=BigInt(n);c*xe/i!==f&&(c=Y.neg(c));const u=xt.G1.ProjectivePoint.fromAffine({x:o,y:c});return u.assertValidity(),u},toRawBytes(e){return Zh(e)},toHex(e){return Vn(Zh(e))}}},G2:{Fp:X,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:X.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:X.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:X.ZERO,b:X.fromBigTuple([fi,fi]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...La},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:e=>{const{x:t,y:n}=S3(X.fromBigTuple(e));return _3(t,n)},isTorsionFree:(e,t)=>t.multiplyUnsafe(_n).negate().equals(Gh(e,t)),clearCofactor:(e,t)=>{const n=_n;let r=t.multiplyUnsafe(n).negate(),i=Gh(e,t),s=t.double();return s=O3(e,s),s=s.subtract(i),i=r.add(i),i=i.multiplyUnsafe(n).negate(),s=s.add(i),s=s.subtract(r),s.subtract(t)},fromBytes:e=>{const{compressed:t,infinity:n,sort:r,value:i}=Is(e);if(!t&&!n&&r||!t&&n&&r||r&&n&&t)throw new Error("invalid encoding flag: "+(e[0]&224));const s=Y.BYTES,o=(a,c,f)=>je(a.slice(c,f));if(i.length===96&&t){const a=xt.params.G2b,c=Y.ORDER;if(n){if(i.reduce((w,v)=>w!==0?v+1:v,0)>0)throw new Error("invalid compressed G2 point");return{x:X.ZERO,y:X.ZERO}}const f=o(i,0,s),u=o(i,s,2*s),d=X.create({c0:Y.create(u),c1:Y.create(f)}),h=X.add(X.pow(d,xs),a);let l=X.sqrt(h);const b=l.c1===ze?l.c0*xe/c:l.c1*xe/c?_s:ze;return l=r&&b>0?l:X.neg(l),{x:d,y:l}}else if(i.length===192&&!t){if(n){if(i.reduce((d,h)=>d!==0?h+1:h,0)>0)throw new Error("invalid uncompressed G2 point");return{x:X.ZERO,y:X.ZERO}}const a=o(i,0,s),c=o(i,s,2*s),f=o(i,2*s,3*s),u=o(i,3*s,4*s);return{x:X.fromBigTuple([c,a]),y:X.fromBigTuple([u,f])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(e,t,n)=>{const{BYTES:r,ORDER:i}=Y,s=t.equals(e.ZERO),{x:o,y:a}=t.toAffine();if(n){if(s)return pe(Ss,me(ze,r));const c=!!(a.c1===ze?a.c0*xe/i:a.c1*xe/i);return pe(ui(me(o.c1,r),{compressed:!0,sort:c}),me(o.c0,r))}else{if(s)return pe(new Uint8Array([64]),new Uint8Array(4*r-1));const{re:c,im:f}=X.reim(o),{re:u,im:d}=X.reim(a);return pe(me(f,r),me(c,r),me(d,r),me(u,r))}},Signature:{fromHex(e){const{infinity:t,sort:n,value:r}=Is(Ne("signatureHex",e)),i=Y.ORDER,s=r.length/2;if(s!==48&&s!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const o=je(r.slice(0,s)),a=je(r.slice(s));if(t)return xt.G2.ProjectivePoint.ZERO;const c=Y.create(o&Y.MASK),f=Y.create(a),u=X.create({c0:f,c1:c}),d=X.add(X.pow(u,xs),xt.params.G2b);let h=X.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:l,im:b}=X.reim(h),w=BigInt(n),v=b>ze&&b*xe/i!==w,D=b===ze&&l*xe/i!==w;(v||D)&&(h=X.neg(h));const C=xt.G2.ProjectivePoint.fromAffine({x:u,y:h});return C.assertValidity(),C},toRawBytes(e){return Yh(e)},toHex(e){return Vn(Yh(e))}}},params:{ateLoopSize:_n,r:Vh.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:La,hash:_r,randomBytes:us});BigInt(0),BigInt(1),BigInt(2),BigInt(8),BigInt(0),BigInt(1),BigInt(2),BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),BigInt(0),BigInt(1),BigInt(2),BigInt(3),BigInt(5),BigInt(8);const Ua=BigInt(0),Fa=BigInt(1);function Os(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function Wn(e,t,n=""){const r=os(e),i=e?.length,s=t!==void 0;if(!r||s&&i!==t){const o=n&&`"${n}" `,a=s?` of length ${t}`:"",c=r?`length=${i}`:`type=${typeof e}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return e}function Bs(e){const t=e.toString(16);return t.length&1?"0"+t:t}function Wh(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ua:BigInt("0x"+e)}function Ds(e){return Wh(mr(e))}function Xh(e){return qt(e),Wh(mr(Uint8Array.from(e).reverse()))}function ja(e,t){return as(e.toString(16).padStart(t*2,"0"))}function Jh(e,t){return ja(e,t).reverse()}function We(e,t,n){let r;if(typeof t=="string")try{r=as(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(os(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}const Ma=e=>typeof e=="bigint"&&Ua<=e;function B3(e,t,n){return Ma(e)&&Ma(t)&&Ma(n)&&t<=e&&e<n}function D3(e,t,n,r){if(!B3(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Qh(e){let t;for(t=0;e>Ua;e>>=Fa,t+=1);return t}const li=e=>(Fa<<BigInt(e))-Fa;function A3(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=l=>new Uint8Array(l),i=l=>Uint8Array.of(l);let s=r(e),o=r(e),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},f=(...l)=>n(o,s,...l),u=(l=r(0))=>{o=f(i(0),l),s=f(),l.length!==0&&(o=f(i(1),l),s=f())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const b=[];for(;l<t;){s=f();const w=s.slice();b.push(w),l+=s.length}return Kt(...b)};return(l,b)=>{c(),u(l);let w;for(;!(w=b(d()));)u();return c(),w}}function ka(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(i,s,o){const a=e[i];if(o&&a===void 0)return;const c=typeof a;if(c!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(t).forEach(([i,s])=>r(i,s,!1)),Object.entries(n).forEach(([i,s])=>r(i,s,!0))}function ed(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}const Xe=BigInt(0),qe=BigInt(1),Xn=BigInt(2),td=BigInt(3),nd=BigInt(4),rd=BigInt(5),T3=BigInt(7),id=BigInt(8),R3=BigInt(9),sd=BigInt(16);function St(e,t){const n=e%t;return n>=Xe?n:t+n}function pt(e,t,n){let r=e;for(;t-- >Xe;)r*=r,r%=n;return r}function od(e,t){if(e===Xe)throw new Error("invert: expected non-zero number");if(t<=Xe)throw new Error("invert: expected positive modulus, got "+t);let n=St(e,t),r=t,i=Xe,s=qe;for(;n!==Xe;){const a=r/n,c=r%n,f=i-s*a;r=n,n=c,i=s,s=f}if(r!==qe)throw new Error("invert: does not exist");return St(i,t)}function za(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function ad(e,t){const n=(e.ORDER+qe)/nd,r=e.pow(t,n);return za(e,r,t),r}function N3(e,t){const n=(e.ORDER-rd)/id,r=e.mul(t,Xn),i=e.pow(r,n),s=e.mul(t,i),o=e.mul(e.mul(s,Xn),i),a=e.mul(s,e.sub(o,e.ONE));return za(e,a,t),a}function C3(e){const t=hi(e),n=cd(e),r=n(t,t.neg(t.ONE)),i=n(t,r),s=n(t,t.neg(r)),o=(e+T3)/sd;return(a,c)=>{let f=a.pow(c,o),u=a.mul(f,r);const d=a.mul(f,i),h=a.mul(f,s),l=a.eql(a.sqr(u),c),b=a.eql(a.sqr(d),c);f=a.cmov(f,u,l),u=a.cmov(h,d,b);const w=a.eql(a.sqr(u),c),v=a.cmov(f,u,w);return za(a,v,c),v}}function cd(e){if(e<td)throw new Error("sqrt is not defined for small field");let t=e-qe,n=0;for(;t%Xn===Xe;)t/=Xn,n++;let r=Xn;const i=hi(e);for(;ud(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return ad;let s=i.pow(r,t);const o=(t+qe)/Xn;return function(c,f){if(c.is0(f))return f;if(ud(c,f)!==1)throw new Error("Cannot find square root");let u=n,d=c.mul(c.ONE,s),h=c.pow(f,t),l=c.pow(f,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let b=1,w=c.sqr(h);for(;!c.eql(w,c.ONE);)if(b++,w=c.sqr(w),b===u)throw new Error("Cannot find square root");const v=qe<<BigInt(u-b-1),D=c.pow(d,v);u=b,d=c.sqr(D),h=c.mul(h,d),l=c.mul(l,D)}return l}}function P3(e){return e%nd===td?ad:e%id===rd?N3:e%sd===R3?C3(e):cd(e)}const $3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function L3(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=$3.reduce((r,i)=>(r[i]="function",r),t);return ka(e,n),e}function U3(e,t,n){if(n<Xe)throw new Error("invalid exponent, negatives unsupported");if(n===Xe)return e.ONE;if(n===qe)return t;let r=e.ONE,i=t;for(;n>Xe;)n&qe&&(r=e.mul(r,i)),i=e.sqr(i),n>>=qe;return r}function fd(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((o,a,c)=>e.is0(a)?o:(r[c]=o,e.mul(o,a)),e.ONE),s=e.inv(i);return t.reduceRight((o,a,c)=>e.is0(a)?o:(r[c]=e.mul(o,r[c]),e.mul(o,a)),s),r}function ud(e,t){const n=(e.ORDER-qe)/Xn,r=e.pow(t,n),i=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function ld(e,t){t!==void 0&&yr(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function hi(e,t,n=!1,r={}){if(e<=Xe)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,s,o=!1,a;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const h=t;h.BITS&&(i=h.BITS),h.sqrt&&(s=h.sqrt),typeof h.isLE=="boolean"&&(n=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof t=="number"&&(i=t),r.sqrt&&(s=r.sqrt);const{nBitLength:c,nByteLength:f}=ld(e,i);if(f>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:e,isLE:n,BITS:c,BYTES:f,MASK:li(c),ZERO:Xe,ONE:qe,allowedLengths:a,create:h=>St(h,e),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return Xe<=h&&h<e},is0:h=>h===Xe,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&qe)===qe,neg:h=>St(-h,e),eql:(h,l)=>h===l,sqr:h=>St(h*h,e),add:(h,l)=>St(h+l,e),sub:(h,l)=>St(h-l,e),mul:(h,l)=>St(h*l,e),pow:(h,l)=>U3(d,h,l),div:(h,l)=>St(h*od(l,e),e),sqrN:h=>h*h,addN:(h,l)=>h+l,subN:(h,l)=>h-l,mulN:(h,l)=>h*l,inv:h=>od(h,e),sqrt:s||(h=>(u||(u=P3(e)),u(d,h))),toBytes:h=>n?Jh(h,f):ja(h,f),fromBytes:(h,l=!0)=>{if(a){if(!a.includes(h.length)||h.length>f)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const w=new Uint8Array(f);w.set(h,n?0:w.length-h.length),h=w}if(h.length!==f)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+h.length);let b=n?Xh(h):Ds(h);if(o&&(b=St(b,e)),!l&&!d.isValid(b))throw new Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:h=>fd(d,h),cmov:(h,l,b)=>b?l:h});return Object.freeze(d)}function hd(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function dd(e){const t=hd(e);return t+Math.ceil(t/2)}function F3(e,t,n=!1){const r=e.length,i=hd(t),s=dd(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=n?Xh(e):Ds(e),a=St(o,t-qe)+qe;return n?Jh(a,i):ja(a,i)}const Or=BigInt(0),Jn=BigInt(1);function As(e,t){const n=t.negate();return e?n:t}function qa(e,t){const n=fd(e.Fp,t.map(r=>r.Z));return t.map((r,i)=>e.fromAffine(r.toAffine(n[i])))}function gd(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ha(e,t){gd(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,s=li(e),o=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function pd(e,t,n){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=n;let a=Number(e&i),c=e>>o;a>r&&(a-=s,c+=Jn);const f=t*r,u=f+Math.abs(a)-1,d=a===0,h=a<0,l=t%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:f}}function j3(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function M3(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Ka=new WeakMap,bd=new WeakMap;function Va(e){return bd.get(e)||1}function yd(e){if(e!==Or)throw new Error("invalid wNAF")}class k3{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let i=t;for(;n>Or;)n&Jn&&(r=r.add(i)),i=i.double(),n>>=Jn;return r}precomputeWindow(t,n){const{windows:r,windowSize:i}=Ha(n,this.bits),s=[];let o=t,a=o;for(let c=0;c<r;c++){a=o,s.push(a);for(let f=1;f<i;f++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE;const o=Ha(t,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:f,isZero:u,isNeg:d,isNegF:h,offsetF:l}=pd(r,a,o);r=c,u?s=s.add(As(h,n[l])):i=i.add(As(d,n[f]))}return yd(r),{p:i,f:s}}wNAFUnsafe(t,n,r,i=this.ZERO){const s=Ha(t,this.bits);for(let o=0;o<s.windows&&r!==Or;o++){const{nextN:a,offset:c,isZero:f,isNeg:u}=pd(r,o,s);if(r=a,!f){const d=n[c];i=i.add(u?d.negate():d)}}return yd(r),i}getPrecomputes(t,n,r){let i=Ka.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(i=r(i)),Ka.set(n,i))),i}cached(t,n,r){const i=Va(t);return this.wNAF(i,this.getPrecomputes(i,t,r),n)}unsafe(t,n,r,i){const s=Va(t);return s===1?this._unsafeLadder(t,n,i):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,i)}createCache(t,n){gd(n,this.bits),bd.set(t,n),Ka.delete(t)}hasCache(t){return Va(t)!==1}}function z3(e,t,n,r){let i=t,s=e.ZERO,o=e.ZERO;for(;n>Or||r>Or;)n&Jn&&(s=s.add(i)),r&Jn&&(o=o.add(i)),i=i.double(),n>>=Jn,r>>=Jn;return{p1:s,p2:o}}function q3(e,t,n,r){j3(n,e),M3(r,t);const i=n.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=Qh(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const f=li(c),u=new Array(Number(f)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let h=o;for(let l=d;l>=0;l-=c){u.fill(o);for(let w=0;w<s;w++){const v=r[w],D=Number(v>>BigInt(l)&f);u[D]=u[D].add(n[w])}let b=o;for(let w=u.length-1,v=o;w>0;w--)v=v.add(u[w]),b=b.add(v);if(h=h.add(b),l!==0)for(let w=0;w<c;w++)h=h.double()}return h}function wd(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return L3(t),t}else return hi(e,{isLE:n})}function H3(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const c of["p","n","h"]){const f=t[c];if(!(typeof f=="bigint"&&f>Or))throw new Error(`CURVE.${c} must be positive bigint`)}const i=wd(t.p,n.Fp,r),s=wd(t.n,n.Fn,r),a=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(const c of a)if(!i.isValid(t[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:i,Fn:s}}const md=(e,t)=>(e+(e>=0?t:-t)/Ed)/t;function K3(e,t,n){const[[r,i],[s,o]]=t,a=md(o*e,n),c=md(-i*e,n);let f=e-a*r-c*s,u=-a*i-c*o;const d=f<Qt,h=u<Qt;d&&(f=-f),h&&(u=-u);const l=li(Math.ceil(Qh(n)/2))+Br;if(f<Qt||f>=l||u<Qt||u>=l)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:d,k1:f,k2neg:h,k2:u}}function Ga(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Za(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return Os(n.lowS,"lowS"),Os(n.prehash,"prehash"),n.format!==void 0&&Ga(n.format),n}class V3 extends Error{constructor(t=""){super(t)}}const Jt={Err:V3,_tlv:{encode:(e,t)=>{const{Err:n}=Jt;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=Bs(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?Bs(i.length/2|128):"";return Bs(e)+s+i+t},decode(e,t){const{Err:n}=Jt;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const f=t.subarray(r,r+c);if(f.length!==c)throw new n("tlv.decode: length bytes not complete");if(f[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of f)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=Jt;if(e<Qt)throw new t("integer: negative integers are not allowed");let n=Bs(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Jt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ds(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Jt,i=We("signature",e),{v:s,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,s),{v:f,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(f)}},hexFromSig(e){const{_tlv:t,_int:n}=Jt,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),s=r+i;return t.encode(48,s)}},Qt=BigInt(0),Br=BigInt(1),Ed=BigInt(2),Ts=BigInt(3),G3=BigInt(4);function Dr(e,t){const{BYTES:n}=e;let r;if(typeof t=="bigint")r=t;else{let i=We("private key",t);try{r=e.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function Z3(e,t={}){const n=H3("weierstrass",e,t),{Fp:r,Fn:i}=n;let s=n.CURVE;const{h:o,n:a}=s;ka(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=t;if(c&&(!r.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const f=_d(r,i);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(E,p,m){const{x:g,y}=p.toAffine(),S=r.toBytes(g);if(Os(m,"isCompressed"),m){u();const I=!r.isOdd(y);return Kt(vd(I),S)}else return Kt(Uint8Array.of(4),S,r.toBytes(y))}function h(E){Wn(E,void 0,"Point");const{publicKey:p,publicKeyUncompressed:m}=f,g=E.length,y=E[0],S=E.subarray(1);if(g===p&&(y===2||y===3)){const I=r.fromBytes(S);if(!r.isValid(I))throw new Error("bad point: is not on curve, wrong x");const O=w(I);let B;try{B=r.sqrt(O)}catch(P){const j=P instanceof Error?": "+P.message:"";throw new Error("bad point: is not on curve, sqrt error"+j)}u();const T=r.isOdd(B);return(y&1)===1!==T&&(B=r.neg(B)),{x:I,y:B}}else if(g===m&&y===4){const I=r.BYTES,O=r.fromBytes(S.subarray(0,I)),B=r.fromBytes(S.subarray(I,I*2));if(!v(O,B))throw new Error("bad point: is not on curve");return{x:O,y:B}}else throw new Error(`bad point: got length ${g}, expected compressed=${p} or uncompressed=${m}`)}const l=t.toBytes||d,b=t.fromBytes||h;function w(E){const p=r.sqr(E),m=r.mul(p,E);return r.add(r.add(m,r.mul(E,s.a)),s.b)}function v(E,p){const m=r.sqr(p),g=w(E);return r.eql(m,g)}if(!v(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const D=r.mul(r.pow(s.a,Ts),G3),C=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(D,C)))throw new Error("bad curve params: a or b");function x(E,p,m=!1){if(!r.isValid(p)||m&&r.is0(p))throw new Error(`bad point coordinate ${E}`);return p}function _(E){if(!(E instanceof A))throw new Error("ProjectivePoint expected")}function R(E){if(!c||!c.basises)throw new Error("no endo");return K3(E,c.basises,i.ORDER)}const $=ed((E,p)=>{const{X:m,Y:g,Z:y}=E;if(r.eql(y,r.ONE))return{x:m,y:g};const S=E.is0();p==null&&(p=S?r.ONE:r.inv(y));const I=r.mul(m,p),O=r.mul(g,p),B=r.mul(y,p);if(S)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:I,y:O}}),F=ed(E=>{if(E.is0()){if(t.allowInfinityPoint&&!r.is0(E.Y))return;throw new Error("bad point: ZERO")}const{x:p,y:m}=E.toAffine();if(!r.isValid(p)||!r.isValid(m))throw new Error("bad point: x or y not field elements");if(!v(p,m))throw new Error("bad point: equation left != right");if(!E.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(E,p,m,g,y){return m=new A(r.mul(m.X,E),m.Y,m.Z),p=As(g,p),m=As(y,m),p.add(m)}class A{constructor(p,m,g){this.X=x("x",p),this.Y=x("y",m,!0),this.Z=x("z",g),Object.freeze(this)}static CURVE(){return s}static fromAffine(p){const{x:m,y:g}=p||{};if(!p||!r.isValid(m)||!r.isValid(g))throw new Error("invalid affine point");if(p instanceof A)throw new Error("projective point not allowed");return r.is0(m)&&r.is0(g)?A.ZERO:new A(m,g,r.ONE)}static fromBytes(p){const m=A.fromAffine(b(Wn(p,void 0,"point")));return m.assertValidity(),m}static fromHex(p){return A.fromBytes(We("pointHex",p))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,m=!0){return k.createCache(this,p),m||this.multiply(Ts),this}assertValidity(){F(this)}hasEvenY(){const{y:p}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(p)}equals(p){_(p);const{X:m,Y:g,Z:y}=this,{X:S,Y:I,Z:O}=p,B=r.eql(r.mul(m,O),r.mul(S,y)),T=r.eql(r.mul(g,O),r.mul(I,y));return B&&T}negate(){return new A(this.X,r.neg(this.Y),this.Z)}double(){const{a:p,b:m}=s,g=r.mul(m,Ts),{X:y,Y:S,Z:I}=this;let O=r.ZERO,B=r.ZERO,T=r.ZERO,L=r.mul(y,y),P=r.mul(S,S),j=r.mul(I,I),N=r.mul(y,S);return N=r.add(N,N),T=r.mul(y,I),T=r.add(T,T),O=r.mul(p,T),B=r.mul(g,j),B=r.add(O,B),O=r.sub(P,B),B=r.add(P,B),B=r.mul(O,B),O=r.mul(N,O),T=r.mul(g,T),j=r.mul(p,j),N=r.sub(L,j),N=r.mul(p,N),N=r.add(N,T),T=r.add(L,L),L=r.add(T,L),L=r.add(L,j),L=r.mul(L,N),B=r.add(B,L),j=r.mul(S,I),j=r.add(j,j),L=r.mul(j,N),O=r.sub(O,L),T=r.mul(j,P),T=r.add(T,T),T=r.add(T,T),new A(O,B,T)}add(p){_(p);const{X:m,Y:g,Z:y}=this,{X:S,Y:I,Z:O}=p;let B=r.ZERO,T=r.ZERO,L=r.ZERO;const P=s.a,j=r.mul(s.b,Ts);let N=r.mul(m,S),M=r.mul(g,I),z=r.mul(y,O),G=r.add(m,g),H=r.add(S,I);G=r.mul(G,H),H=r.add(N,M),G=r.sub(G,H),H=r.add(m,y);let V=r.add(S,O);return H=r.mul(H,V),V=r.add(N,z),H=r.sub(H,V),V=r.add(g,y),B=r.add(I,O),V=r.mul(V,B),B=r.add(M,z),V=r.sub(V,B),L=r.mul(P,H),B=r.mul(j,z),L=r.add(B,L),B=r.sub(M,L),L=r.add(M,L),T=r.mul(B,L),M=r.add(N,N),M=r.add(M,N),z=r.mul(P,z),H=r.mul(j,H),M=r.add(M,z),z=r.sub(N,z),z=r.mul(P,z),H=r.add(H,z),N=r.mul(M,H),T=r.add(T,N),N=r.mul(V,H),B=r.mul(G,B),B=r.sub(B,N),N=r.mul(G,M),L=r.mul(V,L),L=r.add(L,N),new A(B,T,L)}subtract(p){return this.add(p.negate())}is0(){return this.equals(A.ZERO)}multiply(p){const{endo:m}=t;if(!i.isValidNot0(p))throw new Error("invalid scalar: out of range");let g,y;const S=I=>k.cached(this,I,O=>qa(A,O));if(m){const{k1neg:I,k1:O,k2neg:B,k2:T}=R(p),{p:L,f:P}=S(O),{p:j,f:N}=S(T);y=P.add(N),g=U(m.beta,L,j,I,B)}else{const{p:I,f:O}=S(p);g=I,y=O}return qa(A,[g,y])[0]}multiplyUnsafe(p){const{endo:m}=t,g=this;if(!i.isValid(p))throw new Error("invalid scalar: out of range");if(p===Qt||g.is0())return A.ZERO;if(p===Br)return g;if(k.hasCache(this))return this.multiply(p);if(m){const{k1neg:y,k1:S,k2neg:I,k2:O}=R(p),{p1:B,p2:T}=z3(A,g,S,O);return U(m.beta,B,T,y,I)}else return k.unsafe(g,p)}multiplyAndAddUnsafe(p,m,g){const y=this.multiplyUnsafe(m).add(p.multiplyUnsafe(g));return y.is0()?void 0:y}toAffine(p){return $(this,p)}isTorsionFree(){const{isTorsionFree:p}=t;return o===Br?!0:p?p(A,this):k.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:p}=t;return o===Br?this:p?p(A,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(p=!0){return Os(p,"isCompressed"),this.assertValidity(),l(A,this,p)}toHex(p=!0){return mr(this.toBytes(p))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(p=!0){return this.toBytes(p)}_setWindowSize(p){this.precompute(p)}static normalizeZ(p){return qa(A,p)}static msm(p,m){return q3(A,i,p,m)}static fromPrivateKey(p){return A.BASE.multiply(Dr(i,p))}}A.BASE=new A(s.Gx,s.Gy,r.ONE),A.ZERO=new A(r.ZERO,r.ONE,r.ZERO),A.Fp=r,A.Fn=i;const q=i.BITS,k=new k3(A,t.endo?Math.ceil(q/2):q);return A.BASE.precompute(8),A}function vd(e){return Uint8Array.of(e?2:3)}function _d(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Y3(e,t={}){const{Fn:n}=e,r=t.randomBytes||us,i=Object.assign(_d(e.Fp,n),{seed:dd(n.ORDER)});function s(l){try{return!!Dr(n,l)}catch{return!1}}function o(l,b){const{publicKey:w,publicKeyUncompressed:v}=i;try{const D=l.length;return b===!0&&D!==w||b===!1&&D!==v?!1:!!e.fromBytes(l)}catch{return!1}}function a(l=r(i.seed)){return F3(Wn(l,i.seed,"seed"),n.ORDER)}function c(l,b=!0){return e.BASE.multiply(Dr(n,l)).toBytes(b)}function f(l){const b=a(l);return{secretKey:b,publicKey:c(b)}}function u(l){if(typeof l=="bigint")return!1;if(l instanceof e)return!0;const{secretKey:b,publicKey:w,publicKeyUncompressed:v}=i;if(n.allowedLengths||b===w)return;const D=We("key",l).length;return D===w||D===v}function d(l,b,w=!0){if(u(l)===!0)throw new Error("first arg must be private key");if(u(b)===!1)throw new Error("second arg must be public key");const v=Dr(n,l);return e.fromHex(b).multiply(v).toBytes(w)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:f,Point:e,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:l=>Dr(n,l),precompute(l=8,b=e.BASE){return b.precompute(l,!1)}},lengths:i})}function W3(e,t,n={}){Hl(t),ka(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||us,i=n.hmac||((m,...g)=>Ea(t,m,Kt(...g))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:c}=o,{keygen:f,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l}=Y3(e,n),b={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},w="compact";function v(m){const g=a>>Br;return m>g}function D(m,g){if(!o.isValidNot0(g))throw new Error(`invalid signature ${m}: out of range 1..Point.Fn.ORDER`);return g}function C(m,g){Ga(g);const y=l.signature,S=g==="compact"?y:g==="recovered"?y+1:void 0;return Wn(m,S,`${g} signature`)}class x{constructor(g,y,S){this.r=D("r",g),this.s=D("s",y),S!=null&&(this.recovery=S),Object.freeze(this)}static fromBytes(g,y=w){C(g,y);let S;if(y==="der"){const{r:T,s:L}=Jt.toSig(Wn(g));return new x(T,L)}y==="recovered"&&(S=g[0],y="compact",g=g.subarray(1));const I=o.BYTES,O=g.subarray(0,I),B=g.subarray(I,I*2);return new x(o.fromBytes(O),o.fromBytes(B),S)}static fromHex(g,y){return this.fromBytes(as(g),y)}addRecoveryBit(g){return new x(this.r,this.s,g)}recoverPublicKey(g){const y=s.ORDER,{r:S,s:I,recovery:O}=this;if(O==null||![0,1,2,3].includes(O))throw new Error("recovery id invalid");if(a*Ed<y&&O>1)throw new Error("recovery id is ambiguous for h>1 curve");const T=O===2||O===3?S+a:S;if(!s.isValid(T))throw new Error("recovery id 2 or 3 invalid");const L=s.toBytes(T),P=e.fromBytes(Kt(vd((O&1)===0),L)),j=o.inv(T),N=R(We("msgHash",g)),M=o.create(-N*j),z=o.create(I*j),G=e.BASE.multiplyUnsafe(M).add(P.multiplyUnsafe(z));if(G.is0())throw new Error("point at infinify");return G.assertValidity(),G}hasHighS(){return v(this.s)}toBytes(g=w){if(Ga(g),g==="der")return as(Jt.hexFromSig(this));const y=o.toBytes(this.r),S=o.toBytes(this.s);if(g==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Kt(Uint8Array.of(this.recovery),y,S)}return Kt(y,S)}toHex(g){return mr(this.toBytes(g))}assertValidity(){}static fromCompact(g){return x.fromBytes(We("sig",g),"compact")}static fromDER(g){return x.fromBytes(We("sig",g),"der")}normalizeS(){return this.hasHighS()?new x(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return mr(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return mr(this.toBytes("compact"))}}const _=n.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const y=Ds(g),S=g.length*8-c;return S>0?y>>BigInt(S):y},R=n.bits2int_modN||function(g){return o.create(_(g))},$=li(c);function F(m){return D3("num < 2^"+c,m,Qt,$),o.toBytes(m)}function U(m,g){return Wn(m,void 0,"message"),g?Wn(t(m),void 0,"prehashed message"):m}function A(m,g,y){if(["recovered","canonical"].some(M=>M in y))throw new Error("sign() legacy options not supported");const{lowS:S,prehash:I,extraEntropy:O}=Za(y,b);m=U(m,I);const B=R(m),T=Dr(o,g),L=[F(T),F(B)];if(O!=null&&O!==!1){const M=O===!0?r(l.secretKey):O;L.push(We("extraEntropy",M))}const P=Kt(...L),j=B;function N(M){const z=_(M);if(!o.isValidNot0(z))return;const G=o.inv(z),H=e.BASE.multiply(z).toAffine(),V=o.create(H.x);if(V===Qt)return;const J=o.create(G*o.create(j+V*T));if(J===Qt)return;let ee=(H.x===V?0:2)|Number(H.y&Br),re=J;return S&&v(J)&&(re=o.neg(J),ee^=1),new x(V,re,ee)}return{seed:P,k2sig:N}}function q(m,g,y={}){m=We("message",m);const{seed:S,k2sig:I}=A(m,g,y);return A3(t.outputLen,o.BYTES,i)(S,I)}function k(m){let g;const y=typeof m=="string"||os(m),S=!y&&m!==null&&typeof m=="object"&&typeof m.r=="bigint"&&typeof m.s=="bigint";if(!y&&!S)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(S)g=new x(m.r,m.s);else if(y){try{g=x.fromBytes(We("sig",m),"der")}catch(I){if(!(I instanceof Jt.Err))throw I}if(!g)try{g=x.fromBytes(We("sig",m),"compact")}catch{return!1}}return g||!1}function E(m,g,y,S={}){const{lowS:I,prehash:O,format:B}=Za(S,b);if(y=We("publicKey",y),g=U(We("message",g),O),"strict"in S)throw new Error("options.strict was renamed to lowS");const T=B===void 0?k(m):x.fromBytes(We("sig",m),B);if(T===!1)return!1;try{const L=e.fromBytes(y);if(I&&T.hasHighS())return!1;const{r:P,s:j}=T,N=R(g),M=o.inv(j),z=o.create(N*M),G=o.create(P*M),H=e.BASE.multiplyUnsafe(z).add(L.multiplyUnsafe(G));return H.is0()?!1:o.create(H.x)===P}catch{return!1}}function p(m,g,y={}){const{prehash:S}=Za(y,b);return g=U(g,S),x.fromBytes(m,"recovered").recoverPublicKey(g).toBytes()}return Object.freeze({keygen:f,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l,Point:e,sign:q,verify:E,recoverPublicKey:p,Signature:x,hash:t})}function X3(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const i=hi(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),s={Fp:n,Fn:i,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function J3(e){const{CURVE:t,curveOpts:n}=X3(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}function Q3(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,ld(n.Fn.ORDER,n.Fn.BITS))})}function e8(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:i}=J3(e),s=Z3(t,n),o=W3(s,r,i);return Q3(e,o)}function t8(e,t){const n=r=>e8({...e,hash:r});return{...n(t),create:n}}oa("HashToScalar-");const Ya={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},n8={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},xd=BigInt(2);function r8(e){const t=Ya.p,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),f=e*e*e%t,u=f*f*e%t,d=pt(u,n,t)*u%t,h=pt(d,n,t)*u%t,l=pt(h,xd,t)*f%t,b=pt(l,i,t)*l%t,w=pt(b,s,t)*b%t,v=pt(w,a,t)*w%t,D=pt(v,c,t)*v%t,C=pt(D,a,t)*w%t,x=pt(C,n,t)*u%t,_=pt(x,o,t)*b%t,R=pt(_,r,t)*f%t,$=pt(R,xd,t);if(!Wa.eql(Wa.sqr($),e))throw new Error("Cannot find square root");return $}const Wa=hi(Ya.p,{sqrt:r8});t8({...Ya,Fp:Wa,lowS:!0,endo:n8},_r);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ar(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Xa(e,...t){if(!Ar(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Sd(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Ja(e){if(typeof e!="function")throw new Error("function expected");return!0}function xn(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Tr(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Rs(e){if(!Array.isArray(e))throw new Error("array expected")}function Ns(e,t){if(!Sd(!0,t))throw new Error(`${e}: array of strings expected`)}function Qa(e,t){if(!Sd(!1,t))throw new Error(`${e}: array of numbers expected`)}function Je(...e){const t=s=>s,n=(s,o)=>a=>s(o(a)),r=e.map(s=>s.encode).reduceRight(n,t),i=e.map(s=>s.decode).reduce(n,t);return{encode:r,decode:i}}function at(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Ns("alphabet",t);const r=new Map(t.map((i,s)=>[i,s]));return{encode:i=>(Rs(i),i.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${e}`);return t[s]})),decode:i=>(Rs(i),i.map(s=>{xn("alphabet.decode",s);const o=r.get(s);if(o===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${e}`);return o}))}}function ct(e=""){return xn("join",e),{encode:t=>(Ns("join.decode",t),t.join(e)),decode:t=>(xn("join.decode",t),t.split(e))}}function Cs(e,t="="){return Tr(e),xn("padding",t),{encode(n){for(Ns("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Ns("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function Id(e){return Ja(e),{encode:t=>t,decode:t=>e(t)}}function Od(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(Rs(e),!e.length)return[];let r=0;const i=[],s=Array.from(e,a=>{if(Tr(a),a<0||a>=t)throw new Error(`invalid integer: ${a}`);return a}),o=s.length;for(;;){let a=0,c=!0;for(let f=r;f<o;f++){const u=s[f],d=t*a,h=d+u;if(!Number.isSafeInteger(h)||d/t!==a||h-u!==d)throw new Error("convertRadix: carry overflow");const l=h/n;a=h%n;const b=Math.floor(l);if(s[f]=b,!Number.isSafeInteger(b)||b*n+a!==h)throw new Error("convertRadix: carry overflow");if(c)b?c=!1:r=f;else continue}if(i.push(a),c)break}for(let a=0;a<e.length-1&&e[a]===0;a++)i.push(0);return i.reverse()}const Bd=(e,t)=>t===0?e:Bd(t,e%t),Ps=(e,t)=>e+(t-Bd(e,t)),$s=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function ec(e,t,n,r){if(Rs(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Ps(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Ps(t,n)}`);let i=0,s=0;const o=$s[t],a=$s[n]-1,c=[];for(const f of e){if(Tr(f),f>=o)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(i=i<<t|f,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)c.push((i>>s-n&a)>>>0);const u=$s[s];if(u===void 0)throw new Error("invalid carry");i&=u-1}if(i=i<<n-s&a,!r&&s>=t)throw new Error("Excess padding");if(!r&&i>0)throw new Error(`Non-zero padding: ${i}`);return r&&s>0&&c.push(i>>>0),c}function i8(e){Tr(e);const t=2**8;return{encode:n=>{if(!Ar(n))throw new Error("radix.encode input should be Uint8Array");return Od(Array.from(n),t,e)},decode:n=>(Qa("radix.decode",n),Uint8Array.from(Od(n,e,t)))}}function bt(e,t=!1){if(Tr(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Ps(8,e)>32||Ps(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Ar(n))throw new Error("radix2.encode input should be Uint8Array");return ec(Array.from(n),8,e,!t)},decode:n=>(Qa("radix2.decode",n),Uint8Array.from(ec(n,e,8,t)))}}function Dd(e){return Ja(e),function(...t){try{return e.apply(null,t)}catch{}}}function s8(e,t){return Tr(e),Ja(t),{encode(n){if(!Ar(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),i=new Uint8Array(n.length+e);return i.set(n),i.set(r,n.length),i},decode(n){if(!Ar(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),i=n.slice(-e),s=t(r).slice(0,e);for(let o=0;o<e;o++)if(s[o]!==i[o])throw new Error("Invalid checksum");return r}}}const Ad=typeof Uint8Array.from([]).toBase64=="function"&&typeof Uint8Array.fromBase64=="function",Td=(e,t)=>{xn("base64",e);const n=t?/^[A-Za-z0-9=_-]+$/:/^[A-Za-z0-9=+/]+$/,r=t?"base64url":"base64";if(e.length>0&&!n.test(e))throw new Error("invalid base64");return Uint8Array.fromBase64(e,{alphabet:r,lastChunkHandling:"strict"})},tc=e=>Je(i8(58),at(e),ct("")),o8=tc("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),a8=e=>Je(s8(4,t=>e(e(t))),o8),nc=Je(at("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),ct("")),Rd=[996825010,642813549,513874426,1027748829,705979059];function di(e){const t=e>>25;let n=(e&33554431)<<5;for(let r=0;r<Rd.length;r++)(t>>r&1)===1&&(n^=Rd[r]);return n}function Nd(e,t,n=1){const r=e.length;let i=1;for(let s=0;s<r;s++){const o=e.charCodeAt(s);if(o<33||o>126)throw new Error(`Invalid prefix (${e})`);i=di(i)^o>>5}i=di(i);for(let s=0;s<r;s++)i=di(i)^e.charCodeAt(s)&31;for(let s of t)i=di(i)^s;for(let s=0;s<6;s++)i=di(i);return i^=n,nc.encode(ec([i%$s[30]],30,5,!1))}function Cd(e){const t=e==="bech32"?1:734539939,n=bt(5),r=n.decode,i=n.encode,s=Dd(r);function o(d,h,l=90){xn("bech32.encode prefix",d),Ar(h)&&(h=Array.from(h)),Qa("bech32.encode",h);const b=d.length;if(b===0)throw new TypeError(`Invalid prefix length ${b}`);const w=b+7+h.length;if(l!==!1&&w>l)throw new TypeError(`Length ${w} exceeds limit ${l}`);const v=d.toLowerCase(),D=Nd(v,h,t);return`${v}1${nc.encode(h)}${D}`}function a(d,h=90){xn("bech32.decode input",d);const l=d.length;if(l<8||h!==!1&&l>h)throw new TypeError(`invalid string length: ${l} (${d}). Expected (8..${h})`);const b=d.toLowerCase();if(d!==b&&d!==d.toUpperCase())throw new Error("String must be lowercase or uppercase");const w=b.lastIndexOf("1");if(w===0||w===-1)throw new Error('Letter "1" must be present between prefix and data only');const v=b.slice(0,w),D=b.slice(w+1);if(D.length<6)throw new Error("Data must be at least 6 characters long");const C=nc.decode(D).slice(0,-6),x=Nd(v,C,t);if(!D.endsWith(x))throw new Error(`Invalid checksum in ${d}: expected "${x}"`);return{prefix:v,words:C}}const c=Dd(a);function f(d){const{prefix:h,words:l}=a(d,!1);return{prefix:h,words:l,bytes:r(l)}}function u(d,h){return o(d,i(h))}return{encode:o,decode:a,encodeFromBytes:u,decodeToBytes:f,decodeUnsafe:c,fromWords:r,fromWordsUnsafe:s,toWords:i}}const c8=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",f8={encode(e){return Xa(e),e.toHex()},decode(e){return xn("hex",e),Uint8Array.fromHex(e)}};a8(_r),oa("Bitcoin seed");/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Pd(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ls(e,...t){if(!Pd(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Us(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $d(e,t){Ls(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function gi(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function rc(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function u8(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function l8(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function pi(e){if(typeof e=="string")e=l8(e);else if(Pd(e))e=Ld(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function Ld(e){return Uint8Array.from(e)}const en=16,ic=new Uint8Array(16),$t=gi(ic),h8=225,d8=(e,t,n,r)=>{const i=r&1;return{s3:n<<31|r>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^h8<<24&-(i&1)}},yt=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0;function g8(e){e.reverse();const t=e[15]&1;let n=0;for(let r=0;r<e.length;r++){const i=e[r];e[r]=i>>>1|n,n=(i&1)<<7}return e[0]^=-t&225,e}const p8=e=>e>64*1024?8:e>1024?4:2;class Ud{constructor(t,n){this.blockLen=en,this.outputLen=en,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=pi(t),Ls(t,16);const r=u8(t);let i=r.getUint32(0,!1),s=r.getUint32(4,!1),o=r.getUint32(8,!1),a=r.getUint32(12,!1);const c=[];for(let b=0;b<128;b++)c.push({s0:yt(i),s1:yt(s),s2:yt(o),s3:yt(a)}),{s0:i,s1:s,s2:o,s3:a}=d8(i,s,o,a);const f=p8(n||1024);if(![1,2,4,8].includes(f))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=f;const d=128/f,h=this.windowSize=2**f,l=[];for(let b=0;b<d;b++)for(let w=0;w<h;w++){let v=0,D=0,C=0,x=0;for(let _=0;_<f;_++){if(!(w>>>f-_-1&1))continue;const{s0:$,s1:F,s2:U,s3:A}=c[f*b+_];v^=$,D^=F,C^=U,x^=A}l.push({s0:v,s1:D,s2:C,s3:x})}this.t=l}_updateBlock(t,n,r,i){t^=this.s0,n^=this.s1,r^=this.s2,i^=this.s3;const{W:s,t:o,windowSize:a}=this;let c=0,f=0,u=0,d=0;const h=(1<<s)-1;let l=0;for(const b of[t,n,r,i])for(let w=0;w<4;w++){const v=b>>>8*w&255;for(let D=8/s-1;D>=0;D--){const C=v>>>s*D&h,{s0:x,s1:_,s2:R,s3:$}=o[l*a+C];c^=x,f^=_,u^=R,d^=$,l+=1}}this.s0=c,this.s1=f,this.s2=u,this.s3=d}update(t){Us(this),t=pi(t),Ls(t);const n=gi(t),r=Math.floor(t.length/en),i=t.length%en;for(let s=0;s<r;s++)this._updateBlock(n[s*4+0],n[s*4+1],n[s*4+2],n[s*4+3]);return i&&(ic.set(t.subarray(r*en)),this._updateBlock($t[0],$t[1],$t[2],$t[3]),rc($t)),this}destroy(){const{t}=this;for(const n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(t){Us(this),$d(t,this),this.finished=!0;const{s0:n,s1:r,s2:i,s3:s}=this,o=gi(t);return o[0]=n,o[1]=r,o[2]=i,o[3]=s,t}digest(){const t=new Uint8Array(en);return this.digestInto(t),this.destroy(),t}}class b8 extends Ud{constructor(t,n){t=pi(t),Ls(t);const r=g8(Ld(t));super(r,n),rc(r)}update(t){t=pi(t),Us(this);const n=gi(t),r=t.length%en,i=Math.floor(t.length/en);for(let s=0;s<i;s++)this._updateBlock(yt(n[s*4+3]),yt(n[s*4+2]),yt(n[s*4+1]),yt(n[s*4+0]));return r&&(ic.set(t.subarray(i*en)),this._updateBlock(yt($t[3]),yt($t[2]),yt($t[1]),yt($t[0])),rc($t)),this}digestInto(t){Us(this),$d(t,this),this.finished=!0;const{s0:n,s1:r,s2:i,s3:s}=this,o=gi(t);return o[0]=n,o[1]=r,o[2]=i,o[3]=s,t.reverse()}}function Fd(e){const t=(r,i)=>e(i,r.length).update(pi(r)).digest(),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(r,i)=>e(r,i),t}Fd((e,t)=>new Ud(e,t)),Fd((e,t)=>new b8(e,t));const jd=mn(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),y8=jd.create(BigInt("-3")),w8=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b");Es({a:y8,b:w8,Fp:jd,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},_r);const Md=mn(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),m8=Md.create(BigInt("-3")),E8=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef");Es({a:m8,b:E8,Fp:Md,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},hv);const kd=mn(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),v8=kd.create(BigInt("-3")),_8=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00");Es({a:v8,b:_8,Fp:kd,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},lv);var x8={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,f,u){this.fn=c,this.context=f,this.once=u||!1}function s(c,f,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var l=new i(u,d||c,h),b=n?n+f:f;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],l]:c._events[b].push(l):(c._events[b]=l,c._eventsCount++),c}function o(c,f){--c._eventsCount===0?c._events=new r:delete c._events[f]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var f=[],u,d;if(this._eventsCount===0)return f;for(d in u=this._events)t.call(u,d)&&f.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(u)):f},a.prototype.listeners=function(f){var u=n?n+f:f,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,l=d.length,b=new Array(l);h<l;h++)b[h]=d[h].fn;return b},a.prototype.listenerCount=function(f){var u=n?n+f:f,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(f,u,d,h,l,b){var w=n?n+f:f;if(!this._events[w])return!1;var v=this._events[w],D=arguments.length,C,x;if(v.fn){switch(v.once&&this.removeListener(f,v.fn,void 0,!0),D){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,l),!0;case 6:return v.fn.call(v.context,u,d,h,l,b),!0}for(x=1,C=new Array(D-1);x<D;x++)C[x-1]=arguments[x];v.fn.apply(v.context,C)}else{var _=v.length,R;for(x=0;x<_;x++)switch(v[x].once&&this.removeListener(f,v[x].fn,void 0,!0),D){case 1:v[x].fn.call(v[x].context);break;case 2:v[x].fn.call(v[x].context,u);break;case 3:v[x].fn.call(v[x].context,u,d);break;case 4:v[x].fn.call(v[x].context,u,d,h);break;default:if(!C)for(R=1,C=new Array(D-1);R<D;R++)C[R-1]=arguments[R];v[x].fn.apply(v[x].context,C)}}return!0},a.prototype.on=function(f,u,d){return s(this,f,u,d,!1)},a.prototype.once=function(f,u,d){return s(this,f,u,d,!0)},a.prototype.removeListener=function(f,u,d,h){var l=n?n+f:f;if(!this._events[l])return this;if(!u)return o(this,l),this;var b=this._events[l];if(b.fn)b.fn===u&&(!h||b.once)&&(!d||b.context===d)&&o(this,l);else{for(var w=0,v=[],D=b.length;w<D;w++)(b[w].fn!==u||h&&!b[w].once||d&&b[w].context!==d)&&v.push(b[w]);v.length?this._events[l]=v.length===1?v[0]:v:o(this,l)}return this},a.prototype.removeAllListeners=function(f){var u;return f?(u=n?n+f:f,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(x8);function S8(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let f=0;f<t.length;f++)t[f]=255;for(let f=0;f<e.length;f++){const u=e.charAt(f),d=u.charCodeAt(0);if(t[d]!==255)throw new TypeError(u+" is ambiguous");t[d]=f}const n=e.length,r=e.charAt(0),i=Math.log(n)/Math.log(256),s=Math.log(256)/Math.log(n);function o(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";let u=0,d=0,h=0;const l=f.length;for(;h!==l&&f[h]===0;)h++,u++;const b=(l-h)*s+1>>>0,w=new Uint8Array(b);for(;h!==l;){let C=f[h],x=0;for(let _=b-1;(C!==0||x<d)&&_!==-1;_--,x++)C+=256*w[_]>>>0,w[_]=C%n>>>0,C=C/n>>>0;if(C!==0)throw new Error("Non-zero carry");d=x,h++}let v=b-d;for(;v!==b&&w[v]===0;)v++;let D=r.repeat(u);for(;v<b;++v)D+=e.charAt(w[v]);return D}function a(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;f[u]===r;)d++,u++;const l=(f.length-u)*i+1>>>0,b=new Uint8Array(l);for(;u<f.length;){const C=f.charCodeAt(u);if(C>255)return;let x=t[C];if(x===255)return;let _=0;for(let R=l-1;(x!==0||_<h)&&R!==-1;R--,_++)x+=n*b[R]>>>0,b[R]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");h=_,u++}let w=l-h;for(;w!==l&&b[w]===0;)w++;const v=new Uint8Array(d+(l-w));let D=d;for(;w!==l;)v[D++]=b[w++];return v}function c(f){const u=a(f);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var I8="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";S8(I8);function bi(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const n=Nl(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return ta(n)}function Qe(e,t="utf8"){const n=$l[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}const O8={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var B8=Object.defineProperty,D8=Object.defineProperties,A8=Object.getOwnPropertyDescriptors,zd=Object.getOwnPropertySymbols,T8=Object.prototype.hasOwnProperty,R8=Object.prototype.propertyIsEnumerable,qd=(e,t,n)=>t in e?B8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Rr=(e,t)=>{for(var n in t||(t={}))T8.call(t,n)&&qd(e,n,t[n]);if(zd)for(var n of zd(t))R8.call(t,n)&&qd(e,n,t[n]);return e},yi=(e,t)=>D8(e,A8(t));const N8="ReactNative",It={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},C8="js";function Fs(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Qn(){return!pr()&&!!ra()&&navigator.product===N8}function P8(){return Qn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function $8(){return Qn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function wi(){return!Fs()&&!!ra()&&!!pr()}function js(){return Qn()?It.reactNative:Fs()?It.node:wi()?It.browser:It.unknown}function Hd(){var e;try{return Qn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(e=global.Application)==null?void 0:e.applicationId:void 0}catch{return}}function L8(e,t){const n=new URLSearchParams(e);return Object.entries(t).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!=null&&n.set(r,String(i))}),n.toString()}function U8(){return kl()||{name:"",description:"",url:"",icons:[""]}}function F8(){if(js()===It.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const e=dE();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function j8(){var e;const t=js();return t===It.browser?[t,((e=Ml())==null?void 0:e.host)||"unknown"].join(":"):t}function Kd(e,t,n){const r=F8(),i=j8();return[[e,t].join("-"),[C8,n].join("-"),r,i].join("/")}function M8({protocol:e,version:t,relayUrl:n,sdkVersion:r,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const f=n.split("?"),u=Kd(e,t,r),d={auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},h=L8(f[1]||"",d);return f[0]+"?"+h}function sc(e){return Object.fromEntries(e.entries())}function oc(e){return new Map(Object.entries(e))}function k8(e=W.FIVE_MINUTES,t){const n=W.toMiliseconds(e||W.FIVE_MINUTES);let r,i,s,o;return{resolve:a=>{s&&r&&(clearTimeout(s),r(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const f=new Error(t);o=Promise.reject(f),c(f)},n),r=a,i=c})}}function Lt(e,t,n){return new Promise(async(r,i)=>{const s=setTimeout(()=>i(new Error(n)),t);try{const o=await e;r(o)}catch(o){i(o)}clearTimeout(s)})}function Vd(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function z8(e){return Vd("topic",e)}function q8(e){return Vd("id",e)}function H8(e){const[t,n]=e.split(":"),r={id:void 0,topic:void 0};if(t==="topic"&&typeof n=="string")r.topic=n;else if(t==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${n}`);return r}function mi(e,t){return W.fromMiliseconds((t||Date.now())+W.toMiliseconds(e))}function Gd(e){return Date.now()>=W.toMiliseconds(e)}function ac(e,t){return`${e}${t?`:${t}`:""}`}function Zd(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Yd(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function Wd(e){return Buffer.from(e,"base64").toString("utf-8")}function K8(e){return new Promise(t=>setTimeout(t,e))}const Ms=BigInt(2**32-1),Xd=BigInt(32);function Jd(e,t=!1){return t?{h:Number(e&Ms),l:Number(e>>Xd&Ms)}:{h:Number(e>>Xd&Ms)|0,l:Number(e&Ms)|0}}function Qd(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let s=0;s<n;s++){const{h:o,l:a}=Jd(e[s],t);[r[s],i[s]]=[o,a]}return[r,i]}const e0=(e,t,n)=>e>>>n,t0=(e,t,n)=>e<<32-n|t>>>n,Sn=(e,t,n)=>e>>>n|t<<32-n,In=(e,t,n)=>e<<32-n|t>>>n,Ei=(e,t,n)=>e<<64-n|t>>>n-32,vi=(e,t,n)=>e>>>n-32|t<<64-n,V8=(e,t)=>t,G8=(e,t)=>e,Z8=(e,t,n)=>e<<n|t>>>32-n,Y8=(e,t,n)=>t<<n|e>>>32-n,W8=(e,t,n)=>t<<n-32|e>>>64-n,X8=(e,t,n)=>e<<n-32|t>>>64-n;function Ot(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const cc=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),fc=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,J8=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Q8=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,e6=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),t6=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,Nr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ks(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function tn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Bt(e,...t){if(!ks(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function zs(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");tn(e.outputLen),tn(e.blockLen)}function On(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function uc(e,t){Bt(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function _i(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function wt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function lc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ut(e,t){return e<<32-t|e>>>t}const n0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function r0(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const nn=n0?e=>e:e=>r0(e);function n6(e){for(let t=0;t<e.length;t++)e[t]=r0(e[t]);return e}const Bn=n0?e=>e:n6,i0=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",r6=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Cr(e){if(Bt(e),i0)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=r6[e[n]];return t}const rn={_0:48,_9:57,A:65,F:70,a:97,f:102};function s0(e){if(e>=rn._0&&e<=rn._9)return e-rn._0;if(e>=rn.A&&e<=rn.F)return e-(rn.A-10);if(e>=rn.a&&e<=rn.f)return e-(rn.a-10)}function qs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(i0)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=s0(e.charCodeAt(s)),a=s0(e.charCodeAt(s+1));if(o===void 0||a===void 0){const c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=o*16+a}return r}function o0(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Dt(e){return typeof e=="string"&&(e=o0(e)),Bt(e),e}function Dn(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];Bt(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}class Hs{}function xi(e){const t=r=>e().update(Dt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function i6(e){const t=(r,i)=>e(i).update(Dt(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function er(e=32){if(Nr&&typeof Nr.getRandomValues=="function")return Nr.getRandomValues(new Uint8Array(e));if(Nr&&typeof Nr.randomBytes=="function")return Uint8Array.from(Nr.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const s6=BigInt(0),Si=BigInt(1),o6=BigInt(2),a6=BigInt(7),c6=BigInt(256),f6=BigInt(113),a0=[],c0=[],f0=[];for(let e=0,t=Si,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],a0.push(2*(5*r+n)),c0.push((e+1)*(e+2)/2%64);let i=s6;for(let s=0;s<7;s++)t=(t<<Si^(t>>a6)*f6)%c6,t&o6&&(i^=Si<<(Si<<BigInt(s))-Si);f0.push(i)}const u0=Qd(f0,!0),u6=u0[0],l6=u0[1],l0=(e,t,n)=>n>32?W8(e,t,n):Z8(e,t,n),h0=(e,t,n)=>n>32?X8(e,t,n):Y8(e,t,n);function h6(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,f=n[c],u=n[c+1],d=l0(f,u,1)^n[a],h=h0(f,u,1)^n[a+1];for(let l=0;l<50;l+=10)e[o+l]^=d,e[o+l+1]^=h}let i=e[2],s=e[3];for(let o=0;o<24;o++){const a=c0[o],c=l0(i,s,a),f=h0(i,s,a),u=a0[o];i=e[u],s=e[u+1],e[u]=c,e[u+1]=f}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=u6[r],e[1]^=l6[r]}wt(n)}class hc extends Hs{constructor(t,n,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=i,this.rounds=s,tn(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=_i(this.state)}clone(){return this._cloneInto()}keccak(){Bn(this.state32),h6(this.state32,this.rounds),Bn(this.state32),this.posOut=0,this.pos=0}update(t){On(this),t=Dt(t),Bt(t);const{blockLen:n,state:r}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:i}=this;t[r]^=n,(n&128)!==0&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){On(this,!1),Bt(t),this.finish();const n=this.state,{blockLen:r}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return tn(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(uc(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,wt(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new hc(n,r,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}}((e,t,n)=>xi(()=>new hc(t,e,n)))(1,136,256/8);function d6(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,f=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+f,a,r)}function g6(e,t,n){return e&t^~e&n}function p6(e,t,n){return e&t^e&n^t&n}class d0 extends Hs{constructor(t,n,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(t),this.view=lc(this.buffer)}update(t){On(this),t=Dt(t),Bt(t);const{view:n,buffer:r,blockLen:i}=this,s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=lc(t);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){On(this),uc(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,wt(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;d6(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=lc(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<f;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=s,t.length=i,t.pos=a,i%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const An=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ce=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Pe=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),b6=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Tn=new Uint32Array(64);class y6 extends d0{constructor(t=32){super(64,t,8,!1),this.A=An[0]|0,this.B=An[1]|0,this.C=An[2]|0,this.D=An[3]|0,this.E=An[4]|0,this.F=An[5]|0,this.G=An[6]|0,this.H=An[7]|0}get(){const{A:t,B:n,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[t,n,r,i,s,o,a,c]}set(t,n,r,i,s,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)Tn[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=Tn[d-15],l=Tn[d-2],b=Ut(h,7)^Ut(h,18)^h>>>3,w=Ut(l,17)^Ut(l,19)^l>>>10;Tn[d]=w+Tn[d-7]+b+Tn[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:f,H:u}=this;for(let d=0;d<64;d++){const h=Ut(a,6)^Ut(a,11)^Ut(a,25),l=u+h+g6(a,c,f)+b6[d]+Tn[d]|0,b=(Ut(r,2)^Ut(r,13)^Ut(r,22))+p6(r,i,s)|0;u=f,f=c,c=a,a=o+l|0,o=s,s=i,i=r,r=l+b|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,f,u)}roundClean(){wt(Tn)}destroy(){this.set(0,0,0,0,0,0,0,0),wt(this.buffer)}}const g0=Qd(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),w6=g0[0],m6=g0[1],Rn=new Uint32Array(80),Nn=new Uint32Array(80);class dc extends d0{constructor(t=64){super(128,t,16,!1),this.Ah=Pe[0]|0,this.Al=Pe[1]|0,this.Bh=Pe[2]|0,this.Bl=Pe[3]|0,this.Ch=Pe[4]|0,this.Cl=Pe[5]|0,this.Dh=Pe[6]|0,this.Dl=Pe[7]|0,this.Eh=Pe[8]|0,this.El=Pe[9]|0,this.Fh=Pe[10]|0,this.Fl=Pe[11]|0,this.Gh=Pe[12]|0,this.Gl=Pe[13]|0,this.Hh=Pe[14]|0,this.Hl=Pe[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:f,El:u,Fh:d,Fl:h,Gh:l,Gl:b,Hh:w,Hl:v}=this;return[t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v]}set(t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=l|0,this.Gl=b|0,this.Hh=w|0,this.Hl=v|0}process(t,n){for(let x=0;x<16;x++,n+=4)Rn[x]=t.getUint32(n),Nn[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){const _=Rn[x-15]|0,R=Nn[x-15]|0,$=Sn(_,R,1)^Sn(_,R,8)^e0(_,R,7),F=In(_,R,1)^In(_,R,8)^t0(_,R,7),U=Rn[x-2]|0,A=Nn[x-2]|0,q=Sn(U,A,19)^Ei(U,A,61)^e0(U,A,6),k=In(U,A,19)^vi(U,A,61)^t0(U,A,6),E=J8(F,k,Nn[x-7],Nn[x-16]),p=Q8(E,$,q,Rn[x-7],Rn[x-16]);Rn[x]=p|0,Nn[x]=E|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:d,El:h,Fh:l,Fl:b,Gh:w,Gl:v,Hh:D,Hl:C}=this;for(let x=0;x<80;x++){const _=Sn(d,h,14)^Sn(d,h,18)^Ei(d,h,41),R=In(d,h,14)^In(d,h,18)^vi(d,h,41),$=d&l^~d&w,F=h&b^~h&v,U=e6(C,R,F,m6[x],Nn[x]),A=t6(U,D,_,$,w6[x],Rn[x]),q=U|0,k=Sn(r,i,28)^Ei(r,i,34)^Ei(r,i,39),E=In(r,i,28)^vi(r,i,34)^vi(r,i,39),p=r&s^r&a^s&a,m=i&o^i&c^o&c;D=w|0,C=v|0,w=l|0,v=b|0,l=d|0,b=h|0,{h:d,l:h}=Ot(f|0,u|0,A|0,q|0),f=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;const g=cc(q,E,m);r=fc(g,A,k,p),i=g|0}({h:r,l:i}=Ot(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Ot(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Ot(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=Ot(this.Dh|0,this.Dl|0,f|0,u|0),{h:d,l:h}=Ot(this.Eh|0,this.El|0,d|0,h|0),{h:l,l:b}=Ot(this.Fh|0,this.Fl|0,l|0,b|0),{h:w,l:v}=Ot(this.Gh|0,this.Gl|0,w|0,v|0),{h:D,l:C}=Ot(this.Hh|0,this.Hl|0,D|0,C|0),this.set(r,i,s,o,a,c,f,u,d,h,l,b,w,v,D,C)}roundClean(){wt(Rn,Nn)}destroy(){wt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class E6 extends dc{constructor(){super(48),this.Ah=Ce[0]|0,this.Al=Ce[1]|0,this.Bh=Ce[2]|0,this.Bl=Ce[3]|0,this.Ch=Ce[4]|0,this.Cl=Ce[5]|0,this.Dh=Ce[6]|0,this.Dl=Ce[7]|0,this.Eh=Ce[8]|0,this.El=Ce[9]|0,this.Fh=Ce[10]|0,this.Fl=Ce[11]|0,this.Gh=Ce[12]|0,this.Gl=Ce[13]|0,this.Hh=Ce[14]|0,this.Hl=Ce[15]|0}}const $e=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class v6 extends dc{constructor(){super(32),this.Ah=$e[0]|0,this.Al=$e[1]|0,this.Bh=$e[2]|0,this.Bl=$e[3]|0,this.Ch=$e[4]|0,this.Cl=$e[5]|0,this.Dh=$e[6]|0,this.Dl=$e[7]|0,this.Eh=$e[8]|0,this.El=$e[9]|0,this.Fh=$e[10]|0,this.Fl=$e[11]|0,this.Gh=$e[12]|0,this.Gl=$e[13]|0,this.Hh=$e[14]|0,this.Hl=$e[15]|0}}const p0=xi(()=>new y6),_6=xi(()=>new dc),x6=xi(()=>new E6);xi(()=>new v6);const S6=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Ee=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Z=new Uint32Array(32);function Cn(e,t,n,r,i,s){const o=i[s],a=i[s+1];let c=Z[2*e],f=Z[2*e+1],u=Z[2*t],d=Z[2*t+1],h=Z[2*n],l=Z[2*n+1],b=Z[2*r],w=Z[2*r+1],v=cc(c,u,o);f=fc(v,f,d,a),c=v|0,{Dh:w,Dl:b}={Dh:w^f,Dl:b^c},{Dh:w,Dl:b}={Dh:V8(w,b),Dl:G8(w)},{h:l,l:h}=Ot(l,h,w,b),{Bh:d,Bl:u}={Bh:d^l,Bl:u^h},{Bh:d,Bl:u}={Bh:Sn(d,u,24),Bl:In(d,u,24)},Z[2*e]=c,Z[2*e+1]=f,Z[2*t]=u,Z[2*t+1]=d,Z[2*n]=h,Z[2*n+1]=l,Z[2*r]=b,Z[2*r+1]=w}function Pn(e,t,n,r,i,s){const o=i[s],a=i[s+1];let c=Z[2*e],f=Z[2*e+1],u=Z[2*t],d=Z[2*t+1],h=Z[2*n],l=Z[2*n+1],b=Z[2*r],w=Z[2*r+1],v=cc(c,u,o);f=fc(v,f,d,a),c=v|0,{Dh:w,Dl:b}={Dh:w^f,Dl:b^c},{Dh:w,Dl:b}={Dh:Sn(w,b,16),Dl:In(w,b,16)},{h:l,l:h}=Ot(l,h,w,b),{Bh:d,Bl:u}={Bh:d^l,Bl:u^h},{Bh:d,Bl:u}={Bh:Ei(d,u,63),Bl:vi(d,u,63)},Z[2*e]=c,Z[2*e+1]=f,Z[2*t]=u,Z[2*t+1]=d,Z[2*n]=h,Z[2*n+1]=l,Z[2*r]=b,Z[2*r+1]=w}function I6(e,t={},n,r,i){if(tn(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=t;if(s!==void 0&&(s.length<1||s.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==i)throw new Error("personalization must be undefined or "+i)}class O6 extends Hs{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,tn(t),tn(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=_i(this.buffer)}update(t){On(this),t=Dt(t),Bt(t);const{blockLen:n,buffer:r,buffer32:i}=this,s=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<s;){this.pos===n&&(Bn(i),this.compress(i,0,!1),Bn(i),this.pos=0);const f=Math.min(n-this.pos,s-c),u=o+c;if(f===n&&!(u%4)&&c+f<s){const d=new Uint32Array(a,u,Math.floor((s-c)/4));Bn(d);for(let h=0;c+n<s;h+=i.length,c+=n)this.length+=n,this.compress(d,h,!1);Bn(d);continue}r.set(t.subarray(c,c+f),this.pos),this.pos+=f,this.length+=f,c+=f}return this}digestInto(t){On(this),uc(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,wt(this.buffer.subarray(n)),Bn(r),this.compress(r,0,!0),Bn(r);const i=_i(t);this.get().forEach((s,o)=>i[o]=nn(s))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.buffer.set(n),t.destroyed=s,t.finished=i,t.length=r,t.pos=a,t.outputLen=o,t}clone(){return this._cloneInto()}}class B6 extends O6{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=Ee[0]|0,this.v0h=Ee[1]|0,this.v1l=Ee[2]|0,this.v1h=Ee[3]|0,this.v2l=Ee[4]|0,this.v2h=Ee[5]|0,this.v3l=Ee[6]|0,this.v3h=Ee[7]|0,this.v4l=Ee[8]|0,this.v4h=Ee[9]|0,this.v5l=Ee[10]|0,this.v5h=Ee[11]|0,this.v6l=Ee[12]|0,this.v6h=Ee[13]|0,this.v7l=Ee[14]|0,this.v7h=Ee[15]|0,I6(n,t,64,16,16);let{key:r,personalization:i,salt:s}=t,o=0;if(r!==void 0&&(r=Dt(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=Dt(s);const a=_i(s);this.v4l^=nn(a[0]),this.v4h^=nn(a[1]),this.v5l^=nn(a[2]),this.v5h^=nn(a[3])}if(i!==void 0){i=Dt(i);const a=_i(i);this.v6l^=nn(a[0]),this.v6h^=nn(a[1]),this.v7l^=nn(a[2]),this.v7h^=nn(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:f,v4h:u,v5l:d,v5h:h,v6l:l,v6h:b,v7l:w,v7h:v}=this;return[t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v]}set(t,n,r,i,s,o,a,c,f,u,d,h,l,b,w,v){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=f|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=l|0,this.v6h=b|0,this.v7l=w|0,this.v7h=v|0}compress(t,n,r){this.get().forEach((c,f)=>Z[f]=c),Z.set(Ee,16);let{h:i,l:s}=Jd(BigInt(this.length));Z[24]=Ee[8]^s,Z[25]=Ee[9]^i,r&&(Z[28]=~Z[28],Z[29]=~Z[29]);let o=0;const a=S6;for(let c=0;c<12;c++)Cn(0,4,8,12,t,n+2*a[o++]),Pn(0,4,8,12,t,n+2*a[o++]),Cn(1,5,9,13,t,n+2*a[o++]),Pn(1,5,9,13,t,n+2*a[o++]),Cn(2,6,10,14,t,n+2*a[o++]),Pn(2,6,10,14,t,n+2*a[o++]),Cn(3,7,11,15,t,n+2*a[o++]),Pn(3,7,11,15,t,n+2*a[o++]),Cn(0,5,10,15,t,n+2*a[o++]),Pn(0,5,10,15,t,n+2*a[o++]),Cn(1,6,11,12,t,n+2*a[o++]),Pn(1,6,11,12,t,n+2*a[o++]),Cn(2,7,8,13,t,n+2*a[o++]),Pn(2,7,8,13,t,n+2*a[o++]),Cn(3,4,9,14,t,n+2*a[o++]),Pn(3,4,9,14,t,n+2*a[o++]);this.v0l^=Z[0]^Z[16],this.v0h^=Z[1]^Z[17],this.v1l^=Z[2]^Z[18],this.v1h^=Z[3]^Z[19],this.v2l^=Z[4]^Z[20],this.v2h^=Z[5]^Z[21],this.v3l^=Z[6]^Z[22],this.v3h^=Z[7]^Z[23],this.v4l^=Z[8]^Z[24],this.v4h^=Z[9]^Z[25],this.v5l^=Z[10]^Z[26],this.v5h^=Z[11]^Z[27],this.v6l^=Z[12]^Z[28],this.v6h^=Z[13]^Z[29],this.v7l^=Z[14]^Z[30],this.v7h^=Z[15]^Z[31],wt(Z)}destroy(){this.destroyed=!0,wt(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}i6(e=>new B6(e));/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function b0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function gc(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function pc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function et(e,...t){if(!b0(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function y0(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function D6(e,t){et(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function $n(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Pr(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function A6(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const T6=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function R6(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function bc(e){if(typeof e=="string")e=R6(e);else if(b0(e))e=yc(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function N6(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function C6(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const P6=(e,t)=>{function n(r,...i){if(et(r),!T6)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const f=i[0];if(!f)throw new Error("nonce / iv required");e.varSizeNonce?et(f):et(f,e.nonceLength)}const s=e.tagLength;s&&i[1]!==void 0&&et(i[1]);const o=t(r,...i),a=(f,u)=>{if(u!==void 0){if(f!==2)throw new Error("cipher output not supported");et(u)}};let c=!1;return{encrypt(f,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,et(f),a(o.encrypt.length,u),o.encrypt(f,u)},decrypt(f,u){if(et(f),s&&f.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(f,u)}}}return Object.assign(n,e),n};function w0(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!L6(t))throw new Error("invalid output, must be aligned");return t}function m0(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,f=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+f,a,r)}function $6(e,t,n){gc(n);const r=new Uint8Array(16),i=A6(r);return m0(i,0,BigInt(t),n),m0(i,8,BigInt(e),n),r}function L6(e){return e.byteOffset%4===0}function yc(e){return Uint8Array.from(e)}const E0=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),U6=E0("expand 16-byte k"),F6=E0("expand 32-byte k"),j6=$n(U6),M6=$n(F6);function ie(e,t){return e<<t|e>>>32-t}function wc(e){return e.byteOffset%4===0}const Ks=64,k6=16,v0=2**32-1,_0=new Uint32Array;function z6(e,t,n,r,i,s,o,a){const c=i.length,f=new Uint8Array(Ks),u=$n(f),d=wc(i)&&wc(s),h=d?$n(i):_0,l=d?$n(s):_0;for(let b=0;b<c;o++){if(e(t,n,r,u,o,a),o>=v0)throw new Error("arx: counter overflow");const w=Math.min(Ks,c-b);if(d&&w===Ks){const v=b/4;if(b%4!==0)throw new Error("arx: invalid block position");for(let D=0,C;D<k6;D++)C=v+D,l[C]=h[C]^u[D];b+=Ks;continue}for(let v=0,D;v<w;v++)D=b+v,s[D]=i[D]^f[v];b+=w}}function q6(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:s,rounds:o}=N6({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return pc(i),pc(o),gc(s),gc(n),(a,c,f,u,d=0)=>{et(a),et(c),et(f);const h=f.length;if(u===void 0&&(u=new Uint8Array(h)),et(u),pc(d),d<0||d>=v0)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const l=[];let b=a.length,w,v;if(b===32)l.push(w=yc(a)),v=M6;else if(b===16&&n)w=new Uint8Array(32),w.set(a),w.set(a,16),v=j6,l.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${b}`);wc(c)||l.push(c=yc(c));const D=$n(w);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(v,D,$n(c.subarray(0,16)),D),c=c.subarray(16)}const C=16-i;if(C!==c.length)throw new Error(`arx: nonce must be ${C} or 16 bytes`);if(C!==12){const _=new Uint8Array(12);_.set(c,s?0:12-c.length),c=_,l.push(c)}const x=$n(c);return z6(e,v,D,x,f,u,d,o),Pr(...l),u}}const De=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class H6{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=bc(t),et(t,32);const n=De(t,0),r=De(t,2),i=De(t,4),s=De(t,6),o=De(t,8),a=De(t,10),c=De(t,12),f=De(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let u=0;u<8;u++)this.pad[u]=De(t,16+2*u)}process(t,n,r=!1){const i=r?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],f=o[2],u=o[3],d=o[4],h=o[5],l=o[6],b=o[7],w=o[8],v=o[9],D=De(t,n+0),C=De(t,n+2),x=De(t,n+4),_=De(t,n+6),R=De(t,n+8),$=De(t,n+10),F=De(t,n+12),U=De(t,n+14);let A=s[0]+(D&8191),q=s[1]+((D>>>13|C<<3)&8191),k=s[2]+((C>>>10|x<<6)&8191),E=s[3]+((x>>>7|_<<9)&8191),p=s[4]+((_>>>4|R<<12)&8191),m=s[5]+(R>>>1&8191),g=s[6]+((R>>>14|$<<2)&8191),y=s[7]+(($>>>11|F<<5)&8191),S=s[8]+((F>>>8|U<<8)&8191),I=s[9]+(U>>>5|i),O=0,B=O+A*a+q*(5*v)+k*(5*w)+E*(5*b)+p*(5*l);O=B>>>13,B&=8191,B+=m*(5*h)+g*(5*d)+y*(5*u)+S*(5*f)+I*(5*c),O+=B>>>13,B&=8191;let T=O+A*c+q*a+k*(5*v)+E*(5*w)+p*(5*b);O=T>>>13,T&=8191,T+=m*(5*l)+g*(5*h)+y*(5*d)+S*(5*u)+I*(5*f),O+=T>>>13,T&=8191;let L=O+A*f+q*c+k*a+E*(5*v)+p*(5*w);O=L>>>13,L&=8191,L+=m*(5*b)+g*(5*l)+y*(5*h)+S*(5*d)+I*(5*u),O+=L>>>13,L&=8191;let P=O+A*u+q*f+k*c+E*a+p*(5*v);O=P>>>13,P&=8191,P+=m*(5*w)+g*(5*b)+y*(5*l)+S*(5*h)+I*(5*d),O+=P>>>13,P&=8191;let j=O+A*d+q*u+k*f+E*c+p*a;O=j>>>13,j&=8191,j+=m*(5*v)+g*(5*w)+y*(5*b)+S*(5*l)+I*(5*h),O+=j>>>13,j&=8191;let N=O+A*h+q*d+k*u+E*f+p*c;O=N>>>13,N&=8191,N+=m*a+g*(5*v)+y*(5*w)+S*(5*b)+I*(5*l),O+=N>>>13,N&=8191;let M=O+A*l+q*h+k*d+E*u+p*f;O=M>>>13,M&=8191,M+=m*c+g*a+y*(5*v)+S*(5*w)+I*(5*b),O+=M>>>13,M&=8191;let z=O+A*b+q*l+k*h+E*d+p*u;O=z>>>13,z&=8191,z+=m*f+g*c+y*a+S*(5*v)+I*(5*w),O+=z>>>13,z&=8191;let G=O+A*w+q*b+k*l+E*h+p*d;O=G>>>13,G&=8191,G+=m*u+g*f+y*c+S*a+I*(5*v),O+=G>>>13,G&=8191;let H=O+A*v+q*w+k*b+E*l+p*h;O=H>>>13,H&=8191,H+=m*d+g*u+y*f+S*c+I*a,O+=H>>>13,H&=8191,O=(O<<2)+O|0,O=O+B|0,B=O&8191,O=O>>>13,T+=O,s[0]=B,s[1]=T,s[2]=L,s[3]=P,s[4]=j,s[5]=N,s[6]=M,s[7]=z,s[8]=G,s[9]=H}finalize(){const{h:t,pad:n}=this,r=new Uint16Array(10);let i=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=i,i=t[a]>>>13,t[a]&=8191;t[0]+=i*5,i=t[0]>>>13,t[0]&=8191,t[1]+=i,i=t[1]>>>13,t[1]&=8191,t[2]+=i,r[0]=t[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=t[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)r[a]&=s;s=~s;for(let a=0;a<10;a++)t[a]=t[a]&s|r[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+n[0];t[0]=o&65535;for(let a=1;a<8;a++)o=(t[a]+n[a]|0)+(o>>>16)|0,t[a]=o&65535;Pr(r)}update(t){y0(this),t=bc(t),et(t);const{buffer:n,blockLen:r}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o===r){for(;r<=i-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){Pr(this.h,this.r,this.buffer,this.pad)}digestInto(t){y0(this),D6(t,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:i}=this;if(i){for(n[i++]=1;i<16;i++)n[i]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)t[s++]=r[o]>>>0,t[s++]=r[o]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}}function K6(e){const t=(r,i)=>e(i).update(bc(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const V6=K6(e=>new H6(e));function G6(e,t,n,r,i,s=20){let o=e[0],a=e[1],c=e[2],f=e[3],u=t[0],d=t[1],h=t[2],l=t[3],b=t[4],w=t[5],v=t[6],D=t[7],C=i,x=n[0],_=n[1],R=n[2],$=o,F=a,U=c,A=f,q=u,k=d,E=h,p=l,m=b,g=w,y=v,S=D,I=C,O=x,B=_,T=R;for(let P=0;P<s;P+=2)$=$+q|0,I=ie(I^$,16),m=m+I|0,q=ie(q^m,12),$=$+q|0,I=ie(I^$,8),m=m+I|0,q=ie(q^m,7),F=F+k|0,O=ie(O^F,16),g=g+O|0,k=ie(k^g,12),F=F+k|0,O=ie(O^F,8),g=g+O|0,k=ie(k^g,7),U=U+E|0,B=ie(B^U,16),y=y+B|0,E=ie(E^y,12),U=U+E|0,B=ie(B^U,8),y=y+B|0,E=ie(E^y,7),A=A+p|0,T=ie(T^A,16),S=S+T|0,p=ie(p^S,12),A=A+p|0,T=ie(T^A,8),S=S+T|0,p=ie(p^S,7),$=$+k|0,T=ie(T^$,16),y=y+T|0,k=ie(k^y,12),$=$+k|0,T=ie(T^$,8),y=y+T|0,k=ie(k^y,7),F=F+E|0,I=ie(I^F,16),S=S+I|0,E=ie(E^S,12),F=F+E|0,I=ie(I^F,8),S=S+I|0,E=ie(E^S,7),U=U+p|0,O=ie(O^U,16),m=m+O|0,p=ie(p^m,12),U=U+p|0,O=ie(O^U,8),m=m+O|0,p=ie(p^m,7),A=A+q|0,B=ie(B^A,16),g=g+B|0,q=ie(q^g,12),A=A+q|0,B=ie(B^A,8),g=g+B|0,q=ie(q^g,7);let L=0;r[L++]=o+$|0,r[L++]=a+F|0,r[L++]=c+U|0,r[L++]=f+A|0,r[L++]=u+q|0,r[L++]=d+k|0,r[L++]=h+E|0,r[L++]=l+p|0,r[L++]=b+m|0,r[L++]=w+g|0,r[L++]=v+y|0,r[L++]=D+S|0,r[L++]=C+I|0,r[L++]=x+O|0,r[L++]=_+B|0,r[L++]=R+T|0}const Z6=q6(G6,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Y6=new Uint8Array(16),x0=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(Y6.subarray(n))},W6=new Uint8Array(32);function S0(e,t,n,r,i){const s=e(t,n,W6),o=V6.create(s);i&&x0(o,i),x0(o,r);const a=$6(r.length,i?i.length:0,!0);o.update(a);const c=o.digest();return Pr(s,a),c}const X6=e=>(t,n,r)=>({encrypt(i,s){const o=i.length;s=w0(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);e(t,n,a,a,1);const c=S0(e,t,n,a,r);return s.set(c,o),Pr(c),s},decrypt(i,s){s=w0(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=S0(e,t,n,o,r);if(!C6(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),e(t,n,s,s,1),Pr(c),s}}),I0=P6({blockSize:64,nonceLength:12,tagLength:16},X6(Z6));class O0 extends Hs{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,zs(t);const r=Dt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?t.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),wt(s)}update(t){return On(this),this.iHash.update(t),this}digestInto(t){On(this),Bt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Vs=(e,t,n)=>new O0(e,t).update(n).digest();Vs.create=(e,t)=>new O0(e,t);function J6(e,t,n){return zs(e),n===void 0&&(n=new Uint8Array(e.outputLen)),Vs(e,Dt(n),Dt(t))}const mc=Uint8Array.from([0]),B0=Uint8Array.of();function Q6(e,t,n,r=32){zs(e),tn(r);const i=e.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(r/i);n===void 0&&(n=B0);const o=new Uint8Array(s*i),a=Vs.create(e,t),c=a._cloneInto(),f=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)mc[0]=u+1,c.update(u===0?B0:f).update(n).update(mc).digestInto(f),o.set(f,i*u),a._cloneInto(c);return a.destroy(),c.destroy(),wt(f,mc),o.slice(0,r)}const e_=(e,t,n,r,i)=>Q6(e,J6(e,t,n),r,i),Gs=p0,Ec=BigInt(0),vc=BigInt(1);function Zs(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function tr(e,t,n=""){const r=ks(e),i=e?.length,s=t!==void 0;if(!r||s&&i!==t){const o=n&&`"${n}" `,a=s?` of length ${t}`:"",c=r?`length=${i}`:`type=${typeof e}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return e}function Ys(e){const t=e.toString(16);return t.length&1?"0"+t:t}function D0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ec:BigInt("0x"+e)}function Ws(e){return D0(Cr(e))}function Xs(e){return Bt(e),D0(Cr(Uint8Array.from(e).reverse()))}function _c(e,t){return qs(e.toString(16).padStart(t*2,"0"))}function xc(e,t){return _c(e,t).reverse()}function Le(e,t,n){let r;if(typeof t=="string")try{r=qs(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(ks(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}const Sc=e=>typeof e=="bigint"&&Ec<=e;function t_(e,t,n){return Sc(e)&&Sc(t)&&Sc(n)&&t<=e&&e<n}function Ic(e,t,n,r){if(!t_(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function A0(e){let t;for(t=0;e>Ec;e>>=vc,t+=1);return t}const Ii=e=>(vc<<BigInt(e))-vc;function n_(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),i=h=>Uint8Array.of(h);let s=r(e),o=r(e),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},f=(...h)=>n(o,s,...h),u=(h=r(0))=>{o=f(i(0),h),s=f(),h.length!==0&&(o=f(i(1),h),s=f())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const l=[];for(;h<t;){s=f();const b=s.slice();l.push(b),h+=s.length}return Dn(...l)};return(h,l)=>{c(),u(h);let b;for(;!(b=l(d()));)u();return c(),b}}function Js(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(i,s,o){const a=e[i];if(o&&a===void 0)return;const c=typeof a;if(c!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(t).forEach(([i,s])=>r(i,s,!1)),Object.entries(n).forEach(([i,s])=>r(i,s,!0))}function T0(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}const tt=BigInt(0),He=BigInt(1),nr=BigInt(2),R0=BigInt(3),N0=BigInt(4),C0=BigInt(5),r_=BigInt(7),P0=BigInt(8),i_=BigInt(9),$0=BigInt(16);function ft(e,t){const n=e%t;return n>=tt?n:t+n}function At(e,t,n){let r=e;for(;t-- >tt;)r*=r,r%=n;return r}function L0(e,t){if(e===tt)throw new Error("invert: expected non-zero number");if(t<=tt)throw new Error("invert: expected positive modulus, got "+t);let n=ft(e,t),r=t,i=tt,s=He;for(;n!==tt;){const o=r/n,a=r%n,c=i-s*o;r=n,n=a,i=s,s=c}if(r!==He)throw new Error("invert: does not exist");return ft(i,t)}function Oc(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function U0(e,t){const n=(e.ORDER+He)/N0,r=e.pow(t,n);return Oc(e,r,t),r}function s_(e,t){const n=(e.ORDER-C0)/P0,r=e.mul(t,nr),i=e.pow(r,n),s=e.mul(t,i),o=e.mul(e.mul(s,nr),i),a=e.mul(s,e.sub(o,e.ONE));return Oc(e,a,t),a}function o_(e){const t=Ln(e),n=F0(e),r=n(t,t.neg(t.ONE)),i=n(t,r),s=n(t,t.neg(r)),o=(e+r_)/$0;return(a,c)=>{let f=a.pow(c,o),u=a.mul(f,r);const d=a.mul(f,i),h=a.mul(f,s),l=a.eql(a.sqr(u),c),b=a.eql(a.sqr(d),c);f=a.cmov(f,u,l),u=a.cmov(h,d,b);const w=a.eql(a.sqr(u),c),v=a.cmov(f,u,w);return Oc(a,v,c),v}}function F0(e){if(e<R0)throw new Error("sqrt is not defined for small field");let t=e-He,n=0;for(;t%nr===tt;)t/=nr,n++;let r=nr;const i=Ln(e);for(;M0(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return U0;let s=i.pow(r,t);const o=(t+He)/nr;return function(a,c){if(a.is0(c))return c;if(M0(a,c)!==1)throw new Error("Cannot find square root");let f=n,u=a.mul(a.ONE,s),d=a.pow(c,t),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let l=1,b=a.sqr(d);for(;!a.eql(b,a.ONE);)if(l++,b=a.sqr(b),l===f)throw new Error("Cannot find square root");const w=He<<BigInt(f-l-1),v=a.pow(u,w);f=l,u=a.sqr(v),d=a.mul(d,u),h=a.mul(h,v)}return h}}function a_(e){return e%N0===R0?U0:e%P0===C0?s_:e%$0===i_?o_(e):F0(e)}const c_=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function f_(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=c_.reduce((r,i)=>(r[i]="function",r),t);return Js(e,n),e}function u_(e,t,n){if(n<tt)throw new Error("invalid exponent, negatives unsupported");if(n===tt)return e.ONE;if(n===He)return t;let r=e.ONE,i=t;for(;n>tt;)n&He&&(r=e.mul(r,i)),i=e.sqr(i),n>>=He;return r}function j0(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((o,a,c)=>e.is0(a)?o:(r[c]=o,e.mul(o,a)),e.ONE),s=e.inv(i);return t.reduceRight((o,a,c)=>e.is0(a)?o:(r[c]=e.mul(o,r[c]),e.mul(o,a)),s),r}function M0(e,t){const n=(e.ORDER-He)/nr,r=e.pow(t,n),i=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function k0(e,t){t!==void 0&&tn(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Ln(e,t,n=!1,r={}){if(e<=tt)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,s,o=!1,a;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const h=t;h.BITS&&(i=h.BITS),h.sqrt&&(s=h.sqrt),typeof h.isLE=="boolean"&&(n=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof t=="number"&&(i=t),r.sqrt&&(s=r.sqrt);const{nBitLength:c,nByteLength:f}=k0(e,i);if(f>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:e,isLE:n,BITS:c,BYTES:f,MASK:Ii(c),ZERO:tt,ONE:He,allowedLengths:a,create:h=>ft(h,e),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return tt<=h&&h<e},is0:h=>h===tt,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&He)===He,neg:h=>ft(-h,e),eql:(h,l)=>h===l,sqr:h=>ft(h*h,e),add:(h,l)=>ft(h+l,e),sub:(h,l)=>ft(h-l,e),mul:(h,l)=>ft(h*l,e),pow:(h,l)=>u_(d,h,l),div:(h,l)=>ft(h*L0(l,e),e),sqrN:h=>h*h,addN:(h,l)=>h+l,subN:(h,l)=>h-l,mulN:(h,l)=>h*l,inv:h=>L0(h,e),sqrt:s||(h=>(u||(u=a_(e)),u(d,h))),toBytes:h=>n?xc(h,f):_c(h,f),fromBytes:(h,l=!0)=>{if(a){if(!a.includes(h.length)||h.length>f)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const w=new Uint8Array(f);w.set(h,n?0:w.length-h.length),h=w}if(h.length!==f)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+h.length);let b=n?Xs(h):Ws(h);if(o&&(b=ft(b,e)),!l&&!d.isValid(b))throw new Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:h=>j0(d,h),cmov:(h,l,b)=>b?l:h});return Object.freeze(d)}function z0(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function q0(e){const t=z0(e);return t+Math.ceil(t/2)}function l_(e,t,n=!1){const r=e.length,i=z0(t),s=q0(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=n?Xs(e):Ws(e),a=ft(o,t-He)+He;return n?xc(a,i):_c(a,i)}const $r=BigInt(0),rr=BigInt(1);function Qs(e,t){const n=t.negate();return e?n:t}function Bc(e,t){const n=j0(e.Fp,t.map(r=>r.Z));return t.map((r,i)=>e.fromAffine(r.toAffine(n[i])))}function H0(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Dc(e,t){H0(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,s=Ii(e),o=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function K0(e,t,n){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=n;let a=Number(e&i),c=e>>o;a>r&&(a-=s,c+=rr);const f=t*r,u=f+Math.abs(a)-1,d=a===0,h=a<0,l=t%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:f}}function h_(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function d_(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Ac=new WeakMap,V0=new WeakMap;function Tc(e){return V0.get(e)||1}function G0(e){if(e!==$r)throw new Error("invalid wNAF")}class g_{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let i=t;for(;n>$r;)n&rr&&(r=r.add(i)),i=i.double(),n>>=rr;return r}precomputeWindow(t,n){const{windows:r,windowSize:i}=Dc(n,this.bits),s=[];let o=t,a=o;for(let c=0;c<r;c++){a=o,s.push(a);for(let f=1;f<i;f++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE;const o=Dc(t,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:f,isZero:u,isNeg:d,isNegF:h,offsetF:l}=K0(r,a,o);r=c,u?s=s.add(Qs(h,n[l])):i=i.add(Qs(d,n[f]))}return G0(r),{p:i,f:s}}wNAFUnsafe(t,n,r,i=this.ZERO){const s=Dc(t,this.bits);for(let o=0;o<s.windows&&r!==$r;o++){const{nextN:a,offset:c,isZero:f,isNeg:u}=K0(r,o,s);if(r=a,!f){const d=n[c];i=i.add(u?d.negate():d)}}return G0(r),i}getPrecomputes(t,n,r){let i=Ac.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(i=r(i)),Ac.set(n,i))),i}cached(t,n,r){const i=Tc(t);return this.wNAF(i,this.getPrecomputes(i,t,r),n)}unsafe(t,n,r,i){const s=Tc(t);return s===1?this._unsafeLadder(t,n,i):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,i)}createCache(t,n){H0(n,this.bits),V0.set(t,n),Ac.delete(t)}hasCache(t){return Tc(t)!==1}}function p_(e,t,n,r){let i=t,s=e.ZERO,o=e.ZERO;for(;n>$r||r>$r;)n&rr&&(s=s.add(i)),r&rr&&(o=o.add(i)),i=i.double(),n>>=rr,r>>=rr;return{p1:s,p2:o}}function b_(e,t,n,r){h_(n,e),d_(r,t);const i=n.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=A0(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const f=Ii(c),u=new Array(Number(f)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let h=o;for(let l=d;l>=0;l-=c){u.fill(o);for(let w=0;w<s;w++){const v=r[w],D=Number(v>>BigInt(l)&f);u[D]=u[D].add(n[w])}let b=o;for(let w=u.length-1,v=o;w>0;w--)v=v.add(u[w]),b=b.add(v);if(h=h.add(b),l!==0)for(let w=0;w<c;w++)h=h.double()}return h}function Z0(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return f_(t),t}else return Ln(e,{isLE:n})}function y_(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const a of["p","n","h"]){const c=t[a];if(!(typeof c=="bigint"&&c>$r))throw new Error(`CURVE.${a} must be positive bigint`)}const i=Z0(t.p,n.Fp,r),s=Z0(t.n,n.Fn,r),o=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(const a of o)if(!i.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:i,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),o0("HashToScalar-");const Oi=BigInt(0),Lr=BigInt(1),eo=BigInt(2);function w_(e){return Js(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(Rr({},e))}function m_(e){const t=w_(e),{P:n,type:r,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=t,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||er,f=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),l=a?eo**BigInt(254):eo**BigInt(447),b=a?BigInt(8)*eo**BigInt(251)-Lr:BigInt(4)*eo**BigInt(445)-Lr,w=l+b+Lr,v=E=>ft(E,n),D=C(d);function C(E){return xc(v(E),u)}function x(E){const p=Le("u coordinate",E,u);return a&&(p[31]&=127),v(Xs(p))}function _(E){return Xs(i(Le("scalar",E,u)))}function R(E,p){const m=U(x(p),_(E));if(m===Oi)throw new Error("invalid private or public key received");return C(m)}function $(E){return R(E,D)}function F(E,p,m){const g=v(E*(p-m));return p=v(p-g),m=v(m+g),{x_2:p,x_3:m}}function U(E,p){Ic("u",E,Oi,n),Ic("scalar",p,l,w);const m=p,g=E;let y=Lr,S=Oi,I=E,O=Lr,B=Oi;for(let L=BigInt(f-1);L>=Oi;L--){const P=m>>L&Lr;B^=P,{x_2:y,x_3:I}=F(B,y,I),{x_2:S,x_3:O}=F(B,S,O),B=P;const j=y+S,N=v(j*j),M=y-S,z=v(M*M),G=N-z,H=I+O,V=I-O,J=v(V*j),ee=v(H*M),re=J+ee,he=J-ee;I=v(re*re),O=v(g*v(he*he)),y=v(N*z),S=v(G*(N+v(h*G)))}({x_2:y,x_3:I}=F(B,y,I)),{x_2:S,x_3:O}=F(B,S,O);const T=s(S);return v(y*T)}const A={secretKey:u,publicKey:u,seed:u},q=(E=c(u))=>(Bt(E,A.seed),E);function k(E){const p=q(E);return{secretKey:p,publicKey:$(p)}}return{keygen:k,getSharedSecret:(E,p)=>R(E,p),getPublicKey:E=>$(E),scalarMult:R,scalarMultBase:$,utils:{randomSecretKey:q,randomPrivateKey:q},GuBytes:D.slice(),lengths:A}}const E_=BigInt(1),Y0=BigInt(2),v_=BigInt(3),__=BigInt(5),x_=BigInt(8),W0=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),S_={p:W0,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:x_,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function I_(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),s=W0,o=e*e%s*e%s,a=At(o,Y0,s)*o%s,c=At(a,E_,s)*e%s,f=At(c,__,s)*c%s,u=At(f,t,s)*f%s,d=At(u,n,s)*u%s,h=At(d,r,s)*d%s,l=At(h,i,s)*h%s,b=At(l,i,s)*h%s,w=At(b,t,s)*f%s;return{pow_p_5_8:At(w,Y0,s)*e%s,b2:o}}function O_(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const B_=Ln(S_.p,{isLE:!0}),Rc=(()=>{const e=B_.ORDER;return m_({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:n,b2:r}=I_(t);return ft(At(n,v_,e)*r,e)},adjustScalarBytes:O_})})(),X0=(e,t)=>(e+(e>=0?t:-t)/J0)/t;function D_(e,t,n){const[[r,i],[s,o]]=t,a=X0(o*e,n),c=X0(-i*e,n);let f=e-a*r-c*s,u=-a*i-c*o;const d=f<on,h=u<on;d&&(f=-f),h&&(u=-u);const l=Ii(Math.ceil(A0(n)/2))+Ur;if(f<on||f>=l||u<on||u>=l)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:d,k1:f,k2neg:h,k2:u}}function Nc(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Cc(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return Zs(n.lowS,"lowS"),Zs(n.prehash,"prehash"),n.format!==void 0&&Nc(n.format),n}class A_ extends Error{constructor(t=""){super(t)}}const sn={Err:A_,_tlv:{encode:(e,t)=>{const{Err:n}=sn;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=Ys(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?Ys(i.length/2|128):"";return Ys(e)+s+i+t},decode(e,t){const{Err:n}=sn;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const f=t.subarray(r,r+c);if(f.length!==c)throw new n("tlv.decode: length bytes not complete");if(f[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of f)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=sn;if(e<on)throw new t("integer: negative integers are not allowed");let n=Ys(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=sn;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ws(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=sn,i=Le("signature",e),{v:s,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,s),{v:f,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(f)}},hexFromSig(e){const{_tlv:t,_int:n}=sn,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),s=r+i;return t.encode(48,s)}},on=BigInt(0),Ur=BigInt(1),J0=BigInt(2),to=BigInt(3),T_=BigInt(4);function Fr(e,t){const{BYTES:n}=e;let r;if(typeof t=="bigint")r=t;else{let i=Le("private key",t);try{r=e.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function R_(e,t={}){const n=y_("weierstrass",e,t),{Fp:r,Fn:i}=n;let s=n.CURVE;const{h:o,n:a}=s;Js(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=t;if(c&&(!r.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const f=eg(r,i);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(E,p,m){const{x:g,y}=p.toAffine(),S=r.toBytes(g);if(Zs(m,"isCompressed"),m){u();const I=!r.isOdd(y);return Dn(Q0(I),S)}else return Dn(Uint8Array.of(4),S,r.toBytes(y))}function h(E){tr(E,void 0,"Point");const{publicKey:p,publicKeyUncompressed:m}=f,g=E.length,y=E[0],S=E.subarray(1);if(g===p&&(y===2||y===3)){const I=r.fromBytes(S);if(!r.isValid(I))throw new Error("bad point: is not on curve, wrong x");const O=w(I);let B;try{B=r.sqrt(O)}catch(L){const P=L instanceof Error?": "+L.message:"";throw new Error("bad point: is not on curve, sqrt error"+P)}u();const T=r.isOdd(B);return(y&1)===1!==T&&(B=r.neg(B)),{x:I,y:B}}else if(g===m&&y===4){const I=r.BYTES,O=r.fromBytes(S.subarray(0,I)),B=r.fromBytes(S.subarray(I,I*2));if(!v(O,B))throw new Error("bad point: is not on curve");return{x:O,y:B}}else throw new Error(`bad point: got length ${g}, expected compressed=${p} or uncompressed=${m}`)}const l=t.toBytes||d,b=t.fromBytes||h;function w(E){const p=r.sqr(E),m=r.mul(p,E);return r.add(r.add(m,r.mul(E,s.a)),s.b)}function v(E,p){const m=r.sqr(p),g=w(E);return r.eql(m,g)}if(!v(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const D=r.mul(r.pow(s.a,to),T_),C=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(D,C)))throw new Error("bad curve params: a or b");function x(E,p,m=!1){if(!r.isValid(p)||m&&r.is0(p))throw new Error(`bad point coordinate ${E}`);return p}function _(E){if(!(E instanceof A))throw new Error("ProjectivePoint expected")}function R(E){if(!c||!c.basises)throw new Error("no endo");return D_(E,c.basises,i.ORDER)}const $=T0((E,p)=>{const{X:m,Y:g,Z:y}=E;if(r.eql(y,r.ONE))return{x:m,y:g};const S=E.is0();p==null&&(p=S?r.ONE:r.inv(y));const I=r.mul(m,p),O=r.mul(g,p),B=r.mul(y,p);if(S)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:I,y:O}}),F=T0(E=>{if(E.is0()){if(t.allowInfinityPoint&&!r.is0(E.Y))return;throw new Error("bad point: ZERO")}const{x:p,y:m}=E.toAffine();if(!r.isValid(p)||!r.isValid(m))throw new Error("bad point: x or y not field elements");if(!v(p,m))throw new Error("bad point: equation left != right");if(!E.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(E,p,m,g,y){return m=new A(r.mul(m.X,E),m.Y,m.Z),p=Qs(g,p),m=Qs(y,m),p.add(m)}class A{constructor(p,m,g){this.X=x("x",p),this.Y=x("y",m,!0),this.Z=x("z",g),Object.freeze(this)}static CURVE(){return s}static fromAffine(p){const{x:m,y:g}=p||{};if(!p||!r.isValid(m)||!r.isValid(g))throw new Error("invalid affine point");if(p instanceof A)throw new Error("projective point not allowed");return r.is0(m)&&r.is0(g)?A.ZERO:new A(m,g,r.ONE)}static fromBytes(p){const m=A.fromAffine(b(tr(p,void 0,"point")));return m.assertValidity(),m}static fromHex(p){return A.fromBytes(Le("pointHex",p))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,m=!0){return k.createCache(this,p),m||this.multiply(to),this}assertValidity(){F(this)}hasEvenY(){const{y:p}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(p)}equals(p){_(p);const{X:m,Y:g,Z:y}=this,{X:S,Y:I,Z:O}=p,B=r.eql(r.mul(m,O),r.mul(S,y)),T=r.eql(r.mul(g,O),r.mul(I,y));return B&&T}negate(){return new A(this.X,r.neg(this.Y),this.Z)}double(){const{a:p,b:m}=s,g=r.mul(m,to),{X:y,Y:S,Z:I}=this;let O=r.ZERO,B=r.ZERO,T=r.ZERO,L=r.mul(y,y),P=r.mul(S,S),j=r.mul(I,I),N=r.mul(y,S);return N=r.add(N,N),T=r.mul(y,I),T=r.add(T,T),O=r.mul(p,T),B=r.mul(g,j),B=r.add(O,B),O=r.sub(P,B),B=r.add(P,B),B=r.mul(O,B),O=r.mul(N,O),T=r.mul(g,T),j=r.mul(p,j),N=r.sub(L,j),N=r.mul(p,N),N=r.add(N,T),T=r.add(L,L),L=r.add(T,L),L=r.add(L,j),L=r.mul(L,N),B=r.add(B,L),j=r.mul(S,I),j=r.add(j,j),L=r.mul(j,N),O=r.sub(O,L),T=r.mul(j,P),T=r.add(T,T),T=r.add(T,T),new A(O,B,T)}add(p){_(p);const{X:m,Y:g,Z:y}=this,{X:S,Y:I,Z:O}=p;let B=r.ZERO,T=r.ZERO,L=r.ZERO;const P=s.a,j=r.mul(s.b,to);let N=r.mul(m,S),M=r.mul(g,I),z=r.mul(y,O),G=r.add(m,g),H=r.add(S,I);G=r.mul(G,H),H=r.add(N,M),G=r.sub(G,H),H=r.add(m,y);let V=r.add(S,O);return H=r.mul(H,V),V=r.add(N,z),H=r.sub(H,V),V=r.add(g,y),B=r.add(I,O),V=r.mul(V,B),B=r.add(M,z),V=r.sub(V,B),L=r.mul(P,H),B=r.mul(j,z),L=r.add(B,L),B=r.sub(M,L),L=r.add(M,L),T=r.mul(B,L),M=r.add(N,N),M=r.add(M,N),z=r.mul(P,z),H=r.mul(j,H),M=r.add(M,z),z=r.sub(N,z),z=r.mul(P,z),H=r.add(H,z),N=r.mul(M,H),T=r.add(T,N),N=r.mul(V,H),B=r.mul(G,B),B=r.sub(B,N),N=r.mul(G,M),L=r.mul(V,L),L=r.add(L,N),new A(B,T,L)}subtract(p){return this.add(p.negate())}is0(){return this.equals(A.ZERO)}multiply(p){const{endo:m}=t;if(!i.isValidNot0(p))throw new Error("invalid scalar: out of range");let g,y;const S=I=>k.cached(this,I,O=>Bc(A,O));if(m){const{k1neg:I,k1:O,k2neg:B,k2:T}=R(p),{p:L,f:P}=S(O),{p:j,f:N}=S(T);y=P.add(N),g=U(m.beta,L,j,I,B)}else{const{p:I,f:O}=S(p);g=I,y=O}return Bc(A,[g,y])[0]}multiplyUnsafe(p){const{endo:m}=t,g=this;if(!i.isValid(p))throw new Error("invalid scalar: out of range");if(p===on||g.is0())return A.ZERO;if(p===Ur)return g;if(k.hasCache(this))return this.multiply(p);if(m){const{k1neg:y,k1:S,k2neg:I,k2:O}=R(p),{p1:B,p2:T}=p_(A,g,S,O);return U(m.beta,B,T,y,I)}else return k.unsafe(g,p)}multiplyAndAddUnsafe(p,m,g){const y=this.multiplyUnsafe(m).add(p.multiplyUnsafe(g));return y.is0()?void 0:y}toAffine(p){return $(this,p)}isTorsionFree(){const{isTorsionFree:p}=t;return o===Ur?!0:p?p(A,this):k.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:p}=t;return o===Ur?this:p?p(A,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(p=!0){return Zs(p,"isCompressed"),this.assertValidity(),l(A,this,p)}toHex(p=!0){return Cr(this.toBytes(p))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(p=!0){return this.toBytes(p)}_setWindowSize(p){this.precompute(p)}static normalizeZ(p){return Bc(A,p)}static msm(p,m){return b_(A,i,p,m)}static fromPrivateKey(p){return A.BASE.multiply(Fr(i,p))}}A.BASE=new A(s.Gx,s.Gy,r.ONE),A.ZERO=new A(r.ZERO,r.ONE,r.ZERO),A.Fp=r,A.Fn=i;const q=i.BITS,k=new g_(A,t.endo?Math.ceil(q/2):q);return A.BASE.precompute(8),A}function Q0(e){return Uint8Array.of(e?2:3)}function eg(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function N_(e,t={}){const{Fn:n}=e,r=t.randomBytes||er,i=Object.assign(eg(e.Fp,n),{seed:q0(n.ORDER)});function s(h){try{return!!Fr(n,h)}catch{return!1}}function o(h,l){const{publicKey:b,publicKeyUncompressed:w}=i;try{const v=h.length;return l===!0&&v!==b||l===!1&&v!==w?!1:!!e.fromBytes(h)}catch{return!1}}function a(h=r(i.seed)){return l_(tr(h,i.seed,"seed"),n.ORDER)}function c(h,l=!0){return e.BASE.multiply(Fr(n,h)).toBytes(l)}function f(h){const l=a(h);return{secretKey:l,publicKey:c(l)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof e)return!0;const{secretKey:l,publicKey:b,publicKeyUncompressed:w}=i;if(n.allowedLengths||l===b)return;const v=Le("key",h).length;return v===b||v===w}function d(h,l,b=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(l)===!1)throw new Error("second arg must be public key");const w=Fr(n,h);return e.fromHex(l).multiply(w).toBytes(b)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:f,Point:e,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:h=>Fr(n,h),precompute(h=8,l=e.BASE){return l.precompute(h,!1)}},lengths:i})}function C_(e,t,n={}){zs(t),Js(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||er,i=n.hmac||((m,...g)=>Vs(t,m,Dn(...g))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:c}=o,{keygen:f,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l}=N_(e,n),b={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},w="compact";function v(m){const g=a>>Ur;return m>g}function D(m,g){if(!o.isValidNot0(g))throw new Error(`invalid signature ${m}: out of range 1..Point.Fn.ORDER`);return g}function C(m,g){Nc(g);const y=l.signature,S=g==="compact"?y:g==="recovered"?y+1:void 0;return tr(m,S,`${g} signature`)}class x{constructor(g,y,S){this.r=D("r",g),this.s=D("s",y),S!=null&&(this.recovery=S),Object.freeze(this)}static fromBytes(g,y=w){C(g,y);let S;if(y==="der"){const{r:T,s:L}=sn.toSig(tr(g));return new x(T,L)}y==="recovered"&&(S=g[0],y="compact",g=g.subarray(1));const I=o.BYTES,O=g.subarray(0,I),B=g.subarray(I,I*2);return new x(o.fromBytes(O),o.fromBytes(B),S)}static fromHex(g,y){return this.fromBytes(qs(g),y)}addRecoveryBit(g){return new x(this.r,this.s,g)}recoverPublicKey(g){const y=s.ORDER,{r:S,s:I,recovery:O}=this;if(O==null||![0,1,2,3].includes(O))throw new Error("recovery id invalid");if(a*J0<y&&O>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=O===2||O===3?S+a:S;if(!s.isValid(B))throw new Error("recovery id 2 or 3 invalid");const T=s.toBytes(B),L=e.fromBytes(Dn(Q0((O&1)===0),T)),P=o.inv(B),j=R(Le("msgHash",g)),N=o.create(-j*P),M=o.create(I*P),z=e.BASE.multiplyUnsafe(N).add(L.multiplyUnsafe(M));if(z.is0())throw new Error("point at infinify");return z.assertValidity(),z}hasHighS(){return v(this.s)}toBytes(g=w){if(Nc(g),g==="der")return qs(sn.hexFromSig(this));const y=o.toBytes(this.r),S=o.toBytes(this.s);if(g==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Dn(Uint8Array.of(this.recovery),y,S)}return Dn(y,S)}toHex(g){return Cr(this.toBytes(g))}assertValidity(){}static fromCompact(g){return x.fromBytes(Le("sig",g),"compact")}static fromDER(g){return x.fromBytes(Le("sig",g),"der")}normalizeS(){return this.hasHighS()?new x(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Cr(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Cr(this.toBytes("compact"))}}const _=n.bits2int||function(m){if(m.length>8192)throw new Error("input is too large");const g=Ws(m),y=m.length*8-c;return y>0?g>>BigInt(y):g},R=n.bits2int_modN||function(m){return o.create(_(m))},$=Ii(c);function F(m){return Ic("num < 2^"+c,m,on,$),o.toBytes(m)}function U(m,g){return tr(m,void 0,"message"),g?tr(t(m),void 0,"prehashed message"):m}function A(m,g,y){if(["recovered","canonical"].some(M=>M in y))throw new Error("sign() legacy options not supported");const{lowS:S,prehash:I,extraEntropy:O}=Cc(y,b);m=U(m,I);const B=R(m),T=Fr(o,g),L=[F(T),F(B)];if(O!=null&&O!==!1){const M=O===!0?r(l.secretKey):O;L.push(Le("extraEntropy",M))}const P=Dn(...L),j=B;function N(M){const z=_(M);if(!o.isValidNot0(z))return;const G=o.inv(z),H=e.BASE.multiply(z).toAffine(),V=o.create(H.x);if(V===on)return;const J=o.create(G*o.create(j+V*T));if(J===on)return;let ee=(H.x===V?0:2)|Number(H.y&Ur),re=J;return S&&v(J)&&(re=o.neg(J),ee^=1),new x(V,re,ee)}return{seed:P,k2sig:N}}function q(m,g,y={}){m=Le("message",m);const{seed:S,k2sig:I}=A(m,g,y);return n_(t.outputLen,o.BYTES,i)(S,I)}function k(m){let g;const y=typeof m=="string"||ks(m),S=!y&&m!==null&&typeof m=="object"&&typeof m.r=="bigint"&&typeof m.s=="bigint";if(!y&&!S)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(S)g=new x(m.r,m.s);else if(y){try{g=x.fromBytes(Le("sig",m),"der")}catch(I){if(!(I instanceof sn.Err))throw I}if(!g)try{g=x.fromBytes(Le("sig",m),"compact")}catch{return!1}}return g||!1}function E(m,g,y,S={}){const{lowS:I,prehash:O,format:B}=Cc(S,b);if(y=Le("publicKey",y),g=U(Le("message",g),O),"strict"in S)throw new Error("options.strict was renamed to lowS");const T=B===void 0?k(m):x.fromBytes(Le("sig",m),B);if(T===!1)return!1;try{const L=e.fromBytes(y);if(I&&T.hasHighS())return!1;const{r:P,s:j}=T,N=R(g),M=o.inv(j),z=o.create(N*M),G=o.create(P*M),H=e.BASE.multiplyUnsafe(z).add(L.multiplyUnsafe(G));return H.is0()?!1:o.create(H.x)===P}catch{return!1}}function p(m,g,y={}){const{prehash:S}=Cc(y,b);return g=U(g,S),x.fromBytes(m,"recovered").recoverPublicKey(g).toBytes()}return Object.freeze({keygen:f,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l,Point:e,sign:q,verify:E,recoverPublicKey:p,Signature:x,hash:t})}function P_(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const i=Ln(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),s={Fp:n,Fn:i,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function $_(e){const{CURVE:t,curveOpts:n}=P_(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}function L_(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,k0(n.Fn.ORDER,n.Fn.BITS))})}function U_(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:i}=$_(e),s=R_(t,n),o=C_(s,r,i);return L_(e,o)}function Pc(e,t){const n=r=>U_(yi(Rr({},e),{hash:r}));return yi(Rr({},n(t)),{create:n})}const tg={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},ng={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},rg={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},F_=Ln(tg.p),j_=Ln(ng.p),M_=Ln(rg.p),k_=Pc(yi(Rr({},tg),{Fp:F_,lowS:!1}),p0);Pc(yi(Rr({},ng),{Fp:j_,lowS:!1}),x6),Pc(yi(Rr({},rg),{Fp:M_,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),_6);const z_=k_,ig="base10",Ke="base16",ir="base64pad",$c="base64url",Bi="utf8",sg=0,jr=1,no=2,q_=0,og=1,Di=12,Lc=32;function H_(){const e=Rc.utils.randomPrivateKey(),t=Rc.getPublicKey(e);return{privateKey:Qe(e,Ke),publicKey:Qe(t,Ke)}}function Uc(){const e=er(Lc);return Qe(e,Ke)}function K_(e,t){const n=Rc.getSharedSecret(ot(e,Ke),ot(t,Ke)),r=e_(Gs,n,void 0,void 0,Lc);return Qe(r,Ke)}function V_(e){const t=Gs(ot(e,Ke));return Qe(t,Ke)}function ro(e){const t=Gs(ot(e,Bi));return Qe(t,Ke)}function ag(e){return ot(`${e}`,ig)}function sr(e){return Number(Qe(e,ig))}function cg(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function fg(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function G_(e){const t=ag(typeof e.type<"u"?e.type:sg);if(sr(t)===jr&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof e.senderPublicKey<"u"?ot(e.senderPublicKey,Ke):void 0,r=typeof e.iv<"u"?ot(e.iv,Ke):er(Di),i=ot(e.symKey,Ke),s=I0(i,r).encrypt(ot(e.message,Bi)),o=ug({type:t,sealed:s,iv:r,senderPublicKey:n});return e.encoding===$c?cg(o):o}function Z_(e){const t=ot(e.symKey,Ke),{sealed:n,iv:r}=Ai({encoded:e.encoded,encoding:e.encoding}),i=I0(t,r).decrypt(n);if(i===null)throw new Error("Failed to decrypt");return Qe(i,Bi)}function Y_(e,t){const n=ag(no),r=er(Di),i=ot(e,Bi),s=ug({type:n,sealed:i,iv:r});return t===$c?cg(s):s}function W_(e,t){const{sealed:n}=Ai({encoded:e,encoding:t});return Qe(n,Bi)}function ug(e){if(sr(e.type)===no)return Qe(bi([e.type,e.sealed]),ir);if(sr(e.type)===jr){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Qe(bi([e.type,e.senderPublicKey,e.iv,e.sealed]),ir)}return Qe(bi([e.type,e.iv,e.sealed]),ir)}function Ai(e){const t=(e.encoding||ir)===$c?fg(e.encoded):e.encoded,n=ot(t,ir),r=n.slice(q_,og),i=og;if(sr(r)===jr){const c=i+Lc,f=c+Di,u=n.slice(i,c),d=n.slice(c,f),h=n.slice(f);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(sr(r)===no){const c=n.slice(i),f=er(Di);return{type:r,sealed:c,iv:f}}const s=i+Di,o=n.slice(i,s),a=n.slice(s);return{type:r,sealed:a,iv:o}}function X_(e,t){const n=Ai({encoded:e,encoding:t?.encoding});return lg({type:sr(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Qe(n.senderPublicKey,Ke):void 0,receiverPublicKey:t?.receiverPublicKey})}function lg(e){const t=e?.type||sg;if(t===jr){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function hg(e){return e.type===jr&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}function dg(e){return e.type===no}function J_(e){const t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return bi([new Uint8Array([4]),t,n])}function Q_(e,t){const[n,r,i]=e.split("."),s=Buffer.from(fg(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=`${n}.${r}`,f=Gs(c),u=J_(t);if(!z_.verify(bi([o,a]),f,u))throw new Error("Invalid signature");return Jo(e).payload}const e4="irn";function io(e){return e?.relay||{protocol:e4}}function Mr(e){const t=O8[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var t4=Object.defineProperty,n4=Object.defineProperties,r4=Object.getOwnPropertyDescriptors,gg=Object.getOwnPropertySymbols,i4=Object.prototype.hasOwnProperty,s4=Object.prototype.propertyIsEnumerable,pg=(e,t,n)=>t in e?t4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Fc=(e,t)=>{for(var n in t||(t={}))i4.call(t,n)&&pg(e,n,t[n]);if(gg)for(var n of gg(t))s4.call(t,n)&&pg(e,n,t[n]);return e},o4=(e,t)=>n4(e,r4(t));function a4(e,t="-"){const n={},r="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(r)){const s=i.replace(r,""),o=e[i];n[s]=o}}),n}function bg(e){if(!e.includes("wc:")){const f=Wd(e);f!=null&&f.includes("wc:")&&(e=f)}e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;const t=e.indexOf(":"),n=e.indexOf("?")!==-1?e.indexOf("?"):void 0,r=e.substring(0,t),i=e.substring(t+1,n).split("@"),s=typeof n<"u"?e.substring(n):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:c4(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:a4(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function c4(e){return e.startsWith("//")?e.substring(2):e}function f4(e,t="-"){const n="relay",r={};return Object.keys(e).forEach(i=>{const s=i,o=n+t+s;e[s]&&(r[o]=e[s])}),r}function yg(e){const t=new URLSearchParams,n=Fc(Fc(o4(Fc({},f4(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")});return Object.entries(n).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!==void 0&&t.append(r,String(i))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}const u4={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},l4={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function oe(e,t){const{message:n,code:r}=l4[e];return{message:t?`${n} ${t}`:n,code:r}}function Ti(e,t){const{message:n,code:r}=u4[e];return{message:t?`${n} ${t}`:n,code:r}}function kr(e){return typeof e>"u"}function wg(e,t){return t&&kr(e)?!0:typeof e=="string"&&!!e.trim().length}function h4(e){function t(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(wg(e,!1)){if(t(e))return!0;const n=Wd(e);return t(n)}}catch{}return!1}function d4(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function g4(e){return e?.topic}function jc(e){return typeof e<"u"&&typeof e!==null}function mg(){const e=js();return new Promise(t=>{switch(e){case It.browser:t(p4());break;case It.reactNative:t(b4());break;case It.node:t(y4());break;default:t(!0)}})}function p4(){return wi()&&navigator?.onLine}async function b4(){if(Qn()&&typeof global<"u"&&global!=null&&global.NetInfo){const e=await(global==null?void 0:global.NetInfo.fetch());return e?.isConnected}return!0}function y4(){return!0}function w4(e){switch(js()){case It.browser:m4(e);break;case It.reactNative:E4(e);break}}function m4(e){!Qn()&&wi()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function E4(e){Qn()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}function v4(){var e;return wi()&&pr()?((e=pr())==null?void 0:e.visibilityState)==="visible":!0}function _4({logger:e,name:t}){const n=typeof e=="string"?kf({opts:{level:e,name:t}}).logger:e;return n.level=typeof e=="string"?e:e.level,n}var x4=Object.defineProperty,S4=(e,t,n)=>t in e?x4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ft=(e,t,n)=>S4(e,typeof t!="symbol"?t+"":t,n);class Eg{constructor(t,n){this.core=t,this.logger=n,Ft(this,"keychain",new Map),Ft(this,"name",Gf),Ft(this,"version",Zf),Ft(this,"initialized",!1),Ft(this,"storagePrefix",Et),Ft(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),Ft(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),Ft(this,"set",async(r,i)=>{this.isInitialized(),this.keychain.set(r,i),await this.persist()}),Ft(this,"get",r=>{this.isInitialized();const i=this.keychain.get(r);if(typeof i>"u"){const{message:s}=oe("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(s)}return i}),Ft(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=t,this.logger=it(n,this.name)}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,sc(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?oc(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var I4=Object.defineProperty,O4=(e,t,n)=>t in e?I4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Se=(e,t,n)=>O4(e,typeof t!="symbol"?t+"":t,n);class vg{constructor(t,n,r){this.core=t,this.logger=n,Se(this,"name",Kf),Se(this,"keychain"),Se(this,"randomSessionIdentifier",Uc()),Se(this,"initialized",!1),Se(this,"clientId"),Se(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Se(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),Se(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const i=await this.getClientSeed(),s=yl(i),o=bl(s.publicKey);return this.clientId=o,o}),Se(this,"generateKeyPair",()=>{this.isInitialized();const i=H_();return this.setPrivateKey(i.publicKey,i.privateKey)}),Se(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=yl(s),a=this.randomSessionIdentifier;return await jm(a,i,Vf,o)}),Se(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=K_(a,s);return this.setSymKey(c,o)}),Se(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||V_(i);return await this.keychain.set(o,i),o}),Se(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),Se(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),Se(this,"encode",async(i,s,o)=>{this.isInitialized();const a=lg(o),c=Zr(s);if(dg(a))return Y_(c,o?.encoding);if(hg(a)){const h=a.senderPublicKey,l=a.receiverPublicKey;i=await this.generateSharedKey(h,l)}const f=this.getSymKey(i),{type:u,senderPublicKey:d}=a;return G_({type:u,symKey:f,message:c,senderPublicKey:d,encoding:o?.encoding})}),Se(this,"decode",async(i,s,o)=>{this.isInitialized();const a=X_(s,o);if(dg(a)){const c=W_(s,o?.encoding);return cr(c)}if(hg(a)){const c=a.receiverPublicKey,f=a.senderPublicKey;i=await this.generateSharedKey(c,f)}try{const c=this.getSymKey(i),f=Z_({symKey:c,encoded:s,encoding:o?.encoding});return cr(f)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Se(this,"getPayloadType",(i,s=ir)=>{const o=Ai({encoded:i,encoding:s});return sr(o.type)}),Se(this,"getPayloadSenderPublicKey",(i,s=ir)=>{const o=Ai({encoded:i,encoding:s});return o.senderPublicKey?Qe(o.senderPublicKey,Ke):void 0}),this.core=t,this.logger=it(n,this.name),this.keychain=r||new Eg(this.core,this.logger)}get context(){return rt(this.logger)}async setPrivateKey(t,n){return await this.keychain.set(t,n),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ao)}catch{t=Uc(),await this.keychain.set(Ao,t)}return ot(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var B4=Object.defineProperty,D4=Object.defineProperties,A4=Object.getOwnPropertyDescriptors,_g=Object.getOwnPropertySymbols,T4=Object.prototype.hasOwnProperty,R4=Object.prototype.propertyIsEnumerable,Mc=(e,t,n)=>t in e?B4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,N4=(e,t)=>{for(var n in t||(t={}))T4.call(t,n)&&Mc(e,n,t[n]);if(_g)for(var n of _g(t))R4.call(t,n)&&Mc(e,n,t[n]);return e},C4=(e,t)=>D4(e,A4(t)),ut=(e,t,n)=>Mc(e,typeof t!="symbol"?t+"":t,n);class xg extends Tb{constructor(t,n){super(t,n),this.logger=t,this.core=n,ut(this,"messages",new Map),ut(this,"messagesWithoutClientAck",new Map),ut(this,"name",Yf),ut(this,"version",Wf),ut(this,"initialized",!1),ut(this,"storagePrefix",Et),ut(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),ut(this,"set",async(r,i,s)=>{this.isInitialized();const o=ro(i);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(r,a),s===Xr.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,C4(N4({},c),{[o]:i}))}return await this.persist(),o}),ut(this,"get",r=>{this.isInitialized();let i=this.messages.get(r);return typeof i>"u"&&(i={}),i}),ut(this,"getWithoutAck",r=>{this.isInitialized();const i={};for(const s of r){const o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),ut(this,"has",(r,i)=>{this.isInitialized();const s=this.get(r),o=ro(i);return typeof s[o]<"u"}),ut(this,"ack",async(r,i)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(r);if(typeof s>"u")return;const o=ro(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,s),await this.persist()}),ut(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=it(t,this.name),this.core=n}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,sc(t))}async setRelayerMessagesWithoutClientAck(t){await this.core.storage.setItem(this.storageKeyWithoutClientAck,sc(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?oc(t):void 0}async getRelayerMessagesWithoutClientAck(){const t=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof t<"u"?oc(t):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}const P4="PARSE_ERROR",$4="INVALID_REQUEST",L4="METHOD_NOT_FOUND",U4="INVALID_PARAMS",Sg="INTERNAL_ERROR",kc="SERVER_ERROR",F4=[-32700,-32600,-32601,-32602,-32603],Ri={[P4]:{code:-32700,message:"Parse error"},[$4]:{code:-32600,message:"Invalid Request"},[L4]:{code:-32601,message:"Method not found"},[U4]:{code:-32602,message:"Invalid params"},[Sg]:{code:-32603,message:"Internal error"},[kc]:{code:-32e3,message:"Server error"}},Ig=kc;function j4(e){return F4.includes(e)}function Og(e){return Object.keys(Ri).includes(e)?Ri[e]:Ri[Ig]}function M4(e){const t=Object.values(Ri).find(n=>n.code===e);return t||Ri[Ig]}function k4(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}var Bg={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var zc=function(e,t){return zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},zc(e,t)};function z4(e,t){zc(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var qc=function(){return qc=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},qc.apply(this,arguments)};function q4(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function H4(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function K4(e,t){return function(n,r){t(n,r,e)}}function V4(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function G4(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{f(r.next(u))}catch(d){o(d)}}function c(u){try{f(r.throw(u))}catch(d){o(d)}}function f(u){u.done?s(u.value):i(u.value).then(a,c)}f((r=r.apply(e,t||[])).next())})}function Z4(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(u){return c([f,u])}}function c(f){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,i=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){n.label=f[1];break}if(f[0]===6&&n.label<s[1]){n.label=s[1],s=f;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(f);break}s[2]&&n.ops.pop(),n.trys.pop();continue}f=t.call(e,n)}catch(u){f=[6,u],i=0}finally{r=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Y4(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}function W4(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Hc(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dg(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function X4(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Dg(arguments[t]));return e}function J4(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function Ni(e){return this instanceof Ni?(this.v=e,this):new Ni(e)}function Q4(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(l){return new Promise(function(b,w){s.push([h,l,b,w])>1||a(h,l)})})}function a(h,l){try{c(r[h](l))}catch(b){d(s[0][3],b)}}function c(h){h.value instanceof Ni?Promise.resolve(h.value.v).then(f,u):d(s[0][2],h)}function f(h){a("next",h)}function u(h){a("throw",h)}function d(h,l){h(l),s.shift(),s.length&&a(s[0][0],s[0][1])}}function e5(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(o){return(n=!n)?{value:Ni(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function t5(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Hc=="function"?Hc(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(f){s({value:f,done:a})},o)}}function n5(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function r5(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i5(e){return e&&e.__esModule?e:{default:e}}function s5(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function o5(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}var a5=Object.freeze({__proto__:null,__extends:z4,get __assign(){return qc},__rest:q4,__decorate:H4,__param:K4,__metadata:V4,__awaiter:G4,__generator:Z4,__createBinding:Y4,__exportStar:W4,__values:Hc,__read:Dg,__spread:X4,__spreadArrays:J4,__await:Ni,__asyncGenerator:Q4,__asyncDelegator:e5,__asyncValues:t5,__makeTemplateObject:n5,__importStar:r5,__importDefault:i5,__classPrivateFieldGet:s5,__classPrivateFieldSet:o5}),c5=nf(a5),an={},Ag;function f5(){if(Ag)return an;Ag=1,Object.defineProperty(an,"__esModule",{value:!0}),an.isBrowserCryptoAvailable=an.getSubtleCrypto=an.getBrowerCrypto=void 0;function e(){return Tt?.crypto||Tt?.msCrypto||{}}an.getBrowerCrypto=e;function t(){const r=e();return r.subtle||r.webkitSubtle}an.getSubtleCrypto=t;function n(){return!!e()&&!!t()}return an.isBrowserCryptoAvailable=n,an}var cn={},Tg;function u5(){if(Tg)return cn;Tg=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.isBrowser=cn.isNode=cn.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}cn.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}cn.isNode=t;function n(){return!e()&&!t()}return cn.isBrowser=n,cn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=c5;t.__exportStar(f5(),e),t.__exportStar(u5(),e)})(Bg);function Rg(e=3){const t=Date.now()*Math.pow(10,e),n=Math.floor(Math.random()*Math.pow(10,e));return t+n}function so(e=6){return BigInt(Rg(e))}function Kc(e,t,n){return{id:n||Rg(),jsonrpc:"2.0",method:e,params:t}}function Ng(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Cg(e,t,n){return{id:e,jsonrpc:"2.0",error:l5(t,n)}}function l5(e,t){return typeof e>"u"?Og(Sg):(typeof e=="string"&&(e=Object.assign(Object.assign({},Og(kc)),{message:e})),typeof t<"u"&&(e.data=t),j4(e.code)&&(e=M4(e.code)),e)}class h5{}class d5 extends h5{constructor(){super()}}class g5 extends d5{constructor(t){super()}}const p5="^wss?:";function b5(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function y5(e,t){const n=b5(e);return typeof n>"u"?!1:new RegExp(t).test(n)}function Pg(e){return y5(e,p5)}function w5(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function $g(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Lg(e){return $g(e)&&"method"in e}function Vc(e){return $g(e)&&(Ug(e)||oo(e))}function Ug(e){return"result"in e}function oo(e){return"error"in e}class m5 extends g5{constructor(t){super(t),this.events=new lt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async request(t,n){return this.requestStrict(Kc(t.method,t.params||[],t.id||so().toString()),n)}async requestStrict(t,n){return new Promise(async(r,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{oo(s)?i(s.error):r(s.result)});try{await this.connection.send(t,n)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Vc(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const E5=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),v5=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Fg=e=>e.split("?")[0],jg=10,_5=E5();class x5{constructor(t){if(this.url=t,this.events=new lt.exports.EventEmitter,this.registering=!1,!Pg(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Zr(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!Pg(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=t,this.registering=!0,new Promise((n,r)=>{const i=Bg.isReactNative()?void 0:{rejectUnauthorized:!w5(t)},s=new _5(t,[],i);v5()?s.onerror=o=>{const a=o;r(this.emitError(a.error))}:s.on("error",o=>{r(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),n(s)}})}onOpen(t){t.onmessage=n=>this.onPayload(n),t.onclose=n=>this.onClose(n),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?cr(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n),i=r.message||r.toString(),s=Cg(t,i);this.events.emit("payload",s)}parseError(t,n=this.url){return k4(t,Fg(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>jg&&this.events.setMaxListeners(jg)}emitError(t){const n=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${Fg(this.url)}`));return this.events.emit("register_error",n),n}}var S5=Object.defineProperty,I5=Object.defineProperties,O5=Object.getOwnPropertyDescriptors,Mg=Object.getOwnPropertySymbols,B5=Object.prototype.hasOwnProperty,D5=Object.prototype.propertyIsEnumerable,Gc=(e,t,n)=>t in e?S5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zr=(e,t)=>{for(var n in t||(t={}))B5.call(t,n)&&Gc(e,n,t[n]);if(Mg)for(var n of Mg(t))D5.call(t,n)&&Gc(e,n,t[n]);return e},kg=(e,t)=>I5(e,O5(t)),mt=(e,t,n)=>Gc(e,typeof t!="symbol"?t+"":t,n);class A5 extends Rb{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,mt(this,"events",new lt.exports.EventEmitter),mt(this,"name",Jf),mt(this,"queue",new Map),mt(this,"publishTimeout",W.toMiliseconds(W.ONE_MINUTE)),mt(this,"initialPublishTimeout",W.toMiliseconds(W.ONE_SECOND*15)),mt(this,"needsTransportRestart",!1),mt(this,"publish",async(r,i,s)=>{var o,a,c,f,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:i,opts:s}});const d=s?.ttl||Xf,h=s?.prompt||!1,l=s?.tag||0,b=s?.id||so().toString(),w=Mr(io().protocol),v={id:b,method:s?.publishMethod||w.publish,params:zr({topic:r,message:i,ttl:d,prompt:h,tag:l,attestation:s?.attestation},s?.tvf)},D=`Failed to publish payload, please try again. id:${b} tag:${l}`;try{kr((o=v.params)==null?void 0:o.prompt)&&((a=v.params)==null||delete a.prompt),kr((c=v.params)==null?void 0:c.tag)&&((f=v.params)==null||delete f.tag);const C=new Promise(async x=>{const _=({id:$})=>{var F;((F=v.id)==null?void 0:F.toString())===$.toString()&&(this.removeRequestFromQueue($),this.relayer.events.removeListener(be.publish,_),x())};this.relayer.events.on(be.publish,_);const R=Lt(new Promise(($,F)=>{this.rpcPublish(v,s).then($).catch(U=>{this.logger.warn(U,U?.message),F(U)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${b} tag:${l}`);try{await R,this.events.removeListener(be.publish,_)}catch($){this.queue.set(b,{request:v,opts:s,attempt:1}),this.logger.warn($,$?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:b,topic:r,message:i,opts:s}}),await Lt(C,this.publishTimeout,D)}catch(C){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(C),(u=s?.internal)!=null&&u.throwOnFailedPublish)throw C}finally{this.queue.delete(b)}}),mt(this,"publishCustom",async r=>{var i,s,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:f,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:l,prompt:b,tag:w,ttl:v=W.FIVE_MINUTES}=u,D=u.id||so().toString(),C=Mr(io().protocol),x=l||C.publish,_={id:D,method:x,params:zr(kg(zr({},f),{ttl:v,prompt:b,tag:w,attestation:d}),h)},R=`Failed to publish custom payload, please try again. id:${D} tag:${w}`;try{kr((i=_.params)==null?void 0:i.prompt)&&((s=_.params)==null||delete s.prompt),kr((o=_.params)==null?void 0:o.tag)&&((a=_.params)==null||delete a.tag);const $=new Promise(async F=>{const U=({id:q})=>{var k;((k=_.id)==null?void 0:k.toString())===q.toString()&&(this.removeRequestFromQueue(q),this.relayer.events.removeListener(be.publish,U),F())};this.relayer.events.on(be.publish,U);const A=Lt(new Promise((q,k)=>{this.rpcPublish(_,u).then(q).catch(E=>{this.logger.warn(E,E?.message),k(E)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${x} id:${D} tag:${w}`);try{await A,this.events.removeListener(be.publish,U)}catch(q){this.queue.set(D,{request:_,opts:u,attempt:1}),this.logger.warn(q,q?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:D,payload:f,opts:u}}),await Lt($,this.publishTimeout,R)}catch($){if(this.logger.debug("Failed to Publish Payload"),this.logger.error($),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw $}finally{this.queue.delete(D)}}),mt(this,"on",(r,i)=>{this.events.on(r,i)}),mt(this,"once",(r,i)=>{this.events.once(r,i)}),mt(this,"off",(r,i)=>{this.events.off(r,i)}),mt(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.relayer=t,this.logger=it(n,this.name),this.registerEventListeners()}get context(){return rt(this.logger)}async rpcPublish(t,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:t});const r=await this.relayer.request(t);return this.relayer.events.emit(be.publish,zr(zr({},t),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async(t,n)=>{var r;const i=t.attempt+1;this.queue.set(n,kg(zr({},t),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${t.request.id}, tag: ${(r=t.request.params)==null?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(t.request,t.opts),this.logger.warn({},`Publisher: queue->published: ${t.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Mn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(be.connection_stalled);return}this.checkQueue()}),this.relayer.on(be.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}var T5=Object.defineProperty,R5=(e,t,n)=>t in e?T5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qr=(e,t,n)=>R5(e,typeof t!="symbol"?t+"":t,n);class N5{constructor(){qr(this,"map",new Map),qr(this,"set",(t,n)=>{const r=this.get(t);this.exists(t,n)||this.map.set(t,[...r,n])}),qr(this,"get",t=>this.map.get(t)||[]),qr(this,"exists",(t,n)=>this.get(t).includes(n)),qr(this,"delete",(t,n)=>{if(typeof n>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,n))return;const i=r.filter(s=>s!==n);if(!i.length){this.map.delete(t);return}this.map.set(t,i)}),qr(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var C5=Object.defineProperty,P5=Object.defineProperties,$5=Object.getOwnPropertyDescriptors,zg=Object.getOwnPropertySymbols,L5=Object.prototype.hasOwnProperty,U5=Object.prototype.propertyIsEnumerable,Zc=(e,t,n)=>t in e?C5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ci=(e,t)=>{for(var n in t||(t={}))L5.call(t,n)&&Zc(e,n,t[n]);if(zg)for(var n of zg(t))U5.call(t,n)&&Zc(e,n,t[n]);return e},Yc=(e,t)=>P5(e,$5(t)),fe=(e,t,n)=>Zc(e,typeof t!="symbol"?t+"":t,n);class qg extends Pb{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,fe(this,"subscriptions",new Map),fe(this,"topicMap",new N5),fe(this,"events",new lt.exports.EventEmitter),fe(this,"name",ou),fe(this,"version",au),fe(this,"pending",new Map),fe(this,"cached",[]),fe(this,"initialized",!1),fe(this,"storagePrefix",Et),fe(this,"subscribeTimeout",W.toMiliseconds(W.ONE_MINUTE)),fe(this,"initialSubscribeTimeout",W.toMiliseconds(W.ONE_SECOND*15)),fe(this,"clientId"),fe(this,"batchSubscribeTopicsLimit",500),fe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),fe(this,"subscribe",async(r,i)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}});try{const o=io(i),a={topic:r,relay:o,transportType:i?.transportType};(s=i?.internal)!=null&&s.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,i);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),fe(this,"unsubscribe",async(r,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(r,i.id,i):await this.unsubscribeByTopic(r,i)}),fe(this,"isSubscribed",r=>new Promise(i=>{i(this.topicMap.topics.includes(r))})),fe(this,"isKnownTopic",r=>new Promise(i=>{i(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(s=>s.topic===r))})),fe(this,"on",(r,i)=>{this.events.on(r,i)}),fe(this,"once",(r,i)=>{this.events.once(r,i)}),fe(this,"off",(r,i)=>{this.events.off(r,i)}),fe(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),fe(this,"start",async()=>{await this.onConnect()}),fe(this,"stop",async()=>{await this.onDisconnect()}),fe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),fe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}),fe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Mn.pulse,async()=>{await this.checkPending()}),this.events.on(Ge.created,async r=>{const i=Ge.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Ge.deleted,async r=>{const i=Ge.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}),this.relayer=t,this.logger=it(n,this.name),this.clientId=""}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(t,n){let r=!1;try{r=this.getSubscription(t).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,n){const r=this.topicMap.get(t);await Promise.all(r.map(async i=>await this.unsubscribeById(t,i,n)))}async unsubscribeById(t,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}});try{const i=io(r);await this.restartToComplete({topic:t,id:n,relay:i}),await this.rpcUnsubscribe(t,n,i);const s=Ti("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,n,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,n,r){var i,s;const o=await this.getSubscriptionId(t);if((i=r?.internal)!=null&&i.skipSubscribe)return o;(!r||r?.transportType===qn.relay)&&await this.restartToComplete({topic:t,id:t,relay:n});const a={method:Mr(n.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{if(r?.transportType===qn.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},W.toMiliseconds(W.ONE_SECOND)),o;const f=new Promise(async d=>{const h=l=>{l.topic===t&&(this.events.removeListener(Ge.created,h),d(l.id))};this.events.on(Ge.created,h);try{const l=await Lt(new Promise((b,w)=>{this.relayer.request(a).catch(v=>{this.logger.warn(v,v?.message),w(v)}).then(b)}),this.initialSubscribeTimeout,`Subscribing to ${t} failed, please try again`);this.events.removeListener(Ge.created,h),d(l)}catch{}}),u=await Lt(f,this.subscribeTimeout,`Subscribing to ${t} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${t} failed, please try again`);return u?o:null}catch(f){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(be.connection_stalled),c)throw f}return null}async rpcBatchSubscribe(t){if(!t.length)return;const n=t[0].relay,r={method:Mr(n.protocol).batchSubscribe,params:{topics:t.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Lt(new Promise(i=>{this.relayer.request(r).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(be.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const n=t[0].relay,r={method:Mr(n.protocol).batchFetchMessages,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let i;try{i=await await Lt(new Promise((s,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(be.connection_stalled)}return i}rpcUnsubscribe(t,n,r){const i={method:Mr(r.protocol).unsubscribe,params:{topic:t,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(t,n){this.setSubscription(t,Yc(Ci({},n),{id:t})),this.pending.delete(n.topic)}onBatchSubscribe(t){t.length&&t.forEach(n=>{this.setSubscription(n.id,Ci({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(t,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,t)&&this.deleteSubscription(n,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:n}),this.addSubscription(t,n)}addSubscription(t,n){this.subscriptions.set(t,Ci({},n)),this.topicMap.set(n.topic,t),this.events.emit(Ge.created,n)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const n=this.subscriptions.get(t);if(!n){const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}deleteSubscription(t,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:n});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(Ge.deleted,Yc(Ci({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ge.sync)}async onRestart(){if(this.cached.length){const t=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const i=t.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Ge.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size&&!t.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){t.length&&(await this.rpcBatchSubscribe(t),this.onBatchSubscribe(await Promise.all(t.map(async n=>Yc(Ci({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const n=await this.rpcBatchFetchMessages(t);n&&n.messages&&(await K8(W.toMiliseconds(W.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(t){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(t),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(t){return ro(t+await this.getClientId())}}var F5=Object.defineProperty,Hg=Object.getOwnPropertySymbols,j5=Object.prototype.hasOwnProperty,M5=Object.prototype.propertyIsEnumerable,Wc=(e,t,n)=>t in e?F5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Kg=(e,t)=>{for(var n in t||(t={}))j5.call(t,n)&&Wc(e,n,t[n]);if(Hg)for(var n of Hg(t))M5.call(t,n)&&Wc(e,n,t[n]);return e},se=(e,t,n)=>Wc(e,typeof t!="symbol"?t+"":t,n);class Vg extends Nb{constructor(t){var n;super(t),se(this,"protocol","wc"),se(this,"version",2),se(this,"core"),se(this,"logger"),se(this,"events",new lt.exports.EventEmitter),se(this,"provider"),se(this,"messages"),se(this,"subscriber"),se(this,"publisher"),se(this,"name",tu),se(this,"transportExplicitlyClosed",!1),se(this,"initialized",!1),se(this,"connectionAttemptInProgress",!1),se(this,"relayUrl"),se(this,"projectId"),se(this,"packageName"),se(this,"bundleId"),se(this,"hasExperiencedNetworkDisruption",!1),se(this,"pingTimeout"),se(this,"heartBeatTimeout",W.toMiliseconds(W.THIRTY_SECONDS+W.FIVE_SECONDS)),se(this,"reconnectTimeout"),se(this,"connectPromise"),se(this,"reconnectInProgress",!1),se(this,"requestsInFlight",[]),se(this,"connectTimeout",W.toMiliseconds(W.ONE_SECOND*15)),se(this,"request",async r=>{var i,s;this.logger.debug("Publishing Request Payload");const o=r.id||so().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");const a=`${o}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(f=>f!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),se(this,"resetPingTimeout",()=>{Fs()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,s,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null?void 0:s.terminate)==null||o.call(s)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),se(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),se(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(be.connect)}),se(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),se(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(be.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),se(this,"registerProviderListeners",()=>{this.provider.on(st.payload,this.onPayloadHandler),this.provider.on(st.connect,this.onConnectHandler),this.provider.on(st.disconnect,this.onDisconnectHandler),this.provider.on(st.error,this.onProviderErrorHandler)}),this.core=t.core,this.logger=_4({logger:(n=t.logger)!=null?n:eu,name:this.name}),this.messages=new xg(this.logger,t.core),this.subscriber=new qg(this,this.logger),this.publisher=new A5(this,this.logger),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||To,P8()?this.packageName=Hd():$8()&&(this.bundleId=Hd()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(t=>this.logger.warn(t,t?.message))}get context(){return rt(this.logger)}get connected(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(t,n,r){this.isInitialized(),await this.publisher.publish(t,n,r),await this.recordMessageEvent({topic:t,message:n,publishedAt:Date.now(),transportType:qn.relay},Xr.outbound)}async publishCustom(t){this.isInitialized(),await this.publisher.publishCustom(t)}async subscribe(t,n){var r,i,s;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(i=n?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"",c;const f=u=>{u.topic===t&&(this.subscriber.off(Ge.created,f),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Ge.created,f)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(t,Kg({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(t,n){this.isInitialized(),await this.subscriber.unsubscribe(t,n)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Lt(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(t).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(t){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await mg())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if(t?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=t.sort((r,i)=>r.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(t,n){const{topic:r}=t;if(!n.sessionExists){const i=mi(W.FIVE_MINUTES),s={topic:r,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,s)}this.events.emit(be.message,t),await this.recordMessageEvent(t,Xr.inbound)}async connect(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to connect"))};this.provider.once(st.disconnect,s),await Lt(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(st.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(st.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(st.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const i=r;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,W.toMiliseconds(n*1))),n++}}startPingTimeout(){var t,n,r,i,s;if(Fs())try{(n=(t=this.provider)==null?void 0:t.connection)!=null&&n.socket&&((s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new m5(new x5(M8({sdkVersion:Yi,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(t,n){const{topic:r,message:i}=t;await this.messages.set(r,i,n)}async shouldIgnoreMessageEvent(t){const{topic:n,message:r}=t;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const i=this.messages.has(n,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Lg(t)){if(!t.method.endsWith(nu))return;const n=t.params,{topic:r,message:i,publishedAt:s,attestation:o}=n.data,a={topic:r,message:i,publishedAt:s,transportType:qn.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Kg({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(t),await this.onMessageEvent(a)}else Vc(t)&&this.events.emit(be.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(await this.recordMessageEvent(t,Xr.inbound),this.events.emit(be.message,t))}async acknowledgePayload(t){const n=Ng(t.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(st.payload,this.onPayloadHandler),this.provider.off(st.connect,this.onConnectHandler),this.provider.off(st.disconnect,this.onDisconnectHandler),this.provider.off(st.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await mg();w4(async n=>{t!==n&&(t=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Mn.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&v4())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(be.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t,t?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},W.toMiliseconds(ru)))))}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function k5(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function Gg(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function Zg(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const z5="[object RegExp]",q5="[object String]",H5="[object Number]",K5="[object Boolean]",Yg="[object Arguments]",V5="[object Symbol]",G5="[object Date]",Z5="[object Map]",Y5="[object Set]",W5="[object Array]",X5="[object Function]",J5="[object ArrayBuffer]",Xc="[object Object]",Q5="[object Error]",ex="[object DataView]",tx="[object Uint8Array]",nx="[object Uint8ClampedArray]",rx="[object Uint16Array]",ix="[object Uint32Array]",sx="[object BigUint64Array]",ox="[object Int8Array]",ax="[object Int16Array]",cx="[object Int32Array]",fx="[object BigInt64Array]",ux="[object Float32Array]",lx="[object Float64Array]";function hx(){}function Wg(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function dx(e,t,n){return Pi(e,t,void 0,void 0,void 0,void 0,n)}function Pi(e,t,n,r,i,s,o){const a=o(e,t,n,r,i,s);if(a!==void 0)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return $i(e,t,s,o)}return $i(e,t,s,o)}function $i(e,t,n,r){if(Object.is(e,t))return!0;let i=Zg(e),s=Zg(t);if(i===Yg&&(i=Xc),s===Yg&&(s=Xc),i!==s)return!1;switch(i){case q5:return e.toString()===t.toString();case H5:{const c=e.valueOf(),f=t.valueOf();return k5(c,f)}case K5:case G5:case V5:return Object.is(e.valueOf(),t.valueOf());case z5:return e.source===t.source&&e.flags===t.flags;case X5:return e===t}n=n??new Map;const o=n.get(e),a=n.get(t);if(o!=null&&a!=null)return o===t;n.set(e,t),n.set(t,e);try{switch(i){case Z5:{if(e.size!==t.size)return!1;for(const[c,f]of e.entries())if(!t.has(c)||!Pi(f,t.get(c),c,e,t,n,r))return!1;return!0}case Y5:{if(e.size!==t.size)return!1;const c=Array.from(e.values()),f=Array.from(t.values());for(let u=0;u<c.length;u++){const d=c[u],h=f.findIndex(l=>Pi(d,l,void 0,e,t,n,r));if(h===-1)return!1;f.splice(h,1)}return!0}case W5:case tx:case nx:case rx:case ix:case sx:case ox:case ax:case cx:case fx:case ux:case lx:{if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let c=0;c<e.length;c++)if(!Pi(e[c],t[c],c,e,t,n,r))return!1;return!0}case J5:return e.byteLength!==t.byteLength?!1:$i(new Uint8Array(e),new Uint8Array(t),n,r);case ex:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:$i(new Uint8Array(e),new Uint8Array(t),n,r);case Q5:return e.name===t.name&&e.message===t.message;case Xc:{if(!($i(e.constructor,t.constructor,n,r)||Wg(e)&&Wg(t)))return!1;const f=[...Object.keys(e),...Gg(e)],u=[...Object.keys(t),...Gg(t)];if(f.length!==u.length)return!1;for(let d=0;d<f.length;d++){const h=f[d],l=e[h];if(!Object.hasOwn(t,h))return!1;const b=t[h];if(!Pi(l,b,h,e,t,n,r))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function gx(e,t){return dx(e,t,hx)}var px=Object.defineProperty,Xg=Object.getOwnPropertySymbols,bx=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,Jc=(e,t,n)=>t in e?px(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jg=(e,t)=>{for(var n in t||(t={}))bx.call(t,n)&&Jc(e,n,t[n]);if(Xg)for(var n of Xg(t))yx.call(t,n)&&Jc(e,n,t[n]);return e},nt=(e,t,n)=>Jc(e,typeof t!="symbol"?t+"":t,n);class Qg extends Cb{constructor(t,n,r,i=Et,s=void 0){super(t,n,r,i),this.core=t,this.logger=n,this.name=r,nt(this,"map",new Map),nt(this,"version",iu),nt(this,"cached",[]),nt(this,"initialized",!1),nt(this,"getKey"),nt(this,"storagePrefix",Et),nt(this,"recentlyDeleted",[]),nt(this,"recentlyDeletedLimit",200),nt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!kr(o)?this.map.set(this.getKey(o),o):d4(o)?this.map.set(o.id,o):g4(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),nt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),nt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),nt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>gx(a[c],o[c]))):this.values)),nt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Jg(Jg({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),nt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=it(n,this.name),this.storagePrefix=i,this.getKey=s}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const n=this.map.get(t);if(!n){if(this.recentlyDeleted.includes(t)){const{message:i}=oe("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var wx=Object.defineProperty,mx=(e,t,n)=>t in e?wx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ne=(e,t,n)=>mx(e,typeof t!="symbol"?t+"":t,n);class ep{constructor(t,n){this.core=t,this.logger=n,ne(this,"name",cu),ne(this,"version",fu),ne(this,"events",new lt.exports),ne(this,"pairings"),ne(this,"initialized",!1),ne(this,"storagePrefix",Et),ne(this,"ignoredPayloadTypes",[jr]),ne(this,"registeredMethods",[]),ne(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ne(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ne(this,"create",async r=>{this.isInitialized();const i=Uc(),s=await this.core.crypto.setSymKey(i),o=mi(W.FIVE_MINUTES),a={protocol:Qf},c={topic:s,expiry:o,relay:a,active:!1,methods:r?.methods},f=yg({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(lr.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:r?.transportType,internal:r?.internal}),{topic:s,uri:f}}),ne(this,"pair",async r=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[Nt.pairing_started]}});this.isValidPair(r,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:f}=bg(r.uri);i.props.properties.topic=s,i.addTrace(Nt.pairing_uri_validation_success),i.addTrace(Nt.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),i.addTrace(Nt.existing_pairing),u.active)throw i.setError(Mt.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(Nt.pairing_not_expired)}const d=c||mi(W.FIVE_MINUTES),h={topic:s,relay:a,expiry:d,active:!1,methods:f};this.core.expirer.set(s,d),await this.pairings.set(s,h),i.addTrace(Nt.store_new_pairing),r.activatePairing&&await this.activate({topic:s}),this.events.emit(lr.create,h),i.addTrace(Nt.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(Nt.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Mt.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(l){throw i.setError(Mt.subscribe_pairing_topic_failure),l}return i.addTrace(Nt.subscribe_pairing_topic_success),h}),ne(this,"activate",async({topic:r})=>{this.isInitialized();const i=mi(W.FIVE_MINUTES);this.core.expirer.set(r,i),await this.pairings.update(r,{active:!0,expiry:i})}),ne(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=r;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=k8();this.events.once(ac("pairing_ping",s),({error:f})=>{f?c(f):a()}),await o()}}),ne(this,"updateExpiry",async({topic:r,expiry:i})=>{this.isInitialized(),await this.pairings.update(r,{expiry:i})}),ne(this,"updateMetadata",async({topic:r,metadata:i})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:i})}),ne(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ne(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ti("USER_DISCONNECTED")),await this.deletePairing(i))}),ne(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(i);return yg({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),ne(this,"sendRequest",async(r,i,s)=>{const o=Kc(i,s),a=await this.core.crypto.encode(r,o),c=ur[i].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),ne(this,"sendResult",async(r,i,s)=>{const o=Ng(r,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,f=ur[c].res;await this.core.relayer.publish(i,a,f),await this.core.history.resolve(o)}),ne(this,"sendError",async(r,i,s)=>{const o=Cg(r,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,f=ur[c]?ur[c].res:ur.unregistered_method.res;await this.core.relayer.publish(i,a,f),await this.core.history.resolve(o)}),ne(this,"deletePairing",async(r,i)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Ti("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),i?Promise.resolve():this.core.expirer.del(r)])}),ne(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(i=>Gd(i.expiry));await Promise.all(r.map(i=>this.deletePairing(i.topic)))}),ne(this,"onRelayEventRequest",async r=>{const{topic:i,payload:s}=r;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),ne(this,"onRelayEventResponse",async r=>{const{topic:i,payload:s}=r,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),ne(this,"onPairingPingRequest",async(r,i)=>{const{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult(s,r,!0),this.events.emit(lr.ping,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),ne(this,"onPairingPingResponse",(r,i)=>{const{id:s}=i;setTimeout(()=>{Ug(i)?this.events.emit(ac("pairing_ping",s),{}):oo(i)&&this.events.emit(ac("pairing_ping",s),{error:i.error})},500)}),ne(this,"onPairingDeleteRequest",async(r,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(lr.delete,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),ne(this,"onUnknownRpcMethodRequest",async(r,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Ti("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,r,a),this.logger.error(a)}catch(a){await this.sendError(s,r,a),this.logger.error(a)}}),ne(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Ti("WC_METHOD_UNSUPPORTED",r))}),ne(this,"isValidPair",(r,i)=>{var s;if(!jc(r)){const{message:a}=oe("MISSING_OR_INVALID",`pair() params: ${r}`);throw i.setError(Mt.malformed_pairing_uri),new Error(a)}if(!h4(r.uri)){const{message:a}=oe("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw i.setError(Mt.malformed_pairing_uri),new Error(a)}const o=bg(r?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=oe("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Mt.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=oe("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Mt.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&W.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Mt.pairing_expired);const{message:a}=oe("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ne(this,"isValidPing",async r=>{if(!jc(r)){const{message:s}=oe("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidPairingTopic(i)}),ne(this,"isValidDisconnect",async r=>{if(!jc(r)){const{message:s}=oe("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidPairingTopic(i)}),ne(this,"isValidPairingTopic",async r=>{if(!wg(r,!1)){const{message:i}=oe("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.pairings.keys.includes(r)){const{message:i}=oe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(Gd(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:i}=oe("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}),this.core=t,this.logger=it(n,this.name),this.pairings=new Qg(this.core,this.logger,this.name,this.storagePrefix)}get context(){return rt(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(be.message,async t=>{const{topic:n,message:r,transportType:i}=t;if(this.pairings.keys.includes(n)&&i!==qn.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const s=await this.core.crypto.decode(n,r);Lg(s)?(this.core.history.set(n,s),await this.onRelayEventRequest({topic:n,payload:s})):Vc(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:n,payload:s}),this.core.history.delete(n,s.id)),await this.core.relayer.messages.ack(n,r)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(dt.expired,async t=>{const{topic:n}=H8(t.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(lr.expire,{topic:n}))})}}var Ex=Object.defineProperty,vx=(e,t,n)=>t in e?Ex(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ae=(e,t,n)=>vx(e,typeof t!="symbol"?t+"":t,n);class tp extends Ab{constructor(t,n){super(t,n),this.core=t,this.logger=n,Ae(this,"records",new Map),Ae(this,"events",new lt.exports.EventEmitter),Ae(this,"name",uu),Ae(this,"version",lu),Ae(this,"cached",[]),Ae(this,"initialized",!1),Ae(this,"storagePrefix",Et),Ae(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ae(this,"set",(r,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:r,request:{method:i.method,params:i.params||null},chainId:s,expiry:mi(W.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(ht.created,o)}),Ae(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const i=await this.getRecord(r.id);typeof i.response>"u"&&(i.response=oo(r)?{error:r.error}:{result:r.result},this.records.set(i.id,i),this.persist(),this.events.emit(ht.updated,i))}),Ae(this,"get",async(r,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:i}),await this.getRecord(i))),Ae(this,"delete",(r,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===r){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(ht.deleted,s)}}),this.persist()}),Ae(this,"exists",async(r,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===r:!1)),Ae(this,"on",(r,i)=>{this.events.on(r,i)}),Ae(this,"once",(r,i)=>{this.events.once(r,i)}),Ae(this,"off",(r,i)=>{this.events.off(r,i)}),Ae(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=it(n,this.name)}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:Kc(n.request.method,n.request.params,n.id),chainId:n.chainId};return t.push(r)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const n=this.records.get(t);if(!n){const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ht.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ht.created,t=>{const n=ht.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(ht.updated,t=>{const n=ht.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(ht.deleted,t=>{const n=ht.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.core.heartbeat.on(Mn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(n=>{W.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(ht.deleted,n,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var _x=Object.defineProperty,xx=(e,t,n)=>t in e?_x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ue=(e,t,n)=>xx(e,typeof t!="symbol"?t+"":t,n);class np extends $b{constructor(t,n){super(t,n),this.core=t,this.logger=n,Ue(this,"expirations",new Map),Ue(this,"events",new lt.exports.EventEmitter),Ue(this,"name",hu),Ue(this,"version",du),Ue(this,"cached",[]),Ue(this,"initialized",!1),Ue(this,"storagePrefix",Et),Ue(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ue(this,"has",r=>{try{const i=this.formatTarget(r);return typeof this.getExpiration(i)<"u"}catch{return!1}}),Ue(this,"set",(r,i)=>{this.isInitialized();const s=this.formatTarget(r),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(dt.created,{target:s,expiration:o})}),Ue(this,"get",r=>{this.isInitialized();const i=this.formatTarget(r);return this.getExpiration(i)}),Ue(this,"del",r=>{if(this.isInitialized(),this.has(r)){const i=this.formatTarget(r),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(dt.deleted,{target:i,expiration:s})}}),Ue(this,"on",(r,i)=>{this.events.on(r,i)}),Ue(this,"once",(r,i)=>{this.events.once(r,i)}),Ue(this,"off",(r,i)=>{this.events.off(r,i)}),Ue(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=it(n,this.name)}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return z8(t);if(typeof t=="number")return q8(t);const{message:n}=oe("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(n)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(dt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const n=this.expirations.get(t);if(!n){const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(t,n){const{expiry:r}=n;W.toMiliseconds(r)-Date.now()<=0&&this.expire(t,n)}expire(t,n){this.expirations.delete(t),this.events.emit(dt.expired,{target:t,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,n)=>this.checkExpiry(n,t))}registerEventListeners(){this.core.heartbeat.on(Mn.pulse,()=>this.checkExpirations()),this.events.on(dt.created,t=>{const n=dt.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(dt.expired,t=>{const n=dt.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(dt.deleted,t=>{const n=dt.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Sx=Object.defineProperty,Ix=(e,t,n)=>t in e?Sx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ye=(e,t,n)=>Ix(e,typeof t!="symbol"?t+"":t,n);class rp extends Lb{constructor(t,n,r){super(t,n,r),this.core=t,this.logger=n,this.store=r,ye(this,"name",gu),ye(this,"abortController"),ye(this,"isDevEnv"),ye(this,"verifyUrlV3",bu),ye(this,"storagePrefix",Et),ye(this,"version",Do),ye(this,"publicKey"),ye(this,"fetchPromise"),ye(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&W.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ye(this,"register",async i=>{if(!wi()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const f=pr(),u=this.startAbortTimer(W.ONE_SECOND*5),d=await new Promise((h,l)=>{const b=()=>{window.removeEventListener("message",v),f.body.removeChild(w),l("attestation aborted")};this.abortController.signal.addEventListener("abort",b);const w=f.createElement("iframe");w.src=c,w.style.display="none",w.addEventListener("error",b,{signal:this.abortController.signal});const v=D=>{if(D.data&&typeof D.data=="string")try{const C=JSON.parse(D.data);if(C.type==="verify_attestation"){if(Jo(C.attestation).payload.id!==o)return;clearInterval(u),f.body.removeChild(w),this.abortController.signal.removeEventListener("abort",b),window.removeEventListener("message",v),h(C.attestation===null?"":C.attestation)}}catch(C){this.logger.warn(C)}};f.body.appendChild(w),window.addEventListener("message",v,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(f){this.logger.warn(f)}return""}),ye(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(Jo(s).payload.id!==a)return;const f=await this.isValidJwtAttestation(s);if(f){if(!f.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return f}}if(!o)return;const c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),ye(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(W.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ye(this,"getVerifyUrl",i=>{let s=i||Jr;return yu.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Jr}`),s=Jr),s}),ye(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(W.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),ye(this,"persistPublicKey",async i=>{this.logger.debug(i,"persisting public key to local storage"),await this.store.setItem(this.storeKey,i),this.publicKey=i}),ye(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ye(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ye(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ye(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),ye(this,"validateAttestation",(i,s)=>{const o=Q_(i,s.publicKey),a={hasExpired:W.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=it(n,this.name),this.abortController=new AbortController,this.isDevEnv=Yd(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return rt(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),W.toMiliseconds(t))}}var Ox=Object.defineProperty,Bx=(e,t,n)=>t in e?Ox(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ip=(e,t,n)=>Bx(e,typeof t!="symbol"?t+"":t,n);class sp extends Ub{constructor(t,n){super(t,n),this.projectId=t,this.logger=n,ip(this,"context",wu),ip(this,"registerDeviceToken",async r=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=r,c=`${mu}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=it(n,this.context)}}var Dx=Object.defineProperty,op=Object.getOwnPropertySymbols,Ax=Object.prototype.hasOwnProperty,Tx=Object.prototype.propertyIsEnumerable,Qc=(e,t,n)=>t in e?Dx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Li=(e,t)=>{for(var n in t||(t={}))Ax.call(t,n)&&Qc(e,n,t[n]);if(op)for(var n of op(t))Tx.call(t,n)&&Qc(e,n,t[n]);return e},Ie=(e,t,n)=>Qc(e,typeof t!="symbol"?t+"":t,n);class ap extends Fb{constructor(t,n,r=!0){super(t,n,r),this.core=t,this.logger=n,Ie(this,"context",vu),Ie(this,"storagePrefix",Et),Ie(this,"storageVersion",Eu),Ie(this,"events",new Map),Ie(this,"shouldPersist",!1),Ie(this,"init",async()=>{if(!Yd())try{const i={eventId:Zd(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Kd(this.core.relayer.protocol,this.core.relayer.version,Yi)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Ie(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,f=Zd(),u=this.core.projectId||"",d=Date.now(),h=Li({eventId:f,timestamp:d,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(f));return this.telemetryEnabled&&(this.events.set(f,h),this.shouldPersist=!0),h}),Ie(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Li(Li({},a),this.setMethods(a.eventId))}),Ie(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),Ie(this,"setEventListeners",()=>{this.core.heartbeat.on(Mn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{W.fromMiliseconds(Date.now())-W.fromMiliseconds(i.timestamp)>_u&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Ie(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),Ie(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),Ie(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Ie(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Ie(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,Li(Li({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),Ie(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),Ie(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${xu}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Yi}${s}`,{method:"POST",body:JSON.stringify(i)})}),Ie(this,"getAppDomain",()=>U8().url),this.logger=it(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Rx=Object.defineProperty,cp=Object.getOwnPropertySymbols,Nx=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,ef=(e,t,n)=>t in e?Rx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fp=(e,t)=>{for(var n in t||(t={}))Nx.call(t,n)&&ef(e,n,t[n]);if(cp)for(var n of cp(t))Cx.call(t,n)&&ef(e,n,t[n]);return e},le=(e,t,n)=>ef(e,typeof t!="symbol"?t+"":t,n);class ao extends Ib{constructor(t){var n;super(t),le(this,"protocol",Bo),le(this,"version",Do),le(this,"name",Wr),le(this,"relayUrl"),le(this,"projectId"),le(this,"customStoragePrefix"),le(this,"events",new lt.exports.EventEmitter),le(this,"logger"),le(this,"heartbeat"),le(this,"relayer"),le(this,"crypto"),le(this,"storage"),le(this,"history"),le(this,"expirer"),le(this,"pairing"),le(this,"verify"),le(this,"echoClient"),le(this,"linkModeSupportedApps"),le(this,"eventClient"),le(this,"initialized",!1),le(this,"logChunkController"),le(this,"on",(a,c)=>this.events.on(a,c)),le(this,"once",(a,c)=>this.events.once(a,c)),le(this,"off",(a,c)=>this.events.off(a,c)),le(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),le(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:f})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:qn.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:f})});const r=this.getGlobalCore(t?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||To,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const i=wb({level:typeof t?.logger=="string"&&t.logger?t.logger:qf.logger,name:Wr}),{logger:s,chunkLoggerController:o}=kf({opts:i,maxSizeInBytes:t?.maxLogBlobSizeInBytes,loggerOverride:t?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=it(s,this.name),this.heartbeat=new yo,this.crypto=new vg(this,this.logger,t?.keychain),this.history=new tp(this,this.logger),this.expirer=new np(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new C1(fp(fp({},Hf),t?.storageOptions)),this.relayer=new Vg({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ep(this,this.logger),this.verify=new rp(this,this.logger,this.storage),this.echoClient=new sp(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new ap(this,this.logger,t?.telemetryEnabled),this.setGlobalCore(this)}static async init(t){const n=new ao(t);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(su,r),n}get context(){return rt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(Ro,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Ro)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(t,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(t.message),t}}getGlobalCore(t=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${t}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(t){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=t.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=t}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&process.env.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}}const Px=ao;K.CORE_CONTEXT=Wr,K.CORE_DEFAULT=qf,K.CORE_PROTOCOL=Bo,K.CORE_STORAGE_OPTIONS=Hf,K.CORE_STORAGE_PREFIX=Et,K.CORE_VERSION=Do,K.CRYPTO_CLIENT_SEED=Ao,K.CRYPTO_CONTEXT=Kf,K.CRYPTO_JWT_TTL=Vf,K.Core=Px,K.Crypto=vg,K.ECHO_CONTEXT=wu,K.ECHO_URL=mu,K.EVENTS_CLIENT_API_URL=xu,K.EVENTS_STORAGE_CLEANUP_INTERVAL=_u,K.EVENTS_STORAGE_CONTEXT=vu,K.EVENTS_STORAGE_VERSION=Eu,K.EVENT_CLIENT_AUTHENTICATE_ERRORS=Wb,K.EVENT_CLIENT_AUTHENTICATE_TRACES=Yb,K.EVENT_CLIENT_CONTEXT=Vb,K.EVENT_CLIENT_PAIRING_ERRORS=Mt,K.EVENT_CLIENT_PAIRING_TRACES=Nt,K.EVENT_CLIENT_SESSION_ERRORS=Zb,K.EVENT_CLIENT_SESSION_TRACES=Gb,K.EXPIRER_CONTEXT=hu,K.EXPIRER_DEFAULT_TTL=Hb,K.EXPIRER_EVENTS=dt,K.EXPIRER_STORAGE_VERSION=du,K.EchoClient=sp,K.EventClient=ap,K.Expirer=np,K.HISTORY_CONTEXT=uu,K.HISTORY_EVENTS=ht,K.HISTORY_STORAGE_VERSION=lu,K.JsonRpcHistory=tp,K.KEYCHAIN_CONTEXT=Gf,K.KEYCHAIN_STORAGE_VERSION=Zf,K.KeyChain=Eg,K.MESSAGES_CONTEXT=Yf,K.MESSAGES_STORAGE_VERSION=Wf,K.MESSAGE_DIRECTION=Xr,K.MessageTracker=xg,K.PAIRING_CONTEXT=cu,K.PAIRING_DEFAULT_TTL=qb,K.PAIRING_EVENTS=lr,K.PAIRING_RPC_OPTS=ur,K.PAIRING_STORAGE_VERSION=fu,K.PENDING_SUB_RESOLUTION_TIMEOUT=zb,K.PUBLISHER_CONTEXT=Jf,K.PUBLISHER_DEFAULT_TTL=Xf,K.Pairing=ep,K.RELAYER_CONTEXT=tu,K.RELAYER_DEFAULT_LOGGER=eu,K.RELAYER_DEFAULT_PROTOCOL=Qf,K.RELAYER_DEFAULT_RELAY_URL=To,K.RELAYER_EVENTS=be,K.RELAYER_PROVIDER_EVENTS=st,K.RELAYER_RECONNECT_TIMEOUT=ru,K.RELAYER_SDK_VERSION=Yi,K.RELAYER_STORAGE_OPTIONS=jb,K.RELAYER_SUBSCRIBER_SUFFIX=nu,K.RELAYER_TRANSPORT_CUTOFF=Mb,K.Relayer=Vg,K.STORE_STORAGE_VERSION=iu,K.SUBSCRIBER_CONTEXT=ou,K.SUBSCRIBER_DEFAULT_TTL=kb,K.SUBSCRIBER_EVENTS=Ge,K.SUBSCRIBER_STORAGE_VERSION=au,K.Store=Qg,K.Subscriber=qg,K.TRANSPORT_TYPES=qn,K.TRUSTED_VERIFY_URLS=yu,K.VERIFY_CONTEXT=gu,K.VERIFY_SERVER=Jr,K.VERIFY_SERVER_V3=bu,K.Verify=rp,K.WALLETCONNECT_CLIENT_ID=su,K.WALLETCONNECT_LINK_MODE_APPS=Ro,K.default=ao,Object.defineProperty(K,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
