{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/utils/abis.js"],"sourcesContent":["const erc20Abi = [{\n  constant: true,\n  inputs: [],\n  name: \"name\",\n  outputs: [{\n    name: \"\",\n    type: \"string\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_spender\",\n    type: \"address\"\n  }, {\n    name: \"_value\",\n    type: \"uint256\"\n  }],\n  name: \"approve\",\n  outputs: [{\n    name: \"success\",\n    type: \"bool\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [],\n  name: \"totalSupply\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_from\",\n    type: \"address\"\n  }, {\n    name: \"_to\",\n    type: \"address\"\n  }, {\n    name: \"_value\",\n    type: \"uint256\"\n  }],\n  name: \"transferFrom\",\n  outputs: [{\n    name: \"success\",\n    type: \"bool\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [],\n  name: \"decimals\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_owner\",\n    type: \"address\"\n  }],\n  name: \"balanceOf\",\n  outputs: [{\n    name: \"balance\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [],\n  name: \"symbol\",\n  outputs: [{\n    name: \"\",\n    type: \"string\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_to\",\n    type: \"address\"\n  }, {\n    name: \"_value\",\n    type: \"uint256\"\n  }],\n  name: \"transfer\",\n  outputs: [{\n    name: \"success\",\n    type: \"bool\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_spender\",\n    type: \"address\"\n  }, {\n    name: \"_value\",\n    type: \"uint256\"\n  }, {\n    name: \"_extraData\",\n    type: \"bytes\"\n  }],\n  name: \"approveAndCall\",\n  outputs: [{\n    name: \"success\",\n    type: \"bool\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_owner\",\n    type: \"address\"\n  }, {\n    name: \"_spender\",\n    type: \"address\"\n  }],\n  name: \"allowance\",\n  outputs: [{\n    name: \"remaining\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  type: \"function\"\n}, {\n  inputs: [{\n    name: \"_initialAmount\",\n    type: \"uint256\"\n  }, {\n    name: \"_tokenName\",\n    type: \"string\"\n  }, {\n    name: \"_decimalUnits\",\n    type: \"uint8\"\n  }, {\n    name: \"_tokenSymbol\",\n    type: \"string\"\n  }],\n  type: \"constructor\"\n}, {\n  payable: false,\n  type: \"fallback\"\n}];\nconst erc721Abi = [{\n  constant: true,\n  inputs: [{\n    name: \"interfaceID\",\n    type: \"bytes4\"\n  }],\n  name: \"supportsInterface\",\n  outputs: [{\n    name: \"\",\n    type: \"bool\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [],\n  name: \"name\",\n  outputs: [{\n    name: \"_name\",\n    type: \"string\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_tokenId\",\n    type: \"uint256\"\n  }],\n  name: \"getApproved\",\n  outputs: [{\n    name: \"\",\n    type: \"address\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_approved\",\n    type: \"address\"\n  }, {\n    name: \"_tokenId\",\n    type: \"uint256\"\n  }],\n  name: \"approve\",\n  outputs: [],\n  payable: true,\n  stateMutability: \"payable\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [],\n  name: \"totalSupply\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_from\",\n    type: \"address\"\n  }, {\n    name: \"_to\",\n    type: \"address\"\n  }, {\n    name: \"_tokenId\",\n    type: \"uint256\"\n  }],\n  name: \"transferFrom\",\n  outputs: [],\n  payable: true,\n  stateMutability: \"payable\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_owner\",\n    type: \"address\"\n  }, {\n    name: \"_index\",\n    type: \"uint256\"\n  }],\n  name: \"tokenOfOwnerByIndex\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: false,\n  inputs: [{\n    name: \"_from\",\n    type: \"address\"\n  }, {\n    name: \"_to\",\n    type: \"address\"\n  }, {\n    name: \"_tokenId\",\n    type: \"uint256\"\n  }],\n  name: \"safeTransferFrom\",\n  outputs: [],\n  payable: true,\n  stateMutability: \"payable\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_index\",\n    type: \"uint256\"\n  }],\n  name: \"tokenByIndex\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_tokenId\",\n    type: \"uint256\"\n  }],\n  name: \"ownerOf\",\n  outputs: [{\n    name: \"\",\n    type: \"address\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_owner\",\n    type: \"address\"\n  }],\n  name: \"balanceOf\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [],\n  name: \"symbol\",\n  outputs: [{\n    name: \"_symbol\",\n    type: \"string\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"_tokenId\",\n    type: \"uint256\"\n  }],\n  name: \"tokenURI\",\n  outputs: [{\n    name: \"\",\n    type: \"string\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}];\nconst erc1155Abi = [{\n  inputs: [{\n    internalType: \"address\",\n    name: \"_owner\",\n    type: \"address\"\n  }, {\n    internalType: \"uint256\",\n    name: \"_id\",\n    type: \"uint256\"\n  }],\n  name: \"balanceOf\",\n  outputs: [{\n    internalType: \"uint256\",\n    name: \"\",\n    type: \"uint256\"\n  }],\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"address[]\",\n    name: \"_owners\",\n    type: \"address[]\"\n  }, {\n    internalType: \"uint256[]\",\n    name: \"_ids\",\n    type: \"uint256[]\"\n  }],\n  name: \"balanceOfBatch\",\n  outputs: [{\n    internalType: \"uint256[]\",\n    name: \"\",\n    type: \"uint256[]\"\n  }],\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"address\",\n    name: \"_owner\",\n    type: \"address\"\n  }, {\n    internalType: \"address\",\n    name: \"_operator\",\n    type: \"address\"\n  }],\n  name: \"isApprovedForAll\",\n  outputs: [{\n    internalType: \"bool\",\n    name: \"isOperator\",\n    type: \"bool\"\n  }],\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"address\",\n    name: \"_from\",\n    type: \"address\"\n  }, {\n    internalType: \"address\",\n    name: \"_to\",\n    type: \"address\"\n  }, {\n    internalType: \"uint256\",\n    name: \"_id\",\n    type: \"uint256\"\n  }, {\n    internalType: \"uint256\",\n    name: \"_amount\",\n    type: \"uint256\"\n  }, {\n    internalType: \"bytes\",\n    name: \"_data\",\n    type: \"bytes\"\n  }],\n  name: \"safeTransferFrom\",\n  outputs: [],\n  stateMutability: \"nonpayable\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"address\",\n    name: \"_operator\",\n    type: \"address\"\n  }, {\n    internalType: \"bool\",\n    name: \"_approved\",\n    type: \"bool\"\n  }],\n  name: \"setApprovalForAll\",\n  outputs: [],\n  stateMutability: \"nonpayable\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"bytes4\",\n    name: \"_interfaceID\",\n    type: \"bytes4\"\n  }],\n  name: \"supportsInterface\",\n  outputs: [{\n    internalType: \"bool\",\n    name: \"\",\n    type: \"bool\"\n  }],\n  stateMutability: \"pure\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"uint256\",\n    name: \"_id\",\n    type: \"uint256\"\n  }],\n  name: \"uri\",\n  outputs: [{\n    internalType: \"string\",\n    name: \"\",\n    type: \"string\"\n  }],\n  stateMutability: \"view\",\n  type: \"function\"\n}];\nconst singleBalanceCheckerAbi = [{\n  payable: true,\n  stateMutability: \"payable\",\n  type: \"fallback\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"user\",\n    type: \"address\"\n  }, {\n    name: \"token\",\n    type: \"address\"\n  }],\n  name: \"tokenBalance\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  constant: true,\n  inputs: [{\n    name: \"users\",\n    type: \"address[]\"\n  }, {\n    name: \"tokens\",\n    type: \"address[]\"\n  }],\n  name: \"balances\",\n  outputs: [{\n    name: \"\",\n    type: \"uint256[]\"\n  }],\n  payable: false,\n  stateMutability: \"view\",\n  type: \"function\"\n}];\n\nexport { erc1155Abi, erc20Abi, erc721Abi, singleBalanceCheckerAbi };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 736, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/utils/constants.js"],"sourcesContent":["import { CHAIN_NAMESPACES, getEnvVariable } from '@toruslabs/base-controllers';\n\nconst LOCALHOST = \"localhost\";\nconst CONTRACT_TYPE_ETH = \"eth\";\nconst CONTRACT_TYPE_ERC20 = \"erc20\";\nconst CONTRACT_TYPE_ERC721 = \"erc721\";\nconst CONTRACT_TYPE_ERC1155 = \"erc1155\";\nconst ERC1155_INTERFACE_ID = \"0xd9b67a26\";\nconst ERC721_INTERFACE_ID = \"0x80ac58cd\";\nconst ERC721_METADATA_INTERFACE_ID = \"0x5b5e139f\";\nconst ERC721_ENUMERABLE_INTERFACE_ID = \"0x780e9d63\";\nconst MAINNET_CHAIN_ID = \"0x1\";\nconst POLYGON_CHAIN_ID = \"0x89\";\nconst BSC_MAINNET_CHAIN_ID = \"0x38\";\nconst AVALANCHE_MAINNET_CHAIN_ID = \"0xa86a\";\nconst XDAI_CHAIN_ID = \"0x64\";\nconst ARBITRUM_MAINNET_CHAIN_ID = \"0xa4b1\";\nconst OPTIMISM_MAINNET_CHAIN_ID = \"0xa\";\nconst CELO_MAINNET_CHAIN_ID = \"0xa4ec\";\nconst BASE_CHAIN_ID = \"0x2105\";\nconst LINEA_CHAIN_ID = \"0xe708\";\nconst SEPOLIA_CHAIN_ID = \"0xaa36a7\";\nconst POLYGON_AMOY_CHAIN_ID = \"0x13882\";\nconst BSC_TESTNET_CHAIN_ID = \"0x61\";\nconst AVALANCHE_TESTNET_CHAIN_ID = \"0xa869\";\nconst ARBITRUM_TESTNET_CHAIN_ID = \"0x66eee\";\nconst OPTIMISM_TESTNET_CHAIN_ID = \"0xaa37dc\";\nconst BASE_TESTNET_CHAIN_ID = \"0x14a34\";\nconst LINEA_SEPOLIA_CHAIN_ID = \"0xe705\";\n\n// Don't change this. It will break production builds.\n// We use this syntax because if both injections fail, we replace the \"process.env.VITE_APP_INFURA_PROJECT_KEY\" using define replacement\nconst INFURA_KEY = getEnvVariable(\"VITE_APP_INFURA_PROJECT_KEY\") || process.env.VITE_APP_INFURA_PROJECT_KEY;\nconst SUPPORTED_NETWORKS = {\n  [MAINNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://etherscan.io\",\n    chainId: MAINNET_CHAIN_ID,\n    displayName: \"Ethereum\",\n    logo: \"eth.svg\",\n    rpcTarget: `https://mainnet.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\"\n  },\n  [POLYGON_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://polygonscan.com\",\n    chainId: POLYGON_CHAIN_ID,\n    displayName: \"Polygon\",\n    logo: \"polygon.svg\",\n    rpcTarget: `https://polygon-mainnet.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"POL\",\n    tickerName: \"Polygon Ecosystem Token\"\n  },\n  [BSC_MAINNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://bscscan.com\",\n    chainId: BSC_MAINNET_CHAIN_ID,\n    displayName: \"Binance Smart Chain (BSC)\",\n    logo: \"bnb_logo.svg\",\n    rpcTarget: `https://bsc-dataseed.binance.org`,\n    ticker: \"BNB\",\n    tickerName: \"Binance Coin\"\n  },\n  [AVALANCHE_MAINNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://snowtrace.io\",\n    chainId: AVALANCHE_MAINNET_CHAIN_ID,\n    displayName: \"Avalanche\",\n    logo: \"avax.svg\",\n    rpcTarget: `https://api.avax.network/ext/bc/C/rpc`,\n    ticker: \"AVAX\",\n    tickerName: \"Avalanche\"\n  },\n  [OPTIMISM_MAINNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://optimistic.etherscan.io\",\n    chainId: OPTIMISM_MAINNET_CHAIN_ID,\n    displayName: \"Optimism\",\n    logo: \"optimism.svg\",\n    rpcTarget: `https://optimism-mainnet.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\"\n  },\n  [CELO_MAINNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://explorer.celo.org\",\n    chainId: CELO_MAINNET_CHAIN_ID,\n    displayName: \"Celo Mainnet\",\n    logo: \"celo.svg\",\n    rpcTarget: `https://celo-mainnet.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"CELO\",\n    tickerName: \"Celo\"\n  },\n  [ARBITRUM_MAINNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://arbiscan.io\",\n    chainId: ARBITRUM_MAINNET_CHAIN_ID,\n    displayName: \"Arbitrum One\",\n    logo: \"arbitrum.svg\",\n    rpcTarget: `https://arbitrum-mainnet.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\"\n  },\n  [BASE_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://basescan.org\",\n    chainId: BASE_CHAIN_ID,\n    displayName: \"Base\",\n    logo: \"base.svg\",\n    rpcTarget: `https://mainnet.base.org`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\"\n  },\n  [LINEA_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://lineascan.build\",\n    chainId: LINEA_CHAIN_ID,\n    displayName: \"Linea\",\n    logo: \"linea.svg\",\n    rpcTarget: `https://linea-mainnet.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\"\n  },\n  [SEPOLIA_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://sepolia.etherscan.io\",\n    chainId: SEPOLIA_CHAIN_ID,\n    displayName: \"Sepolia Test Network\",\n    logo: \"eth.svg\",\n    rpcTarget: `https://sepolia.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\",\n    isTestnet: true\n  },\n  [LINEA_SEPOLIA_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://sepolia.lineascan.build\",\n    chainId: LINEA_SEPOLIA_CHAIN_ID,\n    displayName: \"Linea Sepolia Testnet\",\n    logo: \"linea.svg\",\n    rpcTarget: `https://linea-sepolia.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\",\n    isTestnet: true\n  },\n  [POLYGON_AMOY_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://amoy.polygonscan.com\",\n    chainId: POLYGON_AMOY_CHAIN_ID,\n    displayName: \"Polygon Amoy\",\n    logo: \"polygon.svg\",\n    rpcTarget: `https://polygon-amoy.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"POL\",\n    tickerName: \"Polygon Ecosystem Token\",\n    isTestnet: true\n  },\n  [BSC_TESTNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://testnet.bscscan.com\",\n    chainId: BSC_TESTNET_CHAIN_ID,\n    displayName: \"Binance Smart Chain Testnet\",\n    logo: \"bnb_logo.svg\",\n    rpcTarget: `https://data-seed-prebsc-1-s1.binance.org:8545`,\n    ticker: \"BNB\",\n    tickerName: \"Binance Coin\",\n    isTestnet: true\n  },\n  [AVALANCHE_TESTNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://testnet.snowtrace.io\",\n    chainId: AVALANCHE_TESTNET_CHAIN_ID,\n    displayName: \"Avalanche Testnet C-Chain\",\n    logo: \"avax.svg\",\n    rpcTarget: `https://api.avax-test.network/ext/bc/C/rpc`,\n    ticker: \"AVAX\",\n    tickerName: \"Avalanche\",\n    isTestnet: true\n  },\n  [ARBITRUM_TESTNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://sepolia.arbiscan.io\",\n    chainId: ARBITRUM_TESTNET_CHAIN_ID,\n    displayName: \"Arbitrum Sepolia\",\n    logo: \"arbitrum.svg\",\n    rpcTarget: `https://arbitrum-sepolia.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\",\n    isTestnet: true\n  },\n  [OPTIMISM_TESTNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://sepolia-optimistic.etherscan.io\",\n    chainId: OPTIMISM_TESTNET_CHAIN_ID,\n    displayName: \"Optimism Sepolia\",\n    logo: \"optimism.svg\",\n    rpcTarget: `https://optimism-sepolia.infura.io/v3/${INFURA_KEY}`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\",\n    isTestnet: true\n  },\n  [BASE_TESTNET_CHAIN_ID]: {\n    chainNamespace: CHAIN_NAMESPACES.EIP155,\n    decimals: 18,\n    blockExplorerUrl: \"https://sepolia.basescan.org\",\n    chainId: BASE_TESTNET_CHAIN_ID,\n    displayName: \"Base Sepolia\",\n    logo: \"base.svg\",\n    rpcTarget: `https://sepolia.base.org`,\n    ticker: \"ETH\",\n    tickerName: \"Ethereum\",\n    isTestnet: true\n  }\n};\nconst METHOD_TYPES = {\n  GET_ACCOUNTS: \"eth_accounts\",\n  ETH_TRANSACTION: \"eth_sendTransaction\",\n  ETH_SIGN_TRANSACTION: \"eth_signTransaction\",\n  // In TransferToken UI of WS, we call this method via JRPC provider to get gas estimation for a user op. Renamed to avoid conflict with bundler's gas estimation method\n  ETH_ESTIMATE_AA_TRANSACTION_GAS: \"eth_estimateAATransactionGas\",\n  // start bundler methods\n  ETH_ESTIMATE_USER_OPERATION_GAS: \"eth_estimateUserOperationGas\",\n  ETH_GET_SUPPORTED_ENTRY_POINTS: \"eth_supportedEntryPoints\",\n  ETH_GET_USER_OPERATION: \"eth_getUserOperationByHash\",\n  ETH_GET_USER_OPERATION_RECEIPT: \"eth_getUserOperationReceipt\",\n  ETH_SEND_USER_OPERATION: \"eth_sendUserOperation\",\n  PIMLICO_GET_USER_OPERATION_GAS_PRICE: \"pimlico_getUserOperationGasPrice\",\n  PIMLICO_GET_USER_OPERATION_STATUS: \"pimlico_getUserOperationStatus\",\n  PIMLICO_SIMULATE_ASSET_CHANGES: \"pimlico_simulateAssetChanges\",\n  BICONOMY_GET_GAS_FEE_VALUES: \"biconomy_getGasFeeValues\",\n  BICONOMY_GET_USER_OPERATION_STATUS: \"biconomy_getUserOperationStatus\",\n  // end bundler methods\n  // start paymaster methods\n  ETH_GET_PAYMASTER_DATA: \"pm_getPaymasterData\",\n  ETH_GET_PAYMASTER_STUB_DATA: \"pm_getPaymasterStubData\",\n  ETH_SPONSOR_USER_OPERATION: \"pm_sponsorUserOperation\",\n  ETH_GET_FEE_QUOTE_OR_DATA: \"pm_getFeeQuoteOrData\",\n  PIMLICO_GET_TOKEN_QUOTES: \"pimlico_getTokenQuotes\",\n  // end paymaster methods\n  ETH_REQUEST_ACCOUNTS: \"eth_requestAccounts\",\n  ETH_SEND_RAW_TRANSACTION: \"eth_sendRawTransaction\",\n  ETH_SIGN: \"eth_sign\",\n  ETH_SIGN_TYPED_DATA_V4: \"eth_signTypedData_v4\",\n  PERSONAL_SIGN: \"personal_sign\",\n  ETH_GET_TRANSACTION_COUNT: \"eth_getTransactionCount\",\n  ETH_GET_TRANSACTION_BY_HASH: \"eth_getTransactionByHash\",\n  ETH_GET_TRANSACTION_RECEIPT: \"eth_getTransactionReceipt\",\n  WATCH_ASSET: \"wallet_watchAsset\",\n  ETH_GET_BLOCK_BY_HASH: \"eth_getBlockByHash\",\n  ETH_GET_CODE: \"eth_getCode\",\n  ETH_GET_GAS_PRICE: \"eth_gasPrice\",\n  ETH_PRIVATE_KEY: \"eth_privateKey\",\n  PRIVATE_KEY: \"private_key\",\n  ETH_PUBLIC_KEY: \"eth_publicKey\",\n  PUBLIC_KEY: \"public_key\",\n  SWITCH_CHAIN: \"wallet_switchEthereumChain\",\n  ADD_CHAIN: \"wallet_addEthereumChain\"\n};\nconst BUNDLER_METHOD_TYPES = [METHOD_TYPES.ETH_ESTIMATE_USER_OPERATION_GAS, METHOD_TYPES.ETH_GET_SUPPORTED_ENTRY_POINTS, METHOD_TYPES.ETH_GET_USER_OPERATION, METHOD_TYPES.ETH_GET_USER_OPERATION_RECEIPT, METHOD_TYPES.ETH_SEND_USER_OPERATION, METHOD_TYPES.PIMLICO_GET_USER_OPERATION_GAS_PRICE, METHOD_TYPES.PIMLICO_GET_USER_OPERATION_STATUS, METHOD_TYPES.PIMLICO_SIMULATE_ASSET_CHANGES, METHOD_TYPES.BICONOMY_GET_GAS_FEE_VALUES, METHOD_TYPES.BICONOMY_GET_USER_OPERATION_STATUS];\nconst PAYMASTER_METHOD_TYPES = [METHOD_TYPES.ETH_GET_PAYMASTER_DATA, METHOD_TYPES.ETH_GET_PAYMASTER_STUB_DATA, METHOD_TYPES.ETH_SPONSOR_USER_OPERATION, METHOD_TYPES.PIMLICO_GET_TOKEN_QUOTES, METHOD_TYPES.ETH_GET_FEE_QUOTE_OR_DATA];\nconst TRANSACTION_ENVELOPE_TYPES = {\n  LEGACY: \"0x0\",\n  ACCESS_LIST: \"0x1\",\n  FEE_MARKET: \"0x2\"\n};\nconst GAS_ESTIMATE_TYPES = {\n  // Fee Market describes the way gas is set after the london hardfork, and was\n  // defined by EIP-1559.\n  FEE_MARKET: \"fee-market\",\n  // Legacy describes gasPrice estimates from before london hardfork, when the\n  // user is connected to mainnet and are presented with fast/average/slow\n  // estimate levels to choose from.\n  LEGACY: \"legacy\",\n  // EthGasPrice describes a gasPrice estimate received from eth_gasPrice. Post\n  // london this value should only be used for legacy type transactions when on\n  // networks that support EIP-1559. This type of estimate is the most accurate\n  // to display on custom networks that don't support EIP-1559.\n  ETH_GASPRICE: \"eth_gasPrice\",\n  // NoEstimate describes the state of the controller before receiving its first\n  // estimate.\n  NONE: \"none\"\n};\n\n// https://help.optimism.io/hc/en-us/articles/4411895794715-Transaction-fees\nconst CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP = {\n  [OPTIMISM_MAINNET_CHAIN_ID]: 1,\n  [OPTIMISM_TESTNET_CHAIN_ID]: 1\n};\nconst OLD_ERC721_LIST = {\n  \"0x06012c8cf97bead5deae237070f9587f8e7a266d\": {\n    name: \"Cryptokitties\",\n    logo: \"dapp-cryptokitty.svg\",\n    erc20: true,\n    symbol: \"CK\",\n    decimals: 0\n  }\n};\nconst TEST_CHAINS = [SEPOLIA_CHAIN_ID];\nconst MM_TOKEN_API_SUPPORTED_CHAINS = [MAINNET_CHAIN_ID, SEPOLIA_CHAIN_ID, BSC_MAINNET_CHAIN_ID, BSC_TESTNET_CHAIN_ID, OPTIMISM_MAINNET_CHAIN_ID, OPTIMISM_TESTNET_CHAIN_ID, AVALANCHE_MAINNET_CHAIN_ID, AVALANCHE_TESTNET_CHAIN_ID, ARBITRUM_MAINNET_CHAIN_ID, ARBITRUM_TESTNET_CHAIN_ID, POLYGON_CHAIN_ID, POLYGON_AMOY_CHAIN_ID, CELO_MAINNET_CHAIN_ID, BASE_CHAIN_ID, BASE_TESTNET_CHAIN_ID, LINEA_CHAIN_ID, LINEA_SEPOLIA_CHAIN_ID];\nconst MM_NFT_API_SUPPORTED_CHAINS = [MAINNET_CHAIN_ID, POLYGON_CHAIN_ID, BSC_MAINNET_CHAIN_ID, AVALANCHE_MAINNET_CHAIN_ID, LINEA_CHAIN_ID, BASE_CHAIN_ID];\nconst COINGECKO_SUPPORTED_CURRENCIES = new Set([\"btc\", \"eth\", \"ltc\", \"bch\", \"bnb\", \"eos\", \"xrp\", \"xlm\", \"link\", \"dot\", \"yfi\", \"usd\", \"aed\", \"ars\", \"aud\", \"bdt\", \"bhd\", \"bmd\", \"brl\", \"cad\", \"chf\", \"clp\", \"cny\", \"czk\", \"dkk\", \"eur\", \"gbp\", \"hkd\", \"huf\", \"idr\", \"ils\", \"inr\", \"jpy\", \"krw\", \"kwd\", \"lkr\", \"mmk\", \"mxn\", \"myr\", \"ngn\", \"nok\", \"nzd\", \"php\", \"pkr\", \"pln\", \"rub\", \"sar\", \"sek\", \"sgd\", \"thb\", \"try\", \"twd\", \"uah\", \"vef\", \"vnd\", \"zar\", \"xdr\", \"xag\", \"xau\", \"bits\", \"sats\"]);\nconst COINGECKO_PLATFORMS_CHAIN_CODE_MAP = {\n  [POLYGON_CHAIN_ID]: {\n    platform: \"polygon-pos\",\n    currency: \"pol\"\n  },\n  [BSC_MAINNET_CHAIN_ID]: {\n    platform: \"binance-smart-chain\",\n    currency: \"bnb\"\n  },\n  [MAINNET_CHAIN_ID]: {\n    platform: \"ethereum\",\n    currency: \"eth\"\n  },\n  [ARBITRUM_MAINNET_CHAIN_ID]: {\n    platform: \"arbitrum-one\",\n    currency: \"eth\"\n  },\n  [OPTIMISM_MAINNET_CHAIN_ID]: {\n    platform: \"optimistic-ethereum\",\n    currency: \"eth\"\n  },\n  [CELO_MAINNET_CHAIN_ID]: {\n    platform: \"celo\",\n    currency: \"celo\"\n  },\n  [XDAI_CHAIN_ID]: {\n    platform: \"xdai\",\n    currency: \"xDAI\"\n  },\n  [AVALANCHE_MAINNET_CHAIN_ID]: {\n    platform: \"avalanche\",\n    currency: \"avax\"\n  },\n  [BASE_CHAIN_ID]: {\n    platform: \"base\",\n    currency: \"eth\"\n  }\n};\nconst SMART_ACCOUNT = {\n  BICONOMY: \"biconomy\",\n  KERNEL: \"kernel\",\n  SAFE: \"safe\",\n  TRUST: \"trust\",\n  // TODO: disabled because of pimlico issues\n  LIGHT: \"light\",\n  SIMPLE: \"simple\",\n  NEXUS: \"nexus\",\n  METAMASK: \"metamask\"\n};\n\nexport { ARBITRUM_MAINNET_CHAIN_ID, ARBITRUM_TESTNET_CHAIN_ID, AVALANCHE_MAINNET_CHAIN_ID, AVALANCHE_TESTNET_CHAIN_ID, BASE_CHAIN_ID, BASE_TESTNET_CHAIN_ID, BSC_MAINNET_CHAIN_ID, BSC_TESTNET_CHAIN_ID, BUNDLER_METHOD_TYPES, CELO_MAINNET_CHAIN_ID, CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP, COINGECKO_PLATFORMS_CHAIN_CODE_MAP, COINGECKO_SUPPORTED_CURRENCIES, CONTRACT_TYPE_ERC1155, CONTRACT_TYPE_ERC20, CONTRACT_TYPE_ERC721, CONTRACT_TYPE_ETH, ERC1155_INTERFACE_ID, ERC721_ENUMERABLE_INTERFACE_ID, ERC721_INTERFACE_ID, ERC721_METADATA_INTERFACE_ID, GAS_ESTIMATE_TYPES, LINEA_CHAIN_ID, LINEA_SEPOLIA_CHAIN_ID, LOCALHOST, MAINNET_CHAIN_ID, METHOD_TYPES, MM_NFT_API_SUPPORTED_CHAINS, MM_TOKEN_API_SUPPORTED_CHAINS, OLD_ERC721_LIST, OPTIMISM_MAINNET_CHAIN_ID, OPTIMISM_TESTNET_CHAIN_ID, PAYMASTER_METHOD_TYPES, POLYGON_AMOY_CHAIN_ID, POLYGON_CHAIN_ID, SEPOLIA_CHAIN_ID, SMART_ACCOUNT, SUPPORTED_NETWORKS, TEST_CHAINS, TRANSACTION_ENVELOPE_TYPES, XDAI_CHAIN_ID };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1297, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/utils/contractAddresses.js"],"sourcesContent":["import { ARBITRUM_MAINNET_CHAIN_ID, AVALANCHE_MAINNET_CHAIN_ID, POLYGON_CHAIN_ID, OPTIMISM_MAINNET_CHAIN_ID, BSC_MAINNET_CHAIN_ID, MAINNET_CHAIN_ID } from './constants.js';\n\nconst SINGLE_CALL_BALANCES_ADDRESSES = {\n  [MAINNET_CHAIN_ID]: \"0xb1f8e55c7f64d203c1400b9d8555d050f94adf39\",\n  // [SEPOLIA_CHAIN_ID]: SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA,\n  // [FANTOM_CHAIN_ID]: \"0x07f697424ABe762bB808c109860c04eA488ff92B\",\n  [BSC_MAINNET_CHAIN_ID]: \"0x2352c63A83f9Fd126af8676146721Fa00924d7e4\",\n  [OPTIMISM_MAINNET_CHAIN_ID]: \"0xB1c568e9C3E6bdaf755A60c7418C269eb11524FC\",\n  [POLYGON_CHAIN_ID]: \"0x2352c63A83f9Fd126af8676146721Fa00924d7e4\",\n  [AVALANCHE_MAINNET_CHAIN_ID]: \"0xD023D153a0DFa485130ECFdE2FAA7e612EF94818\",\n  [ARBITRUM_MAINNET_CHAIN_ID]: \"0x151E24A486D7258dd7C33Fb67E4bB01919B7B32c\"\n};\n\nexport { SINGLE_CALL_BALANCES_ADDRESSES };\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,iCAAiC;IACrC,CAAC,yNAAgB,CAAC,EAAE;IACpB,4DAA4D;IAC5D,mEAAmE;IACnE,CAAC,6NAAoB,CAAC,EAAE;IACxB,CAAC,kOAAyB,CAAC,EAAE;IAC7B,CAAC,yNAAgB,CAAC,EAAE;IACpB,CAAC,mOAA0B,CAAC,EAAE;IAC9B,CAAC,kOAAyB,CAAC,EAAE;AAC/B","ignoreList":[0]}},
    {"offset": {"line": 1318, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Account/AccountTrackerController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseController } from '@toruslabs/base-controllers';\nimport { Mutex } from 'async-mutex';\nimport { BrowserProvider, toQuantity, Contract } from 'ethers';\nimport log from 'loglevel';\nimport { singleBalanceCheckerAbi } from '../utils/abis.js';\nimport { SINGLE_CALL_BALANCES_ADDRESSES } from '../utils/contractAddresses.js';\n\nconst ZERO_ADDRESS = \"0x0000000000000000000000000000000000000000\";\n\n/**\n * Tracks accounts based on blocks.\n * If block tracker provides latest block, we query accounts from it.\n * Preferences state changes also retrigger accounts update.\n * Network state changes also retrigger accounts update.\n */\nclass AccountTrackerController extends BaseController {\n  constructor({\n    config,\n    state,\n    provider,\n    blockTracker,\n    getIdentities,\n    onPreferencesStateChange,\n    getCurrentChainId\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"blockTracker\", void 0);\n    _defineProperty(this, \"mutex\", new Mutex());\n    _defineProperty(this, \"ethersProvider\", void 0);\n    _defineProperty(this, \"getIdentities\", void 0);\n    _defineProperty(this, \"getCurrentChainId\", void 0);\n    this.defaultState = {\n      accounts: {}\n    };\n    this.initialize();\n    this.provider = provider;\n    this.blockTracker = blockTracker;\n    this.ethersProvider = new BrowserProvider(this.provider, \"any\");\n    this.getIdentities = getIdentities;\n    this.getCurrentChainId = getCurrentChainId;\n    onPreferencesStateChange(() => {\n      const refreshNeeded = this.syncAccounts();\n      if (refreshNeeded) {\n        log.info(\"onPreferencesStateChange called\");\n        this.refresh();\n      }\n    });\n    this.blockTrackerListener = this.blockTrackerListener.bind(this);\n  }\n  blockTrackerListener() {\n    this.refresh();\n  }\n  startPolling() {\n    this.stopPolling();\n    // Initiate block tracker internal tracking.\n    if (Object.keys(this.state.accounts).length > 0) {\n      // Adding this listener on block tracker triggers it to start polling.\n      this.blockTracker.on(\"latest\", this.blockTrackerListener);\n    }\n  }\n  stopPolling() {\n    this.blockTracker.removeListener(\"latest\", this.blockTrackerListener);\n  }\n  syncAccounts() {\n    const {\n      accounts\n    } = this.state;\n    const addresses = Object.keys(this.getIdentities());\n    const existing = Object.keys(accounts);\n    const newAddresses = addresses.filter(address => existing.indexOf(address) === -1);\n    const oldAddresses = existing.filter(address => addresses.indexOf(address) === -1);\n    let isUpdated = false;\n    newAddresses.forEach(address => {\n      isUpdated = true;\n      accounts[address] = {\n        balance: \"0x0\"\n      };\n    });\n    oldAddresses.forEach(address => {\n      isUpdated = true;\n      delete accounts[address];\n    });\n    this.update({\n      accounts: _objectSpread({}, accounts)\n    });\n    return isUpdated;\n  }\n  async refresh() {\n    const releaseLock = await this.mutex.acquire();\n    try {\n      this._updateAccounts();\n    } catch {\n      // do nothing\n    } finally {\n      releaseLock();\n    }\n  }\n  async _updateAccounts() {\n    const {\n      accounts\n    } = this.state;\n    const addresses = Object.keys(accounts);\n    const chainId = this.getCurrentChainId();\n    if (chainId === \"loading\") return;\n    if (addresses.length > 0) {\n      if (SINGLE_CALL_BALANCES_ADDRESSES[chainId]) {\n        await this._updateAccountsViaBalanceChecker(addresses, SINGLE_CALL_BALANCES_ADDRESSES[chainId]);\n        return;\n      }\n      log.info(\"falling back to ethQuery.getBalance\");\n      await Promise.all(addresses.map(x => this._updateAccount(x)));\n    }\n  }\n  async _updateAccount(address) {\n    const balance = await this.provider.request({\n      method: \"eth_getBalance\",\n      params: [address, \"latest\"]\n    });\n    const {\n      accounts\n    } = this.state;\n    if (!accounts[address]) return;\n    accounts[address] = {\n      balance: toQuantity(balance)\n    };\n    this.update({\n      accounts\n    });\n  }\n  async _updateAccountsViaBalanceChecker(addresses, deployedContractAddress) {\n    const ethContract = new Contract(deployedContractAddress, singleBalanceCheckerAbi, this.ethersProvider);\n    try {\n      const result = await ethContract.balances(addresses, [ZERO_ADDRESS]);\n      const {\n        accounts\n      } = this.state;\n      addresses.forEach((address, index) => {\n        const balance = toQuantity(result[index]);\n        if (!accounts[address]) return;\n        accounts[address] = {\n          balance\n        };\n      });\n      return this.update({\n        accounts\n      });\n    } catch (error) {\n      log.warn(\"Torus - Account Tracker single call balance fetch failed\", error);\n      return Promise.all(addresses.map(x => this._updateAccount(x)));\n    }\n  }\n}\n\nexport { AccountTrackerController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;AAEA,MAAM,eAAe;AAErB;;;;;CAKC,GACD,MAAM,iCAAiC,yQAAc;IACnD,YAAY,EACV,MAAM,EACN,KAAK,EACL,QAAQ,EACR,YAAY,EACZ,aAAa,EACb,wBAAwB,EACxB,iBAAiB,EAClB,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,YAAY,KAAK;QACvC,IAAA,oLAAe,EAAC,IAAI,EAAE,gBAAgB,KAAK;QAC3C,IAAA,oLAAe,EAAC,IAAI,EAAE,SAAS,IAAI,oJAAK;QACxC,IAAA,oLAAe,EAAC,IAAI,EAAE,kBAAkB,KAAK;QAC7C,IAAA,oLAAe,EAAC,IAAI,EAAE,iBAAiB,KAAK;QAC5C,IAAA,oLAAe,EAAC,IAAI,EAAE,qBAAqB,KAAK;QAChD,IAAI,CAAC,YAAY,GAAG;YAClB,UAAU,CAAC;QACb;QACA,IAAI,CAAC,UAAU;QACf,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,YAAY,GAAG;QACpB,IAAI,CAAC,cAAc,GAAG,IAAI,8LAAe,CAAC,IAAI,CAAC,QAAQ,EAAE;QACzD,IAAI,CAAC,aAAa,GAAG;QACrB,IAAI,CAAC,iBAAiB,GAAG;QACzB,yBAAyB;YACvB,MAAM,gBAAgB,IAAI,CAAC,YAAY;YACvC,IAAI,eAAe;gBACjB,yJAAG,CAAC,IAAI,CAAC;gBACT,IAAI,CAAC,OAAO;YACd;QACF;QACA,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI;IACjE;IACA,uBAAuB;QACrB,IAAI,CAAC,OAAO;IACd;IACA,eAAe;QACb,IAAI,CAAC,WAAW;QAChB,4CAA4C;QAC5C,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,MAAM,GAAG,GAAG;YAC/C,sEAAsE;YACtE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,IAAI,CAAC,oBAAoB;QAC1D;IACF;IACA,cAAc;QACZ,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,UAAU,IAAI,CAAC,oBAAoB;IACtE;IACA,eAAe;QACb,MAAM,EACJ,QAAQ,EACT,GAAG,IAAI,CAAC,KAAK;QACd,MAAM,YAAY,OAAO,IAAI,CAAC,IAAI,CAAC,aAAa;QAChD,MAAM,WAAW,OAAO,IAAI,CAAC;QAC7B,MAAM,eAAe,UAAU,MAAM,CAAC,CAAA,UAAW,SAAS,OAAO,CAAC,aAAa,CAAC;QAChF,MAAM,eAAe,SAAS,MAAM,CAAC,CAAA,UAAW,UAAU,OAAO,CAAC,aAAa,CAAC;QAChF,IAAI,YAAY;QAChB,aAAa,OAAO,CAAC,CAAA;YACnB,YAAY;YACZ,QAAQ,CAAC,QAAQ,GAAG;gBAClB,SAAS;YACX;QACF;QACA,aAAa,OAAO,CAAC,CAAA;YACnB,YAAY;YACZ,OAAO,QAAQ,CAAC,QAAQ;QAC1B;QACA,IAAI,CAAC,MAAM,CAAC;YACV,UAAU,IAAA,mLAAa,EAAC,CAAC,GAAG;QAC9B;QACA,OAAO;IACT;IACA,MAAM,UAAU;QACd,MAAM,cAAc,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO;QAC5C,IAAI;YACF,IAAI,CAAC,eAAe;QACtB,EAAE,OAAM;QACN,aAAa;QACf,SAAU;YACR;QACF;IACF;IACA,MAAM,kBAAkB;QACtB,MAAM,EACJ,QAAQ,EACT,GAAG,IAAI,CAAC,KAAK;QACd,MAAM,YAAY,OAAO,IAAI,CAAC;QAC9B,MAAM,UAAU,IAAI,CAAC,iBAAiB;QACtC,IAAI,YAAY,WAAW;QAC3B,IAAI,UAAU,MAAM,GAAG,GAAG;YACxB,IAAI,+OAA8B,CAAC,QAAQ,EAAE;gBAC3C,MAAM,IAAI,CAAC,gCAAgC,CAAC,WAAW,+OAA8B,CAAC,QAAQ;gBAC9F;YACF;YACA,yJAAG,CAAC,IAAI,CAAC;YACT,MAAM,QAAQ,GAAG,CAAC,UAAU,GAAG,CAAC,CAAA,IAAK,IAAI,CAAC,cAAc,CAAC;QAC3D;IACF;IACA,MAAM,eAAe,OAAO,EAAE;QAC5B,MAAM,UAAU,MAAM,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;YAC1C,QAAQ;YACR,QAAQ;gBAAC;gBAAS;aAAS;QAC7B;QACA,MAAM,EACJ,QAAQ,EACT,GAAG,IAAI,CAAC,KAAK;QACd,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;QACxB,QAAQ,CAAC,QAAQ,GAAG;YAClB,SAAS,IAAA,uKAAU,EAAC;QACtB;QACA,IAAI,CAAC,MAAM,CAAC;YACV;QACF;IACF;IACA,MAAM,iCAAiC,SAAS,EAAE,uBAAuB,EAAE;QACzE,MAAM,cAAc,IAAI,2KAAQ,CAAC,yBAAyB,2NAAuB,EAAE,IAAI,CAAC,cAAc;QACtG,IAAI;YACF,MAAM,SAAS,MAAM,YAAY,QAAQ,CAAC,WAAW;gBAAC;aAAa;YACnE,MAAM,EACJ,QAAQ,EACT,GAAG,IAAI,CAAC,KAAK;YACd,UAAU,OAAO,CAAC,CAAC,SAAS;gBAC1B,MAAM,UAAU,IAAA,uKAAU,EAAC,MAAM,CAAC,MAAM;gBACxC,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;gBACxB,QAAQ,CAAC,QAAQ,GAAG;oBAClB;gBACF;YACF;YACA,OAAO,IAAI,CAAC,MAAM,CAAC;gBACjB;YACF;QACF,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,IAAI,CAAC,4DAA4D;YACrE,OAAO,QAAQ,GAAG,CAAC,UAAU,GAAG,CAAC,CAAA,IAAK,IAAI,CAAC,cAAc,CAAC;QAC5D;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 1481, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/AccountAbstractionController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { addHexPrefix } from '@ethereumjs/util';\nimport { BaseController, TransactionStatus } from '@toruslabs/base-controllers';\nimport { JRPCEngine, providerFromEngine } from '@web3auth/auth';\nimport { isHexString } from 'ethers';\nimport log from 'loglevel';\nimport { defineChain, createPublicClient, http, createWalletClient, custom, parseEther, toHex } from 'viem';\nimport { createPaymasterClient, createBundlerClient } from 'viem/account-abstraction';\n\nconst eoaInterceptorMiddleware = eoaAddress => (req, res, next, end) => {\n  req.isAAProviderRequest = true;\n  if (req.method === \"eth_accounts\" || req.method === \"eth_requestAccounts\") {\n    res.result = [eoaAddress];\n    end();\n    return;\n  }\n  next();\n};\nfunction eoaProviderAsMiddleware(provider) {\n  return async (req, res, _next, end) => {\n    // send request to provider\n    try {\n      const providerRes = await provider.request(req);\n      res.result = providerRes;\n      return end();\n    } catch (error) {\n      return end(error);\n    }\n  };\n}\nclass AccountAbstractionController extends BaseController {\n  constructor({\n    config,\n    state,\n    getProviderConfig,\n    onNetworkStateChange\n  }) {\n    super({\n      state,\n      config\n    });\n    _defineProperty(this, \"_smartAccount\", void 0);\n    _defineProperty(this, \"_publicClient\", void 0);\n    _defineProperty(this, \"_bundlerClient\", void 0);\n    _defineProperty(this, \"_paymasterClient\", void 0);\n    _defineProperty(this, \"getProviderConfig\", void 0);\n    this.initialize();\n    this.getProviderConfig = getProviderConfig;\n    // TODO: handle network change in torus controller & call setupProvider\n    onNetworkStateChange(networkState => {\n      if (networkState.chainId !== this.config.chainId) {\n        this.configure({\n          chainId: networkState.chainId\n        });\n      }\n    });\n  }\n  get smartAccount() {\n    return this._smartAccount;\n  }\n  get bundlerClient() {\n    return this._bundlerClient;\n  }\n  async setupProvider(eoaProvider, eoaAddress) {\n    const providerConfig = this.getProviderConfig();\n    const chain = defineChain({\n      id: Number.parseInt(providerConfig.chainId, 16),\n      // id in number form\n      name: providerConfig.displayName,\n      rpcUrls: {\n        default: {\n          http: [providerConfig.rpcTarget],\n          webSocket: [providerConfig.wsTarget]\n        }\n      },\n      blockExplorers: providerConfig.blockExplorerUrl ? {\n        default: {\n          name: \"explorer\",\n          // TODO: correct name if chain config has it\n          url: providerConfig.blockExplorerUrl\n        }\n      } : undefined,\n      nativeCurrency: {\n        name: providerConfig.tickerName,\n        symbol: providerConfig.ticker,\n        decimals: providerConfig.decimals || 18\n      }\n    });\n    this._publicClient = createPublicClient({\n      chain,\n      transport: http(providerConfig.rpcTarget)\n    });\n\n    // viem wallet client using json-rpc account from eoaProvider\n    const aaEngine = new JRPCEngine();\n    aaEngine.push(eoaInterceptorMiddleware(eoaAddress));\n    aaEngine.push(eoaProviderAsMiddleware(eoaProvider));\n    const provider = providerFromEngine(aaEngine);\n    // need to hoist the account address https://viem.sh/docs/clients/wallet#optional-hoist-the-account\n    const eoaWalletClient = createWalletClient({\n      account: eoaAddress,\n      chain,\n      transport: custom(provider)\n    });\n    this._smartAccount = await this.config.smartAccountInit.getSmartAccount({\n      walletClient: eoaWalletClient,\n      client: this._publicClient\n    });\n    if (this.config.paymasterConfig) {\n      this._paymasterClient = createPaymasterClient(_objectSpread(_objectSpread({}, this.config.paymasterConfig), {}, {\n        transport: custom(provider)\n      }));\n    }\n    this._bundlerClient = createBundlerClient(_objectSpread(_objectSpread({}, this.config.bundlerConfig), {}, {\n      account: this.smartAccount,\n      client: this._publicClient,\n      transport: custom(provider),\n      paymaster: this._paymasterClient\n    }));\n    log.info(\"check: this._smartAccount\", this.smartAccount.address);\n    this.update({\n      smartAccountAddress: this.smartAccount.address\n    });\n  }\n  async sendTransaction(id, tx, address) {\n    var _txParams$chainId, _txReceipt$receipt, _txReceipt$nonce, _txReceipt$receipt2, _txReceipt$receipt3, _txReceipt$receipt4;\n    if (address.toLowerCase() !== this.smartAccount.address.toLowerCase()) {\n      throw new Error(\"Invalid address\");\n    }\n    const txParams = tx;\n    // @ts-expect-error TODO: viem types are too deep\n    const userOperationParams = {\n      account: this.smartAccount,\n      calls: [{\n        to: txParams.to,\n        // Explicit conversation required to avoid value being passed as hex\n        value: txParams.value ? BigInt(txParams.value) : undefined,\n        data: txParams.data\n      }],\n      maxFeePerGas: txParams.maxFeePerGas ? BigInt(txParams.maxFeePerGas) : undefined,\n      maxPriorityFeePerGas: txParams.maxPriorityFeePerGas ? BigInt(txParams.maxPriorityFeePerGas) : undefined,\n      callGasLimit: txParams.callGasLimit ? BigInt(txParams.callGasLimit) : undefined,\n      preVerificationGas: txParams.preVerificationGas ? BigInt(txParams.preVerificationGas) : undefined,\n      verificationGasLimit: txParams.verificationGasLimit ? BigInt(txParams.verificationGasLimit) : undefined,\n      paymasterVerificationGasLimit: txParams.paymasterVerificationGasLimit ? BigInt(txParams.paymasterVerificationGasLimit) : undefined,\n      paymasterPostOpGasLimit: txParams.paymasterPostOpGasLimit ? BigInt(txParams.paymasterPostOpGasLimit) : undefined\n    };\n    const userOpMeta = {\n      transactionParams: txParams,\n      chainId: (_txParams$chainId = txParams.chainId) !== null && _txParams$chainId !== void 0 ? _txParams$chainId : this.getProviderConfig().chainId,\n      createdAt: new Date(),\n      status: TransactionStatus.approved\n    };\n    this.updateUserOpMeta(id, userOpMeta);\n    const userOpHash = await this.bundlerClient.sendUserOperation(userOperationParams);\n    this.updateUserOpMeta(id, {\n      userOpHash,\n      status: TransactionStatus.submitted\n    });\n    const txReceipt = await this.bundlerClient.waitForUserOperationReceipt({\n      hash: userOpHash\n    });\n    this.updateUserOpMeta(id, {\n      receipt: {\n        transactionHash: (_txReceipt$receipt = txReceipt.receipt) === null || _txReceipt$receipt === void 0 ? void 0 : _txReceipt$receipt.transactionHash,\n        nonce: (_txReceipt$nonce = txReceipt.nonce) === null || _txReceipt$nonce === void 0 ? void 0 : _txReceipt$nonce.toString(),\n        gasUsed: addHexPrefix((_txReceipt$receipt2 = txReceipt.receipt) === null || _txReceipt$receipt2 === void 0 || (_txReceipt$receipt2 = _txReceipt$receipt2.gasUsed) === null || _txReceipt$receipt2 === void 0 ? void 0 : _txReceipt$receipt2.toString(16)),\n        effectiveGasPrice: addHexPrefix((_txReceipt$receipt3 = txReceipt.receipt) === null || _txReceipt$receipt3 === void 0 || (_txReceipt$receipt3 = _txReceipt$receipt3.effectiveGasPrice) === null || _txReceipt$receipt3 === void 0 ? void 0 : _txReceipt$receipt3.toString(16)),\n        type: (_txReceipt$receipt4 = txReceipt.receipt) === null || _txReceipt$receipt4 === void 0 ? void 0 : _txReceipt$receipt4.type,\n        reason: txReceipt.reason\n      },\n      status: txReceipt.success ? TransactionStatus.confirmed : TransactionStatus.failed\n    });\n    return txReceipt.receipt.transactionHash;\n  }\n  async signTransaction(id, tx, address) {\n    var _txParams$chainId2;\n    if (address.toLowerCase() !== this.smartAccount.address.toLowerCase()) {\n      throw new Error(\"Invalid address\");\n    }\n    const txParams = tx;\n    const userOpMeta = {\n      transactionParams: txParams,\n      chainId: (_txParams$chainId2 = txParams.chainId) !== null && _txParams$chainId2 !== void 0 ? _txParams$chainId2 : this.getProviderConfig().chainId,\n      createdAt: new Date(),\n      status: TransactionStatus.approved\n    };\n    this.updateUserOpMeta(id, userOpMeta);\n    const request = await this.bundlerClient.prepareUserOperation({\n      account: this.smartAccount,\n      calls: [{\n        to: txParams.to,\n        // Explicit conversation required to avoid value being passed as hex\n        value: txParams.value ? BigInt(txParams.value) : undefined,\n        data: txParams.data\n      }],\n      maxFeePerGas: txParams.maxFeePerGas ? BigInt(txParams.maxFeePerGas) : undefined,\n      maxPriorityFeePerGas: txParams.maxPriorityFeePerGas ? BigInt(txParams.maxPriorityFeePerGas) : undefined,\n      callGasLimit: txParams.callGasLimit ? BigInt(txParams.callGasLimit) : undefined,\n      preVerificationGas: txParams.preVerificationGas ? BigInt(txParams.preVerificationGas) : undefined,\n      verificationGasLimit: txParams.verificationGasLimit ? BigInt(txParams.verificationGasLimit) : undefined,\n      paymasterVerificationGasLimit: txParams.paymasterVerificationGasLimit ? BigInt(txParams.paymasterVerificationGasLimit) : undefined,\n      paymasterPostOpGasLimit: txParams.paymasterPostOpGasLimit ? BigInt(txParams.paymasterPostOpGasLimit) : undefined\n    });\n    const signature = await this.smartAccount.signUserOperation(request);\n    this.updateUserOpMeta(id, {\n      signature,\n      status: TransactionStatus.signed\n    });\n    return signature;\n  }\n  async estimateGas(txParams, address) {\n    if (address.toLowerCase() !== this.smartAccount.address.toLowerCase()) throw new Error(\"Invalid address\");\n    const calls = [{\n      to: txParams.to,\n      value: txParams.value ? BigInt(txParams.value) : undefined,\n      data: txParams.data\n    }];\n    const maxFeePerGas = txParams.maxFeePerGas ? BigInt(txParams.maxFeePerGas) : undefined;\n    const maxPriorityFeePerGas = txParams.maxPriorityFeePerGas ? BigInt(txParams.maxPriorityFeePerGas) : undefined;\n\n    // estimate gas: maxFeePerGas and maxPriorityFeePerGas are not required\n    const estimateGasParams = {\n      account: this.smartAccount,\n      calls,\n      maxFeePerGas,\n      maxPriorityFeePerGas,\n      stateOverride: [\n      // override state to estimate gas for an ERC-20 transfer without causing a RPC error due to insufficient funds\n      // ref: https://docs.cometh.io/connect-4337/bundler/bundler-api/eth_estimateuseroperationgas#optional-state-override-set\n      {\n        address: this.smartAccount.address,\n        balance: parseEther(\"1\")\n      }]\n    };\n\n    // bundler only support factoryArgs for estimate user operation gas in entryPoint v0.7\n    let factoryArgs;\n    if (this.smartAccount.entryPoint.version !== \"0.6\") {\n      factoryArgs = await this.smartAccount.getFactoryArgs(); // will return undefined if smart account already deployed\n    }\n    if (factoryArgs) {\n      // using object spread here will cause type error because of viem's excessively deep types\n      // TODO: currently using single property assignment, check again when viem types are updated\n      if (factoryArgs.factory) {\n        estimateGasParams.factory = factoryArgs.factory;\n      }\n      if (factoryArgs.factoryData) {\n        estimateGasParams.factoryData = factoryArgs.factoryData;\n      }\n    }\n    const result = await this.bundlerClient.estimateUserOperationGas(estimateGasParams);\n    const gasData = {\n      callGasLimit: toHex(result.callGasLimit),\n      preVerificationGas: toHex(result.preVerificationGas),\n      verificationGasLimit: toHex(result.verificationGasLimit)\n    };\n    // NOTE: paymasterVerificationGasLimit and paymasterPostOpGasLimit are optional don't include it in the object otherwise bundler rpc call will throw error (depend on bundler)\n    if (result.paymasterVerificationGasLimit) {\n      gasData.paymasterVerificationGasLimit = toHex(result.paymasterVerificationGasLimit);\n    }\n    if (result.paymasterPostOpGasLimit) {\n      gasData.paymasterPostOpGasLimit = toHex(result.paymasterPostOpGasLimit);\n    }\n    return gasData;\n  }\n  async signMessage(message, address) {\n    if (address.toLowerCase() !== this.smartAccount.address.toLowerCase()) {\n      throw new Error(\"Invalid address\");\n    }\n    return this.smartAccount.sign({\n      hash: message\n    });\n  }\n  async signPersonalMessage(message, address) {\n    var _this$smartAccount;\n    if (address.toLowerCase() !== this.smartAccount.address.toLowerCase()) {\n      throw new Error(\"Invalid address\");\n    }\n    return (_this$smartAccount = this.smartAccount) === null || _this$smartAccount === void 0 ? void 0 : _this$smartAccount.signMessage({\n      message: isHexString(message) ? {\n        raw: message\n      } : message\n    });\n  }\n  async signTypedData(data, address) {\n    var _this$smartAccount2;\n    if (address.toLowerCase() !== this.smartAccount.address.toLowerCase()) {\n      throw new Error(\"Invalid address\");\n    }\n    return (_this$smartAccount2 = this.smartAccount) === null || _this$smartAccount2 === void 0 ? void 0 : _this$smartAccount2.signTypedData({\n      domain: _objectSpread(_objectSpread({}, data.domain), {}, {\n        verifyingContract: data.domain.verifyingContract,\n        salt: data.domain.salt,\n        chainId: Number(data.domain.chainId)\n      }),\n      primaryType: data.primaryType,\n      types: data.types,\n      message: data.message\n    });\n  }\n  updateUserOpMeta(id, data) {\n    const userOp = this.state.userOperations[id];\n    this.update({\n      userOperations: _objectSpread(_objectSpread({}, this.state.userOperations), {}, {\n        [id]: _objectSpread(_objectSpread({}, userOp), data)\n      })\n    });\n  }\n}\n\nexport { AccountAbstractionController, eoaInterceptorMiddleware, eoaProviderAsMiddleware };\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;;;;;;;;;;AAEA,MAAM,2BAA2B,CAAA,aAAc,CAAC,KAAK,KAAK,MAAM;QAC9D,IAAI,mBAAmB,GAAG;QAC1B,IAAI,IAAI,MAAM,KAAK,kBAAkB,IAAI,MAAM,KAAK,uBAAuB;YACzE,IAAI,MAAM,GAAG;gBAAC;aAAW;YACzB;YACA;QACF;QACA;IACF;AACA,SAAS,wBAAwB,QAAQ;IACvC,OAAO,OAAO,KAAK,KAAK,OAAO;QAC7B,2BAA2B;QAC3B,IAAI;YACF,MAAM,cAAc,MAAM,SAAS,OAAO,CAAC;YAC3C,IAAI,MAAM,GAAG;YACb,OAAO;QACT,EAAE,OAAO,OAAO;YACd,OAAO,IAAI;QACb;IACF;AACF;AACA,MAAM,qCAAqC,yQAAc;IACvD,YAAY,EACV,MAAM,EACN,KAAK,EACL,iBAAiB,EACjB,oBAAoB,EACrB,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,iBAAiB,KAAK;QAC5C,IAAA,oLAAe,EAAC,IAAI,EAAE,iBAAiB,KAAK;QAC5C,IAAA,oLAAe,EAAC,IAAI,EAAE,kBAAkB,KAAK;QAC7C,IAAA,oLAAe,EAAC,IAAI,EAAE,oBAAoB,KAAK;QAC/C,IAAA,oLAAe,EAAC,IAAI,EAAE,qBAAqB,KAAK;QAChD,IAAI,CAAC,UAAU;QACf,IAAI,CAAC,iBAAiB,GAAG;QACzB,uEAAuE;QACvE,qBAAqB,CAAA;YACnB,IAAI,aAAa,OAAO,KAAK,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBAChD,IAAI,CAAC,SAAS,CAAC;oBACb,SAAS,aAAa,OAAO;gBAC/B;YACF;QACF;IACF;IACA,IAAI,eAAe;QACjB,OAAO,IAAI,CAAC,aAAa;IAC3B;IACA,IAAI,gBAAgB;QAClB,OAAO,IAAI,CAAC,cAAc;IAC5B;IACA,MAAM,cAAc,WAAW,EAAE,UAAU,EAAE;QAC3C,MAAM,iBAAiB,IAAI,CAAC,iBAAiB;QAC7C,MAAM,QAAQ,IAAA,+KAAW,EAAC;YACxB,IAAI,OAAO,QAAQ,CAAC,eAAe,OAAO,EAAE;YAC5C,oBAAoB;YACpB,MAAM,eAAe,WAAW;YAChC,SAAS;gBACP,SAAS;oBACP,MAAM;wBAAC,eAAe,SAAS;qBAAC;oBAChC,WAAW;wBAAC,eAAe,QAAQ;qBAAC;gBACtC;YACF;YACA,gBAAgB,eAAe,gBAAgB,GAAG;gBAChD,SAAS;oBACP,MAAM;oBACN,4CAA4C;oBAC5C,KAAK,eAAe,gBAAgB;gBACtC;YACF,IAAI;YACJ,gBAAgB;gBACd,MAAM,eAAe,UAAU;gBAC/B,QAAQ,eAAe,MAAM;gBAC7B,UAAU,eAAe,QAAQ,IAAI;YACvC;QACF;QACA,IAAI,CAAC,aAAa,GAAG,IAAA,sLAAkB,EAAC;YACtC;YACA,WAAW,IAAA,wKAAI,EAAC,eAAe,SAAS;QAC1C;QAEA,6DAA6D;QAC7D,MAAM,WAAW,IAAI,yPAAU;QAC/B,SAAS,IAAI,CAAC,yBAAyB;QACvC,SAAS,IAAI,CAAC,wBAAwB;QACtC,MAAM,WAAW,IAAA,iQAAkB,EAAC;QACpC,mGAAmG;QACnG,MAAM,kBAAkB,IAAA,sLAAkB,EAAC;YACzC,SAAS;YACT;YACA,WAAW,IAAA,4KAAM,EAAC;QACpB;QACA,IAAI,CAAC,aAAa,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,eAAe,CAAC;YACtE,cAAc;YACd,QAAQ,IAAI,CAAC,aAAa;QAC5B;QACA,IAAI,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE;YAC/B,IAAI,CAAC,gBAAgB,GAAG,IAAA,sNAAqB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,GAAG,CAAC,GAAG;gBAC9G,WAAW,IAAA,4KAAM,EAAC;YACpB;QACF;QACA,IAAI,CAAC,cAAc,GAAG,IAAA,kNAAmB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,GAAG,CAAC,GAAG;YACxG,SAAS,IAAI,CAAC,YAAY;YAC1B,QAAQ,IAAI,CAAC,aAAa;YAC1B,WAAW,IAAA,4KAAM,EAAC;YAClB,WAAW,IAAI,CAAC,gBAAgB;QAClC;QACA,yJAAG,CAAC,IAAI,CAAC,6BAA6B,IAAI,CAAC,YAAY,CAAC,OAAO;QAC/D,IAAI,CAAC,MAAM,CAAC;YACV,qBAAqB,IAAI,CAAC,YAAY,CAAC,OAAO;QAChD;IACF;IACA,MAAM,gBAAgB,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE;QACrC,IAAI,mBAAmB,oBAAoB,kBAAkB,qBAAqB,qBAAqB;QACvG,IAAI,QAAQ,WAAW,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,IAAI;YACrE,MAAM,IAAI,MAAM;QAClB;QACA,MAAM,WAAW;QACjB,iDAAiD;QACjD,MAAM,sBAAsB;YAC1B,SAAS,IAAI,CAAC,YAAY;YAC1B,OAAO;gBAAC;oBACN,IAAI,SAAS,EAAE;oBACf,oEAAoE;oBACpE,OAAO,SAAS,KAAK,GAAG,OAAO,SAAS,KAAK,IAAI;oBACjD,MAAM,SAAS,IAAI;gBACrB;aAAE;YACF,cAAc,SAAS,YAAY,GAAG,OAAO,SAAS,YAAY,IAAI;YACtE,sBAAsB,SAAS,oBAAoB,GAAG,OAAO,SAAS,oBAAoB,IAAI;YAC9F,cAAc,SAAS,YAAY,GAAG,OAAO,SAAS,YAAY,IAAI;YACtE,oBAAoB,SAAS,kBAAkB,GAAG,OAAO,SAAS,kBAAkB,IAAI;YACxF,sBAAsB,SAAS,oBAAoB,GAAG,OAAO,SAAS,oBAAoB,IAAI;YAC9F,+BAA+B,SAAS,6BAA6B,GAAG,OAAO,SAAS,6BAA6B,IAAI;YACzH,yBAAyB,SAAS,uBAAuB,GAAG,OAAO,SAAS,uBAAuB,IAAI;QACzG;QACA,MAAM,aAAa;YACjB,mBAAmB;YACnB,SAAS,CAAC,oBAAoB,SAAS,OAAO,MAAM,QAAQ,sBAAsB,KAAK,IAAI,oBAAoB,IAAI,CAAC,iBAAiB,GAAG,OAAO;YAC/I,WAAW,IAAI;YACf,QAAQ,mSAAiB,CAAC,QAAQ;QACpC;QACA,IAAI,CAAC,gBAAgB,CAAC,IAAI;QAC1B,MAAM,aAAa,MAAM,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC;QAC9D,IAAI,CAAC,gBAAgB,CAAC,IAAI;YACxB;YACA,QAAQ,mSAAiB,CAAC,SAAS;QACrC;QACA,MAAM,YAAY,MAAM,IAAI,CAAC,aAAa,CAAC,2BAA2B,CAAC;YACrE,MAAM;QACR;QACA,IAAI,CAAC,gBAAgB,CAAC,IAAI;YACxB,SAAS;gBACP,iBAAiB,CAAC,qBAAqB,UAAU,OAAO,MAAM,QAAQ,uBAAuB,KAAK,IAAI,KAAK,IAAI,mBAAmB,eAAe;gBACjJ,OAAO,CAAC,mBAAmB,UAAU,KAAK,MAAM,QAAQ,qBAAqB,KAAK,IAAI,KAAK,IAAI,iBAAiB,QAAQ;gBACxH,SAAS,IAAA,yOAAY,EAAC,CAAC,sBAAsB,UAAU,OAAO,MAAM,QAAQ,wBAAwB,KAAK,KAAK,CAAC,sBAAsB,oBAAoB,OAAO,MAAM,QAAQ,wBAAwB,KAAK,IAAI,KAAK,IAAI,oBAAoB,QAAQ,CAAC;gBACrP,mBAAmB,IAAA,yOAAY,EAAC,CAAC,sBAAsB,UAAU,OAAO,MAAM,QAAQ,wBAAwB,KAAK,KAAK,CAAC,sBAAsB,oBAAoB,iBAAiB,MAAM,QAAQ,wBAAwB,KAAK,IAAI,KAAK,IAAI,oBAAoB,QAAQ,CAAC;gBACzQ,MAAM,CAAC,sBAAsB,UAAU,OAAO,MAAM,QAAQ,wBAAwB,KAAK,IAAI,KAAK,IAAI,oBAAoB,IAAI;gBAC9H,QAAQ,UAAU,MAAM;YAC1B;YACA,QAAQ,UAAU,OAAO,GAAG,mSAAiB,CAAC,SAAS,GAAG,mSAAiB,CAAC,MAAM;QACpF;QACA,OAAO,UAAU,OAAO,CAAC,eAAe;IAC1C;IACA,MAAM,gBAAgB,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE;QACrC,IAAI;QACJ,IAAI,QAAQ,WAAW,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,IAAI;YACrE,MAAM,IAAI,MAAM;QAClB;QACA,MAAM,WAAW;QACjB,MAAM,aAAa;YACjB,mBAAmB;YACnB,SAAS,CAAC,qBAAqB,SAAS,OAAO,MAAM,QAAQ,uBAAuB,KAAK,IAAI,qBAAqB,IAAI,CAAC,iBAAiB,GAAG,OAAO;YAClJ,WAAW,IAAI;YACf,QAAQ,mSAAiB,CAAC,QAAQ;QACpC;QACA,IAAI,CAAC,gBAAgB,CAAC,IAAI;QAC1B,MAAM,UAAU,MAAM,IAAI,CAAC,aAAa,CAAC,oBAAoB,CAAC;YAC5D,SAAS,IAAI,CAAC,YAAY;YAC1B,OAAO;gBAAC;oBACN,IAAI,SAAS,EAAE;oBACf,oEAAoE;oBACpE,OAAO,SAAS,KAAK,GAAG,OAAO,SAAS,KAAK,IAAI;oBACjD,MAAM,SAAS,IAAI;gBACrB;aAAE;YACF,cAAc,SAAS,YAAY,GAAG,OAAO,SAAS,YAAY,IAAI;YACtE,sBAAsB,SAAS,oBAAoB,GAAG,OAAO,SAAS,oBAAoB,IAAI;YAC9F,cAAc,SAAS,YAAY,GAAG,OAAO,SAAS,YAAY,IAAI;YACtE,oBAAoB,SAAS,kBAAkB,GAAG,OAAO,SAAS,kBAAkB,IAAI;YACxF,sBAAsB,SAAS,oBAAoB,GAAG,OAAO,SAAS,oBAAoB,IAAI;YAC9F,+BAA+B,SAAS,6BAA6B,GAAG,OAAO,SAAS,6BAA6B,IAAI;YACzH,yBAAyB,SAAS,uBAAuB,GAAG,OAAO,SAAS,uBAAuB,IAAI;QACzG;QACA,MAAM,YAAY,MAAM,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC;QAC5D,IAAI,CAAC,gBAAgB,CAAC,IAAI;YACxB;YACA,QAAQ,mSAAiB,CAAC,MAAM;QAClC;QACA,OAAO;IACT;IACA,MAAM,YAAY,QAAQ,EAAE,OAAO,EAAE;QACnC,IAAI,QAAQ,WAAW,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,IAAI,MAAM,IAAI,MAAM;QACvF,MAAM,QAAQ;YAAC;gBACb,IAAI,SAAS,EAAE;gBACf,OAAO,SAAS,KAAK,GAAG,OAAO,SAAS,KAAK,IAAI;gBACjD,MAAM,SAAS,IAAI;YACrB;SAAE;QACF,MAAM,eAAe,SAAS,YAAY,GAAG,OAAO,SAAS,YAAY,IAAI;QAC7E,MAAM,uBAAuB,SAAS,oBAAoB,GAAG,OAAO,SAAS,oBAAoB,IAAI;QAErG,uEAAuE;QACvE,MAAM,oBAAoB;YACxB,SAAS,IAAI,CAAC,YAAY;YAC1B;YACA;YACA;YACA,eAAe;gBACf,8GAA8G;gBAC9G,wHAAwH;gBACxH;oBACE,SAAS,IAAI,CAAC,YAAY,CAAC,OAAO;oBAClC,SAAS,IAAA,4KAAU,EAAC;gBACtB;aAAE;QACJ;QAEA,sFAAsF;QACtF,IAAI;QACJ,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,KAAK,OAAO;YAClD,cAAc,MAAM,IAAI,CAAC,YAAY,CAAC,cAAc,IAAI,0DAA0D;QACpH;QACA,IAAI,aAAa;YACf,0FAA0F;YAC1F,4FAA4F;YAC5F,IAAI,YAAY,OAAO,EAAE;gBACvB,kBAAkB,OAAO,GAAG,YAAY,OAAO;YACjD;YACA,IAAI,YAAY,WAAW,EAAE;gBAC3B,kBAAkB,WAAW,GAAG,YAAY,WAAW;YACzD;QACF;QACA,MAAM,SAAS,MAAM,IAAI,CAAC,aAAa,CAAC,wBAAwB,CAAC;QACjE,MAAM,UAAU;YACd,cAAc,IAAA,sKAAK,EAAC,OAAO,YAAY;YACvC,oBAAoB,IAAA,sKAAK,EAAC,OAAO,kBAAkB;YACnD,sBAAsB,IAAA,sKAAK,EAAC,OAAO,oBAAoB;QACzD;QACA,8KAA8K;QAC9K,IAAI,OAAO,6BAA6B,EAAE;YACxC,QAAQ,6BAA6B,GAAG,IAAA,sKAAK,EAAC,OAAO,6BAA6B;QACpF;QACA,IAAI,OAAO,uBAAuB,EAAE;YAClC,QAAQ,uBAAuB,GAAG,IAAA,sKAAK,EAAC,OAAO,uBAAuB;QACxE;QACA,OAAO;IACT;IACA,MAAM,YAAY,OAAO,EAAE,OAAO,EAAE;QAClC,IAAI,QAAQ,WAAW,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,IAAI;YACrE,MAAM,IAAI,MAAM;QAClB;QACA,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YAC5B,MAAM;QACR;IACF;IACA,MAAM,oBAAoB,OAAO,EAAE,OAAO,EAAE;QAC1C,IAAI;QACJ,IAAI,QAAQ,WAAW,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,IAAI;YACrE,MAAM,IAAI,MAAM;QAClB;QACA,OAAO,CAAC,qBAAqB,IAAI,CAAC,YAAY,MAAM,QAAQ,uBAAuB,KAAK,IAAI,KAAK,IAAI,mBAAmB,WAAW,CAAC;YAClI,SAAS,IAAA,uKAAW,EAAC,WAAW;gBAC9B,KAAK;YACP,IAAI;QACN;IACF;IACA,MAAM,cAAc,IAAI,EAAE,OAAO,EAAE;QACjC,IAAI;QACJ,IAAI,QAAQ,WAAW,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,IAAI;YACrE,MAAM,IAAI,MAAM;QAClB;QACA,OAAO,CAAC,sBAAsB,IAAI,CAAC,YAAY,MAAM,QAAQ,wBAAwB,KAAK,IAAI,KAAK,IAAI,oBAAoB,aAAa,CAAC;YACvI,QAAQ,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,KAAK,MAAM,GAAG,CAAC,GAAG;gBACxD,mBAAmB,KAAK,MAAM,CAAC,iBAAiB;gBAChD,MAAM,KAAK,MAAM,CAAC,IAAI;gBACtB,SAAS,OAAO,KAAK,MAAM,CAAC,OAAO;YACrC;YACA,aAAa,KAAK,WAAW;YAC7B,OAAO,KAAK,KAAK;YACjB,SAAS,KAAK,OAAO;QACvB;IACF;IACA,iBAAiB,EAAE,EAAE,IAAI,EAAE;QACzB,MAAM,SAAS,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,GAAG;QAC5C,IAAI,CAAC,MAAM,CAAC;YACV,gBAAgB,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,GAAG,CAAC,GAAG;gBAC9E,CAAC,GAAG,EAAE,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,SAAS;YACjD;QACF;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 1827, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Block/PollingBlockTracker.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseBlockTracker, PollingManager, timeout } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\n\nconst DEFAULT_POLLING_INTERVAL = 20;\nconst DEFAULT_RETRY_TIMEOUT = 2;\nconst SEC = 1000;\nclass PollingBlockTracker extends BaseBlockTracker {\n  constructor({\n    config,\n    state = {},\n    idleTimeTracker\n  }) {\n    if (!config.provider) {\n      throw new Error(\"PollingBlockTracker - no provider specified.\");\n    }\n    if (!idleTimeTracker) {\n      throw new Error(\"PollingBlockTracker - no idleTimeTracker specified.\");\n    }\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"pollingManager\", void 0);\n    const pollingInterval = config.pollingInterval || DEFAULT_POLLING_INTERVAL;\n    const retryTimeout = config.retryTimeout || DEFAULT_RETRY_TIMEOUT;\n\n    // merge default + provided config.\n    this.defaultConfig = {\n      provider: config.provider,\n      pollingInterval: pollingInterval * SEC,\n      retryTimeout: retryTimeout * SEC,\n      setSkipCacheFlag: config.setSkipCacheFlag || false\n    };\n    this.initialize();\n    this.pollingManager = new PollingManager(idleTimeTracker, pollingInterval);\n  }\n  async checkForLatestBlock() {\n    await this._updateLatestBlock();\n    return this.getLatestBlock();\n  }\n\n  // overrides the BaseBlockTracker._start method.\n  _start() {\n    this.pollingManager.start(async () => {\n      await this._synchronize().catch(err => {\n        this.emit(\"error\", err);\n      });\n    });\n  }\n  _end() {\n    this.pollingManager.stop();\n  }\n  async _synchronize() {\n    try {\n      await this._updateLatestBlock();\n    } catch (err) {\n      const newErr = new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\\n${err.stack}`);\n      try {\n        this.emit(\"error\", newErr);\n      } catch {\n        log.error(newErr);\n      }\n      await timeout(this.config.retryTimeout);\n    }\n  }\n  async _updateLatestBlock() {\n    // fetch + set latest block\n    const latestBlock = await this._fetchLatestBlock();\n    this._newPotentialLatest(latestBlock);\n  }\n  async _fetchLatestBlock() {\n    try {\n      const block = await this.config.provider.request({\n        method: \"eth_getBlockByNumber\",\n        params: [\"latest\", false]\n      });\n      return {\n        blockHash: block.hash,\n        idempotencyKey: block.number,\n        timestamp: block.timestamp,\n        baseFeePerGas: block.baseFeePerGas,\n        gasLimit: block.gasLimit\n      };\n    } catch (error) {\n      log.error(\"Polling Block Tracker: \", error);\n      throw new Error(`PollingBlockTracker - encountered error fetching block:\\n${error.message}`);\n    }\n  }\n}\n\nexport { PollingBlockTracker };\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AAAA;AACA;;;;AAEA,MAAM,2BAA2B;AACjC,MAAM,wBAAwB;AAC9B,MAAM,MAAM;AACZ,MAAM,4BAA4B,sRAAgB;IAChD,YAAY,EACV,MAAM,EACN,QAAQ,CAAC,CAAC,EACV,eAAe,EAChB,CAAE;QACD,IAAI,CAAC,OAAO,QAAQ,EAAE;YACpB,MAAM,IAAI,MAAM;QAClB;QACA,IAAI,CAAC,iBAAiB;YACpB,MAAM,IAAI,MAAM;QAClB;QACA,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,kBAAkB,KAAK;QAC7C,MAAM,kBAAkB,OAAO,eAAe,IAAI;QAClD,MAAM,eAAe,OAAO,YAAY,IAAI;QAE5C,mCAAmC;QACnC,IAAI,CAAC,aAAa,GAAG;YACnB,UAAU,OAAO,QAAQ;YACzB,iBAAiB,kBAAkB;YACnC,cAAc,eAAe;YAC7B,kBAAkB,OAAO,gBAAgB,IAAI;QAC/C;QACA,IAAI,CAAC,UAAU;QACf,IAAI,CAAC,cAAc,GAAG,IAAI,kRAAc,CAAC,iBAAiB;IAC5D;IACA,MAAM,sBAAsB;QAC1B,MAAM,IAAI,CAAC,kBAAkB;QAC7B,OAAO,IAAI,CAAC,cAAc;IAC5B;IAEA,gDAAgD;IAChD,SAAS;QACP,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC;YACxB,MAAM,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,CAAA;gBAC9B,IAAI,CAAC,IAAI,CAAC,SAAS;YACrB;QACF;IACF;IACA,OAAO;QACL,IAAI,CAAC,cAAc,CAAC,IAAI;IAC1B;IACA,MAAM,eAAe;QACnB,IAAI;YACF,MAAM,IAAI,CAAC,kBAAkB;QAC/B,EAAE,OAAO,KAAK;YACZ,MAAM,SAAS,IAAI,MAAM,CAAC,qFAAqF,EAAE,IAAI,KAAK,EAAE;YAC5H,IAAI;gBACF,IAAI,CAAC,IAAI,CAAC,SAAS;YACrB,EAAE,OAAM;gBACN,yJAAG,CAAC,KAAK,CAAC;YACZ;YACA,MAAM,IAAA,kQAAO,EAAC,IAAI,CAAC,MAAM,CAAC,YAAY;QACxC;IACF;IACA,MAAM,qBAAqB;QACzB,2BAA2B;QAC3B,MAAM,cAAc,MAAM,IAAI,CAAC,iBAAiB;QAChD,IAAI,CAAC,mBAAmB,CAAC;IAC3B;IACA,MAAM,oBAAoB;QACxB,IAAI;YACF,MAAM,QAAQ,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC;gBAC/C,QAAQ;gBACR,QAAQ;oBAAC;oBAAU;iBAAM;YAC3B;YACA,OAAO;gBACL,WAAW,MAAM,IAAI;gBACrB,gBAAgB,MAAM,MAAM;gBAC5B,WAAW,MAAM,SAAS;gBAC1B,eAAe,MAAM,aAAa;gBAClC,UAAU,MAAM,QAAQ;YAC1B;QACF,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC,2BAA2B;YACrC,MAAM,IAAI,MAAM,CAAC,yDAAyD,EAAE,MAAM,OAAO,EAAE;QAC7F;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 1927, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Currency/CurrencyController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseCurrencyController, PollingManager } from '@toruslabs/base-controllers';\nimport { get } from '@toruslabs/http-helpers';\nimport log from 'loglevel';\n\nclass CurrencyController extends BaseCurrencyController {\n  constructor({\n    config,\n    state,\n    idleTimeTracker,\n    onNetworkChanged\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"pollingManager\", void 0);\n    this.defaultState = _objectSpread(_objectSpread({}, this.defaultState), {}, {\n      commonDenomination: \"USD\",\n      commonDenominatorPrice: 0\n    });\n    this.initialize();\n    onNetworkChanged(networkState => {\n      // to be called as (listener) => this.networkController.on('networkDidChange', listener);\n      if (networkState.providerConfig.ticker.toUpperCase() !== this.state.nativeCurrency.toUpperCase()) {\n        this.setNativeCurrency(networkState.providerConfig.ticker);\n        this.updateConversionRate();\n      }\n    });\n    this.pollingManager = new PollingManager(idleTimeTracker, this.config.pollInterval);\n  }\n  setCommonDenomination(commonDenomination) {\n    this.update({\n      commonDenomination\n    });\n  }\n  getCommonDenomination() {\n    return this.state.commonDenomination;\n  }\n  setCommonDenominatorPrice(commonDenominatorPrice) {\n    this.update({\n      commonDenominatorPrice\n    });\n  }\n  getCommonDenominatorPrice() {\n    return this.state.commonDenominatorPrice;\n  }\n\n  /**\n   * Creates a new poll, using setInterval, to periodically call updateConversionRate. The id of the interval is\n   * stored at the controller's conversionInterval property. If it is called and such an id already exists, the\n   * previous interval is clear and a new one is created.\n   */\n  async scheduleConversionInterval() {\n    this.pollingManager.start(this.updateConversionRate.bind(this));\n  }\n\n  /**\n   * Updates the conversionRate and conversionDate properties associated with the currentCurrency. Updated info is\n   * fetched from an external API\n   */\n  async updateConversionRate() {\n    const currentCurrency = this.getCurrentCurrency();\n    const nativeCurrency = this.getNativeCurrency();\n    const commonDenomination = this.getCommonDenomination();\n    const conversionRate = await this.retrieveConversionRate(nativeCurrency, currentCurrency, commonDenomination);\n    const currentCurrencyRate = Number.parseFloat(conversionRate[currentCurrency.toUpperCase()]);\n    const commonDenominationRate = Number.parseFloat(conversionRate[commonDenomination.toUpperCase()]);\n    // set conversion rate\n    if (currentCurrencyRate || commonDenominationRate) {\n      // ETC\n      this.setConversionRate(currentCurrencyRate);\n      this.setConversionDate(Math.floor(Date.now() / 1000).toString());\n      if (currentCurrency.toUpperCase() === commonDenomination.toUpperCase()) {\n        this.setCommonDenominatorPrice(currentCurrencyRate);\n      } else {\n        this.setCommonDenominatorPrice(commonDenominationRate);\n      }\n    } else {\n      this.setConversionRate(0);\n      this.setConversionDate(\"N/A\");\n    }\n  }\n  async retrieveConversionRate(fromCurrency, toCurrency, commonDenomination) {\n    try {\n      let apiUrl = `${this.config.api}/currency?fsym=${fromCurrency.toUpperCase()}&tsyms=${toCurrency.toUpperCase()}`;\n      if (commonDenomination && commonDenomination.toUpperCase() !== toCurrency.toUpperCase()) {\n        apiUrl += `,${commonDenomination.toUpperCase()}`;\n      }\n      const parsedResponse = await get(apiUrl);\n      return parsedResponse;\n    } catch (error) {\n      log.error(error, `CurrencyController - updateCommonDenominatorPrice: Failed to query rate for currency: ${fromCurrency}/ ${toCurrency}`);\n    }\n    return {\n      [toCurrency.toUpperCase()]: \"0\",\n      [commonDenomination.toUpperCase()]: \"0\"\n    };\n  }\n}\n\nexport { CurrencyController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2033, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/utils/conversionUtils.js"],"sourcesContent":["import _objectDestructuringEmpty from '@babel/runtime/helpers/objectDestructuringEmpty';\nimport _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport { stripHexPrefix } from '@ethereumjs/util';\nimport { BigNumber } from 'bignumber.js';\nimport BN from 'bn.js';\n\nconst _excluded = [\"aBase\", \"bBase\"],\n  _excluded2 = [\"aBase\", \"bBase\"],\n  _excluded3 = [\"multiplicandBase\", \"multiplierBase\"];\n\n// Big Number Constants\nconst BIG_NUMBER_WEI_MULTIPLIER = new BigNumber(\"1000000000000000000\");\nconst BIG_NUMBER_GWEI_MULTIPLIER = new BigNumber(\"1000000000\");\nconst BIG_NUMBER_ETH_MULTIPLIER = new BigNumber(\"1\");\n// Setter Maps\nconst toBigNumber = {\n  hex: n => new BigNumber(stripHexPrefix(n), 16),\n  dec: n => new BigNumber(String(n), 10),\n  BN: n => new BigNumber(n.toString(16), 16)\n};\nconst toNormalizedDenomination = {\n  WEI: bigNumber => bigNumber.div(BIG_NUMBER_WEI_MULTIPLIER),\n  GWEI: bigNumber => bigNumber.div(BIG_NUMBER_GWEI_MULTIPLIER),\n  ETH: bigNumber => bigNumber.div(BIG_NUMBER_ETH_MULTIPLIER)\n};\nconst toSpecifiedDenomination = {\n  WEI: bigNumber => bigNumber.times(BIG_NUMBER_WEI_MULTIPLIER).dp(0, BigNumber.ROUND_HALF_UP),\n  GWEI: bigNumber => bigNumber.times(BIG_NUMBER_GWEI_MULTIPLIER).dp(9, BigNumber.ROUND_HALF_UP),\n  ETH: bigNumber => bigNumber.times(BIG_NUMBER_ETH_MULTIPLIER).dp(9, BigNumber.ROUND_HALF_UP)\n};\nconst baseChange = {\n  hex: n => n.toString(16),\n  dec: n => new BigNumber(n).toString(10),\n  BN: n => new BN(n.toString(16))\n};\n\n// Utility function for checking base types\nconst isValidBase = base => Number.isInteger(base) && base > 1;\n\n/**\n * Utility method to convert a value between denominations, formats and currencies.\n */\nconst converter = ({\n  value,\n  fromNumericBase,\n  fromDenomination,\n  fromCurrency,\n  toNumericBase,\n  toDenomination,\n  toCurrency,\n  numberOfDecimals,\n  conversionRate,\n  invertConversionRate,\n  roundDown\n}) => {\n  let convertedValue = fromNumericBase ? toBigNumber[fromNumericBase](value) : value;\n  if (fromDenomination) {\n    convertedValue = toNormalizedDenomination[fromDenomination](convertedValue);\n  }\n  if (fromCurrency !== toCurrency) {\n    if (conversionRate === null || conversionRate === undefined) {\n      throw new Error(`Converting from ${fromCurrency} to ${toCurrency} requires a conversionRate, but one was not provided`);\n    }\n    let rate = toBigNumber.dec(conversionRate);\n    if (invertConversionRate) {\n      rate = new BigNumber(1).div(conversionRate);\n    }\n    convertedValue = convertedValue.times(rate);\n  }\n  if (toDenomination) {\n    convertedValue = toSpecifiedDenomination[toDenomination](convertedValue);\n  }\n  if (numberOfDecimals) {\n    convertedValue = convertedValue.dp(numberOfDecimals, BigNumber.ROUND_HALF_DOWN);\n  }\n  if (roundDown) {\n    convertedValue = convertedValue.dp(roundDown, BigNumber.ROUND_DOWN);\n  }\n  if (toNumericBase) {\n    convertedValue = baseChange[toNumericBase](convertedValue);\n  }\n  return convertedValue;\n};\nconst conversionUtil = (value, {\n  fromCurrency = null,\n  toCurrency = fromCurrency,\n  fromNumericBase,\n  toNumericBase,\n  fromDenomination,\n  toDenomination,\n  numberOfDecimals,\n  conversionRate,\n  invertConversionRate\n}) => {\n  if (fromCurrency !== toCurrency && !conversionRate) {\n    return 0;\n  }\n  return converter({\n    fromCurrency,\n    toCurrency,\n    fromNumericBase,\n    toNumericBase,\n    fromDenomination,\n    toDenomination,\n    numberOfDecimals,\n    conversionRate,\n    invertConversionRate,\n    value\n  });\n};\nconst getBigNumber = (value, base) => {\n  if (!isValidBase(base)) {\n    throw new Error(\"Must specificy valid base\");\n  }\n\n  // We don't include 'number' here, because BigNumber will throw if passed\n  // a number primitive it considers unsafe.\n  if (typeof value === \"string\" || value instanceof BigNumber) {\n    return new BigNumber(value, base);\n  }\n  return new BigNumber(String(value), base);\n};\nconst addCurrencies = (a, b, options = {}) => {\n  const {\n      aBase,\n      bBase\n    } = options,\n    conversionOptions = _objectWithoutProperties(options, _excluded);\n  if (!isValidBase(aBase) || !isValidBase(bBase)) {\n    throw new Error(\"Must specify valid aBase and bBase\");\n  }\n  const value = getBigNumber(a, aBase).plus(getBigNumber(b, bBase));\n  return converter(_objectSpread({\n    value\n  }, conversionOptions));\n};\nconst subtractCurrencies = (a, b, options = {}) => {\n  const {\n      aBase,\n      bBase\n    } = options,\n    conversionOptions = _objectWithoutProperties(options, _excluded2);\n  if (!isValidBase(aBase) || !isValidBase(bBase)) {\n    throw new Error(\"Must specify valid aBase and bBase\");\n  }\n  const value = getBigNumber(a, aBase).minus(getBigNumber(b, bBase));\n  return converter(_objectSpread({\n    value\n  }, conversionOptions));\n};\nconst multiplyCurrencies = (a, b, options = {}) => {\n  const {\n      multiplicandBase,\n      multiplierBase\n    } = options,\n    conversionOptions = _objectWithoutProperties(options, _excluded3);\n  if (!isValidBase(multiplicandBase) || !isValidBase(multiplierBase)) {\n    throw new Error(\"Must specify valid multiplicandBase and multiplierBase\");\n  }\n  const value = getBigNumber(a, multiplicandBase).times(getBigNumber(b, multiplierBase));\n  return converter(_objectSpread({\n    value\n  }, conversionOptions));\n};\nconst conversionGreaterThan = (_ref, _ref2) => {\n  let secondProps = Object.assign({}, (_objectDestructuringEmpty(_ref2), _ref2));\n  let firstProps = Object.assign({}, (_objectDestructuringEmpty(_ref), _ref));\n  const firstValue = converter(_objectSpread({}, firstProps));\n  const secondValue = converter(_objectSpread({}, secondProps));\n  return firstValue.gt(secondValue);\n};\nconst conversionLessThan = (_ref3, _ref4) => {\n  let secondProps = Object.assign({}, (_objectDestructuringEmpty(_ref4), _ref4));\n  let firstProps = Object.assign({}, (_objectDestructuringEmpty(_ref3), _ref3));\n  const firstValue = converter(_objectSpread({}, firstProps));\n  const secondValue = converter(_objectSpread({}, secondProps));\n  return firstValue.lt(secondValue);\n};\nconst conversionMax = (_ref5, _ref6) => {\n  let secondProps = Object.assign({}, (_objectDestructuringEmpty(_ref6), _ref6));\n  let firstProps = Object.assign({}, (_objectDestructuringEmpty(_ref5), _ref5));\n  const firstIsGreater = conversionGreaterThan(_objectSpread({}, firstProps), _objectSpread({}, secondProps));\n  return firstIsGreater ? firstProps.value : secondProps.value;\n};\nconst conversionGTE = (_ref7, _ref8) => {\n  let secondProps = Object.assign({}, (_objectDestructuringEmpty(_ref8), _ref8));\n  let firstProps = Object.assign({}, (_objectDestructuringEmpty(_ref7), _ref7));\n  const firstValue = converter(_objectSpread({}, firstProps));\n  const secondValue = converter(_objectSpread({}, secondProps));\n  return firstValue.isGreaterThanOrEqualTo(secondValue);\n};\nconst conversionLTE = (_ref9, _ref0) => {\n  let secondProps = Object.assign({}, (_objectDestructuringEmpty(_ref0), _ref0));\n  let firstProps = Object.assign({}, (_objectDestructuringEmpty(_ref9), _ref9));\n  const firstValue = converter(_objectSpread({}, firstProps));\n  const secondValue = converter(_objectSpread({}, secondProps));\n  return firstValue.isLessThanOrEqualTo(secondValue);\n};\nconst toNegative = (n, options = {}) => multiplyCurrencies(n, -1, options);\nconst decGWEIToHexWEI = decGWEI => {\n  return conversionUtil(decGWEI, {\n    fromNumericBase: \"dec\",\n    toNumericBase: \"hex\",\n    fromDenomination: \"GWEI\",\n    toDenomination: \"WEI\"\n  });\n};\nconst hexWEIToDecGWEI = decGWEI => {\n  return conversionUtil(decGWEI, {\n    fromNumericBase: \"hex\",\n    toNumericBase: \"dec\",\n    fromDenomination: \"WEI\",\n    toDenomination: \"GWEI\"\n  });\n};\n\nexport { addCurrencies, conversionGTE, conversionGreaterThan, conversionLTE, conversionLessThan, conversionMax, conversionUtil, decGWEIToHexWEI, getBigNumber, hexWEIToDecGWEI, multiplyCurrencies, subtractCurrencies, toNegative };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2256, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Gas/gasUtil.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport { get } from '@toruslabs/http-helpers';\nimport { BigNumber } from 'bignumber.js';\nimport { METHOD_TYPES } from '../utils/constants.js';\nimport { hexWEIToDecGWEI, decGWEIToHexWEI } from '../utils/conversionUtils.js';\n\nfunction normalizeGWEIDecimalNumbers(n) {\n  const numberAsWEIHex = decGWEIToHexWEI(new BigNumber(n));\n  const numberAsGWEI = hexWEIToDecGWEI(numberAsWEIHex);\n  return numberAsGWEI;\n}\nasync function fetchGasEstimates(url) {\n  const estimates = await get(url);\n  const normalizedEstimates = {\n    estimatedBaseFee: normalizeGWEIDecimalNumbers(estimates.estimatedBaseFee).toString(10),\n    low: _objectSpread(_objectSpread({}, estimates.low), {}, {\n      suggestedMaxPriorityFeePerGas: normalizeGWEIDecimalNumbers(estimates.low.suggestedMaxPriorityFeePerGas).toString(10),\n      suggestedMaxFeePerGas: normalizeGWEIDecimalNumbers(estimates.low.suggestedMaxFeePerGas).toString(10)\n    }),\n    medium: _objectSpread(_objectSpread({}, estimates.medium), {}, {\n      suggestedMaxPriorityFeePerGas: normalizeGWEIDecimalNumbers(estimates.medium.suggestedMaxPriorityFeePerGas).toString(10),\n      suggestedMaxFeePerGas: normalizeGWEIDecimalNumbers(estimates.medium.suggestedMaxFeePerGas).toString(10)\n    }),\n    high: _objectSpread(_objectSpread({}, estimates.high), {}, {\n      suggestedMaxPriorityFeePerGas: normalizeGWEIDecimalNumbers(estimates.high.suggestedMaxPriorityFeePerGas).toString(10),\n      suggestedMaxFeePerGas: normalizeGWEIDecimalNumbers(estimates.high.suggestedMaxFeePerGas).toString(10)\n    })\n  };\n  return normalizedEstimates;\n}\nasync function fetchGasEstimatesViaEthFeeHistory(provider) {\n  const noOfBlocks = 10;\n  const newestBlock = \"latest\";\n  // get the 10, 50 and 95th percentile of the tip fees from the last 10 blocks\n  const percentileValues = [10, 50, 95];\n  const feeHistory = await provider.request({\n    method: \"eth_feeHistory\",\n    params: [noOfBlocks, newestBlock, percentileValues]\n  });\n  // this is in hex wei\n  const finalBaseFeePerGas = feeHistory.baseFeePerGas[feeHistory.baseFeePerGas.length - 1];\n  // this is in hex wei\n  const rewardList = feeHistory.reward.filter(reward => reward[0] !== \"0x0\" || reward[1] !== \"0x0\" || reward[2] !== \"0x0\");\n  let priorityFeeCalcs;\n  let numberOfRewards;\n  if (rewardList.length > 0) {\n    priorityFeeCalcs = rewardList.reduce((acc, curr) => {\n      return {\n        slow: acc.slow.plus(new BigNumber(curr[0], 16)),\n        average: acc.average.plus(new BigNumber(curr[1], 16)),\n        fast: acc.fast.plus(new BigNumber(curr[2], 16))\n      };\n    }, {\n      slow: new BigNumber(0),\n      average: new BigNumber(0),\n      fast: new BigNumber(0)\n    });\n    numberOfRewards = rewardList.length;\n  } else {\n    // fallback to eth_maxPriorityFeePerGas if there are no rewards\n    const maxPriorityFeePerGasResult = await provider.request({\n      method: \"eth_maxPriorityFeePerGas\"\n    });\n    const maxPriorityFeePerGas = new BigNumber(maxPriorityFeePerGasResult, 16);\n    priorityFeeCalcs = {\n      slow: maxPriorityFeePerGas,\n      average: maxPriorityFeePerGas.multipliedBy(1.1),\n      fast: maxPriorityFeePerGas.multipliedBy(1.5)\n    };\n    numberOfRewards = 1;\n  }\n  return {\n    estimatedBaseFee: hexWEIToDecGWEI(finalBaseFeePerGas).toString(10),\n    high: {\n      maxWaitTimeEstimate: 30000,\n      minWaitTimeEstimate: 15000,\n      suggestedMaxFeePerGas: hexWEIToDecGWEI(priorityFeeCalcs.fast.div(numberOfRewards).plus(finalBaseFeePerGas).toString(16)).toString(),\n      suggestedMaxPriorityFeePerGas: hexWEIToDecGWEI(priorityFeeCalcs.fast.div(numberOfRewards).toString(16)).toString()\n    },\n    medium: {\n      maxWaitTimeEstimate: 45000,\n      minWaitTimeEstimate: 15000,\n      suggestedMaxFeePerGas: hexWEIToDecGWEI(priorityFeeCalcs.average.div(numberOfRewards).plus(finalBaseFeePerGas).toString(16)).toString(),\n      suggestedMaxPriorityFeePerGas: hexWEIToDecGWEI(priorityFeeCalcs.average.div(numberOfRewards).toString(16)).toString()\n    },\n    low: {\n      maxWaitTimeEstimate: 60000,\n      minWaitTimeEstimate: 15000,\n      suggestedMaxFeePerGas: hexWEIToDecGWEI(priorityFeeCalcs.slow.div(numberOfRewards).plus(finalBaseFeePerGas).toString(16)).toString(),\n      suggestedMaxPriorityFeePerGas: hexWEIToDecGWEI(priorityFeeCalcs.slow.div(numberOfRewards).toString(16)).toString()\n    }\n  };\n}\n\n/**\n * Hit the legacy MetaSwaps gasPrices estimate api and return the low, medium\n * high values from that API.\n */\nasync function fetchLegacyGasPriceEstimates(url) {\n  const result = await get(url, {\n    referrer: url,\n    referrerPolicy: \"no-referrer-when-downgrade\",\n    method: \"GET\"\n  });\n  // this returns decimal gwei\n  return {\n    low: result.SafeGasPrice,\n    medium: result.ProposeGasPrice,\n    high: result.FastGasPrice\n  };\n}\nasync function fetchEthGasPriceEstimate(provider) {\n  const gasPrice = await provider.request({\n    method: METHOD_TYPES.ETH_GET_GAS_PRICE\n  });\n  return {\n    gasPrice: hexWEIToDecGWEI(gasPrice).toString()\n  };\n}\nfunction calculateTimeEstimate(maxPriorityFeePerGas, maxFeePerGas, gasFeeEstimates) {\n  // all are in dec gwei\n  const {\n    low,\n    medium,\n    high,\n    estimatedBaseFee\n  } = gasFeeEstimates;\n  const maxPriorityFeePerGasInWEI = new BigNumber(decGWEIToHexWEI(new BigNumber(maxPriorityFeePerGas)), 16);\n  const maxFeePerGasInWEI = new BigNumber(decGWEIToHexWEI(new BigNumber(maxFeePerGas)), 16);\n  const estimatedBaseFeeInWEI = new BigNumber(decGWEIToHexWEI(new BigNumber(estimatedBaseFee)), 16);\n  const effectiveMaxPriorityFee = BigNumber.min(maxPriorityFeePerGasInWEI, maxFeePerGasInWEI.minus(estimatedBaseFeeInWEI));\n  const lowMaxPriorityFeeInWEI = new BigNumber(decGWEIToHexWEI(new BigNumber(low.suggestedMaxPriorityFeePerGas)), 16);\n  const mediumMaxPriorityFeeInWEI = new BigNumber(decGWEIToHexWEI(new BigNumber(medium.suggestedMaxPriorityFeePerGas)), 16);\n  const highMaxPriorityFeeInWEI = new BigNumber(decGWEIToHexWEI(new BigNumber(high.suggestedMaxPriorityFeePerGas)), 16);\n  let lowerTimeBound;\n  let upperTimeBound;\n  if (effectiveMaxPriorityFee.lt(lowMaxPriorityFeeInWEI)) {\n    lowerTimeBound = null;\n    upperTimeBound = \"unknown\";\n  } else if (effectiveMaxPriorityFee.gte(lowMaxPriorityFeeInWEI) && effectiveMaxPriorityFee.lt(mediumMaxPriorityFeeInWEI)) {\n    lowerTimeBound = low.minWaitTimeEstimate;\n    upperTimeBound = low.maxWaitTimeEstimate;\n  } else if (effectiveMaxPriorityFee.gte(mediumMaxPriorityFeeInWEI) && effectiveMaxPriorityFee.lt(highMaxPriorityFeeInWEI)) {\n    lowerTimeBound = medium.minWaitTimeEstimate;\n    upperTimeBound = medium.maxWaitTimeEstimate;\n  } else if (effectiveMaxPriorityFee.eq(highMaxPriorityFeeInWEI)) {\n    lowerTimeBound = high.minWaitTimeEstimate;\n    upperTimeBound = high.maxWaitTimeEstimate;\n  } else {\n    lowerTimeBound = 0;\n    upperTimeBound = high.maxWaitTimeEstimate;\n  }\n  return {\n    lowerTimeBound,\n    upperTimeBound\n  };\n}\n\nexport { calculateTimeEstimate, fetchEthGasPriceEstimate, fetchGasEstimates, fetchGasEstimatesViaEthFeeHistory, fetchLegacyGasPriceEstimates, normalizeGWEIDecimalNumbers };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2437, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Gas/GasFeeController.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { isHexString, addHexPrefix } from '@ethereumjs/util';\nimport { BaseController, PollingManager, cloneDeep } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\nimport { GAS_ESTIMATE_TYPES } from '../utils/constants.js';\nimport { fetchGasEstimates, fetchEthGasPriceEstimate, fetchLegacyGasPriceEstimates, fetchGasEstimatesViaEthFeeHistory, calculateTimeEstimate } from './gasUtil.js';\n\nconst GAS_FEE_API = \"https://mock-gas-server.herokuapp.com/\";\nconst LEGACY_GAS_PRICES_API_URL = \"https://api.metaswap.codefi.network/gasPrices\";\n/**\n * Returns gas prices in dec gwei\n */\nclass GasFeeController extends BaseController {\n  constructor({\n    config,\n    state,\n    idleTimeTracker,\n    getNetworkIdentifier,\n    getProvider,\n    fetchGasEstimates: fetchGasEstimates$1 = fetchGasEstimates,\n    fetchEthGasPriceEstimate: fetchEthGasPriceEstimate$1 = fetchEthGasPriceEstimate,\n    fetchLegacyGasPriceEstimates: fetchLegacyGasPriceEstimates$1 = fetchLegacyGasPriceEstimates,\n    fetchGasEstimatesViaEthFeeHistory: fetchGasEstimatesViaEthFeeHistory$1 = fetchGasEstimatesViaEthFeeHistory,\n    getCurrentNetworkLegacyGasAPICompatibility,\n    getCurrentNetworkEIP1559Compatibility,\n    getCurrentAccountEIP1559Compatibility,\n    onNetworkStateChange\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"GasFeeController\");\n    // https://0x.org/docs/introduction/0x-cheat-sheet#swap-api-endpoints\n    _defineProperty(this, \"API_SUPPORTED_CHAINIDS\", new Set([\"0x1\", \"0x5\", \"0xa4b1\", \"0xa86a\", \"0x2105\", \"0x38\", \"0xfa\", \"0xa\", \"0x89\"]));\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"currentChainId\", void 0);\n    _defineProperty(this, \"getNetworkIdentifier\", void 0);\n    _defineProperty(this, \"getProvider\", void 0);\n    _defineProperty(this, \"fetchGasEstimates\", void 0);\n    _defineProperty(this, \"fetchGasEstimatesViaEthFeeHistory\", void 0);\n    _defineProperty(this, \"fetchEthGasPriceEstimate\", void 0);\n    _defineProperty(this, \"fetchLegacyGasPriceEstimates\", void 0);\n    _defineProperty(this, \"getCurrentNetworkEIP1559Compatibility\", void 0);\n    _defineProperty(this, \"getCurrentAccountEIP1559Compatibility\", void 0);\n    _defineProperty(this, \"getCurrentNetworkLegacyGasAPICompatibility\", void 0);\n    _defineProperty(this, \"pollingManager\", void 0);\n    this.getNetworkIdentifier = getNetworkIdentifier;\n    this.getProvider = getProvider;\n    this.fetchGasEstimates = fetchGasEstimates$1;\n    this.fetchEthGasPriceEstimate = fetchEthGasPriceEstimate$1;\n    this.fetchLegacyGasPriceEstimates = fetchLegacyGasPriceEstimates$1;\n    this.getCurrentNetworkEIP1559Compatibility = getCurrentNetworkEIP1559Compatibility;\n    this.getCurrentNetworkLegacyGasAPICompatibility = getCurrentNetworkLegacyGasAPICompatibility;\n    this.getCurrentAccountEIP1559Compatibility = getCurrentAccountEIP1559Compatibility;\n    this.fetchGasEstimatesViaEthFeeHistory = fetchGasEstimatesViaEthFeeHistory$1;\n    this.defaultConfig = {\n      interval: 30000,\n      legacyAPIEndpoint: LEGACY_GAS_PRICES_API_URL,\n      EIP1559APIEndpoint: GAS_FEE_API\n    };\n    this.defaultState = {\n      gasFeeEstimates: {},\n      estimatedGasFeeTimeBounds: {},\n      gasEstimateType: GAS_ESTIMATE_TYPES.NONE\n    };\n    // Initialize.\n    this.currentChainId = this.getNetworkIdentifier();\n    this.provider = this.getProvider();\n    this.initialize();\n    onNetworkStateChange(() => {\n      this.onNetworkStateChange();\n    });\n    this.pollingManager = new PollingManager(idleTimeTracker, this.config.interval);\n  }\n  async onNetworkStateChange() {\n    this.provider = this.getProvider();\n    const newChainId = this.getNetworkIdentifier();\n    if (this.currentChainId !== newChainId) {\n      this.currentChainId = newChainId;\n      await this.fetchGasFeeEstimates();\n    }\n  }\n  async resetPolling() {\n    this.stopPolling();\n    await this.getGasFeeEstimatesAndStartPolling();\n  }\n  async fetchGasFeeEstimates() {\n    return this._fetchGasFeeEstimateData();\n  }\n  async getGasFeeEstimatesAndStartPolling() {\n    await this._fetchGasFeeEstimateData();\n    this._startPolling();\n  }\n  disconnectPoller() {\n    this.stopPolling();\n  }\n\n  /**\n   * Prepare to discard this controller.\n   *\n   * This stops any active polling.\n   */\n  destroy() {\n    this.stopPolling();\n  }\n  stopPolling() {\n    this.resetState();\n  }\n\n  /**\n   * Gets and sets gasFeeEstimates in state\n   *\n   * @returns GasFeeEstimates\n   */\n  async _fetchGasFeeEstimateData() {\n    let isEIP1559Compatible;\n    const isLegacyGasAPICompatible = this.getCurrentNetworkLegacyGasAPICompatibility();\n    const chainId = this.getNetworkIdentifier();\n    if (chainId === \"loading\") return;\n    let chainIdInt;\n    if (typeof chainId === \"string\" && isHexString(addHexPrefix(chainId))) {\n      chainIdInt = Number.parseInt(chainId, 16);\n    }\n    try {\n      isEIP1559Compatible = await this.getEIP1559Compatibility();\n      log.info(\"eip1559 compatible\", isEIP1559Compatible);\n    } catch (error) {\n      log.warn(error);\n      isEIP1559Compatible = false;\n    }\n    let newState = cloneDeep(this.defaultState);\n    try {\n      if (isEIP1559Compatible) {\n        let estimates;\n        try {\n          if (this.API_SUPPORTED_CHAINIDS.has(chainId)) {\n            estimates = await this.fetchGasEstimates(this.config.EIP1559APIEndpoint.replace(\"<chain_id>\", `${chainIdInt}`));\n          } else {\n            throw new Error(\"ChainId not supported by api\");\n          }\n        } catch {\n          estimates = await this.fetchGasEstimatesViaEthFeeHistory(this.provider);\n        }\n        const {\n          suggestedMaxPriorityFeePerGas,\n          suggestedMaxFeePerGas\n        } = estimates.medium;\n        const estimatedGasFeeTimeBounds = this.getTimeEstimate(suggestedMaxPriorityFeePerGas, suggestedMaxFeePerGas);\n        newState = {\n          gasFeeEstimates: estimates,\n          estimatedGasFeeTimeBounds,\n          gasEstimateType: GAS_ESTIMATE_TYPES.FEE_MARKET\n        };\n      } else if (isLegacyGasAPICompatible) {\n        const estimates = await this.fetchLegacyGasPriceEstimates(this.config.legacyAPIEndpoint.replace(\"<chain_id>\", `${chainIdInt}`));\n        newState = {\n          gasFeeEstimates: estimates,\n          estimatedGasFeeTimeBounds: {},\n          gasEstimateType: GAS_ESTIMATE_TYPES.LEGACY\n        };\n      } else {\n        throw new Error(\"Main gas fee/price estimation failed. Use fallback\");\n      }\n    } catch {\n      try {\n        const estimates = await this.fetchEthGasPriceEstimate(this.provider);\n        newState = {\n          gasFeeEstimates: estimates,\n          estimatedGasFeeTimeBounds: {},\n          gasEstimateType: GAS_ESTIMATE_TYPES.ETH_GASPRICE\n        };\n      } catch (error) {\n        throw new Error(`Gas fee/price estimation failed. Message: ${error.message}`);\n      }\n    }\n    this.update(newState);\n    return newState;\n  }\n  async _startPolling() {\n    this.pollingManager.start(async () => {\n      await this._fetchGasFeeEstimateData();\n    });\n  }\n  resetState() {\n    this.update(cloneDeep(this.defaultState));\n  }\n  async getEIP1559Compatibility() {\n    var _this$getCurrentAccou, _this$getCurrentAccou2;\n    const currentNetworkIsEIP1559Compatible = await this.getCurrentNetworkEIP1559Compatibility();\n    const currentAccountIsEIP1559Compatible = (_this$getCurrentAccou = (_this$getCurrentAccou2 = this.getCurrentAccountEIP1559Compatibility) === null || _this$getCurrentAccou2 === void 0 ? void 0 : _this$getCurrentAccou2.call(this)) !== null && _this$getCurrentAccou !== void 0 ? _this$getCurrentAccou : true;\n    return currentNetworkIsEIP1559Compatible && currentAccountIsEIP1559Compatible;\n  }\n  getTimeEstimate(maxPriorityFeePerGas, maxFeePerGas) {\n    if (!this.state.gasFeeEstimates || this.state.gasEstimateType !== GAS_ESTIMATE_TYPES.FEE_MARKET) {\n      return {};\n    }\n    return calculateTimeEstimate(maxPriorityFeePerGas, maxFeePerGas, this.state.gasFeeEstimates);\n  }\n}\n\nexport { GasFeeController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2643, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Keyring/KeyringController.js"],"sourcesContent":["import { addHexPrefix, bytesToHex, privateToPublic, toChecksumAddress, privateToAddress, stripHexPrefix, bigIntToBytes, isHexString } from '@ethereumjs/util';\nimport { BaseKeyringController, ecsignature, concatSig } from '@toruslabs/base-controllers';\nimport { SigningKey, hashMessage, TypedDataEncoder } from 'ethers';\n\nclass KeyringController extends BaseKeyringController {\n  constructor({\n    config,\n    state\n  }) {\n    super({\n      config,\n      state\n    });\n    this.defaultState = {\n      wallets: []\n    };\n    this.initialize();\n  }\n  async signTransaction(tx, address) {\n    const wallet = this._getWalletForAccount(address);\n    const privKey = new SigningKey(addHexPrefix(wallet.privateKey));\n    const localTx = tx;\n    localTx.signature = privKey.sign(localTx.unsignedHash);\n    return localTx;\n  }\n  getAccounts() {\n    return this.state.wallets.map(w => w.publicKey);\n  }\n  importAccount(accountPrivateKey) {\n    const hexPrivateKey = accountPrivateKey.padStart(64, \"0\");\n    const bufferPrivKey = Buffer.from(hexPrivateKey, \"hex\");\n    const publicKey = bytesToHex(privateToPublic(bufferPrivKey));\n    const address = toChecksumAddress(bytesToHex(privateToAddress(bufferPrivKey)));\n    const existingWallet = this.state.wallets.find(w => w.address === address);\n    if (existingWallet) return existingWallet.address;\n    this.update({\n      wallets: [...this.state.wallets, {\n        publicKey,\n        privateKey: accountPrivateKey,\n        address\n      }]\n    });\n    return address;\n  }\n  removeAccount(address) {\n    const newWallets = [...this.state.wallets];\n    const idx = newWallets.findIndex(w => w.address === address);\n    if (idx !== -1) {\n      newWallets.splice(idx, 1);\n      this.update({\n        wallets: newWallets\n      });\n    }\n  }\n  getBufferPrivateKey(privateKey) {\n    const stripped = stripHexPrefix(privateKey);\n    return Buffer.from(stripped, \"hex\");\n  }\n\n  // For eth_sign, we need to sign arbitrary data:\n  async signMessage(data, address) {\n    const wallet = this._getWalletForAccount(address);\n    const privKey = this.getBufferPrivateKey(wallet.privateKey);\n    const messageSig = ecsignature(Buffer.from(stripHexPrefix(data), \"hex\"), privKey);\n    const sig = concatSig(Buffer.from(bigIntToBytes(messageSig.v)), Buffer.from(messageSig.r), Buffer.from(messageSig.s));\n    return sig;\n  }\n  async signPersonalMessage(data, address) {\n    const wallet = this._getWalletForAccount(address);\n    const privKey = new SigningKey(addHexPrefix(wallet.privateKey));\n    // we need to check if the data is hex or not\n    // For historical reasons, you must submit the message to sign in hex-encoded UTF-8.\n    // https://docs.metamask.io/wallet/how-to/sign-data/#use-personal_sign\n    const message = isHexString(data) ? Buffer.from(stripHexPrefix(data), \"hex\") : Buffer.from(data);\n    const signature = privKey.sign(hashMessage(message)).serialized;\n    return signature;\n  }\n\n  // personal_signTypedData, signs data along with the schema\n  async signTypedData(typedData, address) {\n    const wallet = this._getWalletForAccount(address);\n    const privKey = new SigningKey(addHexPrefix(wallet.privateKey));\n    delete typedData.types.EIP712Domain;\n    const signature = privKey.sign(TypedDataEncoder.hash(typedData.domain, typedData.types, typedData.message)).serialized;\n    return signature;\n  }\n  _getWalletForAccount(account) {\n    const address = account.toLowerCase();\n    const wallet = this.state.wallets.find(w => w.address.toLowerCase() === address);\n    if (!wallet) throw new Error(\"Torus Keyring - Unable to find matching address.\");\n    return wallet;\n  }\n}\n\nexport { KeyringController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2754, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Message/utils.js"],"sourcesContent":["import { isValidAddress, stripHexPrefix, addHexPrefix, bytesToHex } from '@ethereumjs/util';\nimport { CHAIN_NAMESPACES } from '@toruslabs/base-controllers';\nimport { isHexString, JsonRpcProvider, toQuantity } from 'ethers';\n\nconst hexRe = /^[0-9A-Fa-f]+$/gu;\nfunction validateAddress(address, propertyName) {\n  if (!address || typeof address !== \"string\" || !isValidAddress(address)) {\n    throw new Error(`Invalid \"${propertyName}\" address: ${address} must be a valid string.`);\n  }\n}\nfunction validateSignMessageData(messageData) {\n  const {\n    from,\n    data\n  } = messageData;\n  validateAddress(from, \"from\");\n  if (!data || typeof data !== \"string\") {\n    throw new Error(`Invalid message \"data\": ${data} must be a valid string.`);\n  }\n}\nfunction normalizeMessageData(data) {\n  try {\n    const stripped = stripHexPrefix(data);\n    if (stripped.match(hexRe)) {\n      return addHexPrefix(stripped);\n    }\n  } catch {\n    // do nothing\n  }\n  return bytesToHex(Buffer.from(data, \"utf8\"));\n}\nasync function validateTypedSignMessageDataV4(messageData, currentChainId) {\n  validateAddress(messageData.from, \"from\");\n  if (!messageData.data || Array.isArray(messageData.data) || typeof messageData.data !== \"object\" && typeof messageData.data !== \"string\") {\n    throw new Error(`Invalid message \"data\": Must be a valid string or object.`);\n  }\n  let data;\n  if (typeof messageData.data === \"object\") {\n    data = messageData.data;\n  } else {\n    try {\n      data = JSON.parse(messageData.data);\n    } catch {\n      throw new Error(\"Data must be passed as a valid JSON string.\");\n    }\n  }\n  if (!currentChainId) {\n    throw new Error(\"Current chainId cannot be null or undefined.\");\n  }\n  let {\n    chainId\n  } = data.domain;\n  if (chainId) {\n    if (typeof chainId === \"string\") {\n      chainId = parseInt(chainId, chainId.startsWith(\"0x\") ? 16 : 10);\n    }\n    const activeChainId = parseInt(currentChainId, 16);\n    if (Number.isNaN(activeChainId)) {\n      throw new Error(`Cannot sign messages for chainId \"${chainId}\", because MetaMask is switching networks.`);\n    }\n    if (chainId !== activeChainId) {\n      throw new Error(`Provided chainId \"${chainId}\" must match the active chainId \"${activeChainId}\"`);\n    }\n  }\n}\nasync function validateAddChainData(data) {\n  const {\n    chainId,\n    rpcUrls,\n    nativeCurrency\n  } = data || {};\n  if (!chainId) {\n    throw new Error(\"Invalid add chain params: please pass chainId in params\");\n  }\n  if (!isHexString(chainId)) {\n    throw new Error(\"Invalid add chain params: please pass a valid hex chainId in params, for: ex: 0x1\");\n  }\n  if (!rpcUrls || rpcUrls.length === 0) throw new Error(\"params.rpcUrls not provided\");\n  if (!nativeCurrency) throw new Error(\"params.nativeCurrency not provided\");\n  const {\n    name,\n    symbol,\n    decimals\n  } = nativeCurrency;\n  if (!name) throw new Error(\"params.nativeCurrency.name not provided\");\n  if (!symbol) throw new Error(\"params.nativeCurrency.symbol not provided\");\n  if (decimals === undefined) throw new Error(\"params.nativeCurrency.decimals not provided\");\n  const _web3 = new JsonRpcProvider(rpcUrls[0], \"any\");\n  const {\n    chainId: networkChainID\n  } = await _web3.getNetwork();\n  if (Number.parseInt(networkChainID.toString()) !== Number.parseInt(chainId, 16)) {\n    throw new Error(`Provided rpc url's chainId version is not matching with provided chainId, expected: ${toQuantity(networkChainID)}, received: ${chainId}`);\n  }\n}\nfunction validateSwitchChainData(data) {\n  const {\n    chainId: fullChainId\n  } = data || {};\n  if (!fullChainId) {\n    throw new Error(\"Invalid switch chain params: please pass chainId in params\");\n  }\n  if (!isHexString(fullChainId)) {\n    const [namespace, chainId] = fullChainId.split(\":\");\n    if (namespace !== CHAIN_NAMESPACES.SOLANA && namespace !== CHAIN_NAMESPACES.EIP155) {\n      throw new Error(\"Invalid switch chain params: invalid namespace\");\n    }\n    if (!chainId || isNaN(Number(chainId))) {\n      throw new Error(\"Invalid switch chain params: invalid chainId\");\n    }\n  }\n}\n\nexport { normalizeMessageData, validateAddChainData, validateAddress, validateSignMessageData, validateSwitchChainData, validateTypedSignMessageDataV4 };\n"],"names":[],"mappings":";;;;;;;;;;;;;;AA6BoB;AA7BpB;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;;;;AAEA,MAAM,QAAQ;AACd,SAAS,gBAAgB,OAAO,EAAE,YAAY;IAC5C,IAAI,CAAC,WAAW,OAAO,YAAY,YAAY,CAAC,IAAA,6OAAc,EAAC,UAAU;QACvE,MAAM,IAAI,MAAM,CAAC,SAAS,EAAE,aAAa,WAAW,EAAE,QAAQ,wBAAwB,CAAC;IACzF;AACF;AACA,SAAS,wBAAwB,WAAW;IAC1C,MAAM,EACJ,IAAI,EACJ,IAAI,EACL,GAAG;IACJ,gBAAgB,MAAM;IACtB,IAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;QACrC,MAAM,IAAI,MAAM,CAAC,wBAAwB,EAAE,KAAK,wBAAwB,CAAC;IAC3E;AACF;AACA,SAAS,qBAAqB,IAAI;IAChC,IAAI;QACF,MAAM,WAAW,IAAA,8OAAc,EAAC;QAChC,IAAI,SAAS,KAAK,CAAC,QAAQ;YACzB,OAAO,IAAA,yOAAY,EAAC;QACtB;IACF,EAAE,OAAM;IACN,aAAa;IACf;IACA,OAAO,IAAA,uOAAU,EAAC,wKAAM,CAAC,IAAI,CAAC,MAAM;AACtC;AACA,eAAe,+BAA+B,WAAW,EAAE,cAAc;IACvE,gBAAgB,YAAY,IAAI,EAAE;IAClC,IAAI,CAAC,YAAY,IAAI,IAAI,MAAM,OAAO,CAAC,YAAY,IAAI,KAAK,OAAO,YAAY,IAAI,KAAK,YAAY,OAAO,YAAY,IAAI,KAAK,UAAU;QACxI,MAAM,IAAI,MAAM,CAAC,yDAAyD,CAAC;IAC7E;IACA,IAAI;IACJ,IAAI,OAAO,YAAY,IAAI,KAAK,UAAU;QACxC,OAAO,YAAY,IAAI;IACzB,OAAO;QACL,IAAI;YACF,OAAO,KAAK,KAAK,CAAC,YAAY,IAAI;QACpC,EAAE,OAAM;YACN,MAAM,IAAI,MAAM;QAClB;IACF;IACA,IAAI,CAAC,gBAAgB;QACnB,MAAM,IAAI,MAAM;IAClB;IACA,IAAI,EACF,OAAO,EACR,GAAG,KAAK,MAAM;IACf,IAAI,SAAS;QACX,IAAI,OAAO,YAAY,UAAU;YAC/B,UAAU,SAAS,SAAS,QAAQ,UAAU,CAAC,QAAQ,KAAK;QAC9D;QACA,MAAM,gBAAgB,SAAS,gBAAgB;QAC/C,IAAI,OAAO,KAAK,CAAC,gBAAgB;YAC/B,MAAM,IAAI,MAAM,CAAC,kCAAkC,EAAE,QAAQ,0CAA0C,CAAC;QAC1G;QACA,IAAI,YAAY,eAAe;YAC7B,MAAM,IAAI,MAAM,CAAC,kBAAkB,EAAE,QAAQ,iCAAiC,EAAE,cAAc,CAAC,CAAC;QAClG;IACF;AACF;AACA,eAAe,qBAAqB,IAAI;IACtC,MAAM,EACJ,OAAO,EACP,OAAO,EACP,cAAc,EACf,GAAG,QAAQ,CAAC;IACb,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,IAAI,CAAC,IAAA,uKAAW,EAAC,UAAU;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,GAAG,MAAM,IAAI,MAAM;IACtD,IAAI,CAAC,gBAAgB,MAAM,IAAI,MAAM;IACrC,MAAM,EACJ,IAAI,EACJ,MAAM,EACN,QAAQ,EACT,GAAG;IACJ,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAC3B,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAC7B,IAAI,aAAa,WAAW,MAAM,IAAI,MAAM;IAC5C,MAAM,QAAQ,IAAI,8LAAe,CAAC,OAAO,CAAC,EAAE,EAAE;IAC9C,MAAM,EACJ,SAAS,cAAc,EACxB,GAAG,MAAM,MAAM,UAAU;IAC1B,IAAI,OAAO,QAAQ,CAAC,eAAe,QAAQ,QAAQ,OAAO,QAAQ,CAAC,SAAS,KAAK;QAC/E,MAAM,IAAI,MAAM,CAAC,oFAAoF,EAAE,IAAA,uKAAU,EAAC,gBAAgB,YAAY,EAAE,SAAS;IAC3J;AACF;AACA,SAAS,wBAAwB,IAAI;IACnC,MAAM,EACJ,SAAS,WAAW,EACrB,GAAG,QAAQ,CAAC;IACb,IAAI,CAAC,aAAa;QAChB,MAAM,IAAI,MAAM;IAClB;IACA,IAAI,CAAC,IAAA,uKAAW,EAAC,cAAc;QAC7B,MAAM,CAAC,WAAW,QAAQ,GAAG,YAAY,KAAK,CAAC;QAC/C,IAAI,cAAc,0RAAgB,CAAC,MAAM,IAAI,cAAc,0RAAgB,CAAC,MAAM,EAAE;YAClF,MAAM,IAAI,MAAM;QAClB;QACA,IAAI,CAAC,WAAW,MAAM,OAAO,WAAW;YACtC,MAAM,IAAI,MAAM;QAClB;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 2876, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Message/AddChainController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { AbstractMessageController, MessageStatus, randomId, MESSAGE_EVENTS } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\nimport { METHOD_TYPES } from '../utils/constants.js';\nimport { validateAddChainData } from './utils.js';\n\nclass AddChainController extends AbstractMessageController {\n  constructor({\n    config,\n    state,\n    addChain\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"AddChainController\");\n    _defineProperty(this, \"addChain\", void 0);\n    this.addChain = addChain;\n    this.initialize();\n  }\n  async processAddChain(messageId) {\n    const msgObject = this.getMessage(messageId);\n    if (!msgObject) {\n      throw new Error(\"Message not found\");\n    }\n    try {\n      await this.approveMessage(messageId, msgObject.messageParams);\n      await this.addChain(msgObject.messageParams);\n      this.updateMessage(_objectSpread(_objectSpread({}, msgObject), {}, {\n        rawSig: JSON.stringify(msgObject.messageParams)\n      }));\n      this.setMessageStatus(messageId, MessageStatus.SIGNED);\n      return null;\n    } catch (error) {\n      log.error(error);\n      msgObject.error = (error === null || error === void 0 ? void 0 : error.message) || (error === null || error === void 0 ? void 0 : error.toString());\n      this.setMessageStatus(messageId, MessageStatus.FAILED);\n    }\n  }\n  async addNewUnapprovedMessage(messageParams, req) {\n    await this.addUnapprovedMessage(messageParams, req);\n    return this.waitForFinishStatus(messageParams, this.name);\n  }\n  async addUnapprovedMessage(messageParams, req) {\n    // set message params origin first to satisfy the eslint rule (origin won't be checked by validateAddChainData)\n    // for \"Possible race condition: `messageParams.origin` might be assigned based on an outdated state of `messageParams`\"\n    if (req) {\n      messageParams.origin = req.origin;\n    }\n    await validateAddChainData(messageParams);\n    const messageId = messageParams.id || randomId();\n    const messageData = {\n      id: messageId,\n      messageParams,\n      status: MessageStatus.UNAPPROVED,\n      time: Date.now(),\n      type: METHOD_TYPES.ADD_CHAIN\n    };\n    await this.addMessage(messageData);\n    this.emit(MESSAGE_EVENTS.UNAPPROVED_MESSAGE, {\n      messageData,\n      req\n    });\n    return messageId;\n  }\n  prepMessageForSigning(messageParams) {\n    return Promise.resolve(messageParams);\n  }\n}\n\nexport { AddChainController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,2BAA2B,0SAAyB;IACxD,YAAY,EACV,MAAM,EACN,KAAK,EACL,QAAQ,EACT,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ;QAC9B,IAAA,oLAAe,EAAC,IAAI,EAAE,YAAY,KAAK;QACvC,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,UAAU;IACjB;IACA,MAAM,gBAAgB,SAAS,EAAE;QAC/B,MAAM,YAAY,IAAI,CAAC,UAAU,CAAC;QAClC,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM;QAClB;QACA,IAAI;YACF,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,aAAa;YAC5D,MAAM,IAAI,CAAC,QAAQ,CAAC,UAAU,aAAa;YAC3C,IAAI,CAAC,aAAa,CAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,YAAY,CAAC,GAAG;gBACjE,QAAQ,KAAK,SAAS,CAAC,UAAU,aAAa;YAChD;YACA,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;YACrD,OAAO;QACT,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC;YACV,UAAU,KAAK,GAAG,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,OAAO,KAAK,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,QAAQ,EAAE;YAClJ,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;QACvD;IACF;IACA,MAAM,wBAAwB,aAAa,EAAE,GAAG,EAAE;QAChD,MAAM,IAAI,CAAC,oBAAoB,CAAC,eAAe;QAC/C,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,IAAI,CAAC,IAAI;IAC1D;IACA,MAAM,qBAAqB,aAAa,EAAE,GAAG,EAAE;QAC7C,+GAA+G;QAC/G,wHAAwH;QACxH,IAAI,KAAK;YACP,cAAc,MAAM,GAAG,IAAI,MAAM;QACnC;QACA,MAAM,IAAA,2NAAoB,EAAC;QAC3B,MAAM,YAAY,cAAc,EAAE,IAAI,IAAA,mQAAQ;QAC9C,MAAM,cAAc;YAClB,IAAI;YACJ;YACA,QAAQ,8QAAa,CAAC,UAAU;YAChC,MAAM,KAAK,GAAG;YACd,MAAM,qNAAY,CAAC,SAAS;QAC9B;QACA,MAAM,IAAI,CAAC,UAAU,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,+QAAc,CAAC,kBAAkB,EAAE;YAC3C;YACA;QACF;QACA,OAAO;IACT;IACA,sBAAsB,aAAa,EAAE;QACnC,OAAO,QAAQ,OAAO,CAAC;IACzB;AACF","ignoreList":[0]}},
    {"offset": {"line": 2959, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Message/MessageController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { AbstractMessageController, MessageStatus, randomId, MESSAGE_EVENTS } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\nimport { METHOD_TYPES } from '../utils/constants.js';\nimport { validateSignMessageData, normalizeMessageData } from './utils.js';\n\nclass MessageController extends AbstractMessageController {\n  constructor({\n    config,\n    state,\n    signMessage\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"MessageController\");\n    _defineProperty(this, \"signMessage\", void 0);\n    this.signMessage = signMessage;\n    this.initialize();\n  }\n  async processSignMessage(messageId) {\n    const msgObject = this.getMessage(messageId);\n    if (!msgObject) {\n      throw new Error(`Message not found`);\n    }\n    try {\n      const cleanMsgParams = await this.approveMessage(messageId, msgObject.messageParams);\n      const rawSig = await this.signMessage(cleanMsgParams.data, cleanMsgParams.from);\n      this.updateMessage(_objectSpread(_objectSpread({}, msgObject), {}, {\n        rawSig\n      }));\n      this.setMessageStatus(messageId, MessageStatus.SIGNED);\n      return rawSig;\n    } catch (error) {\n      log.error(error);\n      msgObject.error = (error === null || error === void 0 ? void 0 : error.message) || (error === null || error === void 0 ? void 0 : error.toString());\n      this.setMessageStatus(messageId, MessageStatus.FAILED);\n    }\n  }\n  async addNewUnapprovedMessage(messageParams, req) {\n    await this.addUnapprovedMessage(messageParams, req);\n    return this.waitForFinishStatus(messageParams, this.name);\n  }\n  async addUnapprovedMessage(messageParams, req) {\n    validateSignMessageData(messageParams);\n    if (req) {\n      messageParams.origin = req.origin;\n    }\n    messageParams.data = normalizeMessageData(messageParams.data);\n    const messageId = messageParams.id || randomId();\n    const messageData = {\n      id: messageId,\n      messageParams,\n      status: MessageStatus.UNAPPROVED,\n      time: Date.now(),\n      type: METHOD_TYPES.ETH_SIGN\n    };\n    await this.addMessage(messageData);\n    this.emit(MESSAGE_EVENTS.UNAPPROVED_MESSAGE, {\n      messageData,\n      req\n    });\n    return messageId;\n  }\n  prepMessageForSigning(messageParams) {\n    return Promise.resolve(messageParams);\n  }\n}\n\nexport { MessageController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,0BAA0B,0SAAyB;IACvD,YAAY,EACV,MAAM,EACN,KAAK,EACL,WAAW,EACZ,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ;QAC9B,IAAA,oLAAe,EAAC,IAAI,EAAE,eAAe,KAAK;QAC1C,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,UAAU;IACjB;IACA,MAAM,mBAAmB,SAAS,EAAE;QAClC,MAAM,YAAY,IAAI,CAAC,UAAU,CAAC;QAClC,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM,CAAC,iBAAiB,CAAC;QACrC;QACA,IAAI;YACF,MAAM,iBAAiB,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,aAAa;YACnF,MAAM,SAAS,MAAM,IAAI,CAAC,WAAW,CAAC,eAAe,IAAI,EAAE,eAAe,IAAI;YAC9E,IAAI,CAAC,aAAa,CAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,YAAY,CAAC,GAAG;gBACjE;YACF;YACA,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;YACrD,OAAO;QACT,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC;YACV,UAAU,KAAK,GAAG,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,OAAO,KAAK,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,QAAQ,EAAE;YAClJ,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;QACvD;IACF;IACA,MAAM,wBAAwB,aAAa,EAAE,GAAG,EAAE;QAChD,MAAM,IAAI,CAAC,oBAAoB,CAAC,eAAe;QAC/C,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,IAAI,CAAC,IAAI;IAC1D;IACA,MAAM,qBAAqB,aAAa,EAAE,GAAG,EAAE;QAC7C,IAAA,8NAAuB,EAAC;QACxB,IAAI,KAAK;YACP,cAAc,MAAM,GAAG,IAAI,MAAM;QACnC;QACA,cAAc,IAAI,GAAG,IAAA,2NAAoB,EAAC,cAAc,IAAI;QAC5D,MAAM,YAAY,cAAc,EAAE,IAAI,IAAA,mQAAQ;QAC9C,MAAM,cAAc;YAClB,IAAI;YACJ;YACA,QAAQ,8QAAa,CAAC,UAAU;YAChC,MAAM,KAAK,GAAG;YACd,MAAM,qNAAY,CAAC,QAAQ;QAC7B;QACA,MAAM,IAAI,CAAC,UAAU,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,+QAAc,CAAC,kBAAkB,EAAE;YAC3C;YACA;QACF;QACA,OAAO;IACT;IACA,sBAAsB,aAAa,EAAE;QACnC,OAAO,QAAQ,OAAO,CAAC;IACzB;AACF","ignoreList":[0]}},
    {"offset": {"line": 3041, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Message/PersonalMessageController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { AbstractMessageController, MessageStatus, randomId, MESSAGE_EVENTS } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\nimport { METHOD_TYPES } from '../utils/constants.js';\nimport { validateSignMessageData, normalizeMessageData } from './utils.js';\n\nclass PersonalMessageController extends AbstractMessageController {\n  constructor({\n    config,\n    state,\n    signPersonalMessage\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"PersonalMessageController\");\n    _defineProperty(this, \"signPersonalMessage\", void 0);\n    this.signPersonalMessage = signPersonalMessage;\n    this.initialize();\n  }\n  async processSignPersonalMessage(messageId) {\n    const msgObject = this.getMessage(messageId);\n    if (!msgObject) {\n      throw new Error(`Message not found`);\n    }\n    try {\n      const cleanMsgParams = await this.approveMessage(messageId, msgObject.messageParams);\n      const rawSig = await this.signPersonalMessage(cleanMsgParams.data, cleanMsgParams.from);\n      this.updateMessage(_objectSpread(_objectSpread({}, msgObject), {}, {\n        rawSig\n      }));\n      this.setMessageStatus(messageId, MessageStatus.SIGNED);\n      return rawSig;\n    } catch (error) {\n      log.error(error);\n      msgObject.error = (error === null || error === void 0 ? void 0 : error.message) || (error === null || error === void 0 ? void 0 : error.toString());\n      this.setMessageStatus(messageId, MessageStatus.FAILED);\n    }\n  }\n  async addNewUnapprovedMessage(messageParams, req) {\n    await this.addUnapprovedMessage(messageParams, req);\n    return this.waitForFinishStatus(messageParams, this.name);\n  }\n  async addUnapprovedMessage(messageParams, req) {\n    validateSignMessageData(messageParams);\n    if (req) {\n      messageParams.origin = req.origin;\n    }\n    messageParams.data = normalizeMessageData(messageParams.data);\n    const messageId = messageParams.id || randomId();\n    const messageData = {\n      id: messageId,\n      messageParams,\n      status: MessageStatus.UNAPPROVED,\n      time: Date.now(),\n      type: METHOD_TYPES.PERSONAL_SIGN\n    };\n    await this.addMessage(messageData);\n    this.emit(MESSAGE_EVENTS.UNAPPROVED_MESSAGE, {\n      messageData,\n      req\n    });\n    return messageId;\n  }\n  prepMessageForSigning(messageParams) {\n    return Promise.resolve(messageParams);\n  }\n}\n\nexport { PersonalMessageController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,kCAAkC,0SAAyB;IAC/D,YAAY,EACV,MAAM,EACN,KAAK,EACL,mBAAmB,EACpB,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ;QAC9B,IAAA,oLAAe,EAAC,IAAI,EAAE,uBAAuB,KAAK;QAClD,IAAI,CAAC,mBAAmB,GAAG;QAC3B,IAAI,CAAC,UAAU;IACjB;IACA,MAAM,2BAA2B,SAAS,EAAE;QAC1C,MAAM,YAAY,IAAI,CAAC,UAAU,CAAC;QAClC,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM,CAAC,iBAAiB,CAAC;QACrC;QACA,IAAI;YACF,MAAM,iBAAiB,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,aAAa;YACnF,MAAM,SAAS,MAAM,IAAI,CAAC,mBAAmB,CAAC,eAAe,IAAI,EAAE,eAAe,IAAI;YACtF,IAAI,CAAC,aAAa,CAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,YAAY,CAAC,GAAG;gBACjE;YACF;YACA,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;YACrD,OAAO;QACT,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC;YACV,UAAU,KAAK,GAAG,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,OAAO,KAAK,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,QAAQ,EAAE;YAClJ,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;QACvD;IACF;IACA,MAAM,wBAAwB,aAAa,EAAE,GAAG,EAAE;QAChD,MAAM,IAAI,CAAC,oBAAoB,CAAC,eAAe;QAC/C,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,IAAI,CAAC,IAAI;IAC1D;IACA,MAAM,qBAAqB,aAAa,EAAE,GAAG,EAAE;QAC7C,IAAA,8NAAuB,EAAC;QACxB,IAAI,KAAK;YACP,cAAc,MAAM,GAAG,IAAI,MAAM;QACnC;QACA,cAAc,IAAI,GAAG,IAAA,2NAAoB,EAAC,cAAc,IAAI;QAC5D,MAAM,YAAY,cAAc,EAAE,IAAI,IAAA,mQAAQ;QAC9C,MAAM,cAAc;YAClB,IAAI;YACJ;YACA,QAAQ,8QAAa,CAAC,UAAU;YAChC,MAAM,KAAK,GAAG;YACd,MAAM,qNAAY,CAAC,aAAa;QAClC;QACA,MAAM,IAAI,CAAC,UAAU,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,+QAAc,CAAC,kBAAkB,EAAE;YAC3C;YACA;QACF;QACA,OAAO;IACT;IACA,sBAAsB,aAAa,EAAE;QACnC,OAAO,QAAQ,OAAO,CAAC;IACzB;AACF","ignoreList":[0]}},
    {"offset": {"line": 3123, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Message/SwitchChainController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { AbstractMessageController, MessageStatus, randomId, MESSAGE_EVENTS } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\nimport { METHOD_TYPES } from '../utils/constants.js';\nimport { validateSwitchChainData } from './utils.js';\n\nclass SwitchChainController extends AbstractMessageController {\n  constructor({\n    config,\n    state,\n    switchChain\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"SwitchChainController\");\n    _defineProperty(this, \"switchChain\", void 0);\n    this.switchChain = switchChain;\n    this.initialize();\n  }\n  async processSwitchChain(messageId) {\n    const msgObject = this.getMessage(messageId);\n    if (!msgObject) {\n      throw new Error(`Message not found`);\n    }\n    try {\n      await this.approveMessage(messageId, msgObject.messageParams);\n      this.switchChain({\n        chainId: msgObject.messageParams.chainId\n      });\n      this.updateMessage(_objectSpread(_objectSpread({}, msgObject), {}, {\n        rawSig: JSON.stringify(msgObject.messageParams)\n      }));\n      this.setMessageStatus(messageId, MessageStatus.SIGNED);\n      return null;\n    } catch (error) {\n      log.error(error);\n      msgObject.error = (error === null || error === void 0 ? void 0 : error.message) || (error === null || error === void 0 ? void 0 : error.toString());\n      this.setMessageStatus(messageId, MessageStatus.FAILED);\n    }\n  }\n  async addNewUnapprovedMessage(messageParams, req) {\n    await this.addUnapprovedMessage(messageParams, req);\n    return this.waitForFinishStatus(messageParams, this.name);\n  }\n  async addUnapprovedMessage(messageParams, req) {\n    validateSwitchChainData(messageParams);\n    if (req) {\n      messageParams.origin = req.origin;\n    }\n    const messageId = messageParams.id || randomId();\n    const messageData = {\n      id: messageId,\n      messageParams,\n      status: MessageStatus.UNAPPROVED,\n      time: Date.now(),\n      type: METHOD_TYPES.SWITCH_CHAIN\n    };\n    await this.addMessage(messageData);\n    this.emit(MESSAGE_EVENTS.UNAPPROVED_MESSAGE, {\n      messageData,\n      req\n    });\n    return messageId;\n  }\n  prepMessageForSigning(messageParams) {\n    return Promise.resolve(messageParams);\n  }\n}\n\nexport { SwitchChainController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,8BAA8B,0SAAyB;IAC3D,YAAY,EACV,MAAM,EACN,KAAK,EACL,WAAW,EACZ,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ;QAC9B,IAAA,oLAAe,EAAC,IAAI,EAAE,eAAe,KAAK;QAC1C,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,UAAU;IACjB;IACA,MAAM,mBAAmB,SAAS,EAAE;QAClC,MAAM,YAAY,IAAI,CAAC,UAAU,CAAC;QAClC,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM,CAAC,iBAAiB,CAAC;QACrC;QACA,IAAI;YACF,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,aAAa;YAC5D,IAAI,CAAC,WAAW,CAAC;gBACf,SAAS,UAAU,aAAa,CAAC,OAAO;YAC1C;YACA,IAAI,CAAC,aAAa,CAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,YAAY,CAAC,GAAG;gBACjE,QAAQ,KAAK,SAAS,CAAC,UAAU,aAAa;YAChD;YACA,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;YACrD,OAAO;QACT,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC;YACV,UAAU,KAAK,GAAG,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,OAAO,KAAK,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,QAAQ,EAAE;YAClJ,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;QACvD;IACF;IACA,MAAM,wBAAwB,aAAa,EAAE,GAAG,EAAE;QAChD,MAAM,IAAI,CAAC,oBAAoB,CAAC,eAAe;QAC/C,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,IAAI,CAAC,IAAI;IAC1D;IACA,MAAM,qBAAqB,aAAa,EAAE,GAAG,EAAE;QAC7C,IAAA,8NAAuB,EAAC;QACxB,IAAI,KAAK;YACP,cAAc,MAAM,GAAG,IAAI,MAAM;QACnC;QACA,MAAM,YAAY,cAAc,EAAE,IAAI,IAAA,mQAAQ;QAC9C,MAAM,cAAc;YAClB,IAAI;YACJ;YACA,QAAQ,8QAAa,CAAC,UAAU;YAChC,MAAM,KAAK,GAAG;YACd,MAAM,qNAAY,CAAC,YAAY;QACjC;QACA,MAAM,IAAI,CAAC,UAAU,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,+QAAc,CAAC,kBAAkB,EAAE;YAC3C;YACA;QACF;QACA,OAAO;IACT;IACA,sBAAsB,aAAa,EAAE;QACnC,OAAO,QAAQ,OAAO,CAAC;IACzB;AACF","ignoreList":[0]}},
    {"offset": {"line": 3206, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Message/TypedMessageController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { AbstractMessageController, MessageStatus, randomId, MESSAGE_EVENTS } from '@toruslabs/base-controllers';\nimport log from 'loglevel';\nimport { METHOD_TYPES } from '../utils/constants.js';\nimport { validateTypedSignMessageDataV4 } from './utils.js';\n\nclass TypedMessageController extends AbstractMessageController {\n  constructor({\n    config,\n    state,\n    signTypedData,\n    getNetworkIdentifier\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"TypedMessageController\");\n    _defineProperty(this, \"signTypedData\", void 0);\n    _defineProperty(this, \"getNetworkIdentifier\", void 0);\n    this.signTypedData = signTypedData;\n    this.getNetworkIdentifier = getNetworkIdentifier;\n    this.initialize();\n  }\n  async processSignTypedMessage(messageId) {\n    const msgObject = this.getMessage(messageId);\n    if (!msgObject) {\n      throw new Error(`Message not found`);\n    }\n    try {\n      const cleanMsgParams = await this.approveMessage(messageId, msgObject.messageParams);\n      const msgData = JSON.parse(cleanMsgParams.data);\n      const rawSig = await this.signTypedData(msgData, cleanMsgParams.from);\n      this.updateMessage(_objectSpread(_objectSpread({}, msgObject), {}, {\n        rawSig\n      }));\n      this.setMessageStatus(messageId, MessageStatus.SIGNED);\n      return rawSig;\n    } catch (error) {\n      log.error(error);\n      msgObject.error = (error === null || error === void 0 ? void 0 : error.message) || (error === null || error === void 0 ? void 0 : error.toString());\n      this.setMessageStatus(messageId, MessageStatus.FAILED);\n    }\n  }\n  async addNewUnapprovedMessage(messageParams, req) {\n    await this.addUnapprovedMessage(messageParams, req);\n    return this.waitForFinishStatus(messageParams, this.name);\n  }\n  async addUnapprovedMessage(messageParams, req) {\n    const currentChainId = this.getNetworkIdentifier();\n    await validateTypedSignMessageDataV4(messageParams, currentChainId);\n    if (typeof messageParams.data !== \"string\") {\n      messageParams.data = JSON.stringify(messageParams.data);\n    }\n    if (req) {\n      messageParams.origin = req.origin;\n    }\n    const messageId = messageParams.id || randomId();\n    const messageData = {\n      id: messageId,\n      messageParams,\n      status: MessageStatus.UNAPPROVED,\n      time: Date.now(),\n      type: METHOD_TYPES.ETH_SIGN_TYPED_DATA_V4\n    };\n    await this.addMessage(messageData);\n    this.emit(MESSAGE_EVENTS.UNAPPROVED_MESSAGE, {\n      messageData,\n      req\n    });\n    return messageId;\n  }\n  prepMessageForSigning(messageParams) {\n    return Promise.resolve(messageParams);\n  }\n}\n\nexport { TypedMessageController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,+BAA+B,0SAAyB;IAC5D,YAAY,EACV,MAAM,EACN,KAAK,EACL,aAAa,EACb,oBAAoB,EACrB,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ;QAC9B,IAAA,oLAAe,EAAC,IAAI,EAAE,iBAAiB,KAAK;QAC5C,IAAA,oLAAe,EAAC,IAAI,EAAE,wBAAwB,KAAK;QACnD,IAAI,CAAC,aAAa,GAAG;QACrB,IAAI,CAAC,oBAAoB,GAAG;QAC5B,IAAI,CAAC,UAAU;IACjB;IACA,MAAM,wBAAwB,SAAS,EAAE;QACvC,MAAM,YAAY,IAAI,CAAC,UAAU,CAAC;QAClC,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM,CAAC,iBAAiB,CAAC;QACrC;QACA,IAAI;YACF,MAAM,iBAAiB,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,aAAa;YACnF,MAAM,UAAU,KAAK,KAAK,CAAC,eAAe,IAAI;YAC9C,MAAM,SAAS,MAAM,IAAI,CAAC,aAAa,CAAC,SAAS,eAAe,IAAI;YACpE,IAAI,CAAC,aAAa,CAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,YAAY,CAAC,GAAG;gBACjE;YACF;YACA,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;YACrD,OAAO;QACT,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC;YACV,UAAU,KAAK,GAAG,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,OAAO,KAAK,CAAC,UAAU,QAAQ,UAAU,KAAK,IAAI,KAAK,IAAI,MAAM,QAAQ,EAAE;YAClJ,IAAI,CAAC,gBAAgB,CAAC,WAAW,8QAAa,CAAC,MAAM;QACvD;IACF;IACA,MAAM,wBAAwB,aAAa,EAAE,GAAG,EAAE;QAChD,MAAM,IAAI,CAAC,oBAAoB,CAAC,eAAe;QAC/C,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,IAAI,CAAC,IAAI;IAC1D;IACA,MAAM,qBAAqB,aAAa,EAAE,GAAG,EAAE;QAC7C,MAAM,iBAAiB,IAAI,CAAC,oBAAoB;QAChD,MAAM,IAAA,qOAA8B,EAAC,eAAe;QACpD,IAAI,OAAO,cAAc,IAAI,KAAK,UAAU;YAC1C,cAAc,IAAI,GAAG,KAAK,SAAS,CAAC,cAAc,IAAI;QACxD;QACA,IAAI,KAAK;YACP,cAAc,MAAM,GAAG,IAAI,MAAM;QACnC;QACA,MAAM,YAAY,cAAc,EAAE,IAAI,IAAA,mQAAQ;QAC9C,MAAM,cAAc;YAClB,IAAI;YACJ;YACA,QAAQ,8QAAa,CAAC,UAAU;YAChC,MAAM,KAAK,GAAG;YACd,MAAM,qNAAY,CAAC,sBAAsB;QAC3C;QACA,MAAM,IAAI,CAAC,UAAU,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,+QAAc,CAAC,kBAAkB,EAAE;YAC3C;YACA;QACF;QACA,OAAO;IACT;IACA,sBAAsB,aAAa,EAAE;QACnC,OAAO,QAAQ,OAAO,CAAC;IACzB;AACF","ignoreList":[0]}},
    {"offset": {"line": 3294, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Network/createEthereumMiddleware.js"],"sourcesContent":["import { PROVIDER_JRPC_METHODS, createFetchMiddleware, createGenericJRPCMiddleware } from '@toruslabs/base-controllers';\nimport { createAsyncMiddleware, mergeMiddleware, createScaffoldMiddleware } from '@web3auth/auth';\nimport { METHOD_TYPES, TRANSACTION_ENVELOPE_TYPES, BUNDLER_METHOD_TYPES, PAYMASTER_METHOD_TYPES } from '../utils/constants.js';\n\nfunction createGetAccountsMiddleware({\n  getAccounts\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.GET_ACCOUNTS) return next();\n    if (!getAccounts) throw new Error(\"WalletMiddleware - opts.getAccounts not provided\");\n    const accounts = await getAccounts(request);\n    response.result = accounts;\n  });\n}\nfunction createProcessTransactionMiddleware({\n  processTransaction\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_TRANSACTION) return next();\n    if (!processTransaction) throw new Error(\"WalletMiddleware - opts.processTransaction not provided\");\n    response.result = await processTransaction(request.params, request);\n  });\n}\nfunction createProcessSignTransactionMiddleware({\n  processSignTransaction\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_SIGN_TRANSACTION) return next();\n    if (!processSignTransaction) throw new Error(\"WalletMiddleware - opts.processSignTransaction not provided\");\n    response.result = await processSignTransaction(request.params, request);\n  });\n}\nfunction createProcessEstimateUserOperationGasMiddleware({\n  processEstimateUserOperationGas\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_ESTIMATE_AA_TRANSACTION_GAS) return next();\n    if (!processEstimateUserOperationGas) throw new Error(\"WalletMiddleware - opts.processEstimateUserOperationGas not provided\");\n    response.result = await processEstimateUserOperationGas(request.params, request);\n  });\n}\nfunction createProcessEthSignMessage({\n  processEthSignMessage\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_SIGN) return next();\n    if (!processEthSignMessage) throw new Error(\"WalletMiddleware - opts.processEthSignMessage not provided\");\n    if (!(request !== null && request !== void 0 && request.params)) throw new Error(\"WalletMiddleware - missing params\");\n    let msgParams = request.params;\n    if (Array.isArray(request.params)) {\n      if (!(request.params.length === 2)) throw new Error(`WalletMiddleware - incorrect params for ${method} method. expected [address, message]`);\n      const params = request.params;\n      const address = params[0];\n      const message = params[1];\n      msgParams = {\n        from: address,\n        data: message\n      };\n    }\n    response.result = await processEthSignMessage(msgParams, request);\n  });\n}\nfunction createProcessTypedMessageV4({\n  processTypedMessageV4\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_SIGN_TYPED_DATA_V4) return next();\n    if (!processTypedMessageV4) throw new Error(\"WalletMiddleware - opts.processTypedMessageV4 is not provided\");\n    if (!(request !== null && request !== void 0 && request.params)) throw new Error(\"WalletMiddleware - missing params\");\n    let msgParams = request.params;\n    if (Array.isArray(request.params)) {\n      if (!(request.params.length === 2)) throw new Error(`WalletMiddleware - incorrect params for ${method} method. expected [address, typedData]`);\n      const params = request.params;\n      const address = params[0];\n      const message = params[1];\n      msgParams = {\n        from: address,\n        data: message\n      };\n    }\n    response.result = await processTypedMessageV4(msgParams, request);\n  });\n}\nfunction createProcessPersonalMessage({\n  processPersonalMessage\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.PERSONAL_SIGN) return next();\n    if (!processPersonalMessage) throw new Error(\"WalletMiddleware - opts.processPersonalMessage is not provided\");\n    if (!(request !== null && request !== void 0 && request.params)) throw new Error(\"WalletMiddleware - missing params\");\n    let msgParams = request.params;\n    if (Array.isArray(request.params)) {\n      if (!(request.params.length >= 2)) throw new Error(`WalletMiddleware - incorrect params for ${method} method. expected [message, address]`);\n      const params = request.params;\n      if (typeof params[0] === \"object\") {\n        const {\n          challenge,\n          address\n        } = params[0];\n        msgParams = {\n          from: address,\n          data: challenge\n        };\n      } else {\n        const message = params[0];\n        const address = params[1];\n        msgParams = {\n          from: address,\n          data: message\n        };\n      }\n    }\n    response.result = await processPersonalMessage(msgParams, request);\n  });\n}\nfunction createPendingNonceMiddleware({\n  getPendingNonce\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      params,\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_GET_TRANSACTION_COUNT) return next();\n    const {\n      blockReference\n    } = params;\n    if (blockReference !== \"pending\") return next();\n    response.result = await getPendingNonce(params, request);\n  });\n}\nfunction formatTxMetaForRpcResult(txMeta) {\n  const {\n    r,\n    s,\n    v,\n    txReceipt,\n    transaction,\n    transactionHash,\n    accessList\n  } = txMeta;\n  const {\n    to,\n    data,\n    nonce,\n    gas,\n    from,\n    value,\n    gasPrice,\n    maxFeePerGas,\n    maxPriorityFeePerGas\n  } = transaction;\n  const formattedTxMeta = {\n    v,\n    r,\n    s,\n    to,\n    gas,\n    from,\n    hash: transactionHash,\n    nonce,\n    input: data || \"0x\",\n    value: value || \"0x0\",\n    accessList: accessList || null,\n    blockHash: (txReceipt === null || txReceipt === void 0 ? void 0 : txReceipt.blockHash) || null,\n    blockNumber: (txReceipt === null || txReceipt === void 0 ? void 0 : txReceipt.blockNumber) || null,\n    transactionIndex: (txReceipt === null || txReceipt === void 0 ? void 0 : txReceipt.transactionIndex) || null,\n    type: null\n  };\n  if (maxFeePerGas && maxPriorityFeePerGas) {\n    formattedTxMeta.maxFeePerGas = maxFeePerGas;\n    formattedTxMeta.maxPriorityFeePerGas = maxPriorityFeePerGas;\n    formattedTxMeta.type = TRANSACTION_ENVELOPE_TYPES.FEE_MARKET;\n  } else {\n    formattedTxMeta.gasPrice = gasPrice;\n    formattedTxMeta.type = TRANSACTION_ENVELOPE_TYPES.LEGACY;\n  }\n  return formattedTxMeta;\n}\nfunction createPendingTxMiddleware({\n  getPendingTransactionByHash\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      params,\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ETH_GET_TRANSACTION_BY_HASH) return next();\n    if (!getPendingTransactionByHash) throw new Error(\"WalletMiddleware - opts.getPendingTransactionByHash not provided\");\n    const txMeta = await getPendingTransactionByHash(params, request);\n    if (!txMeta) {\n      return next();\n    }\n    response.result = formatTxMetaForRpcResult(txMeta);\n    return undefined;\n  });\n}\nfunction createProcessSwitchEthereumChain({\n  processSwitchEthereumChain\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.SWITCH_CHAIN) return next();\n    if (!processSwitchEthereumChain) throw new Error(\"WalletMiddleware - opts.processSwitchEthereumChain not provided\");\n    if (!(request !== null && request !== void 0 && request.params)) throw new Error(\"WalletMiddleware - missing params\");\n    let msgParams = request.params;\n    if (Array.isArray(request.params)) {\n      if (!(request.params.length === 1)) throw new Error(`WalletMiddleware - incorrect params for ${method} method. expected [data]`);\n      const [message] = request.params;\n      msgParams = message;\n    }\n    response.result = await processSwitchEthereumChain(msgParams, request);\n  });\n}\nfunction createProcessWalletSwitchChain({\n  processWalletSwitchChain\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== PROVIDER_JRPC_METHODS.WALLET_SWITCH_CHAIN) return next();\n    if (!processWalletSwitchChain) throw new Error(\"WalletMiddleware - opts.processWalletSwitchChain not provided\");\n    if (!(request !== null && request !== void 0 && request.params)) throw new Error(\"WalletMiddleware - missing params\");\n    let msgParams = request.params;\n    if (Array.isArray(request.params)) {\n      if (!(request.params.length === 1)) throw new Error(`WalletMiddleware - incorrect params for ${method} method. expected [data]`);\n      const [message] = request.params;\n      msgParams = message;\n    }\n    response.result = await processWalletSwitchChain(msgParams, request);\n  });\n}\nfunction createProcessAddEthereumChain({\n  processAddEthereumChain\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== METHOD_TYPES.ADD_CHAIN) return next();\n    if (!processAddEthereumChain) throw new Error(\"WalletMiddleware - opts.processAddEthereumChain not provided\");\n    if (!(request !== null && request !== void 0 && request.params)) throw new Error(\"WalletMiddleware - missing params\");\n    let msgParams = request.params;\n    if (Array.isArray(request.params)) {\n      if (!(request.params.length === 1)) throw new Error(`WalletMiddleware - incorrect params for ${method} method. expected [data]`);\n      const [message] = request.params;\n      msgParams = message;\n    }\n    response.result = await processAddEthereumChain(msgParams, request);\n  });\n}\nfunction createRequestAccountsMiddleware({\n  requestAccounts\n}) {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const {\n      method\n    } = request;\n    if (method !== \"eth_requestAccounts\") return next();\n    if (!requestAccounts) throw new Error(\"WalletMiddleware - opts.requestAccounts not provided\");\n    // This calls the UI login function\n    const accounts = await requestAccounts(request);\n    response.result = accounts;\n    return undefined;\n  });\n}\n\n/**\n * Middleware to handle bundler/paymaster rpc method\n */\nfunction createAAMiddleware({\n  bundlerUrl,\n  paymasterUrl,\n  providerConfig,\n  analytics\n}) {\n  // forward request to bundler/paymaster\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const middlewares = [];\n\n  // NOTE: bundler/paymaster rpc only accept number as request id, we need to handle that here if client doesn't handle request id themselves\n  const idNumberRemapMiddleware = (req, res, next, _end) => {\n    // skip if not bundler/paymaster methods\n    if (!BUNDLER_METHOD_TYPES.includes(req.method) && !PAYMASTER_METHOD_TYPES.includes(req.method)) {\n      return next();\n    }\n    const originalId = req.id;\n    const newId = Math.floor(Math.random() * 1000000);\n    req.id = newId;\n    res.id = newId;\n    next(done => {\n      req.id = originalId;\n      res.id = originalId;\n      done();\n    });\n  };\n  const bundlerFetchMiddleware = createFetchMiddleware({\n    rpcTarget: bundlerUrl,\n    providerConfig,\n    analytics\n  });\n  middlewares.push(idNumberRemapMiddleware);\n  middlewares.push((request, response, next, end) => {\n    if (!BUNDLER_METHOD_TYPES.includes(request.method)) {\n      return next();\n    }\n    bundlerFetchMiddleware(request, response, next, end);\n  });\n  if (paymasterUrl) {\n    const paymasterFetchMiddleware = createFetchMiddleware({\n      rpcTarget: paymasterUrl,\n      providerConfig,\n      analytics\n    });\n    middlewares.push((request, response, next, end) => {\n      if (!PAYMASTER_METHOD_TYPES.includes(request.method)) {\n        return next();\n      }\n      paymasterFetchMiddleware(request, response, next, end);\n    });\n  }\n  return mergeMiddleware(middlewares);\n}\nfunction createEthereumMiddleware(providerHandlers, providerConfig, analytics) {\n  const {\n    requestAccounts,\n    getAccounts,\n    getPrivateKey,\n    getPublicKey,\n    processTransaction,\n    processSignTransaction,\n    processEstimateUserOperationGas,\n    processEthSignMessage,\n    processTypedMessageV4,\n    processPersonalMessage,\n    getPendingNonce,\n    getPendingTransactionByHash,\n    processSwitchEthereumChain,\n    processWalletSwitchChain,\n    processAddEthereumChain,\n    getProviderState,\n    aaConfig,\n    version\n  } = providerHandlers;\n  const middlewares = [createScaffoldMiddleware({\n    version,\n    [PROVIDER_JRPC_METHODS.GET_PROVIDER_STATE]: getProviderState\n  }), createRequestAccountsMiddleware({\n    requestAccounts\n  }), createGetAccountsMiddleware({\n    getAccounts\n  }), createGenericJRPCMiddleware(METHOD_TYPES.ETH_PRIVATE_KEY, getPrivateKey), createGenericJRPCMiddleware(METHOD_TYPES.PRIVATE_KEY, getPrivateKey), createGenericJRPCMiddleware(METHOD_TYPES.ETH_PUBLIC_KEY, getPublicKey), createGenericJRPCMiddleware(METHOD_TYPES.PUBLIC_KEY, getPublicKey), createProcessTransactionMiddleware({\n    processTransaction\n  }), createProcessSignTransactionMiddleware({\n    processSignTransaction\n  }), createProcessEstimateUserOperationGasMiddleware({\n    processEstimateUserOperationGas\n  }), createProcessEthSignMessage({\n    processEthSignMessage\n  }), createProcessTypedMessageV4({\n    processTypedMessageV4\n  }), createProcessPersonalMessage({\n    processPersonalMessage\n  }), createPendingNonceMiddleware({\n    getPendingNonce\n  }), createPendingTxMiddleware({\n    getPendingTransactionByHash\n  }), createProcessSwitchEthereumChain({\n    processSwitchEthereumChain\n  }), createProcessWalletSwitchChain({\n    processWalletSwitchChain\n  }), createProcessAddEthereumChain({\n    processAddEthereumChain\n  })];\n  if (aaConfig) {\n    middlewares.push(createAAMiddleware({\n      bundlerUrl: aaConfig.bundlerUrl,\n      paymasterUrl: aaConfig.paymasterUrl,\n      providerConfig,\n      analytics\n    }));\n  }\n  return mergeMiddleware(middlewares);\n}\n\nexport { createAAMiddleware, createEthereumMiddleware, createGetAccountsMiddleware, createPendingNonceMiddleware, createPendingTxMiddleware, createProcessAddEthereumChain, createProcessEstimateUserOperationGasMiddleware, createProcessEthSignMessage, createProcessPersonalMessage, createProcessSignTransactionMiddleware, createProcessSwitchEthereumChain, createProcessTransactionMiddleware, createProcessTypedMessageV4, createProcessWalletSwitchChain, createRequestAccountsMiddleware, formatTxMetaForRpcResult };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3661, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Network/cacheIdentifier.js"],"sourcesContent":["import stringify from 'fast-safe-stringify';\n\nlet CacheStrategy = /*#__PURE__*/function (CacheStrategy) {\n  /**\n   * Cache per-block.\n   */\n  CacheStrategy[\"Block\"] = \"block\";\n  /**\n   * Cache until a chain reorganization occurs.\n   */\n  CacheStrategy[\"Fork\"] = \"fork\";\n  /**\n   * Never cache.\n   */\n  CacheStrategy[\"Never\"] = \"never\";\n  /**\n   * Permanently cache.\n   */\n  CacheStrategy[\"Permanent\"] = \"perma\";\n  return CacheStrategy;\n}({});\nfunction blockTagParamIndex(method) {\n  switch (method) {\n    // blockTag is at index 2\n    case \"eth_getStorageAt\":\n      return 2;\n    // blockTag is at index 1\n    case \"eth_getBalance\":\n    case \"eth_getCode\":\n    case \"eth_getTransactionCount\":\n    case \"eth_call\":\n      return 1;\n    // blockTag is at index 0\n    case \"eth_getBlockByNumber\":\n      return 0;\n    // there is no blockTag\n    default:\n      return undefined;\n  }\n}\nfunction cacheTypeForMethod(method) {\n  switch (method) {\n    // cache permanently\n    case \"web3_clientVersion\":\n    case \"web3_sha3\":\n    case \"eth_protocolVersion\":\n    case \"eth_getBlockTransactionCountByHash\":\n    case \"eth_getUncleCountByBlockHash\":\n    case \"eth_getCode\":\n    case \"eth_getBlockByHash\":\n    case \"eth_getTransactionByHash\":\n    case \"eth_getTransactionByBlockHashAndIndex\":\n    case \"eth_getTransactionReceipt\":\n    case \"eth_getUncleByBlockHashAndIndex\":\n    case \"eth_getCompilers\":\n    case \"eth_compileLLL\":\n    case \"eth_compileSolidity\":\n    case \"eth_compileSerpent\":\n    case \"shh_version\":\n    case \"test_permaCache\":\n      return CacheStrategy.Permanent;\n\n    // cache until fork\n    case \"eth_getBlockByNumber\":\n    case \"eth_getBlockTransactionCountByNumber\":\n    case \"eth_getUncleCountByBlockNumber\":\n    case \"eth_getTransactionByBlockNumberAndIndex\":\n    case \"eth_getUncleByBlockNumberAndIndex\":\n    case \"test_forkCache\":\n      return CacheStrategy.Fork;\n\n    // cache for block\n    case \"eth_gasPrice\":\n    case \"eth_blockNumber\":\n    case \"eth_getBalance\":\n    case \"eth_getStorageAt\":\n    case \"eth_getTransactionCount\":\n    case \"eth_call\":\n    case \"eth_estimateGas\":\n    case \"eth_getFilterLogs\":\n    case \"eth_getLogs\":\n    case \"test_blockCache\":\n      return CacheStrategy.Block;\n\n    // never cache\n    default:\n      return CacheStrategy.Never;\n  }\n}\nfunction canCache(method) {\n  return cacheTypeForMethod(method) !== CacheStrategy.Never;\n}\nfunction paramsWithoutBlockTag(request) {\n  if (!request.params) {\n    return [];\n  }\n  const index = blockTagParamIndex(request.method);\n\n  // Block tag param not passed.\n  if (index === undefined || !Array.isArray(request.params) || index >= request.params.length) {\n    return request.params;\n  }\n\n  // eth_getBlockByNumber has the block tag first, then the optional includeTx? param\n  if (request.method === \"eth_getBlockByNumber\") {\n    return request.params.slice(1);\n  }\n  return request.params.slice(0, index);\n}\nfunction cacheIdentifierForRequest(request, skipBlockRef) {\n  var _request$params;\n  const simpleParams = skipBlockRef ? paramsWithoutBlockTag(request) : (_request$params = request.params) !== null && _request$params !== void 0 ? _request$params : [];\n  if (canCache(request.method)) {\n    return `${request.method}:${stringify(simpleParams)}`;\n  }\n  return null;\n}\n\nexport { CacheStrategy, blockTagParamIndex, cacheIdentifierForRequest, cacheTypeForMethod };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,IAAI,gBAAgB,WAAW,GAAE,SAAU,aAAa;IACtD;;GAEC,GACD,aAAa,CAAC,QAAQ,GAAG;IACzB;;GAEC,GACD,aAAa,CAAC,OAAO,GAAG;IACxB;;GAEC,GACD,aAAa,CAAC,QAAQ,GAAG;IACzB;;GAEC,GACD,aAAa,CAAC,YAAY,GAAG;IAC7B,OAAO;AACT,EAAE,CAAC;AACH,SAAS,mBAAmB,MAAM;IAChC,OAAQ;QACN,yBAAyB;QACzB,KAAK;YACH,OAAO;QACT,yBAAyB;QACzB,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO;QACT,yBAAyB;QACzB,KAAK;YACH,OAAO;QACT,uBAAuB;QACvB;YACE,OAAO;IACX;AACF;AACA,SAAS,mBAAmB,MAAM;IAChC,OAAQ;QACN,oBAAoB;QACpB,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,cAAc,SAAS;QAEhC,mBAAmB;QACnB,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,cAAc,IAAI;QAE3B,kBAAkB;QAClB,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,cAAc,KAAK;QAE5B,cAAc;QACd;YACE,OAAO,cAAc,KAAK;IAC9B;AACF;AACA,SAAS,SAAS,MAAM;IACtB,OAAO,mBAAmB,YAAY,cAAc,KAAK;AAC3D;AACA,SAAS,sBAAsB,OAAO;IACpC,IAAI,CAAC,QAAQ,MAAM,EAAE;QACnB,OAAO,EAAE;IACX;IACA,MAAM,QAAQ,mBAAmB,QAAQ,MAAM;IAE/C,8BAA8B;IAC9B,IAAI,UAAU,aAAa,CAAC,MAAM,OAAO,CAAC,QAAQ,MAAM,KAAK,SAAS,QAAQ,MAAM,CAAC,MAAM,EAAE;QAC3F,OAAO,QAAQ,MAAM;IACvB;IAEA,mFAAmF;IACnF,IAAI,QAAQ,MAAM,KAAK,wBAAwB;QAC7C,OAAO,QAAQ,MAAM,CAAC,KAAK,CAAC;IAC9B;IACA,OAAO,QAAQ,MAAM,CAAC,KAAK,CAAC,GAAG;AACjC;AACA,SAAS,0BAA0B,OAAO,EAAE,YAAY;IACtD,IAAI;IACJ,MAAM,eAAe,eAAe,sBAAsB,WAAW,CAAC,kBAAkB,QAAQ,MAAM,MAAM,QAAQ,oBAAoB,KAAK,IAAI,kBAAkB,EAAE;IACrK,IAAI,SAAS,QAAQ,MAAM,GAAG;QAC5B,OAAO,GAAG,QAAQ,MAAM,CAAC,CAAC,EAAE,IAAA,gKAAS,EAAC,eAAe;IACvD;IACA,OAAO;AACT","ignoreList":[0]}},
    {"offset": {"line": 3784, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Network/createJsonRpcClient.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport { createFetchMiddleware, createInflightCacheMiddleware } from '@toruslabs/base-controllers';\nimport { providerFromMiddleware, mergeMiddleware } from '@web3auth/auth';\nimport { PollingBlockTracker } from '../Block/PollingBlockTracker.js';\nimport { cacheIdentifierForRequest } from './cacheIdentifier.js';\n\nfunction createChainIdMiddleware(chainId) {\n  return (req, res, next, end) => {\n    if (req.method === \"eth_chainId\") {\n      res.result = chainId;\n      return end();\n    }\n    if (req.method === \"net_version\") {\n      // convert to decimal\n      res.result = Number.parseInt(chainId, 16).toString(10);\n      return end();\n    }\n    return next();\n  };\n}\nfunction createProviderConfigMiddleware(providerConfig) {\n  return (req, res, next, end) => {\n    if (req.method === \"eth_provider_config\") {\n      res.result = providerConfig;\n      return end();\n    }\n    return next();\n  };\n}\nfunction createJsonRpcClient(providerConfig, networkConfig, idleTimeTracker, analytics) {\n  const {\n    chainId,\n    rpcTarget\n  } = providerConfig;\n  const fetchMiddleware = createFetchMiddleware({\n    rpcTarget,\n    providerConfig,\n    analytics\n  });\n  const blockProvider = providerFromMiddleware(fetchMiddleware);\n  const blockTracker = new PollingBlockTracker({\n    config: _objectSpread(_objectSpread({}, networkConfig), {}, {\n      provider: blockProvider\n    }),\n    state: {},\n    idleTimeTracker\n  });\n  const networkMiddleware = mergeMiddleware([createChainIdMiddleware(chainId), createProviderConfigMiddleware(providerConfig),\n  // No need for the following middlewares for web because all browser sessions are quite short lived and each session is limited to scope of a window/tab\n  // createBlockRefRewriteMiddleware({ blockTracker }),\n  // createBlockCacheMiddleware({ blockTracker }),\n  createInflightCacheMiddleware({\n    cacheIdentifierForRequest\n  }),\n  // createBlockTrackerInspectorMiddleware({ blockTracker }),\n  fetchMiddleware]);\n  return {\n    networkMiddleware,\n    blockTracker\n  };\n}\n\nexport { createChainIdMiddleware, createJsonRpcClient, createProviderConfigMiddleware };\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;;;AAEA,SAAS,wBAAwB,OAAO;IACtC,OAAO,CAAC,KAAK,KAAK,MAAM;QACtB,IAAI,IAAI,MAAM,KAAK,eAAe;YAChC,IAAI,MAAM,GAAG;YACb,OAAO;QACT;QACA,IAAI,IAAI,MAAM,KAAK,eAAe;YAChC,qBAAqB;YACrB,IAAI,MAAM,GAAG,OAAO,QAAQ,CAAC,SAAS,IAAI,QAAQ,CAAC;YACnD,OAAO;QACT;QACA,OAAO;IACT;AACF;AACA,SAAS,+BAA+B,cAAc;IACpD,OAAO,CAAC,KAAK,KAAK,MAAM;QACtB,IAAI,IAAI,MAAM,KAAK,uBAAuB;YACxC,IAAI,MAAM,GAAG;YACb,OAAO;QACT;QACA,OAAO;IACT;AACF;AACA,SAAS,oBAAoB,cAAc,EAAE,aAAa,EAAE,eAAe,EAAE,SAAS;IACpF,MAAM,EACJ,OAAO,EACP,SAAS,EACV,GAAG;IACJ,MAAM,kBAAkB,IAAA,kSAAqB,EAAC;QAC5C;QACA;QACA;IACF;IACA,MAAM,gBAAgB,IAAA,qQAAsB,EAAC;IAC7C,MAAM,eAAe,IAAI,sOAAmB,CAAC;QAC3C,QAAQ,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,gBAAgB,CAAC,GAAG;YAC1D,UAAU;QACZ;QACA,OAAO,CAAC;QACR;IACF;IACA,MAAM,oBAAoB,IAAA,8PAAe,EAAC;QAAC,wBAAwB;QAAU,+BAA+B;QAC5G,wJAAwJ;QACxJ,qDAAqD;QACrD,gDAAgD;QAChD,IAAA,kTAA6B,EAAC;YAC5B,2BAAA,0OAAyB;QAC3B;QACA,2DAA2D;QAC3D;KAAgB;IAChB,OAAO;QACL;QACA;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 3863, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Network/NetworkController.js"],"sourcesContent":["import _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseController, createAnalyticsMiddleware, createSwappableProxy, createEventEmitterProxy } from '@toruslabs/base-controllers';\nimport { JRPCEngine, providerFromEngine } from '@web3auth/auth';\nimport { Mutex } from 'async-mutex';\nimport log from 'loglevel';\nimport { SUPPORTED_NETWORKS, MAINNET_CHAIN_ID } from '../utils/constants.js';\nimport { createEthereumMiddleware } from './createEthereumMiddleware.js';\nimport { createJsonRpcClient } from './createJsonRpcClient.js';\n\nconst _excluded = [\"chainId\", \"rpcTarget\"];\nclass NetworkController extends BaseController {\n  constructor({\n    config,\n    state,\n    idleTimeTracker,\n    analytics\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"NetworkController\");\n    _defineProperty(this, \"providerProxy\", void 0);\n    _defineProperty(this, \"blockTrackerProxy\", void 0);\n    _defineProperty(this, \"mutex\", new Mutex());\n    _defineProperty(this, \"provider\", null);\n    _defineProperty(this, \"blockTracker\", null);\n    _defineProperty(this, \"baseProviderHandlers\", void 0);\n    _defineProperty(this, \"idleTimeTracker\", void 0);\n    _defineProperty(this, \"analytics\", void 0);\n    this.defaultState = {\n      chainId: \"loading\",\n      properties: {\n        EIPS_1559: undefined\n      },\n      providerConfig: SUPPORTED_NETWORKS[MAINNET_CHAIN_ID]\n    };\n    this.analytics = analytics;\n\n    // when a new network is set,\n    // we set to loading first and\n    // then when connection succeeds,\n    // we update the network\n    this.initialize();\n    this.idleTimeTracker = idleTimeTracker;\n  }\n  getNetworkIdentifier() {\n    return this.state.chainId;\n  }\n  getNetworkRPCUrl() {\n    return this.state.providerConfig.rpcTarget;\n  }\n\n  /**\n   * Called by orchestrator once while initializing the class\n   * @param providerHandlers - JRPC handlers for provider\n   * @returns - provider - Returns the providerProxy\n   */\n  initializeProvider(providerHandlers) {\n    this.baseProviderHandlers = providerHandlers;\n    this.configureProvider();\n    this.lookupNetwork(); // Not awaiting this, because we don't want to block the initialization\n    return this.providerProxy;\n  }\n  getProvider() {\n    return this.providerProxy;\n  }\n  getBlockTracker() {\n    return this.blockTrackerProxy;\n  }\n  getProviderConfig() {\n    return this.state.providerConfig;\n  }\n  setProviderConfig(config) {\n    this.update({\n      providerConfig: _objectSpread({}, config)\n    });\n    this.refreshNetwork();\n  }\n  async getEIP1559Compatibility() {\n    const {\n      EIPS_1559\n    } = this.state.properties;\n    // log.info('checking eip 1559 compatibility')\n    if (EIPS_1559 !== undefined) {\n      return EIPS_1559;\n    }\n    const latestBlock = await this.blockTracker.getLatestBlock();\n    const supportsEIP1559 = latestBlock && latestBlock.baseFeePerGas !== undefined;\n    this.update({\n      properties: {\n        EIPS_1559: supportsEIP1559\n      }\n    });\n    return supportsEIP1559;\n  }\n\n  /**\n   * Refreshes the current network code\n   */\n  async lookupNetwork() {\n    const {\n      chainId,\n      rpcTarget\n    } = this.getProviderConfig();\n    if (!chainId || !rpcTarget || !this.provider) {\n      this.update({\n        chainId: \"loading\",\n        properties: {}\n      });\n      return;\n    }\n    const releaseLock = await this.mutex.acquire();\n    try {\n      // use eth_chainId\n      const [networkChainId] = await Promise.all([this.provider.request({\n        method: \"eth_chainId\"\n      }), this.getEIP1559Compatibility()]);\n      log.info(\"network fetched chain id\", networkChainId);\n      // update chain ID\n      this.update({\n        chainId: networkChainId\n      });\n      this.emit(\"networkDidChange\");\n    } catch {\n      this.update({\n        chainId: \"loading\"\n      });\n    } finally {\n      releaseLock();\n    }\n  }\n  configureProvider() {\n    const _this$getProviderConf = this.getProviderConfig(),\n      {\n        chainId,\n        rpcTarget\n      } = _this$getProviderConf,\n      rest = _objectWithoutProperties(_this$getProviderConf, _excluded);\n    if (!chainId || !rpcTarget) {\n      throw new Error(\"chainId and rpcTarget must be provided in providerConfig\");\n    }\n    this.configureStandardProvider(_objectSpread({\n      chainId,\n      rpcTarget\n    }, rest));\n  }\n  setNetworkClient({\n    networkMiddleware,\n    blockTracker\n  }) {\n    const ethereumMiddleware = createEthereumMiddleware(this.baseProviderHandlers, this.getProviderConfig(), this.analytics);\n    const engine = new JRPCEngine();\n    engine.push(createAnalyticsMiddleware({\n      providerConfig: this.getProviderConfig(),\n      analytics: this.analytics\n    }));\n    engine.push(ethereumMiddleware);\n    engine.push(networkMiddleware);\n    const provider = providerFromEngine(engine);\n    this.setProvider({\n      provider,\n      blockTracker\n    });\n  }\n  setProvider({\n    provider,\n    blockTracker\n  }) {\n    if (this.providerProxy) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this.providerProxy.setTarget(provider);\n    } else {\n      this.providerProxy = createSwappableProxy(provider);\n    }\n    if (this.blockTrackerProxy) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this.blockTrackerProxy.setTarget(blockTracker);\n    } else {\n      this.blockTrackerProxy = createEventEmitterProxy(blockTracker, {\n        eventFilter: \"skipInternal\"\n      });\n    }\n\n    // set new provider and blockTracker\n    this.provider = provider;\n    provider.setMaxListeners(10);\n    this.blockTracker = blockTracker;\n  }\n  configureStandardProvider(providerConfig) {\n    const networkClient = createJsonRpcClient(providerConfig, this.config, this.idleTimeTracker, this.analytics);\n    log.info(\"networkClient\", networkClient);\n    this.setNetworkClient(networkClient);\n  }\n  refreshNetwork() {\n    this.update({\n      chainId: \"loading\",\n      properties: {}\n    });\n    this.configureProvider();\n    this.lookupNetwork();\n  }\n}\n\nexport { NetworkController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4070, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/TransactionUtils.js"],"sourcesContent":["import { addHexPrefix, isHexString, isValidAddress } from '@ethereumjs/util';\nimport { randomId, TransactionStatus, TRANSACTION_TYPES } from '@toruslabs/base-controllers';\nimport { rpcErrors } from '@web3auth/auth';\nimport { Interface } from 'ethers';\nimport log from 'loglevel';\nimport { erc20Abi, erc721Abi, erc1155Abi } from '../utils/abis.js';\nimport { CONTRACT_TYPE_ERC20, CONTRACT_TYPE_ERC721, CONTRACT_TYPE_ERC1155, METHOD_TYPES, CONTRACT_TYPE_ETH, TRANSACTION_ENVELOPE_TYPES } from '../utils/constants.js';\n\nconst erc20Interface = new Interface(erc20Abi);\nconst erc721Interface = new Interface(erc721Abi);\nconst erc1155Interface = new Interface(erc1155Abi);\n\n// functions that handle normalizing of that key in txParams\n\nconst normalizers = {\n  from: (from, LowerCase = true) => LowerCase ? addHexPrefix(from).toLowerCase() : addHexPrefix(from),\n  to: (to, LowerCase = true) => LowerCase ? addHexPrefix(to).toLowerCase() : addHexPrefix(to),\n  nonce: nonce => addHexPrefix(nonce),\n  customNonceValue: nonce => addHexPrefix(nonce),\n  value: value => addHexPrefix(value),\n  data: data => addHexPrefix(data),\n  gas: gas => addHexPrefix(gas),\n  gasPrice: gasPrice => addHexPrefix(gasPrice),\n  type: addHexPrefix,\n  maxFeePerGas: addHexPrefix,\n  maxPriorityFeePerGas: addHexPrefix,\n  callGasLimit: addHexPrefix,\n  preVerificationGas: addHexPrefix,\n  verificationGasLimit: addHexPrefix,\n  paymasterVerificationGasLimit: addHexPrefix,\n  paymasterPostOpGasLimit: addHexPrefix\n};\n\n/**\n * normalizes txParams\n */\nfunction normalizeTxParameters(txParameters, lowerCase = true) {\n  // apply only keys in the normalizers\n  const normalizedTxParameters = {\n    id: txParameters.id || randomId(),\n    from: txParameters.from\n  };\n  for (const key in normalizers) {\n    const currentKey = key;\n    if (txParameters[currentKey])\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      normalizedTxParameters[currentKey] = normalizers[currentKey](txParameters[currentKey], lowerCase);\n  }\n  return normalizedTxParameters;\n}\nfunction transactionMatchesNetwork(transaction, chainId) {\n  if (typeof transaction.chainId !== \"undefined\") {\n    return transaction.chainId === chainId;\n  }\n  return false;\n}\n\n/**\n * Determines if the maxFeePerGas and maxPriorityFeePerGas fields are supplied\n * and valid inputs. This will return false for non hex string inputs.\n *  the transaction to check\n * @returns true if transaction uses valid EIP1559 fields\n */\nfunction isEIP1559Transaction(transaction) {\n  var _transaction$transact, _transaction$transact2;\n  return isHexString(addHexPrefix(transaction === null || transaction === void 0 || (_transaction$transact = transaction.transaction) === null || _transaction$transact === void 0 ? void 0 : _transaction$transact.maxFeePerGas)) && isHexString(addHexPrefix(transaction === null || transaction === void 0 || (_transaction$transact2 = transaction.transaction) === null || _transaction$transact2 === void 0 ? void 0 : _transaction$transact2.maxPriorityFeePerGas));\n}\n\n/**\n * Determine if the maxFeePerGas and maxPriorityFeePerGas fields are not\n * supplied and that the gasPrice field is valid if it is provided. This will\n * return false if gasPrice is a non hex string.\n * transaction -\n *  the transaction to check\n * @returns true if transaction uses valid Legacy fields OR lacks\n *  EIP1559 fields\n */\nfunction isLegacyTransaction(transaction) {\n  return typeof transaction.transaction.maxFeePerGas === \"undefined\" && typeof transaction.transaction.maxPriorityFeePerGas === \"undefined\" && (typeof transaction.transaction.gasPrice === \"undefined\" || isHexString(addHexPrefix(transaction.transaction.gasPrice)));\n}\n\n/**\n * Given two fields, ensure that the second field is not included in txParams,\n * and if it is throw an invalidParams error.\n */\nfunction ensureMutuallyExclusiveFieldsNotProvided(txParams, fieldBeingValidated, mutuallyExclusiveField) {\n  if (typeof txParams[mutuallyExclusiveField] !== \"undefined\") {\n    throw rpcErrors.invalidParams(`Invalid transaction params: specified ${fieldBeingValidated} but also included ${mutuallyExclusiveField}, these cannot be mixed`);\n  }\n}\n\n/**\n * Ensures that the provided value for field is a string, throws an\n * invalidParams error if field is not a string.\n */\nfunction ensureFieldIsString(txParams, field) {\n  if (typeof txParams[field] !== \"string\") {\n    throw rpcErrors.invalidParams(`Invalid transaction params: ${field} is not a string. got: (${txParams[field]})`);\n  }\n}\n\n/**\n * Ensures that the provided txParams has the proper 'type' specified for the\n * given field, if it is provided. If types do not match throws an\n * invalidParams error.\n */\nfunction ensureProperTransactionEnvelopeTypeProvided(txParams, field) {\n  switch (field) {\n    case \"maxFeePerGas\":\n    case \"maxPriorityFeePerGas\":\n      if (txParams.type && txParams.type !== TRANSACTION_ENVELOPE_TYPES.FEE_MARKET) {\n        throw rpcErrors.invalidParams(`Invalid transaction envelope type: specified type \"${txParams.type}\" but ` + `including maxFeePerGas and maxPriorityFeePerGas requires type: \"${TRANSACTION_ENVELOPE_TYPES.FEE_MARKET}\"`);\n      }\n      break;\n    case \"gasPrice\":\n    default:\n      if (txParams.type && txParams.type === TRANSACTION_ENVELOPE_TYPES.FEE_MARKET) {\n        throw rpcErrors.invalidParams(`Invalid transaction envelope type: specified type \"${txParams.type}\" but ` + \"included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas\");\n      }\n  }\n}\n\n/**\n * validates the from field in  txParams\n */\nfunction validateFrom(txParams) {\n  if (!(typeof txParams.from === \"string\")) {\n    throw rpcErrors.invalidParams(`Invalid \"from\" address \"${txParams.from}\": not a string.`);\n  }\n  if (!isValidAddress(txParams.from)) {\n    throw rpcErrors.invalidParams('Invalid \"from\" address.');\n  }\n}\n\n/**\n * validates the to field in  txParams\n */\nfunction validateRecipient(txParameters) {\n  if (txParameters.to === \"0x\" || txParameters.to === null) {\n    if (txParameters.data) {\n      delete txParameters.to;\n    } else {\n      throw rpcErrors.invalidParams('Invalid \"to\" address.');\n    }\n  } else if (txParameters.to !== undefined && !isValidAddress(txParameters.to)) {\n    throw rpcErrors.invalidParams('Invalid \"to\" address.');\n  }\n  return txParameters;\n}\n\n/**\n * Validates the given tx parameters\n * @throws if the tx params contains invalid fields\n */\nfunction validateTxParameters(txParams, eip1559Compatibility = true) {\n  if (!txParams || typeof txParams !== \"object\" || Array.isArray(txParams)) {\n    throw rpcErrors.invalidParams(\"Invalid transaction params: must be an object.\");\n  }\n  if (!txParams.to && !txParams.data) {\n    throw rpcErrors.invalidParams('Invalid transaction params: must specify \"data\" for contract deployments, or \"to\" (and optionally \"data\") for all other types of transactions.');\n  }\n  if (isEIP1559Transaction({\n    transaction: txParams\n  }) && !eip1559Compatibility) {\n    throw rpcErrors.invalidParams(\"Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559\");\n  }\n  Object.entries(txParams).forEach(([key, value]) => {\n    // validate types\n    switch (key) {\n      case \"from\":\n        validateFrom(txParams);\n        break;\n      case \"to\":\n        validateRecipient(txParams);\n        break;\n      case \"gasPrice\":\n        ensureProperTransactionEnvelopeTypeProvided(txParams, \"gasPrice\");\n        ensureMutuallyExclusiveFieldsNotProvided(txParams, \"gasPrice\", \"maxFeePerGas\");\n        ensureMutuallyExclusiveFieldsNotProvided(txParams, \"gasPrice\", \"maxPriorityFeePerGas\");\n        ensureFieldIsString(txParams, \"gasPrice\");\n        break;\n      case \"maxFeePerGas\":\n        ensureProperTransactionEnvelopeTypeProvided(txParams, \"maxFeePerGas\");\n        ensureMutuallyExclusiveFieldsNotProvided(txParams, \"maxFeePerGas\", \"gasPrice\");\n        ensureFieldIsString(txParams, \"maxFeePerGas\");\n        break;\n      case \"maxPriorityFeePerGas\":\n        ensureProperTransactionEnvelopeTypeProvided(txParams, \"maxPriorityFeePerGas\");\n        ensureMutuallyExclusiveFieldsNotProvided(txParams, \"maxPriorityFeePerGas\", \"gasPrice\");\n        ensureFieldIsString(txParams, \"maxPriorityFeePerGas\");\n        break;\n      case \"value\":\n        ensureFieldIsString(txParams, \"value\");\n        if (value.toString().includes(\"-\")) {\n          throw rpcErrors.invalidParams(`Invalid transaction value \"${value}\": not a positive number.`);\n        }\n        if (value.toString().includes(\".\")) {\n          throw rpcErrors.invalidParams(`Invalid transaction value of \"${value}\": number must be in wei.`);\n        }\n        break;\n      case \"chainId\":\n        if (typeof value !== \"number\" && typeof value !== \"string\") {\n          throw rpcErrors.invalidParams(`Invalid transaction params: ${key} is not a Number or hex string. got: (${value})`);\n        }\n        break;\n      default:\n        ensureFieldIsString(txParams, key);\n    }\n  });\n}\nfunction normalizeAndValidateTxParams(txParams, lowerCase = true) {\n  const normalizedTxParams = normalizeTxParameters(txParams, lowerCase);\n  validateTxParameters(normalizedTxParams);\n  return normalizedTxParams;\n}\n\n/**\n * @returns an array of states that can be considered final\n */\nfunction getFinalStates() {\n  return [TransactionStatus.rejected,\n  // the user has responded no!\n  TransactionStatus.confirmed,\n  // the tx has been included in a block.\n  TransactionStatus.failed,\n  // the tx failed for some reason, included on tx data.\n  TransactionStatus.dropped // the tx nonce was already used\n  ];\n}\nfunction parseStandardTokenTransactionData(data) {\n  try {\n    const txDesc = erc20Interface.parseTransaction({\n      data\n    });\n    if (txDesc) return {\n      name: txDesc.name,\n      methodParams: txDesc.args.toArray(),\n      type: CONTRACT_TYPE_ERC20\n    };\n  } catch {\n    // ignore and next try to parse with erc721 ABI\n  }\n  try {\n    const txDesc = erc721Interface.parseTransaction({\n      data\n    });\n    if (txDesc) return {\n      name: txDesc.name,\n      methodParams: txDesc.args.toArray(),\n      type: CONTRACT_TYPE_ERC721\n    };\n  } catch {\n    // ignore and next try to parse with erc1155 ABI\n  }\n  try {\n    const txDesc = erc1155Interface.parseTransaction({\n      data\n    });\n    if (txDesc) return {\n      name: txDesc.name,\n      methodParams: txDesc.args.toArray(),\n      type: CONTRACT_TYPE_ERC1155\n    };\n  } catch {\n    // ignore and return undefined\n  }\n  return undefined;\n}\nconst readAddressAsContract = async (provider, address) => {\n  let contractCode;\n  try {\n    contractCode = await provider.request({\n      method: METHOD_TYPES.ETH_GET_CODE,\n      params: [address, \"latest\"]\n    });\n  } catch {\n    contractCode = null;\n  }\n  const isContractAddress = contractCode ? contractCode !== \"0x\" && contractCode !== \"0x0\" : false;\n  return {\n    contractCode,\n    isContractAddress\n  };\n};\nasync function determineTransactionType(txParams, provider) {\n  const {\n    data,\n    to\n  } = txParams;\n  let name = \"\";\n  let methodParams = [];\n  let type = \"\";\n  try {\n    ({\n      name,\n      methodParams,\n      type\n    } = data && parseStandardTokenTransactionData(data) || {});\n  } catch (error) {\n    log.debug(\"Failed to parse transaction data\", error);\n  }\n  let result;\n  let contractCode = \"\";\n  if (data && !to) {\n    result = TRANSACTION_TYPES.DEPLOY_CONTRACT;\n  } else {\n    const {\n      contractCode: resultCode,\n      isContractAddress\n    } = await readAddressAsContract(provider, to);\n    contractCode = resultCode;\n    if (isContractAddress) {\n      const valueExists = txParams.value && Number(txParams.value) !== 0;\n      const tokenMethodName = [TRANSACTION_TYPES.TOKEN_METHOD_APPROVE, TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER, TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM, TRANSACTION_TYPES.COLLECTIBLE_METHOD_SAFE_TRANSFER_FROM, TRANSACTION_TYPES.SET_APPROVAL_FOR_ALL].find(x => {\n        var _name;\n        return x.toLowerCase() === ((_name = name) === null || _name === void 0 ? void 0 : _name.toLowerCase());\n      });\n      result = data && tokenMethodName && !valueExists ? tokenMethodName : TRANSACTION_TYPES.CONTRACT_INTERACTION;\n    } else {\n      result = TRANSACTION_TYPES.SENT_ETHER;\n    }\n  }\n  return {\n    type: type || CONTRACT_TYPE_ETH,\n    category: result,\n    methodParams,\n    getCodeResponse: contractCode\n  };\n}\n\nexport { determineTransactionType, ensureFieldIsString, ensureMutuallyExclusiveFieldsNotProvided, getFinalStates, isEIP1559Transaction, isLegacyTransaction, normalizeAndValidateTxParams, normalizeTxParameters, parseStandardTokenTransactionData, readAddressAsContract, transactionMatchesNetwork, validateFrom, validateRecipient, validateTxParameters };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4421, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/utils/helpers.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport { addHexPrefix, stripHexPrefix, isValidAddress, toChecksumAddress } from '@ethereumjs/util';\nimport { formatSmallNumbers, significantDigits, ACTIVITY_ACTION_RECEIVE, ACTIVITY_ACTION_SEND, addressSlicer, TransactionStatus } from '@toruslabs/base-controllers';\nimport { BigNumber } from 'bignumber.js';\nimport log from 'loglevel';\nimport { determineTransactionType } from '../Transaction/TransactionUtils.js';\nimport { SUPPORTED_NETWORKS, CONTRACT_TYPE_ERC721, CONTRACT_TYPE_ERC1155, CONTRACT_TYPE_ERC20, METHOD_TYPES, MAINNET_CHAIN_ID, TEST_CHAINS, CONTRACT_TYPE_ETH } from './constants.js';\n\nfunction hexToBn(hex) {\n  return new BigNumber(stripHexPrefix(hex), 16);\n}\nfunction BNToHex(bn) {\n  return addHexPrefix(bn.toString(16));\n}\nfunction getEtherScanHashLink(txHash, chainId) {\n  if (!SUPPORTED_NETWORKS[chainId]) return \"\";\n  return `${SUPPORTED_NETWORKS[chainId].blockExplorerUrl}/tx/${txHash}`;\n}\nconst formatPastTx = params => {\n  var _transaction$to;\n  const {\n    transaction,\n    lowerCaseSelectedAddress,\n    blockExplorerUrl\n  } = params;\n  let totalAmountString = \"\";\n  if (transaction.type === CONTRACT_TYPE_ERC721 || transaction.type === CONTRACT_TYPE_ERC1155) totalAmountString = transaction.symbol;else if (transaction.type === CONTRACT_TYPE_ERC20) totalAmountString = formatSmallNumbers(Number.parseFloat(transaction.total_amount), transaction.symbol, true);else totalAmountString = formatSmallNumbers(Number.parseFloat(transaction.total_amount), transaction.type_name, true);\n  const currencyAmountString = transaction.type === CONTRACT_TYPE_ERC721 || transaction.type === CONTRACT_TYPE_ERC1155 || transaction.isEtherscan ? \"\" : formatSmallNumbers(Number.parseFloat(transaction.currency_amount), transaction.selected_currency, true);\n  const finalObject = {\n    id: transaction.created_at.toString(),\n    date: new Date(transaction.created_at).toString(),\n    from: transaction.from,\n    from_aa_address: transaction.from_aa_address,\n    slicedFrom: typeof transaction.from === \"string\" ? addressSlicer(transaction.from) : \"\",\n    to: transaction.to,\n    slicedTo: typeof transaction.to === \"string\" ? addressSlicer(transaction.to) : \"\",\n    action: lowerCaseSelectedAddress === ((_transaction$to = transaction.to) === null || _transaction$to === void 0 ? void 0 : _transaction$to.toLowerCase()) || \"\" ? ACTIVITY_ACTION_RECEIVE : ACTIVITY_ACTION_SEND,\n    totalAmount: transaction.total_amount,\n    totalAmountString,\n    currencyAmount: transaction.currency_amount,\n    currencyAmountString,\n    amount: `${totalAmountString} / ${currencyAmountString}`,\n    status: transaction.status,\n    etherscanLink: blockExplorerUrl ? `${blockExplorerUrl}/tx/${transaction.transaction_hash}` : \"\",\n    chainId: transaction.chain_id,\n    ethRate: Number.parseFloat(transaction === null || transaction === void 0 ? void 0 : transaction.total_amount) && Number.parseFloat(transaction === null || transaction === void 0 ? void 0 : transaction.currency_amount) ? `1 ${transaction.symbol} = ${significantDigits(Number.parseFloat(transaction.currency_amount) / Number.parseFloat(transaction.total_amount))}` : \"\",\n    currencyUsed: transaction.selected_currency,\n    type: transaction.type,\n    type_name: transaction.type_name,\n    type_image_link: transaction.type_image_link,\n    transaction_hash: transaction.transaction_hash,\n    transaction_category: transaction.transaction_category,\n    isEtherscan: transaction.isEtherscan,\n    input: transaction.input || \"\",\n    token_id: transaction.token_id || \"\",\n    contract_address: transaction.contract_address || \"\",\n    nonce: transaction.nonce || \"\",\n    is_cancel: !!transaction.is_cancel || false,\n    gas: transaction.gas || \"\",\n    gasPrice: transaction.gasPrice || \"\"\n  };\n  return finalObject;\n};\n\n/**\n * Ref - https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_gettransactionreceipt\n */\nconst getEthTxStatus = async (hash, provider) => {\n  try {\n    const result = await provider.request({\n      method: METHOD_TYPES.ETH_GET_TRANSACTION_RECEIPT,\n      params: [hash]\n    });\n    if (result === null) return TransactionStatus.submitted;\n    if (result && result.status === \"0x1\") return TransactionStatus.confirmed;\n    if (result && result.status === \"0x0\") return TransactionStatus.rejected;\n    return undefined;\n  } catch (err) {\n    log.warn(\"unable to fetch transaction status\", err);\n    return undefined;\n  }\n};\nfunction formatDate(inputDate) {\n  const monthList = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n  const date = new Date(inputDate);\n  const day = date.getDate();\n  const month = monthList[date.getMonth()];\n  const year = date.getFullYear();\n  return `${day} ${month} ${year}`;\n}\nfunction formatTime(time) {\n  return new Date(time).toTimeString().slice(0, 8);\n}\nfunction isAddressByChainId(address, _chainId) {\n  // TOOD: add rsk network checks.\n  return isValidAddress(address);\n}\nfunction toChecksumAddressByChainId(address, chainId) {\n  // TOOD: add rsk network checks.\n  if (!isAddressByChainId(address)) return address;\n  return toChecksumAddress(address);\n}\nconst GAS_LIMITS = {\n  // maximum gasLimit of a simple send\n  SIMPLE: addHexPrefix(21000 .toString(16)),\n  // a base estimate for token transfers.\n  BASE_TOKEN_ESTIMATE: addHexPrefix(100000 .toString(16))\n};\nfunction bnLessThan(a, b) {\n  if (a === null || a === undefined || b === null || b === undefined) {\n    return null;\n  }\n  return new BigNumber(a, 10).lt(b, 10);\n}\nconst getIpfsEndpoint = path => `https://infura-ipfs.io/${path}`;\nfunction sanitizeNftMetdataUrl(url) {\n  let finalUri = url;\n  if (url !== null && url !== void 0 && url.startsWith(\"ipfs\")) {\n    const ipfsPath = url.split(\"ipfs://\")[1];\n    finalUri = getIpfsEndpoint(ipfsPath);\n  }\n  return finalUri;\n}\nfunction getChainType(chainId) {\n  if (chainId === MAINNET_CHAIN_ID) {\n    return \"mainnet\";\n  } else if (TEST_CHAINS.includes(chainId)) {\n    return \"testnet\";\n  }\n  return \"custom\";\n}\nconst addEtherscanTransactions = async params => {\n  const {\n    txn,\n    lowerCaseSelectedAddress,\n    provider,\n    chainId,\n    blockExplorerUrl\n  } = params;\n  const transactionPromises = await Promise.all(txn.map(async tx => {\n    var _SUPPORTED_NETWORKS$c, _SUPPORTED_NETWORKS$c2;\n    const {\n      category,\n      type\n    } = await determineTransactionType(_objectSpread(_objectSpread({}, tx), {}, {\n      data: tx.input\n    }), provider);\n    tx.transaction_category = tx.transaction_category || category;\n    tx.type_image_link = ((_SUPPORTED_NETWORKS$c = SUPPORTED_NETWORKS[chainId]) === null || _SUPPORTED_NETWORKS$c === void 0 ? void 0 : _SUPPORTED_NETWORKS$c.logo) || \"\";\n    tx.type_name = (_SUPPORTED_NETWORKS$c2 = SUPPORTED_NETWORKS[chainId]) === null || _SUPPORTED_NETWORKS$c2 === void 0 ? void 0 : _SUPPORTED_NETWORKS$c2.ticker;\n    tx.type = type;\n    return tx;\n  }));\n  const finalTxs = transactionPromises.reduce((accumulator, x) => {\n    var _SUPPORTED_NETWORKS$c3, _SUPPORTED_NETWORKS$c4;\n    let totalAmountString = x.value ? new BigNumber(x.value).div(new BigNumber(10).pow(new BigNumber(x.tokenDecimal || 18))).toString() : \"\";\n    let type = CONTRACT_TYPE_ETH;\n    if (x.contractAddress !== \"\") {\n      if (x.tokenID) {\n        type = x.tokenValue ? CONTRACT_TYPE_ERC1155 : CONTRACT_TYPE_ERC721;\n      } else {\n        type = CONTRACT_TYPE_ERC20;\n      }\n    }\n    if (type === CONTRACT_TYPE_ERC1155) {\n      totalAmountString = x.tokenValue;\n    }\n    const etherscanTransaction = {\n      type,\n      type_image_link: x.type_image_link || \"n/a\",\n      type_name: x.tokenName || ((_SUPPORTED_NETWORKS$c3 = SUPPORTED_NETWORKS[chainId]) === null || _SUPPORTED_NETWORKS$c3 === void 0 ? void 0 : _SUPPORTED_NETWORKS$c3.ticker) || \"n/a\",\n      symbol: x.tokenSymbol || ((_SUPPORTED_NETWORKS$c4 = SUPPORTED_NETWORKS[chainId]) === null || _SUPPORTED_NETWORKS$c4 === void 0 ? void 0 : _SUPPORTED_NETWORKS$c4.ticker),\n      token_id: x.tokenID || \"\",\n      total_amount: totalAmountString,\n      created_at: new Date(Number(x.timeStamp) * 1000),\n      from: x.from,\n      to: x.to,\n      transaction_hash: x.hash,\n      status: x.txreceipt_status && x.txreceipt_status === \"0\" ? TransactionStatus.failed : TransactionStatus.confirmed,\n      isEtherscan: true,\n      input: x.input,\n      contract_address: x.contractAddress,\n      transaction_category: x.transaction_category,\n      gas: `0x${new BigNumber(x.gasUsed || 0, 10).toString(16)}`,\n      gasPrice: `0x${new BigNumber(x.gasPrice || 0, 10).toString(16)}`,\n      chain_id: chainId,\n      currency_amount: \"\",\n      nonce: x.nonce,\n      from_aa_address: \"\",\n      is_cancel: false,\n      selected_currency: \"\"\n    };\n    accumulator.push(formatPastTx({\n      transaction: etherscanTransaction,\n      lowerCaseSelectedAddress,\n      blockExplorerUrl\n    }));\n    return accumulator;\n  }, []);\n  return finalTxs;\n};\n\nexport { BNToHex, GAS_LIMITS, addEtherscanTransactions, bnLessThan, formatDate, formatPastTx, formatTime, getChainType, getEthTxStatus, getEtherScanHashLink, getIpfsEndpoint, hexToBn, isAddressByChainId, sanitizeNftMetdataUrl, toChecksumAddressByChainId };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4672, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Nfts/NftHandler.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { get } from '@toruslabs/http-helpers';\nimport { Contract } from 'ethers';\nimport log from 'loglevel';\nimport { erc721Abi, erc1155Abi } from '../utils/abis.js';\nimport { CONTRACT_TYPE_ERC721, CONTRACT_TYPE_ERC1155, OLD_ERC721_LIST, ERC721_INTERFACE_ID, ERC1155_INTERFACE_ID } from '../utils/constants.js';\nimport { sanitizeNftMetdataUrl } from '../utils/helpers.js';\n\nclass NftHandler {\n  constructor({\n    chainId,\n    contractAddress,\n    contractImage,\n    contractName,\n    contractSymbol,\n    nftStandard,\n    provider,\n    contractDescription,\n    contractFallbackLogo,\n    contractSupply\n  }) {\n    _defineProperty(this, \"contractAddress\", void 0);\n    _defineProperty(this, \"contractName\", void 0);\n    _defineProperty(this, \"contractSymbol\", void 0);\n    _defineProperty(this, \"contractImage\", void 0);\n    _defineProperty(this, \"contractSupply\", void 0);\n    _defineProperty(this, \"contractFallbackLogo\", void 0);\n    _defineProperty(this, \"nftStandard\", void 0);\n    _defineProperty(this, \"contractDescription\", void 0);\n    _defineProperty(this, \"chainId\", void 0);\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"isSpecial\", void 0);\n    this.chainId = chainId;\n    this.contractAddress = contractAddress;\n    this.contractImage = contractImage;\n    this.contractName = contractName;\n    this.contractSymbol = contractSymbol;\n    this.nftStandard = nftStandard;\n    this.provider = provider;\n    this.contractDescription = contractDescription;\n    this.contractFallbackLogo = contractFallbackLogo;\n    this.contractSupply = contractSupply;\n  }\n  async getNftMetadata(userAddress, tokenInfo) {\n    const returnNftItem = _objectSpread({\n      description: \"\",\n      image: \"\",\n      name: \"\",\n      tokenBalance: \"\",\n      tokenId: \"\",\n      decimals: \"1\"\n    }, tokenInfo);\n    const [tokenURI, balance] = await Promise.all([this.getCollectibleTokenURI(returnNftItem.tokenId, this.nftStandard), !returnNftItem.tokenBalance ? this.fetchNftBalance(userAddress, returnNftItem.tokenId) : Promise.resolve(\"0\")]);\n    returnNftItem.tokenBalance = returnNftItem.tokenBalance || balance;\n    // some people put full json object in uri\n    try {\n      const object = JSON.parse(tokenURI);\n      returnNftItem.image = returnNftItem.image || sanitizeNftMetdataUrl(object.image);\n      returnNftItem.name = returnNftItem.name || object.name;\n      returnNftItem.description = returnNftItem.description || object.description;\n      returnNftItem.decimals = returnNftItem.decimals || object.decimals;\n    } catch (error) {\n      log.warn(\"Token uri is not a valid json object\", error);\n    }\n    const finalTokenMetaUri = sanitizeNftMetdataUrl(tokenURI);\n    try {\n      if (!returnNftItem.description || !returnNftItem.image || !returnNftItem.name) {\n        // this call might fail, if metadata url available in smart contract is not reachable\n        const object = await get(finalTokenMetaUri);\n        returnNftItem.image = returnNftItem.image || sanitizeNftMetdataUrl(object.image);\n        returnNftItem.name = returnNftItem.name || object.name;\n        returnNftItem.description = returnNftItem.description || object.description;\n        returnNftItem.decimals = returnNftItem.decimals || object.decimals;\n      }\n    } catch (error) {\n      log.error(\"Failed to fetch nft metadata\", error);\n    }\n    return returnNftItem;\n  }\n  async getContractMetadata() {\n    const returnNft = {\n      chainId: this.chainId,\n      contractAddress: this.contractAddress,\n      contractName: this.contractName,\n      contractSymbol: this.contractSymbol,\n      nftStandard: this.nftStandard,\n      contractImage: this.contractImage,\n      contractDescription: this.contractDescription,\n      contractFallbackLogo: this.contractFallbackLogo,\n      contractSupply: this.contractSupply\n    };\n    if (!this.nftStandard) {\n      const {\n        standard,\n        isSpecial\n      } = await this.checkNftStandard();\n      returnNft.nftStandard = standard;\n      this.nftStandard = standard;\n      this.isSpecial = isSpecial;\n    }\n    if (!this.contractName || !this.contractSymbol || !this.contractDescription) {\n      const abi = this.nftStandard === CONTRACT_TYPE_ERC721 ? erc721Abi : erc1155Abi;\n      const contract = new Contract(this.contractAddress, abi, this.provider);\n      const [name, symbol] = await Promise.all([contract.name(), contract.symbol()]);\n      returnNft.contractName = name;\n      returnNft.contractSymbol = symbol;\n      if (!this.contractName) this.contractName = name;\n      if (!this.contractSymbol) this.contractSymbol = symbol;\n    }\n    return returnNft;\n  }\n  async fetchNftBalance(userAddress, tokenId) {\n    const {\n      standard\n    } = await this.checkNftStandard();\n    const abi = standard === CONTRACT_TYPE_ERC721 ? erc721Abi : erc1155Abi;\n    const contract = new Contract(this.contractAddress, abi, this.provider);\n    if (standard === CONTRACT_TYPE_ERC1155) {\n      const balance = await contract.balanceOf(userAddress, tokenId);\n      return balance;\n    }\n    let owner = \"\";\n    try {\n      owner = await contract.ownerOf(tokenId);\n    } catch {\n      throw new Error(\"Token id doesn't exists\");\n    }\n    if (owner.toLowerCase() === userAddress.toLowerCase()) {\n      return \"1\";\n    }\n    return \"0\";\n  }\n  async checkNftStandard() {\n    // For Cryptokitties\n    if (this.nftStandard && this.isSpecial !== undefined) return;\n    if (Object.prototype.hasOwnProperty.call(OLD_ERC721_LIST, this.contractAddress.toLowerCase())) {\n      this.nftStandard = CONTRACT_TYPE_ERC721;\n      this.isSpecial = true;\n      return {\n        standard: CONTRACT_TYPE_ERC721,\n        isSpecial: true\n      };\n    }\n    const isErc721 = await this.contractSupportsInterface(CONTRACT_TYPE_ERC721, ERC721_INTERFACE_ID);\n    if (isErc721) {\n      this.nftStandard = CONTRACT_TYPE_ERC721;\n      this.isSpecial = false;\n      return {\n        standard: CONTRACT_TYPE_ERC721,\n        isSpecial: false\n      };\n    }\n    const isErc1155 = await this.contractSupportsInterface(CONTRACT_TYPE_ERC1155, ERC1155_INTERFACE_ID);\n    if (isErc1155) {\n      this.nftStandard = CONTRACT_TYPE_ERC1155;\n      this.isSpecial = false;\n      return {\n        standard: CONTRACT_TYPE_ERC1155,\n        isSpecial: false\n      };\n    }\n    throw new Error(\"Unsupported nft standard\");\n  }\n  async contractSupportsInterface(standard, interfaceId) {\n    const abi = standard === CONTRACT_TYPE_ERC721 ? erc721Abi : erc1155Abi;\n    const contract = new Contract(this.contractAddress, abi, this.provider);\n    return contract.supportsInterface(interfaceId);\n  }\n  async getCollectibleTokenURI(tokenId, standard = CONTRACT_TYPE_ERC721) {\n    const method = standard === CONTRACT_TYPE_ERC721 ? \"tokenURI\" : \"uri\";\n    const abi = standard === CONTRACT_TYPE_ERC721 ? erc721Abi : erc1155Abi;\n    const contract = new Contract(this.contractAddress, abi, this.provider);\n    return contract[method](tokenId);\n  }\n}\n\nexport { NftHandler };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4854, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Nfts/NftsController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseController, PollingManager } from '@toruslabs/base-controllers';\nimport deepmerge from 'deepmerge';\nimport { BrowserProvider } from 'ethers';\nimport log from 'loglevel';\nimport { MM_NFT_API_SUPPORTED_CHAINS } from '../utils/constants.js';\nimport { NftHandler } from './NftHandler.js';\n\nconst DEFAULT_INTERVAL = 180 * 1000;\nclass NftsController extends BaseController {\n  constructor({\n    config,\n    state,\n    provider,\n    getCustomNfts,\n    getSimpleHashNfts,\n    onPreferencesStateChange,\n    onNetworkStateChange,\n    idleTimeTracker\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"NftsController\");\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"ethersProvider\", void 0);\n    _defineProperty(this, \"getCustomNfts\", void 0);\n    _defineProperty(this, \"getSimpleHashNfts\", void 0);\n    _defineProperty(this, \"pollingManager\", void 0);\n    this.provider = provider;\n    this.ethersProvider = new BrowserProvider(this.provider, \"any\");\n    this.getCustomNfts = getCustomNfts;\n    this.getSimpleHashNfts = getSimpleHashNfts;\n    this.defaultConfig = {\n      interval: DEFAULT_INTERVAL,\n      selectedAddress: \"\",\n      chainId: \"\"\n    };\n    this.defaultState = {\n      nfts: {}\n    };\n    this.initialize();\n    onPreferencesStateChange(preferencesState => {\n      if (preferencesState.selectedAddress !== this.config.selectedAddress) {\n        this.configure({\n          selectedAddress: preferencesState.selectedAddress\n        });\n        this.restartNftDetection();\n      }\n    });\n    onNetworkStateChange(networkState => {\n      const {\n        chainId\n      } = networkState.providerConfig;\n      if (chainId !== this.config.chainId) {\n        this.configure({\n          chainId\n        });\n        this.restartNftDetection();\n      }\n    });\n    this.pollingManager = new PollingManager(idleTimeTracker, this.config.interval);\n  }\n  get userSelectedAddress() {\n    return this.config.selectedAddress;\n  }\n  get userNfts() {\n    var _this$state$nfts$this;\n    if (!this.userSelectedAddress) return [];\n    return (_this$state$nfts$this = this.state.nfts[this.userSelectedAddress]) !== null && _this$state$nfts$this !== void 0 ? _this$state$nfts$this : [];\n  }\n  startNftDetection(selectedAddress) {\n    this.configure({\n      selectedAddress\n    });\n    this.restartNftDetection();\n  }\n\n  /**\n   * Restart nft detection polling period and call detectNewNfts\n   * in case of address change or user session initialization.\n   *\n   */\n  restartNftDetection() {\n    if (!this.userSelectedAddress) {\n      return;\n    }\n    this.pollingManager.start(() => {\n      this.detectNewNfts();\n      this.refreshNftBalances();\n    });\n  }\n  detectNewNfts() {\n    const userAddress = this.userSelectedAddress;\n    if (!userAddress) return;\n    const currentChainId = this.config.chainId;\n    const nftsToDetect = []; // object[]\n    if (!currentChainId) {\n      this.update({\n        nfts: {\n          [userAddress]: [...nftsToDetect]\n        }\n      });\n      return;\n    }\n    if (this.getCustomNfts) {\n      const customNfts = this.getCustomNfts(userAddress);\n      const reducedNfts = customNfts.reduce((acc, x) => {\n        // first aggregate by contract address\n        if (x.network === currentChainId) {\n          const newAsset = {\n            description: \"\",\n            image: \"\",\n            name: \"\",\n            tokenBalance: \"\",\n            tokenId: x.nft_id,\n            customNftId: x.id.toString()\n          };\n          if (acc[x.nft_address]) {\n            acc[x.nft_address].assets.push(newAsset);\n          } else {\n            const objToPush = {\n              assets: [newAsset],\n              chainId: x.network,\n              contractAddress: x.nft_address,\n              contractName: \"\",\n              contractSymbol: \"\",\n              contractImage: \"\",\n              nftStandard: x.nft_contract_standard,\n              contractDescription: \"\"\n            };\n            acc[x.nft_address] = objToPush;\n          }\n        }\n        return acc;\n      }, {});\n      nftsToDetect.push(...Object.values(reducedNfts));\n    }\n    this.update({\n      nfts: {\n        [userAddress]: [...nftsToDetect]\n      }\n    });\n  }\n  async refreshNftBalances(skipCache) {\n    const userAddress = this.userSelectedAddress;\n    if (userAddress === \"\") return;\n    const oldNfts = [...this.userNfts];\n    const nonZeroNfts = [];\n    try {\n      const currentChainId = this.config.chainId;\n      if (MM_NFT_API_SUPPORTED_CHAINS.includes(currentChainId)) {\n        const simpleHashBalances = await this.getSimpleHashNfts(userAddress, currentChainId, skipCache);\n        nonZeroNfts.push(...simpleHashBalances);\n        this.update({\n          nfts: {\n            [userAddress]: nonZeroNfts\n          }\n        });\n      }\n      if (oldNfts.length > 0) {\n        this.getNftBalancesUsingHandler(oldNfts);\n      }\n    } catch (error) {\n      log.error(error, \"unable to fetch nft balances\");\n    }\n  }\n  async getNftBalancesUsingHandler(customNfts) {\n    if (!this.userSelectedAddress) return;\n    const userAddress = this.userSelectedAddress;\n    const currentNetworkNfts = customNfts;\n    const promiseSettledResult = await Promise.allSettled(currentNetworkNfts.map(async x => {\n      try {\n        const tokenInstance = new NftHandler(_objectSpread(_objectSpread({}, x), {}, {\n          provider: this.ethersProvider\n        }));\n        const contractData = await tokenInstance.getContractMetadata();\n        const assetData = await Promise.allSettled(x.assets.map(y => tokenInstance.getNftMetadata(userAddress, y)));\n        return _objectSpread(_objectSpread({}, contractData), {}, {\n          assets: assetData.filter(z => z.status === \"fulfilled\").map(z => z.value)\n        });\n      } catch (error) {\n        log.warn(\"Invalid contract address while fetching\", error);\n        return undefined;\n      }\n    }));\n    const nonZeroTokens = promiseSettledResult.filter(x => x.status === \"fulfilled\" && x.value).map(x => x.value);\n    this.update({\n      nfts: {\n        [userAddress]: deepmerge(this.userNfts, nonZeroTokens)\n      }\n    });\n  }\n}\n\nexport { NftsController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5062, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Preferences/PreferencesController.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { stripHexPrefix } from '@ethereumjs/util';\nimport { BasePreferencesController, CHAIN_NAMESPACES, isUnauthorizedError, TransactionStatus } from '@toruslabs/base-controllers';\nimport { Mutex } from 'async-mutex';\nimport log from 'loglevel';\nimport { MM_TOKEN_API_SUPPORTED_CHAINS, SUPPORTED_NETWORKS } from '../utils/constants.js';\nimport { formatPastTx, addEtherscanTransactions, getEthTxStatus, formatTime, formatDate } from '../utils/helpers.js';\n\nclass PreferencesController extends BasePreferencesController {\n  constructor({\n    config,\n    state,\n    provider,\n    signAuthMessage,\n    getProviderConfig,\n    setProviderConfig,\n    validateSignMessage\n  }) {\n    super({\n      config,\n      state,\n      defaultPreferences: {\n        formattedPastTransactions: [],\n        fetchedPastTx: [],\n        paymentTx: [],\n        etherscanTransactions: []\n      },\n      signAuthMessage,\n      validateSignMessage\n    });\n    _defineProperty(this, \"chainNamespace\", CHAIN_NAMESPACES.EIP155);\n    _defineProperty(this, \"_handle\", void 0);\n    _defineProperty(this, \"_mutex\", new Mutex());\n    _defineProperty(this, \"getProviderConfig\", void 0);\n    _defineProperty(this, \"setProviderConfig\", void 0);\n    _defineProperty(this, \"provider\", void 0);\n    this.provider = provider;\n    this.getProviderConfig = getProviderConfig;\n    this.setProviderConfig = setProviderConfig;\n  }\n  async poll(interval) {\n    var _this$getAddressState;\n    const releaseLock = await this._mutex.acquire();\n    if (interval) this.configure({\n      pollInterval: interval\n    });\n    if (this._handle) window.clearTimeout(this._handle);\n    // call here\n    const storeSelectedAddress = this.state.selectedAddress;\n    if (!storeSelectedAddress) return;\n    if (!((_this$getAddressState = this.getAddressState(storeSelectedAddress)) !== null && _this$getAddressState !== void 0 && _this$getAddressState.jwtToken)) return;\n    // This should never throw\n    await this.sync(storeSelectedAddress);\n    releaseLock();\n    this._handle = window.setTimeout(() => {\n      this.poll(this.config.pollInterval);\n    }, this.config.pollInterval);\n  }\n  async initPreferences(params) {\n    const {\n      address,\n      jwtToken,\n      calledFromEmbed,\n      userInfo,\n      rehydrate,\n      locale = \"en\",\n      type,\n      signatures,\n      web3AuthClientId,\n      web3AuthNetwork,\n      loginMode,\n      sessionPubKey,\n      aaProvider,\n      eoaAddress,\n      mainAddress\n    } = params;\n    const {\n      chainId\n    } = this.getProviderConfig();\n    await super.init({\n      address,\n      userInfo,\n      idToken: jwtToken,\n      type,\n      metadata: {\n        email: userInfo.email,\n        signatures,\n        network: web3AuthNetwork,\n        eoa_address: eoaAddress,\n        aa_provider: aaProvider,\n        chain_id: chainId,\n        main_address: mainAddress\n      }\n    });\n    const {\n      groupedAuthConnectionId,\n      authConnectionId,\n      userId\n    } = userInfo || {};\n    const userExists = await this.sync(address);\n    if (!userExists) {\n      const accountState = this.getAddressState(address);\n      await this.createUser({\n        selectedCurrency: accountState.selectedCurrency,\n        theme: accountState.theme,\n        groupedAuthConnectionId,\n        authConnectionId,\n        userId,\n        locale,\n        address,\n        type,\n        web3AuthNetwork,\n        metadata: {\n          aa_provider: aaProvider,\n          chain_id: chainId,\n          eoa_address: eoaAddress\n        }\n      });\n    }\n    if (eoaAddress) this.updateState({\n      eoaAddress\n    }, address);\n    this.storeUserLogin({\n      groupedAuthConnectionId,\n      authConnectionId,\n      userId,\n      options: {\n        calledFromEmbed,\n        rehydrate\n      },\n      address,\n      web3AuthClientId,\n      web3AuthNetwork,\n      sessionPubKey,\n      loginMode\n    });\n  }\n  getSelectedAddress() {\n    return this.state.selectedAddress;\n  }\n  async sync(address) {\n    try {\n      const user = await this.getUser(address);\n      if (user) {\n        const {\n          default_currency: defaultCurrency,\n          contacts,\n          theme,\n          locale,\n          public_address: userPublicAddress,\n          default_public_address: defaultPublicAddress,\n          customNetworks,\n          customTokens,\n          customNfts,\n          account_type: accountType\n        } = user || {};\n\n        // update latest data in state.\n        this.updateState({\n          contacts,\n          theme,\n          selectedCurrency: defaultCurrency,\n          locale,\n          defaultPublicAddress: defaultPublicAddress || userPublicAddress,\n          customTokens,\n          customNfts,\n          customNetworks,\n          accountType: accountType\n        }, address);\n        return true;\n      }\n      return false;\n    } catch (error) {\n      if (isUnauthorizedError(error)) {\n        throw error;\n      }\n      log.error(error);\n      return false;\n    } finally {\n      this.getWalletOrders(address).then(walletTx => {\n        // eslint-disable-next-line promise/always-return\n        if (walletTx && walletTx.length > 0) {\n          this.updateState({\n            fetchedPastTx: [...walletTx]\n          }, address);\n          this.calculatePastTx(walletTx, address);\n        }\n      }).catch(error => log.error(error));\n    }\n  }\n  async patchNewTx(tx, address) {\n    var _this$getAddressState2;\n    const formattedTx = formatPastTx({\n      transaction: tx,\n      blockExplorerUrl: this.getBlockExplorerUrl()\n    });\n    const storePastTx = ((_this$getAddressState2 = this.getAddressState(address)) === null || _this$getAddressState2 === void 0 ? void 0 : _this$getAddressState2.formattedPastTransactions) || [];\n    const duplicateIndex = storePastTx.findIndex(x => x.transaction_hash === tx.transaction_hash && x.chainId === tx.chain_id);\n    if (tx.status === TransactionStatus.submitted || tx.status === TransactionStatus.confirmed) {\n      if (duplicateIndex === -1) {\n        var _tx$to;\n        // No duplicate found\n\n        const finalTx = this.cancelTxCalculate([...storePastTx, formattedTx]);\n        tx.is_cancel = formattedTx.is_cancel;\n        tx.to = (_tx$to = tx.to) === null || _tx$to === void 0 ? void 0 : _tx$to.toLowerCase();\n        tx.from = tx.from.toLowerCase();\n        this.updateState({\n          formattedPastTransactions: finalTx\n        }, address);\n        this.postPastTx(tx, address);\n      } else {\n        // avoid overriding is_cancel\n        formattedTx.is_cancel = storePastTx[duplicateIndex].is_cancel;\n        storePastTx[duplicateIndex] = formattedTx;\n        this.updateState({\n          formattedPastTransactions: this.cancelTxCalculate([...storePastTx])\n        }, address);\n      }\n    }\n  }\n  recalculatePastTx(address) {\n    // This triggers store update which calculates past Tx status for that network\n    const selectedAddress = address || this.state.selectedAddress;\n    const state = this.getAddressState(selectedAddress);\n    if (!(state !== null && state !== void 0 && state.fetchedPastTx)) return;\n    this.calculatePastTx(state.fetchedPastTx, selectedAddress);\n  }\n  async refetchEtherscanTx(address) {\n    var _this$getAddressState3;\n    const selectedAddress = address || this.state.selectedAddress;\n    if (!selectedAddress) return [];\n    const lowerCaseSelectedAddress = selectedAddress === null || selectedAddress === void 0 ? void 0 : selectedAddress.toLowerCase();\n    if ((_this$getAddressState3 = this.getAddressState(selectedAddress)) !== null && _this$getAddressState3 !== void 0 && _this$getAddressState3.jwtToken) {\n      const {\n        chainId\n      } = this.getProviderConfig();\n      if (MM_TOKEN_API_SUPPORTED_CHAINS.includes(chainId)) {\n        const etherscanTxn = await this.fetchEtherscanTx({\n          selectedAddress,\n          chainId: this.getProviderConfig().chainId\n        });\n        const finalEthScanTxn = await addEtherscanTransactions({\n          txn: etherscanTxn,\n          lowerCaseSelectedAddress,\n          provider: this.provider,\n          chainId,\n          blockExplorerUrl: this.getBlockExplorerUrl()\n        });\n        log.info(\"Formatted Etherscan Response\", finalEthScanTxn);\n        this.updateState({\n          etherscanTransactions: finalEthScanTxn\n        });\n        return etherscanTxn;\n      }\n    }\n  }\n  async fetchEtherscanTx(parameters) {\n    try {\n      const response = await this.wsApiClient.authGet(`etherscan?chainId=${parameters.chainId}`, this.authCredentials(parameters.selectedAddress));\n      log.info(\"Etherscan Response API\", response);\n      return response.success ? response.data : [];\n    } catch (error) {\n      log.error(\"unable to fetch etherscan tx\", error);\n      return [];\n    }\n  }\n  async fetchQuote(parameters) {\n    try {\n      const response = await this.wsApiClient.authPost(\"quote\", parameters, this.authCredentials());\n      return response.success ? response.data : [];\n    } catch (error) {\n      log.error(\"unable to get swap quote\", error);\n      return [];\n    }\n  }\n  async getEtherScanTokens(address, chainId, skipCache) {\n    const selectedAddress = address;\n    let path = `tokens?chainId=${chainId}&address=${selectedAddress}`;\n    if (skipCache) {\n      path += `&skipCache=true`;\n    }\n    const result = await this.wsApiClient.authGet(path, this.authCredentials());\n    return result.data;\n  }\n  async getSimpleHashNfts(address, chainId, skipCache) {\n    const selectedAddress = address;\n    let path = `nfts?chainId=${chainId}&address=${selectedAddress}`;\n    if (skipCache) {\n      path += `&skipCache=true`;\n    }\n    const result = await this.wsApiClient.authGet(path, this.authCredentials());\n    return result.data;\n  }\n  getCustomTokens(address) {\n    var _this$getAddressState4, _this$getAddressState5;\n    return (_this$getAddressState4 = (_this$getAddressState5 = this.getAddressState(address)) === null || _this$getAddressState5 === void 0 ? void 0 : _this$getAddressState5.customTokens) !== null && _this$getAddressState4 !== void 0 ? _this$getAddressState4 : [];\n  }\n  getCustomNfts(address) {\n    var _this$getAddressState6, _this$getAddressState7;\n    return (_this$getAddressState6 = (_this$getAddressState7 = this.getAddressState(address)) === null || _this$getAddressState7 === void 0 ? void 0 : _this$getAddressState7.customNfts) !== null && _this$getAddressState6 !== void 0 ? _this$getAddressState6 : [];\n  }\n  isChainIdSupported(address, chainId) {\n    const approveChainOptions = this.getChainOptions(address);\n    const providerConfig = approveChainOptions.find(x => stripHexPrefix(x.chainId) === chainId);\n    return !!providerConfig;\n  }\n  async addChain(network) {\n    const approveChainOptions = this.getChainOptions();\n    const providerConfig = approveChainOptions.find(x => x.chainId === network.chainId);\n    if (providerConfig) return;\n    const newNetwork = {\n      displayName: network.chainName,\n      rpcTarget: network.rpcUrls[0],\n      ticker: network.nativeCurrency.symbol,\n      chainId: network.chainId,\n      blockExplorerUrl: network.blockExplorerUrls[0],\n      tickerName: network.nativeCurrency.name,\n      logo: network.nativeCurrency.symbol\n    };\n    const isSuccess = await this.addCustomNetwork({\n      network: newNetwork\n    });\n    if (!isSuccess) throw new Error(\"unable to add custom network\");\n  }\n  switchChain(data) {\n    const chainOptions = this.getChainOptions();\n    const providerConfig = chainOptions.find(x => x.chainId === data.chainId);\n    if (providerConfig) {\n      this.setProviderConfig(providerConfig);\n    } else {\n      throw new Error(`chainId ${data.chainId} is not supported`);\n    }\n  }\n\n  // Custom Network methods\n  async addCustomNetwork({\n    network\n  }) {\n    try {\n      const {\n        selectedAddress\n      } = this.state;\n      const payload = {\n        network_name: network.displayName,\n        rpc_url: network.rpcTarget,\n        chain_id: network.chainId,\n        symbol: network.ticker,\n        block_explorer_url: network.blockExplorerUrl || undefined,\n        is_testnet: network.isTestnet || false,\n        logo: network.logo,\n        symbol_name: network.tickerName\n      };\n      const res = await this.wsApiClient.authPost(\"customnetwork\", payload, this.authCredentials(selectedAddress), {\n        useAPIKey: true\n      });\n      await this.sync(selectedAddress);\n      return res.data.id;\n    } catch {\n      log.error(\"error adding custom network\");\n      return null;\n    }\n  }\n  async deleteCustomNetwork(id) {\n    try {\n      const {\n        selectedAddress\n      } = this.state;\n      await this.wsApiClient.authRemove(`customnetwork/${id}`, {}, this.authCredentials(selectedAddress), {\n        useAPIKey: true\n      });\n      await this.sync(selectedAddress);\n      return true;\n    } catch {\n      log.error(\"error deleting custom network\");\n      return false;\n    }\n  }\n  async editCustomNetwork({\n    network,\n    id\n  }) {\n    try {\n      const {\n        selectedAddress\n      } = this.state;\n      const payload = {\n        network_name: network.displayName,\n        rpc_url: network.rpcTarget,\n        chain_id: network.chainId,\n        symbol: network.ticker || undefined,\n        block_explorer_url: network.blockExplorerUrl || undefined,\n        is_testnet: network.isTestnet || false\n      };\n      await this.wsApiClient.authPatch(`customnetwork/${id}`, payload, this.authCredentials(selectedAddress), {\n        useAPIKey: true\n      });\n      await this.sync(selectedAddress);\n      return true;\n    } catch {\n      log.error(\"error editing custom network\");\n      return false;\n    }\n  }\n  getChainOptions(address = this.state.selectedAddress) {\n    var _identities$address$c, _identities$address;\n    const {\n      identities\n    } = this.state;\n    const customNetworks = (_identities$address$c = (_identities$address = identities[address]) === null || _identities$address === void 0 ? void 0 : _identities$address.customNetworks) !== null && _identities$address$c !== void 0 ? _identities$address$c : [];\n    const custom = Object.values(customNetworks).reduce((chains, network) => {\n      const networkItem = {\n        blockExplorerUrl: network.block_explorer_url,\n        chainId: network.chain_id,\n        displayName: network.network_name,\n        logo: \"eth.svg\",\n        rpcTarget: network.rpc_url,\n        ticker: network.symbol,\n        tickerName: network.symbol.toUpperCase(),\n        isCustom: true,\n        id: network.id\n      };\n      if (Object.keys(SUPPORTED_NETWORKS).includes(networkItem.chainId)) return chains;\n      chains.push(networkItem);\n      return chains;\n    }, []);\n    const supported = Object.values(SUPPORTED_NETWORKS).reduce((chains, network) => {\n      chains.push(network);\n      return chains;\n    }, []);\n    return [...supported, ...custom];\n  }\n  getBlockExplorerUrl() {\n    const supportedNetworks = this.getChainOptions();\n    const network = supportedNetworks.find(x => x.chainId === this.getProviderConfig().chainId);\n    if (!network) return \"\";\n    return `${network.blockExplorerUrl}`;\n  }\n  async calculatePastTx(txs, address) {\n    const pastTx = [];\n    const pendingTx = [];\n    const lowerCaseSelectedAddress = address.toLowerCase();\n    const supportedNetworks = this.getChainOptions(address);\n    const supportedNetwork = supportedNetworks.find(x => x.chainId === this.getProviderConfig().chainId);\n    for (const x of txs) {\n      var _x$to;\n      if ((supportedNetwork === null || supportedNetwork === void 0 ? void 0 : supportedNetwork.chainId) === x.chain_id && x.to && x.from && (lowerCaseSelectedAddress === x.from.toLowerCase() || lowerCaseSelectedAddress === ((_x$to = x.to) === null || _x$to === void 0 ? void 0 : _x$to.toLowerCase()))) {\n        if (x.status !== \"confirmed\") {\n          pendingTx.push(x);\n        } else {\n          const finalObject = formatPastTx({\n            transaction: x,\n            lowerCaseSelectedAddress,\n            blockExplorerUrl: this.getBlockExplorerUrl()\n          });\n          pastTx.push(finalObject);\n        }\n      }\n    }\n    const pendingTxPromises = pendingTx.map(x => getEthTxStatus(x.transaction_hash, this.provider).catch(error => log.error(error)));\n    const resolvedTxStatuses = await Promise.all(pendingTxPromises);\n    for (const [index, element] of pendingTx.entries()) {\n      const finalObject = formatPastTx({\n        transaction: element,\n        lowerCaseSelectedAddress,\n        blockExplorerUrl: this.getBlockExplorerUrl()\n      });\n      finalObject.status = resolvedTxStatuses[index] || TransactionStatus.submitted;\n      pastTx.push(finalObject);\n      if (lowerCaseSelectedAddress === element.from.toLowerCase() && finalObject.status && finalObject.status !== element.status) this.patchPastTx({\n        id: element.id,\n        status: finalObject.status\n      }, address);\n    }\n    const finalTx = this.cancelTxCalculate(pastTx);\n    this.updateState({\n      formattedPastTransactions: [...finalTx]\n    }, address);\n  }\n  cancelTxCalculate(pastTx) {\n    const nonceMap = {};\n    for (const x of pastTx) {\n      if (!nonceMap[x.nonce]) nonceMap[x.nonce] = [x];else {\n        nonceMap[x.nonce].push(x);\n      }\n    }\n    for (const [, value] of Object.entries(nonceMap)) {\n      // has duplicate\n      if (value.length > 1) {\n        // get latest and mark it as is_cancel\n        const latestTxs = value.sort((a, b) => {\n          const aDate = new Date(a.date).getTime();\n          const bDate = new Date(b.date).getTime();\n          return bDate - aDate;\n        });\n        const latestCancelTx = latestTxs[0];\n        latestCancelTx.is_cancel = true;\n        latestTxs.slice(1).forEach(x => {\n          x.hasCancel = true;\n          x.status = latestCancelTx.status === \"confirmed\" ? TransactionStatus.cancelled : TransactionStatus.cancelling;\n          x.cancelDateInitiated = `${formatTime(new Date(latestCancelTx.date).getTime())} - ${formatDate(latestCancelTx.date)}`;\n          x.etherscanLink = latestCancelTx.etherscanLink;\n          x.cancelGas = latestCancelTx.gas;\n          x.cancelGasPrice = latestCancelTx.gasPrice;\n        });\n      }\n    }\n    return pastTx;\n  }\n}\n\nexport { PreferencesController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5547, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Tokens/TokenHandler.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { Contract } from 'ethers';\nimport log from 'loglevel';\nimport { erc20Abi } from '../utils/abis.js';\n\nclass TokenHandler {\n  constructor({\n    address,\n    symbol,\n    decimals,\n    name,\n    provider\n  }) {\n    _defineProperty(this, \"address\", void 0);\n    _defineProperty(this, \"symbol\", void 0);\n    _defineProperty(this, \"decimals\", void 0);\n    _defineProperty(this, \"name\", void 0);\n    _defineProperty(this, \"contract\", void 0);\n    this.address = address;\n    this.contract = new Contract(address, erc20Abi, provider);\n    this.symbol = symbol;\n    this.decimals = decimals;\n    this.name = name;\n  }\n  async getSymbol() {\n    if (!this.symbol || this.symbol === \"ERC20\") this.symbol = await this.contract.symbol();\n    return this.symbol;\n  }\n  async getDecimals() {\n    try {\n      if (!this.decimals) this.decimals = await this.contract.decimals();\n      return this.decimals;\n    } catch (error) {\n      log.warn(`Could not get decimals for token ${this.address}`, error);\n      return 0;\n    }\n  }\n  async getName() {\n    if (!this.name) this.name = await this.contract.name();\n    return this.name;\n  }\n  async getUserBalance(userAddress) {\n    if (!this.decimals) await this.getDecimals();\n    const balance = await this.contract.balanceOf(userAddress);\n    return balance.toString(16);\n  }\n}\n\nexport { TokenHandler };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM;IACJ,YAAY,EACV,OAAO,EACP,MAAM,EACN,QAAQ,EACR,IAAI,EACJ,QAAQ,EACT,CAAE;QACD,IAAA,oLAAe,EAAC,IAAI,EAAE,WAAW,KAAK;QACtC,IAAA,oLAAe,EAAC,IAAI,EAAE,UAAU,KAAK;QACrC,IAAA,oLAAe,EAAC,IAAI,EAAE,YAAY,KAAK;QACvC,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ,KAAK;QACnC,IAAA,oLAAe,EAAC,IAAI,EAAE,YAAY,KAAK;QACvC,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,QAAQ,GAAG,IAAI,2KAAQ,CAAC,SAAS,4MAAQ,EAAE;QAChD,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,IAAI,GAAG;IACd;IACA,MAAM,YAAY;QAChB,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,CAAC,MAAM,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM;QACrF,OAAO,IAAI,CAAC,MAAM;IACpB;IACA,MAAM,cAAc;QAClB,IAAI;YACF,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,QAAQ;YAChE,OAAO,IAAI,CAAC,QAAQ;QACtB,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,IAAI,CAAC,CAAC,iCAAiC,EAAE,IAAI,CAAC,OAAO,EAAE,EAAE;YAC7D,OAAO;QACT;IACF;IACA,MAAM,UAAU;QACd,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI;QACpD,OAAO,IAAI,CAAC,IAAI;IAClB;IACA,MAAM,eAAe,WAAW,EAAE;QAChC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,IAAI,CAAC,WAAW;QAC1C,MAAM,UAAU,MAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;QAC9C,OAAO,QAAQ,QAAQ,CAAC;IAC1B;AACF","ignoreList":[0]}},
    {"offset": {"line": 5600, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Tokens/TokenRatesController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseController, PollingManager } from '@toruslabs/base-controllers';\nimport { get } from '@toruslabs/http-helpers';\nimport log from 'loglevel';\nimport { COINGECKO_PLATFORMS_CHAIN_CODE_MAP, COINGECKO_SUPPORTED_CURRENCIES } from '../utils/constants.js';\n\nconst DEFAULT_CURRENCY = \"eth\";\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\n\nclass TokenRatesController extends BaseController {\n  constructor({\n    config,\n    state,\n    idleTimeTracker,\n    onPreferencesStateChange,\n    onNetworkStateChange,\n    onTokensStateChange\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"pollingManager\", void 0);\n    this.defaultState = _objectSpread(_objectSpread({}, this.defaultState), {}, {\n      contractExchangeRates: {}\n    });\n    this.initialize();\n    onPreferencesStateChange(preferencesState => {\n      const {\n        selectedAddress\n      } = preferencesState;\n      this.configure({\n        selectedAddress\n      });\n    });\n    onNetworkStateChange(networkState => {\n      const {\n        chainId,\n        ticker\n      } = networkState.providerConfig;\n      this.configure({\n        chainId,\n        nativeCurrency: ticker\n      });\n    });\n    onTokensStateChange(tokensState => {\n      const {\n        tokens\n      } = tokensState;\n      const currentUserTokens = tokens[this.config.selectedAddress];\n      if ((currentUserTokens === null || currentUserTokens === void 0 ? void 0 : currentUserTokens.length) > 0 && this.config.tokens !== tokens[this.config.selectedAddress]) {\n        this.configure({\n          tokens: tokens[this.config.selectedAddress]\n        });\n        this.updateExchangeRates();\n      }\n    });\n    this.pollingManager = new PollingManager(idleTimeTracker, this.config.pollInterval);\n  }\n\n  /**\n   * Creates a new poll, using setInterval, to periodically call updateConversionRate. The id of the interval is\n   * stored at the controller's conversionInterval property. If it is called and such an id already exists, the\n   * previous interval is clear and a new one is created.\n   */\n  async scheduleConversionInterval() {\n    this.pollingManager.start(this.updateExchangeRates.bind(this));\n  }\n  async updateExchangeRates() {\n    const chainCodes = COINGECKO_PLATFORMS_CHAIN_CODE_MAP[this.config.chainId];\n    let newContractExchangeRates = {};\n    if (!chainCodes) {\n      log.info(`ChainId ${this.config.chainId} not supported by coingecko`);\n      this.config.tokens.forEach(token => {\n        newContractExchangeRates[token.tokenAddress] = undefined;\n      });\n    } else {\n      newContractExchangeRates = await this.fetchExchangeRates(this.config.nativeCurrency, chainCodes);\n    }\n    this.update({\n      contractExchangeRates: newContractExchangeRates\n    });\n  }\n  async fetchExchangeRates(nativeCurrency, chainCodes) {\n    const contractAddresses = this.config.tokens.map(token => token.tokenAddress);\n    const isNativeCurrencySupported = COINGECKO_SUPPORTED_CURRENCIES.has(nativeCurrency.toLowerCase());\n    if (isNativeCurrencySupported) {\n      const response = await get(`${this.config.currencyApi}/currency/exchange-rates?platform=${chainCodes.platform}&contract_addresses=${contractAddresses.join(\",\")}&vs_currencies=${nativeCurrency.toLowerCase()}`);\n      const newContractExchangeRates = {};\n      Object.keys(response).forEach(contractAddress => {\n        newContractExchangeRates[contractAddress] = response[contractAddress][nativeCurrency.toLowerCase()] || 0;\n      });\n      return newContractExchangeRates;\n    }\n    const [response, currencyResponse] = await Promise.all([get(`${this.config.currencyApi}/currency/exchange-rates?platform=${chainCodes.platform}&contract_addresses=${contractAddresses.join(\",\")}&vs_currencies=${DEFAULT_CURRENCY}`), get(`${this.config.currencyApi}/currency?fsym=${nativeCurrency.toUpperCase()}&tsyms=${DEFAULT_CURRENCY.toUpperCase()}`)]);\n    const newContractExchangeRates = {};\n    Object.keys(response).forEach(contractAddress => {\n      newContractExchangeRates[contractAddress] = response[contractAddress][DEFAULT_CURRENCY] * Number.parseFloat(currencyResponse[DEFAULT_CURRENCY]) || 0;\n    });\n    return newContractExchangeRates;\n  }\n}\n\nexport { DEFAULT_CURRENCY, TokenRatesController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5706, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Tokens/TokensController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { BaseController, PollingManager } from '@toruslabs/base-controllers';\nimport { BrowserProvider, Contract, toQuantity } from 'ethers';\nimport log from 'loglevel';\nimport { singleBalanceCheckerAbi } from '../utils/abis.js';\nimport { MM_TOKEN_API_SUPPORTED_CHAINS } from '../utils/constants.js';\nimport { SINGLE_CALL_BALANCES_ADDRESSES } from '../utils/contractAddresses.js';\nimport { TokenHandler } from './TokenHandler.js';\n\nconst DEFAULT_INTERVAL = 180 * 1000;\nclass TokensController extends BaseController {\n  constructor({\n    config,\n    state,\n    provider,\n    idleTimeTracker,\n    getCustomTokens,\n    getEtherScanTokens,\n    getProviderConfig,\n    onPreferencesStateChange,\n    onNetworkStateChange\n  }) {\n    super({\n      config,\n      state\n    });\n    _defineProperty(this, \"name\", \"TokensController\");\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"ethersProvider\", void 0);\n    _defineProperty(this, \"pollingManager\", void 0);\n    _defineProperty(this, \"getProviderConfig\", void 0);\n    _defineProperty(this, \"getCustomTokens\", void 0);\n    _defineProperty(this, \"getEtherScanTokens\", void 0);\n    this.provider = provider;\n    this.ethersProvider = new BrowserProvider(this.provider, \"any\");\n    this.getCustomTokens = getCustomTokens;\n    this.getEtherScanTokens = getEtherScanTokens;\n    this.getProviderConfig = getProviderConfig;\n    this.defaultConfig = {\n      interval: DEFAULT_INTERVAL,\n      selectedAddress: \"\",\n      chainId: \"\"\n    };\n    this.defaultState = {\n      tokens: {}\n    };\n    this.initialize();\n    onPreferencesStateChange(preferencesState => {\n      if (preferencesState.selectedAddress !== this.config.selectedAddress) {\n        this.configure({\n          selectedAddress: preferencesState.selectedAddress\n        });\n        this.restartTokenDetection();\n      }\n    });\n    onNetworkStateChange(networkState => {\n      const {\n        chainId\n      } = networkState.providerConfig;\n      if (chainId !== this.config.chainId) {\n        this.configure({\n          chainId\n        });\n        this.restartTokenDetection();\n      }\n    });\n    this.pollingManager = new PollingManager(idleTimeTracker, this.config.interval);\n  }\n  get userSelectedAddress() {\n    return this.config.selectedAddress;\n  }\n  get userTokens() {\n    var _this$state$tokens$th;\n    if (!this.userSelectedAddress) return [];\n    return (_this$state$tokens$th = this.state.tokens[this.userSelectedAddress]) !== null && _this$state$tokens$th !== void 0 ? _this$state$tokens$th : [];\n  }\n  startTokenDetection(selectedAddress) {\n    this.configure({\n      selectedAddress\n    });\n    this.restartTokenDetection();\n  }\n\n  /**\n   * Restart token detection polling period and call detectNewTokens\n   * in case of address change or user session initialization.\n   *\n   */\n  restartTokenDetection() {\n    if (!this.userSelectedAddress) {\n      return;\n    }\n    this.pollingManager.start(async () => {\n      this.detectNewTokens();\n      await this.refreshTokenBalances();\n    });\n  }\n  detectNewTokens() {\n    const userAddress = this.userSelectedAddress;\n    if (!userAddress) return;\n    const currentChainId = this.config.chainId;\n    const tokens = []; // object[]\n    if (!currentChainId) {\n      this.update({\n        tokens: {\n          [userAddress]: [...tokens]\n        }\n      });\n      return;\n    }\n    const networkConfig = this.getProviderConfig();\n    if (networkConfig !== null && networkConfig !== void 0 && networkConfig.isErc20 && networkConfig !== null && networkConfig !== void 0 && networkConfig.tokenAddress) {\n      tokens.push({\n        tokenAddress: networkConfig.tokenAddress,\n        name: networkConfig.tickerName,\n        logo: networkConfig.logo,\n        erc20: true,\n        symbol: networkConfig.ticker,\n        decimals: \"18\",\n        chainId: currentChainId\n      });\n    }\n    if (this.getCustomTokens) {\n      const customTokens = this.getCustomTokens(userAddress);\n      tokens.push(...customTokens.reduce((acc, x) => {\n        if (x.network === currentChainId) acc.push({\n          tokenAddress: x.token_address,\n          name: x.token_name,\n          logo: \"eth.svg\",\n          erc20: true,\n          symbol: x.token_symbol,\n          decimals: x.decimals,\n          balance: \"\",\n          customTokenId: x.id.toString(),\n          chainId: x.network\n        });\n        return acc;\n      }, []));\n    }\n    this.update({\n      tokens: {\n        [userAddress]: [...tokens]\n      }\n    });\n  }\n  async refreshTokenBalances(skipCache) {\n    const userAddress = this.userSelectedAddress;\n    if (userAddress === \"\") return;\n    const oldTokens = [...this.userTokens];\n    // - fetch from Etherscan, if failed then fetch from TokenHandler\n    // - if there are remaining tokens, fetch either from SingleAddressContract (if failed then use TokenHandler) or TokenHandler\n    try {\n      const nonZeroTokens = [];\n      const currentChainId = this.config.chainId;\n      if (MM_TOKEN_API_SUPPORTED_CHAINS.includes(currentChainId)) {\n        const etherscanBalances = await this.getEtherScanTokens(userAddress, currentChainId, skipCache);\n        nonZeroTokens.push(...etherscanBalances);\n      }\n\n      // only fetch balances for tokens that are not already in the nonZeroTokens array\n      const remainingTokens = oldTokens.filter(x => !nonZeroTokens.find(y => {\n        var _y$tokenAddress, _x$tokenAddress;\n        return ((_y$tokenAddress = y.tokenAddress) === null || _y$tokenAddress === void 0 ? void 0 : _y$tokenAddress.toLocaleLowerCase()) === ((_x$tokenAddress = x.tokenAddress) === null || _x$tokenAddress === void 0 ? void 0 : _x$tokenAddress.toLocaleLowerCase());\n      }));\n      if (remainingTokens.length > 0) {\n        const remainingTokensAddresses = remainingTokens.map(x => x.tokenAddress);\n        const currentSingleCallAddress = SINGLE_CALL_BALANCES_ADDRESSES[currentChainId];\n        if (currentSingleCallAddress) {\n          const ethContract = new Contract(currentSingleCallAddress, singleBalanceCheckerAbi, this.ethersProvider);\n          const result = await ethContract.balances([userAddress], remainingTokensAddresses);\n          remainingTokensAddresses.forEach((_, index) => {\n            const balance = toQuantity(result[index]);\n            if (balance && balance !== \"0x0\") {\n              nonZeroTokens.push(_objectSpread(_objectSpread({}, remainingTokens[index]), {}, {\n                balance,\n                chainId: currentChainId\n              }));\n            }\n          });\n        } else {\n          const fetchedRemainingTokens = await this.getTokenBalancesUsingHandler(remainingTokens);\n          nonZeroTokens.push(...fetchedRemainingTokens);\n        }\n      }\n      this.update({\n        tokens: {\n          [userAddress]: nonZeroTokens\n        }\n      });\n    } catch (error) {\n      log.error(error, \"unable to fetch token balances using single call balance address\");\n      const fetchedTokens = await this.getTokenBalancesUsingHandler(oldTokens);\n      this.update({\n        tokens: {\n          [userAddress]: fetchedTokens\n        }\n      });\n    }\n  }\n  async getTokenBalancesUsingHandler(customTokens) {\n    if (!this.userSelectedAddress) return [];\n    const currentNetworkTokens = customTokens;\n    const promiseSettledResult = await Promise.allSettled(currentNetworkTokens.map(async x => {\n      try {\n        const tokenInstance = new TokenHandler({\n          address: x.tokenAddress,\n          decimals: Number.parseInt(x.decimals),\n          name: x.name,\n          symbol: x.symbol,\n          provider: this.ethersProvider\n        });\n        const balance = await tokenInstance.getUserBalance(this.userSelectedAddress);\n        return {\n          decimals: tokenInstance.decimals.toString(),\n          erc20: true,\n          logo: x.logo || \"eth.svg\",\n          name: tokenInstance.name,\n          symbol: tokenInstance.symbol,\n          tokenAddress: tokenInstance.address,\n          balance: `0x${balance}`,\n          customTokenId: x.customTokenId,\n          network: x.chainId,\n          chainId: x.chainId\n        };\n      } catch (error) {\n        log.warn(\"could not fetch user token balance\", error);\n        return undefined;\n      }\n    }));\n    const nonZeroTokens = promiseSettledResult.reduce((acc, x) => {\n      if (x.status === \"fulfilled\" && x.value) acc.push(x.value);\n      return acc;\n    }, []);\n    return nonZeroTokens;\n  }\n}\n\nexport { TokensController };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAEA,MAAM,mBAAmB,MAAM;AAC/B,MAAM,yBAAyB,yQAAc;IAC3C,YAAY,EACV,MAAM,EACN,KAAK,EACL,QAAQ,EACR,eAAe,EACf,eAAe,EACf,kBAAkB,EAClB,iBAAiB,EACjB,wBAAwB,EACxB,oBAAoB,EACrB,CAAE;QACD,KAAK,CAAC;YACJ;YACA;QACF;QACA,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ;QAC9B,IAAA,oLAAe,EAAC,IAAI,EAAE,YAAY,KAAK;QACvC,IAAA,oLAAe,EAAC,IAAI,EAAE,kBAAkB,KAAK;QAC7C,IAAA,oLAAe,EAAC,IAAI,EAAE,kBAAkB,KAAK;QAC7C,IAAA,oLAAe,EAAC,IAAI,EAAE,qBAAqB,KAAK;QAChD,IAAA,oLAAe,EAAC,IAAI,EAAE,mBAAmB,KAAK;QAC9C,IAAA,oLAAe,EAAC,IAAI,EAAE,sBAAsB,KAAK;QACjD,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,cAAc,GAAG,IAAI,8LAAe,CAAC,IAAI,CAAC,QAAQ,EAAE;QACzD,IAAI,CAAC,eAAe,GAAG;QACvB,IAAI,CAAC,kBAAkB,GAAG;QAC1B,IAAI,CAAC,iBAAiB,GAAG;QACzB,IAAI,CAAC,aAAa,GAAG;YACnB,UAAU;YACV,iBAAiB;YACjB,SAAS;QACX;QACA,IAAI,CAAC,YAAY,GAAG;YAClB,QAAQ,CAAC;QACX;QACA,IAAI,CAAC,UAAU;QACf,yBAAyB,CAAA;YACvB,IAAI,iBAAiB,eAAe,KAAK,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE;gBACpE,IAAI,CAAC,SAAS,CAAC;oBACb,iBAAiB,iBAAiB,eAAe;gBACnD;gBACA,IAAI,CAAC,qBAAqB;YAC5B;QACF;QACA,qBAAqB,CAAA;YACnB,MAAM,EACJ,OAAO,EACR,GAAG,aAAa,cAAc;YAC/B,IAAI,YAAY,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBACnC,IAAI,CAAC,SAAS,CAAC;oBACb;gBACF;gBACA,IAAI,CAAC,qBAAqB;YAC5B;QACF;QACA,IAAI,CAAC,cAAc,GAAG,IAAI,kRAAc,CAAC,iBAAiB,IAAI,CAAC,MAAM,CAAC,QAAQ;IAChF;IACA,IAAI,sBAAsB;QACxB,OAAO,IAAI,CAAC,MAAM,CAAC,eAAe;IACpC;IACA,IAAI,aAAa;QACf,IAAI;QACJ,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,OAAO,EAAE;QACxC,OAAO,CAAC,wBAAwB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC,MAAM,QAAQ,0BAA0B,KAAK,IAAI,wBAAwB,EAAE;IACxJ;IACA,oBAAoB,eAAe,EAAE;QACnC,IAAI,CAAC,SAAS,CAAC;YACb;QACF;QACA,IAAI,CAAC,qBAAqB;IAC5B;IAEA;;;;GAIC,GACD,wBAAwB;QACtB,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;YAC7B;QACF;QACA,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC;YACxB,IAAI,CAAC,eAAe;YACpB,MAAM,IAAI,CAAC,oBAAoB;QACjC;IACF;IACA,kBAAkB;QAChB,MAAM,cAAc,IAAI,CAAC,mBAAmB;QAC5C,IAAI,CAAC,aAAa;QAClB,MAAM,iBAAiB,IAAI,CAAC,MAAM,CAAC,OAAO;QAC1C,MAAM,SAAS,EAAE,EAAE,WAAW;QAC9B,IAAI,CAAC,gBAAgB;YACnB,IAAI,CAAC,MAAM,CAAC;gBACV,QAAQ;oBACN,CAAC,YAAY,EAAE;2BAAI;qBAAO;gBAC5B;YACF;YACA;QACF;QACA,MAAM,gBAAgB,IAAI,CAAC,iBAAiB;QAC5C,IAAI,kBAAkB,QAAQ,kBAAkB,KAAK,KAAK,cAAc,OAAO,IAAI,kBAAkB,QAAQ,kBAAkB,KAAK,KAAK,cAAc,YAAY,EAAE;YACnK,OAAO,IAAI,CAAC;gBACV,cAAc,cAAc,YAAY;gBACxC,MAAM,cAAc,UAAU;gBAC9B,MAAM,cAAc,IAAI;gBACxB,OAAO;gBACP,QAAQ,cAAc,MAAM;gBAC5B,UAAU;gBACV,SAAS;YACX;QACF;QACA,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,MAAM,eAAe,IAAI,CAAC,eAAe,CAAC;YAC1C,OAAO,IAAI,IAAI,aAAa,MAAM,CAAC,CAAC,KAAK;gBACvC,IAAI,EAAE,OAAO,KAAK,gBAAgB,IAAI,IAAI,CAAC;oBACzC,cAAc,EAAE,aAAa;oBAC7B,MAAM,EAAE,UAAU;oBAClB,MAAM;oBACN,OAAO;oBACP,QAAQ,EAAE,YAAY;oBACtB,UAAU,EAAE,QAAQ;oBACpB,SAAS;oBACT,eAAe,EAAE,EAAE,CAAC,QAAQ;oBAC5B,SAAS,EAAE,OAAO;gBACpB;gBACA,OAAO;YACT,GAAG,EAAE;QACP;QACA,IAAI,CAAC,MAAM,CAAC;YACV,QAAQ;gBACN,CAAC,YAAY,EAAE;uBAAI;iBAAO;YAC5B;QACF;IACF;IACA,MAAM,qBAAqB,SAAS,EAAE;QACpC,MAAM,cAAc,IAAI,CAAC,mBAAmB;QAC5C,IAAI,gBAAgB,IAAI;QACxB,MAAM,YAAY;eAAI,IAAI,CAAC,UAAU;SAAC;QACtC,iEAAiE;QACjE,6HAA6H;QAC7H,IAAI;YACF,MAAM,gBAAgB,EAAE;YACxB,MAAM,iBAAiB,IAAI,CAAC,MAAM,CAAC,OAAO;YAC1C,IAAI,sOAA6B,CAAC,QAAQ,CAAC,iBAAiB;gBAC1D,MAAM,oBAAoB,MAAM,IAAI,CAAC,kBAAkB,CAAC,aAAa,gBAAgB;gBACrF,cAAc,IAAI,IAAI;YACxB;YAEA,iFAAiF;YACjF,MAAM,kBAAkB,UAAU,MAAM,CAAC,CAAA,IAAK,CAAC,cAAc,IAAI,CAAC,CAAA;oBAChE,IAAI,iBAAiB;oBACrB,OAAO,CAAC,CAAC,kBAAkB,EAAE,YAAY,MAAM,QAAQ,oBAAoB,KAAK,IAAI,KAAK,IAAI,gBAAgB,iBAAiB,EAAE,MAAM,CAAC,CAAC,kBAAkB,EAAE,YAAY,MAAM,QAAQ,oBAAoB,KAAK,IAAI,KAAK,IAAI,gBAAgB,iBAAiB,EAAE;gBACjQ;YACA,IAAI,gBAAgB,MAAM,GAAG,GAAG;gBAC9B,MAAM,2BAA2B,gBAAgB,GAAG,CAAC,CAAA,IAAK,EAAE,YAAY;gBACxE,MAAM,2BAA2B,+OAA8B,CAAC,eAAe;gBAC/E,IAAI,0BAA0B;oBAC5B,MAAM,cAAc,IAAI,2KAAQ,CAAC,0BAA0B,2NAAuB,EAAE,IAAI,CAAC,cAAc;oBACvG,MAAM,SAAS,MAAM,YAAY,QAAQ,CAAC;wBAAC;qBAAY,EAAE;oBACzD,yBAAyB,OAAO,CAAC,CAAC,GAAG;wBACnC,MAAM,UAAU,IAAA,uKAAU,EAAC,MAAM,CAAC,MAAM;wBACxC,IAAI,WAAW,YAAY,OAAO;4BAChC,cAAc,IAAI,CAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,eAAe,CAAC,MAAM,GAAG,CAAC,GAAG;gCAC9E;gCACA,SAAS;4BACX;wBACF;oBACF;gBACF,OAAO;oBACL,MAAM,yBAAyB,MAAM,IAAI,CAAC,4BAA4B,CAAC;oBACvE,cAAc,IAAI,IAAI;gBACxB;YACF;YACA,IAAI,CAAC,MAAM,CAAC;gBACV,QAAQ;oBACN,CAAC,YAAY,EAAE;gBACjB;YACF;QACF,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,KAAK,CAAC,OAAO;YACjB,MAAM,gBAAgB,MAAM,IAAI,CAAC,4BAA4B,CAAC;YAC9D,IAAI,CAAC,MAAM,CAAC;gBACV,QAAQ;oBACN,CAAC,YAAY,EAAE;gBACjB;YACF;QACF;IACF;IACA,MAAM,6BAA6B,YAAY,EAAE;QAC/C,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,OAAO,EAAE;QACxC,MAAM,uBAAuB;QAC7B,MAAM,uBAAuB,MAAM,QAAQ,UAAU,CAAC,qBAAqB,GAAG,CAAC,OAAM;YACnF,IAAI;gBACF,MAAM,gBAAgB,IAAI,yNAAY,CAAC;oBACrC,SAAS,EAAE,YAAY;oBACvB,UAAU,OAAO,QAAQ,CAAC,EAAE,QAAQ;oBACpC,MAAM,EAAE,IAAI;oBACZ,QAAQ,EAAE,MAAM;oBAChB,UAAU,IAAI,CAAC,cAAc;gBAC/B;gBACA,MAAM,UAAU,MAAM,cAAc,cAAc,CAAC,IAAI,CAAC,mBAAmB;gBAC3E,OAAO;oBACL,UAAU,cAAc,QAAQ,CAAC,QAAQ;oBACzC,OAAO;oBACP,MAAM,EAAE,IAAI,IAAI;oBAChB,MAAM,cAAc,IAAI;oBACxB,QAAQ,cAAc,MAAM;oBAC5B,cAAc,cAAc,OAAO;oBACnC,SAAS,CAAC,EAAE,EAAE,SAAS;oBACvB,eAAe,EAAE,aAAa;oBAC9B,SAAS,EAAE,OAAO;oBAClB,SAAS,EAAE,OAAO;gBACpB;YACF,EAAE,OAAO,OAAO;gBACd,yJAAG,CAAC,IAAI,CAAC,sCAAsC;gBAC/C,OAAO;YACT;QACF;QACA,MAAM,gBAAgB,qBAAqB,MAAM,CAAC,CAAC,KAAK;YACtD,IAAI,EAAE,MAAM,KAAK,eAAe,EAAE,KAAK,EAAE,IAAI,IAAI,CAAC,EAAE,KAAK;YACzD,OAAO;QACT,GAAG,EAAE;QACL,OAAO;IACT;AACF","ignoreList":[0]}},
    {"offset": {"line": 5956, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/NonceTracker.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { Mutex } from 'async-mutex';\nimport { METHOD_TYPES } from '../utils/constants.js';\n\nclass NonceTracker {\n  constructor({\n    provider,\n    blockTracker,\n    getPendingTransactions,\n    getConfirmedTransactions\n  }) {\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"blockTracker\", void 0);\n    _defineProperty(this, \"getPendingTransactions\", void 0);\n    _defineProperty(this, \"getConfirmedTransactions\", void 0);\n    _defineProperty(this, \"lockMap\", void 0);\n    this.provider = provider;\n    this.blockTracker = blockTracker;\n    this.getPendingTransactions = getPendingTransactions;\n    this.getConfirmedTransactions = getConfirmedTransactions;\n    this.lockMap = {};\n  }\n  async getGlobalLock() {\n    const globalMutex = this._lookupMutex(\"global\");\n    // await global mutex free\n    const releaseLock = await globalMutex.acquire();\n    return {\n      releaseLock\n    };\n  }\n\n  /**\n    this will return an object with the `nextNonce` \n    `nonceDetails`, and the releaseLock.\n    Note: releaseLock must be called after adding a signed tx \n    to pending transactions (or discarding).\n  */\n  async getNonceLock(address) {\n    // await global mutex free\n    await this._globalMutexFree();\n    // await lock free, then take lock\n    const releaseLock = await this._takeMutex(address);\n    try {\n      // evaluate multiple nextNonce strategies\n      const nonceDetails = {};\n      const networkNonceResult = await this._getNetworkNextNonce(address);\n      const highestLocallyConfirmed = this._getHighestLocallyConfirmed(address);\n      const nextNetworkNonce = networkNonceResult.nonce;\n      const highestSuggested = Math.max(nextNetworkNonce, highestLocallyConfirmed);\n      const pendingTxs = this.getPendingTransactions(address);\n      const localNonceResult = this._getHighestContinuousFrom(pendingTxs, highestSuggested);\n      nonceDetails.params = {\n        highestLocallyConfirmed,\n        highestSuggested,\n        nextNetworkNonce\n      };\n      nonceDetails.local = localNonceResult;\n      nonceDetails.network = networkNonceResult;\n      const nextNonce = Math.max(networkNonceResult.nonce, localNonceResult.nonce);\n\n      // return nonce and release cb\n      return {\n        nextNonce,\n        nonceDetails,\n        releaseLock\n      };\n    } catch (error) {\n      // release lock if we encounter an error\n      releaseLock();\n      throw error;\n    }\n  }\n  async _globalMutexFree() {\n    const globalMutex = this._lookupMutex(\"global\");\n    const releaseLock = await globalMutex.acquire();\n    releaseLock();\n  }\n  async _takeMutex(lockId) {\n    const mutex = this._lookupMutex(lockId);\n    const releaseLock = await mutex.acquire();\n    return releaseLock;\n  }\n  _lookupMutex(lockId) {\n    let mutex = this.lockMap[lockId];\n    if (!mutex) {\n      mutex = new Mutex();\n      this.lockMap[lockId] = mutex;\n    }\n    return mutex;\n  }\n  async _getNetworkNextNonce(address) {\n    // calculate next nonce\n    // we need to make sure our base count\n    // and pending count are from the same block\n    const block = await this.blockTracker.getLatestBlock();\n    const baseCountStr = await this.provider.request({\n      method: METHOD_TYPES.ETH_GET_TRANSACTION_COUNT,\n      params: [address, block.idempotencyKey]\n    });\n    const baseCount = Number.parseInt(baseCountStr, 16);\n    const nonceDetails = {\n      block,\n      baseCount\n    };\n    return {\n      name: \"network\",\n      nonce: baseCount,\n      details: nonceDetails\n    };\n  }\n  _getHighestLocallyConfirmed(address) {\n    const confirmedTransactions = this.getConfirmedTransactions(address);\n    const highest = this._getHighestNonce(confirmedTransactions);\n    return Number.isInteger(highest) ? highest + 1 : 0;\n  }\n  _getHighestNonce(txList) {\n    const nonces = txList.map(txMeta => {\n      const {\n        nonce\n      } = txMeta.transaction;\n      return Number.parseInt(nonce, 16);\n    });\n    const highestNonce = Math.max.apply(null, nonces);\n    return highestNonce;\n  }\n  _getHighestContinuousFrom(txList, startPoint) {\n    const nonces = new Set(txList.map(txMeta => {\n      const {\n        nonce\n      } = txMeta.transaction;\n      return Number.parseInt(nonce, 16);\n    }));\n    let highest = startPoint;\n    while (nonces.has(highest)) {\n      highest += 1;\n    }\n    return {\n      name: \"local\",\n      nonce: highest,\n      details: {\n        startPoint,\n        highest\n      }\n    };\n  }\n}\n\nexport { NonceTracker };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 6104, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/PendingTransactionTracker.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { TX_EVENTS, TransactionStatus } from '@toruslabs/base-controllers';\nimport { SafeEventEmitter } from '@web3auth/auth';\nimport log from 'loglevel';\nimport { METHOD_TYPES } from '../utils/constants.js';\n\nclass PendingTransactionTracker extends SafeEventEmitter {\n  constructor({\n    provider,\n    nonceTracker,\n    approveTransaction,\n    publishTransaction,\n    getPendingTransactions,\n    getConfirmedTransactions\n  }) {\n    super();\n    _defineProperty(this, \"DROPPED_BUFFER_COUNT\", 3);\n    _defineProperty(this, \"nonceTracker\", void 0);\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"approveTransaction\", void 0);\n    _defineProperty(this, \"droppedBlocksBufferByHash\", void 0);\n    _defineProperty(this, \"getConfirmedTransactions\", void 0);\n    _defineProperty(this, \"getPendingTransactions\", void 0);\n    _defineProperty(this, \"publishTransaction\", void 0);\n    this.provider = provider;\n    this.nonceTracker = nonceTracker;\n    this.approveTransaction = approveTransaction;\n    this.publishTransaction = publishTransaction;\n    this.getPendingTransactions = getPendingTransactions;\n    this.getConfirmedTransactions = getConfirmedTransactions;\n    this.droppedBlocksBufferByHash = new Map();\n  }\n\n  /**\n    checks the network for signed txs and releases the nonce global lock if it is\n  */\n  async updatePendingTxs() {\n    // in order to keep the nonceTracker accurate we block it while updating pending transactions\n    const nonceGlobalLock = await this.nonceTracker.getGlobalLock();\n    try {\n      const pendingTxs = this.getPendingTransactions();\n      await Promise.all(pendingTxs.map(txMeta => this._checkPendingTx(txMeta)));\n    } catch (error) {\n      log.error(\"PendingTransactionTracker - Error updating pending transactions\");\n      log.error(error);\n    }\n    nonceGlobalLock.releaseLock();\n  }\n  async resubmitPendingTxs(block) {\n    const pending = this.getPendingTransactions();\n    // only try resubmitting if their are transactions to resubmit\n    if (pending.length === 0) return;\n    // Keep this as a for loop because we want to wait for each item to be submitted\n    for (const txMeta of pending) {\n      try {\n        await this._resubmitTx(txMeta, block.idempotencyKey);\n      } catch (error) {\n        var _value;\n        /*\n        Dont marked as failed if the error is a \"known\" transaction warning\n        \"there is already a transaction with the same sender-nonce\n        but higher/same gas price\"\n        Also don't mark as failed if it has ever been broadcast successfully.\n        A successful broadcast means it may still be mined.\n        */\n        const errorMessage = ((_value = error.value) === null || _value === void 0 || (_value = _value.message) === null || _value === void 0 ? void 0 : _value.toLowerCase()) || error.message.toLowerCase();\n        const isKnownTx =\n        // geth\n        errorMessage.includes(\"replacement transaction underpriced\") || errorMessage.includes(\"known transaction\") ||\n        // parity\n        errorMessage.includes(\"gas price too low to replace\") || errorMessage.includes(\"transaction with the same hash was already imported\") ||\n        // other\n        errorMessage.includes(\"gateway timeout\") || errorMessage.includes(\"nonce too low\");\n        // ignore resubmit warnings, return early\n        if (isKnownTx) return;\n        // encountered real error - transition to error state\n        txMeta.warning = {\n          error: errorMessage,\n          message: \"There was an error when resubmitting this transaction.\"\n        };\n        this.emit(TX_EVENTS.TX_WARNING, {\n          txMeta,\n          txId: txMeta.id\n        });\n      }\n    }\n  }\n  async _resubmitTx(txMeta, latestBlockNumber) {\n    if (txMeta.userOpHash) return;\n    if (!txMeta.firstRetryBlockNumber) {\n      this.emit(TX_EVENTS.TX_BLOCK_UPDATE, {\n        txMeta,\n        latestBlockNumber,\n        txId: txMeta.id\n      });\n    }\n    const firstRetryBlockNumber = txMeta.firstRetryBlockNumber || latestBlockNumber;\n    const txBlockDistance = Number.parseInt(latestBlockNumber, 16) - Number.parseInt(firstRetryBlockNumber, 16);\n    const retryCount = txMeta.retryCount || 0;\n\n    // Exponential backoff to limit retries at publishing (capped at last 15 mins)\n    if (txBlockDistance <= Math.min(50, 2 ** retryCount)) return undefined;\n\n    // Only auto-submit already-signed txs:\n    if (!(\"rawTransaction\" in txMeta)) return this.approveTransaction(txMeta.id);\n    const {\n      rawTransaction\n    } = txMeta;\n    const txHash = await this.publishTransaction(rawTransaction);\n\n    // Increment successful tries:\n    this.emit(TX_EVENTS.TX_RETRY, {\n      txMeta,\n      txId: txMeta.id\n    });\n    return txHash;\n  }\n  async _checkPendingTx(foundTx) {\n    const txMeta = foundTx;\n    const txHash = txMeta.transactionHash;\n    const txId = txMeta.id;\n\n    // Only check submitted txs\n    if (txMeta.status !== TransactionStatus.submitted || txMeta.isUserOperation) return;\n\n    // extra check in case there was an uncaught error during the\n    // signature and submission process\n    if (!txHash) {\n      const noTxHashError = new Error(\"We had an error while submitting this transaction, please try again.\");\n      noTxHashError.name = \"NoTxHashError\";\n      this.emit(TX_EVENTS.TX_FAILED, {\n        txId,\n        error: noTxHashError\n      });\n      return;\n    }\n\n    // If another tx with the same nonce is mined, set as failed.\n    if (this._checkIfNonceIsTaken(txMeta)) {\n      this.emit(TX_EVENTS.TX_DROPPED, {\n        txId\n      });\n      return;\n    }\n    try {\n      const transactionReceipt = await this.provider.request({\n        method: METHOD_TYPES.ETH_GET_TRANSACTION_RECEIPT,\n        params: [txHash]\n      });\n      if (transactionReceipt !== null && transactionReceipt !== void 0 && transactionReceipt.blockNumber) {\n        const {\n          baseFeePerGas,\n          timestamp\n        } = await this.provider.request({\n          method: METHOD_TYPES.ETH_GET_BLOCK_BY_HASH,\n          params: [transactionReceipt.blockHash, false]\n        });\n        this.emit(TX_EVENTS.TX_CONFIRMED, {\n          txId,\n          txReceipt: transactionReceipt,\n          baseFeePerGas,\n          blockTimestamp: timestamp\n        });\n        return;\n      }\n    } catch (error) {\n      log.error(\"error while loading tx\", error);\n      txMeta.warning = {\n        error: error.message,\n        message: \"There was a problem loading this transaction.\"\n      };\n      this.emit(TX_EVENTS.TX_WARNING, {\n        txMeta,\n        txId\n      });\n    }\n    if (await this._checkIfTxWasDropped(txMeta)) {\n      this.emit(TX_EVENTS.TX_DROPPED, {\n        txId\n      });\n    }\n  }\n  async _checkIfTxWasDropped(txMeta) {\n    const {\n      transactionHash: txHash,\n      transaction: {\n        nonce,\n        from\n      }\n    } = txMeta;\n    const networkNextNonce = await this.provider.request({\n      method: METHOD_TYPES.ETH_GET_TRANSACTION_COUNT,\n      params: [from, \"latest\"]\n    });\n    if (Number.parseInt(nonce, 16) >= Number.parseInt(networkNextNonce, 16)) {\n      return false;\n    }\n    if (!this.droppedBlocksBufferByHash.has(txHash)) {\n      this.droppedBlocksBufferByHash.set(txHash, 0);\n    }\n    const currentBlockBuffer = this.droppedBlocksBufferByHash.get(txHash);\n    if (currentBlockBuffer < this.DROPPED_BUFFER_COUNT) {\n      this.droppedBlocksBufferByHash.set(txHash, currentBlockBuffer + 1);\n      return false;\n    }\n    this.droppedBlocksBufferByHash.delete(txHash);\n    return true;\n  }\n  _checkIfNonceIsTaken(txMeta) {\n    const address = txMeta.transaction.from;\n    const completed = this.getConfirmedTransactions(address);\n    return completed.some(otherMeta => {\n      if (otherMeta.id === txMeta.id) {\n        return false;\n      }\n      return otherMeta.transaction.nonce === txMeta.transaction.nonce;\n    });\n  }\n}\n\nexport { PendingTransactionTracker };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 6314, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/TransactionGasUtil.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { stripHexPrefix, addHexPrefix } from '@ethereumjs/util';\nimport { cloneDeep } from '@toruslabs/base-controllers';\nimport { BN } from 'bn.js';\nimport log from 'loglevel';\n\nclass TransactionGasUtil {\n  constructor(provider, blockTracker) {\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"blockTracker\", void 0);\n    this.provider = provider;\n    this.blockTracker = blockTracker;\n  }\n  async analyzeGasUsage(txMeta) {\n    const block = await this.blockTracker.getLatestBlock();\n    // fallback to block gasLimit\n    const blockGasLimitBN = new BN(stripHexPrefix(block.gasLimit), 16);\n    const saferGasLimitBN = blockGasLimitBN.mul(new BN(19)).div(new BN(20));\n    let estimatedGasHex = addHexPrefix(saferGasLimitBN.toString(\"hex\"));\n    let simulationFails;\n    try {\n      estimatedGasHex = await this.estimateTxGas(txMeta);\n    } catch (error) {\n      log.warn(error);\n      simulationFails = {\n        reason: error.message,\n        errorKey: error.errorKey,\n        debug: {\n          blockNumber: block.idempotencyKey,\n          blockGasLimit: block.gasLimit\n        }\n      };\n    }\n    return {\n      blockGasLimit: block.gasLimit,\n      estimatedGasHex,\n      simulationFails\n    };\n  }\n\n  /**\n    Adds a gas buffer with out exceeding the block gas limit\n  */\n  addGasBuffer(initialGasLimitHex, blockGasLimitHex, multiplier = 1.5) {\n    const initialGasLimitBn = new BN(stripHexPrefix(initialGasLimitHex), 16);\n    const blockGasLimitBn = new BN(stripHexPrefix(blockGasLimitHex), 16);\n    const upperGasLimitBn = blockGasLimitBn.muln(0.9);\n    const bufferedGasLimitBn = initialGasLimitBn.muln(multiplier);\n\n    // if initialGasLimit is above blockGasLimit, dont modify it\n    if (initialGasLimitBn.gt(upperGasLimitBn)) return addHexPrefix(initialGasLimitBn.toString(\"hex\"));\n    // if bufferedGasLimit is below blockGasLimit, use bufferedGasLimit\n    if (bufferedGasLimitBn.lt(upperGasLimitBn)) return addHexPrefix(bufferedGasLimitBn.toString(\"hex\"));\n    // otherwise use blockGasLimit\n    return addHexPrefix(upperGasLimitBn.toString(\"hex\"));\n  }\n\n  /**\n    Estimates the tx's gas usage\n  */\n  async estimateTxGas(txMeta) {\n    const txParams = cloneDeep(txMeta.transaction);\n\n    // `eth_estimateGas` can fail if the user has insufficient balance for the\n    // value being sent, or for the gas cost. We don't want to check their\n    // balance here, we just want the gas estimate. The gas price is removed\n    // to skip those balance checks. We check balance elsewhere. We also delete\n    // maxFeePerGas and maxPriorityFeePerGas to support EIP-1559 txs.\n    delete txParams.gasPrice;\n    delete txParams.maxFeePerGas;\n    delete txParams.maxPriorityFeePerGas;\n    return this.provider.request({\n      method: \"eth_estimateGas\",\n      params: [txParams]\n    });\n  }\n}\n\nexport { TransactionGasUtil };\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM;IACJ,YAAY,QAAQ,EAAE,YAAY,CAAE;QAClC,IAAA,oLAAe,EAAC,IAAI,EAAE,YAAY,KAAK;QACvC,IAAA,oLAAe,EAAC,IAAI,EAAE,gBAAgB,KAAK;QAC3C,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,YAAY,GAAG;IACtB;IACA,MAAM,gBAAgB,MAAM,EAAE;QAC5B,MAAM,QAAQ,MAAM,IAAI,CAAC,YAAY,CAAC,cAAc;QACpD,6BAA6B;QAC7B,MAAM,kBAAkB,IAAI,8IAAE,CAAC,IAAA,8OAAc,EAAC,MAAM,QAAQ,GAAG;QAC/D,MAAM,kBAAkB,gBAAgB,GAAG,CAAC,IAAI,8IAAE,CAAC,KAAK,GAAG,CAAC,IAAI,8IAAE,CAAC;QACnE,IAAI,kBAAkB,IAAA,yOAAY,EAAC,gBAAgB,QAAQ,CAAC;QAC5D,IAAI;QACJ,IAAI;YACF,kBAAkB,MAAM,IAAI,CAAC,aAAa,CAAC;QAC7C,EAAE,OAAO,OAAO;YACd,yJAAG,CAAC,IAAI,CAAC;YACT,kBAAkB;gBAChB,QAAQ,MAAM,OAAO;gBACrB,UAAU,MAAM,QAAQ;gBACxB,OAAO;oBACL,aAAa,MAAM,cAAc;oBACjC,eAAe,MAAM,QAAQ;gBAC/B;YACF;QACF;QACA,OAAO;YACL,eAAe,MAAM,QAAQ;YAC7B;YACA;QACF;IACF;IAEA;;EAEA,GACA,aAAa,kBAAkB,EAAE,gBAAgB,EAAE,aAAa,GAAG,EAAE;QACnE,MAAM,oBAAoB,IAAI,8IAAE,CAAC,IAAA,8OAAc,EAAC,qBAAqB;QACrE,MAAM,kBAAkB,IAAI,8IAAE,CAAC,IAAA,8OAAc,EAAC,mBAAmB;QACjE,MAAM,kBAAkB,gBAAgB,IAAI,CAAC;QAC7C,MAAM,qBAAqB,kBAAkB,IAAI,CAAC;QAElD,4DAA4D;QAC5D,IAAI,kBAAkB,EAAE,CAAC,kBAAkB,OAAO,IAAA,yOAAY,EAAC,kBAAkB,QAAQ,CAAC;QAC1F,mEAAmE;QACnE,IAAI,mBAAmB,EAAE,CAAC,kBAAkB,OAAO,IAAA,yOAAY,EAAC,mBAAmB,QAAQ,CAAC;QAC5F,8BAA8B;QAC9B,OAAO,IAAA,yOAAY,EAAC,gBAAgB,QAAQ,CAAC;IAC/C;IAEA;;EAEA,GACA,MAAM,cAAc,MAAM,EAAE;QAC1B,MAAM,WAAW,IAAA,0QAAS,EAAC,OAAO,WAAW;QAE7C,0EAA0E;QAC1E,sEAAsE;QACtE,wEAAwE;QACxE,2EAA2E;QAC3E,iEAAiE;QACjE,OAAO,SAAS,QAAQ;QACxB,OAAO,SAAS,YAAY;QAC5B,OAAO,SAAS,oBAAoB;QACpC,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;YAC3B,QAAQ;YACR,QAAQ;gBAAC;aAAS;QACpB;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 6402, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/TransactionStateHistoryHelper.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport { cloneDeep } from '@toruslabs/base-controllers';\nimport jsonDiffer from 'fast-json-patch';\n\n/**\n  Generates an array of history objects sense the previous state.\n  The object has the keys\n    op (the operation performed),\n    path (the key and if a nested object then each key will be seperated with a `/`)\n    value\n  with the first entry having the note and a timestamp when the change took place\n*/\nfunction generateHistoryEntry(previousState, newState, note) {\n  const entry = jsonDiffer.compare(previousState, newState);\n  // Add a note to the first op, since it breaks if we append it to the entry\n  if (entry[0]) {\n    if (note) {\n      entry[0].note = note;\n    }\n    entry[0].timestamp = Date.now();\n  }\n  return entry;\n}\n\n/**\n  Recovers previous txMeta state obj\n*/\nfunction replayHistory(_shortHistory) {\n  const shortHistory = cloneDeep(_shortHistory);\n  return shortHistory.reduce((val, entry) => jsonDiffer.applyPatch(val, entry).newDocument);\n}\nfunction snapshotFromTxMeta(txMeta) {\n  const shallow = _objectSpread({}, txMeta);\n  delete shallow.history;\n  return cloneDeep(shallow);\n}\n\nexport { generateHistoryEntry, replayHistory, snapshotFromTxMeta };\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAEA;;;;;;;AAOA,GACA,SAAS,qBAAqB,aAAa,EAAE,QAAQ,EAAE,IAAI;IACzD,MAAM,QAAQ,6KAAU,CAAC,OAAO,CAAC,eAAe;IAChD,2EAA2E;IAC3E,IAAI,KAAK,CAAC,EAAE,EAAE;QACZ,IAAI,MAAM;YACR,KAAK,CAAC,EAAE,CAAC,IAAI,GAAG;QAClB;QACA,KAAK,CAAC,EAAE,CAAC,SAAS,GAAG,KAAK,GAAG;IAC/B;IACA,OAAO;AACT;AAEA;;AAEA,GACA,SAAS,cAAc,aAAa;IAClC,MAAM,eAAe,IAAA,0QAAS,EAAC;IAC/B,OAAO,aAAa,MAAM,CAAC,CAAC,KAAK,QAAU,6KAAU,CAAC,UAAU,CAAC,KAAK,OAAO,WAAW;AAC1F;AACA,SAAS,mBAAmB,MAAM;IAChC,MAAM,UAAU,IAAA,mLAAa,EAAC,CAAC,GAAG;IAClC,OAAO,QAAQ,OAAO;IACtB,OAAO,IAAA,0QAAS,EAAC;AACnB","ignoreList":[0]}},
    {"offset": {"line": 6450, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/TransactionStateManager.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport { BaseTransactionStateManager, TransactionStatus, randomId, omitBy, transactionMatchesNetwork, mapValues, keyBy, sortBy, pickBy, TX_EVENTS } from '@toruslabs/base-controllers';\nimport { snapshotFromTxMeta, replayHistory, generateHistoryEntry } from './TransactionStateHistoryHelper.js';\nimport { normalizeAndValidateTxParams, getFinalStates } from './TransactionUtils.js';\n\nclass TransactionStateManager extends BaseTransactionStateManager {\n  constructor({\n    config,\n    state,\n    getCurrentChainId\n  }) {\n    super({\n      config,\n      state,\n      getCurrentChainId\n    });\n  }\n  generateTxMeta(opts = {}) {\n    var _opts$transaction;\n    const chainId = this.getCurrentChainId();\n    if (chainId === \"loading\") throw new Error(\"Torus is having trouble connecting to the network\");\n    let dappSuggestedGasFees = null;\n\n    // If we are dealing with a transaction suggested by a dapp and not\n    // an internally created transaction, we need to keep record of\n    // the originally submitted gasParams.\n    if (opts.transaction && typeof opts.origin === \"string\" && opts.origin !== \"torus\") {\n      if (typeof opts.transaction.gasPrice !== \"undefined\") {\n        dappSuggestedGasFees = {\n          gasPrice: opts.transaction.gasPrice\n        };\n      } else if (typeof opts.transaction.maxFeePerGas !== \"undefined\" || typeof opts.transaction.maxPriorityFeePerGas !== \"undefined\") {\n        dappSuggestedGasFees = {\n          maxPriorityFeePerGas: opts.transaction.maxPriorityFeePerGas,\n          maxFeePerGas: opts.transaction.maxFeePerGas\n        };\n      }\n      if (typeof opts.transaction.gas !== \"undefined\") {\n        dappSuggestedGasFees = _objectSpread(_objectSpread({}, dappSuggestedGasFees), {}, {\n          gas: opts.transaction.gas\n        });\n      }\n    }\n    return _objectSpread({\n      id: ((_opts$transaction = opts.transaction) === null || _opts$transaction === void 0 ? void 0 : _opts$transaction.id) || randomId(),\n      time: Date.now(),\n      status: TransactionStatus.unapproved,\n      loadingDefaults: true,\n      chainId,\n      dappSuggestedGasFees\n    }, opts);\n  }\n  addTransactionToState(txMeta) {\n    if (txMeta.transaction) {\n      txMeta.transaction = normalizeAndValidateTxParams(txMeta.transaction, false);\n    }\n    this.once(`${txMeta.id}:signed`, () => {\n      this.removeAllListeners(`${txMeta.id}:rejected`);\n    });\n    this.once(`${txMeta.id}:rejected`, () => {\n      this.removeAllListeners(`${txMeta.id}:signed`);\n    });\n    // initialize history\n    txMeta.history = [];\n    // capture initial snapshot of txMeta for history\n    const snapshot = snapshotFromTxMeta(txMeta);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    txMeta.history.push(snapshot);\n    const transactions = this.getTransactions({\n      filterToCurrentNetwork: false\n    });\n    const {\n      txHistoryLimit\n    } = this.config;\n\n    // checks if the length of the tx history is longer then desired persistence\n    // limit and then if it is removes the oldest confirmed or rejected tx.\n    // Pending or unapproved transactions will not be removed by this\n    // operation. For safety of presenting a fully functional transaction UI\n    // representation, this function will not break apart transactions with the\n    // same nonce, per network. Not accounting for transactions of the same\n    // nonce and network combo can result in confusing or broken experiences\n    // in the UI.\n    //\n    // we will send UI only collected groups of transactions *per page* so at\n    // some point in the future, this persistence limit can be adjusted. When\n    // we do that I think we should figure out a better storage solution for\n    // transaction history entries.\n    const nonceNetworkSet = new Set();\n    const txsToDelete = transactions.reverse().filter(tx => {\n      const {\n        nonce\n      } = tx.transaction;\n      const {\n        chainId,\n        status\n      } = tx;\n      const key = `${nonce}-${chainId}`;\n      if (nonceNetworkSet.has(key)) {\n        return false;\n      }\n      if (nonceNetworkSet.size < txHistoryLimit - 1 || getFinalStates().includes(status) === false) {\n        nonceNetworkSet.add(key);\n        return false;\n      }\n      return true;\n    }).map(tx => tx.id);\n    this._deleteTransactions(txsToDelete);\n    this._addTransactionsToState([txMeta]);\n    return txMeta;\n  }\n\n  /**\n    Removes transaction from the given address for the current network\n    from the txList\n  */\n  wipeTransactions(address) {\n    const {\n      transactions\n    } = this.state;\n    const chainId = this.getCurrentChainId();\n    this.update({\n      transactions: omitBy(transactions, txMeta => {\n        const transactionMatch = transactionMatchesNetwork(txMeta, chainId);\n        return txMeta.transaction.from === address && transactionMatch;\n      })\n    });\n  }\n  getTransactions({\n    searchCriteria = {},\n    initialList = undefined,\n    filterToCurrentNetwork = true,\n    limit = undefined\n  } = {}) {\n    const chainId = this.getCurrentChainId();\n    // searchCriteria is an object that might have values that aren't predicate\n    // methods. When providing any other value type (string, number, etc), we\n    // consider this shorthand for \"check the value at key for strict equality\n    // with the provided value\". To conform this object to be only methods, we\n    // mapValues (lodash) such that every value on the object is a method that\n    // returns a boolean.\n    const predicateMethods = mapValues(searchCriteria, predicate => typeof predicate === \"function\" ? predicate : v => v === predicate);\n\n    // If an initial list is provided we need to change it back into an object\n    // first, so that it matches the shape of our state. This is done by the\n    // lodash keyBy method. This is the edge case for this method, typically\n    // initialList will be undefined.\n    const transactionsToFilter = initialList ? keyBy(initialList, \"id\") : this.state.transactions;\n\n    // Combine sortBy and pickBy to transform our state object into an array of\n    // matching transactions that are sorted by time.\n    const filteredTransactions = sortBy(Object.values(pickBy(transactionsToFilter, txMeta => {\n      // default matchesCriteria to the value of transactionMatchesNetwork\n      // when filterToCurrentNetwork is true.\n      const transactionMatches = transactionMatchesNetwork(txMeta, chainId);\n      if (filterToCurrentNetwork && !transactionMatches) {\n        return false;\n      }\n      // iterate over the predicateMethods keys to check if the transaction\n      // matches the searchCriteria\n      for (const [key, predicate] of Object.entries(predicateMethods)) {\n        // We return false early as soon as we know that one of the specified\n        // search criteria do not match the transaction. This prevents\n        // needlessly checking all criteria when we already know the criteria\n        // are not fully satisfied. We check both txParams and the base\n        // object as predicate keys can be either.\n        if (key in txMeta.transaction) {\n          if (predicate(txMeta.transaction[key]) === false) {\n            return false;\n          }\n        } else if (predicate(txMeta[key]) === false) {\n          return false;\n        }\n      }\n      return true;\n    })), \"time\");\n    if (limit !== undefined) {\n      // We need to have all transactions of a given nonce in order to display\n      // necessary details in the UI. We use the size of this set to determine\n      // whether we have reached the limit provided, thus ensuring that all\n      // transactions of nonces we include will be sent to the UI.\n      const nonces = new Set();\n      const txs = [];\n      // By default, the transaction list we filter from is sorted by time ASC.\n      // To ensure that filtered results prefers the newest transactions we\n      // iterate from right to left, inserting transactions into front of a new\n      // array. The original order is preserved, but we ensure that newest txs\n      // are preferred.\n      for (let i = filteredTransactions.length - 1; i > -1; i -= 1) {\n        const txMeta = filteredTransactions[i];\n        const {\n          nonce\n        } = txMeta.transaction;\n        if (!nonces.has(nonce)) {\n          if (nonces.size < limit) {\n            nonces.add(nonce);\n          } else {\n            continue;\n          }\n        }\n        // Push transaction into the beginning of our array to ensure the\n        // original order is preserved.\n        txs.unshift(txMeta);\n      }\n      return txs;\n    }\n    return filteredTransactions;\n  }\n  getApprovedTransactions(address) {\n    const searchCriteria = {\n      status: TransactionStatus.approved\n    };\n    if (address) {\n      searchCriteria.from = address;\n    }\n    return this.getTransactions({\n      searchCriteria\n    });\n  }\n  getSubmittedTransactions(address) {\n    const searchCriteria = {\n      status: TransactionStatus.submitted\n    };\n    if (address) {\n      searchCriteria.from = address;\n    }\n    return this.getTransactions({\n      searchCriteria\n    });\n  }\n  getPendingTransactions(address) {\n    const submitted = this.getSubmittedTransactions(address);\n    const approved = this.getApprovedTransactions(address);\n    return [...submitted, ...approved];\n  }\n  getConfirmedTransactions(address) {\n    const searchCriteria = {\n      status: TransactionStatus.confirmed\n    };\n    if (address) {\n      searchCriteria.from = address;\n    }\n    return this.getTransactions({\n      searchCriteria\n    });\n  }\n  getUnapprovedTxList() {\n    const chainId = this.getCurrentChainId();\n    return pickBy(this.state.transactions, transaction => {\n      const transactionMatches = transactionMatchesNetwork(transaction, chainId);\n      return transaction.status === TransactionStatus.unapproved && transactionMatches;\n    });\n  }\n  updateTransactionInState(txMeta, note) {\n    // validate txParams\n    if (txMeta.transaction) {\n      txMeta.transaction = normalizeAndValidateTxParams(txMeta.transaction, false);\n    }\n\n    // create txMeta snapshot for history\n    const currentState = snapshotFromTxMeta(txMeta);\n    // recover previous tx state obj\n    const previousState = replayHistory(txMeta.history);\n    // generate history entry and add to history\n    const entry = generateHistoryEntry(previousState, currentState, note);\n    if (entry.length > 0) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      txMeta.history.push(entry);\n    }\n\n    // commit txMeta to state\n    this.updateTransaction(txMeta);\n  }\n  _setTransactionStatus(txId, status, isFinalStep) {\n    const txMeta = this.getTransaction(txId);\n    if (!txMeta) {\n      return;\n    }\n    txMeta.status = status;\n    this.updateTransactionInState(txMeta);\n    this.emit(TX_EVENTS.TX_STATUS_UPDATE, {\n      txId,\n      status\n    });\n    if (this.isFinalState(status) || isFinalStep) {\n      this.emit(`${txMeta.id}:finished`, txMeta);\n    } else {\n      this.emit(`${txMeta.id}:${status}`, txId);\n    }\n  }\n}\n\nexport { TransactionStateManager };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 6733, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/Transaction/TransactionController.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { addHexPrefix, stripHexPrefix } from '@ethereumjs/util';\nimport { TRANSACTION_TYPES, TX_EVENTS, TransactionStatus } from '@toruslabs/base-controllers';\nimport { providerErrors, rpcErrors } from '@web3auth/auth';\nimport { BigNumber } from 'bignumber.js';\nimport { Transaction, keccak256 } from 'ethers';\nimport log from 'loglevel';\nimport { METHOD_TYPES, TRANSACTION_ENVELOPE_TYPES, GAS_ESTIMATE_TYPES, CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP } from '../utils/constants.js';\nimport { decGWEIToHexWEI } from '../utils/conversionUtils.js';\nimport { bnLessThan, getChainType, GAS_LIMITS } from '../utils/helpers.js';\nimport { NonceTracker } from './NonceTracker.js';\nimport { PendingTransactionTracker } from './PendingTransactionTracker.js';\nimport { TransactionGasUtil } from './TransactionGasUtil.js';\nimport { TransactionStateManager } from './TransactionStateManager.js';\nimport { isEIP1559Transaction, normalizeTxParameters, validateTxParameters, determineTransactionType } from './TransactionUtils.js';\n\nclass TransactionController extends TransactionStateManager {\n  constructor({\n    config,\n    state,\n    provider,\n    blockTracker,\n    signEthTx,\n    getCurrentChainId,\n    getCurrentNetworkEIP1559Compatibility,\n    getCurrentAccountEIP1559Compatibility,\n    getSelectedAddress,\n    getEIP1559GasFeeEstimates\n  }) {\n    super({\n      config,\n      state,\n      getCurrentChainId\n    });\n    _defineProperty(this, \"getSelectedAddress\", void 0);\n    _defineProperty(this, \"getEIP1559GasFeeEstimates\", void 0);\n    _defineProperty(this, \"nonceTracker\", void 0);\n    _defineProperty(this, \"pendingTxTracker\", void 0);\n    _defineProperty(this, \"txGasUtil\", void 0);\n    _defineProperty(this, \"_getCurrentNetworkEIP1559Compatibility\", void 0);\n    _defineProperty(this, \"_getCurrentAccountEIP1559Compatibility\", void 0);\n    _defineProperty(this, \"signEthTx\", void 0);\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"blockTracker\", void 0);\n    _defineProperty(this, \"inProcessOfSigning\", new Set());\n    _defineProperty(this, \"getUnapprovedTxCount\", () => Object.keys(this.getUnapprovedTxList()).length);\n    _defineProperty(this, \"getPendingTxCount\", account => this.getPendingTransactions(account).length);\n    this.blockTracker = blockTracker;\n    this._getCurrentNetworkEIP1559Compatibility = getCurrentNetworkEIP1559Compatibility;\n    this._getCurrentAccountEIP1559Compatibility = getCurrentAccountEIP1559Compatibility;\n    this.getSelectedAddress = getSelectedAddress;\n    this.getEIP1559GasFeeEstimates = getEIP1559GasFeeEstimates;\n    this.signEthTx = signEthTx;\n    this.provider = provider;\n    this.txGasUtil = new TransactionGasUtil(this.provider, this.blockTracker);\n    this.nonceTracker = new NonceTracker({\n      provider,\n      blockTracker,\n      getConfirmedTransactions: this.getConfirmedTransactions.bind(this),\n      getPendingTransactions: this.getSubmittedTransactions.bind(this) // nonce tracker should only care about submitted transactions\n    });\n    this.pendingTxTracker = new PendingTransactionTracker({\n      provider,\n      nonceTracker: this.nonceTracker,\n      getPendingTransactions: this.getPendingTransactions.bind(this),\n      // pending tx tracker should only care about submitted and approved transactions\n      getConfirmedTransactions: this.getConfirmedTransactions.bind(this),\n      approveTransaction: this.approveTransaction.bind(this),\n      publishTransaction: rawTx => this.provider.request({\n        method: METHOD_TYPES.ETH_SEND_RAW_TRANSACTION,\n        params: [rawTx]\n      })\n    });\n    this._setupListeners();\n  }\n  addTransactionUnapproved(txMeta) {\n    this.addTransactionToState(txMeta);\n    this.emit(`${txMeta.id}:unapproved`, txMeta);\n  }\n  async addNewUnapprovedTransaction(txParams, req) {\n    const txMeta = await this.createTransaction(txParams, req);\n    return this.processApproval(txMeta);\n  }\n  async processApproval(txMeta) {\n    return new Promise((resolve, reject) => {\n      const handleFinished = msg => {\n        if (msg.status === TransactionStatus.rejected) {\n          return reject(providerErrors.userRejectedRequest(`Transaction Signature: User denied message signature`));\n        }\n        if (msg.status === TransactionStatus.failed) {\n          return reject(rpcErrors.internal(`Transaction Signature: failed to sign message ${msg.error}`));\n        }\n        if (msg.status === TransactionStatus.signed && msg.isSignOnly) {\n          return resolve(msg.rawTransaction);\n        }\n        if (msg.status === TransactionStatus.submitted) {\n          return resolve(msg.transactionHash);\n        }\n        return reject(rpcErrors.internal(`Transaction Signature: Unknown problem: ${JSON.stringify(txMeta.transaction)}`));\n      };\n      this.once(`${txMeta.id}:finished`, handleFinished);\n    });\n  }\n  async approveTransaction(transactionID) {\n    const txMeta = this.getTransaction(transactionID);\n    if (this.inProcessOfSigning.has(transactionID)) {\n      return;\n    }\n    this.inProcessOfSigning.add(transactionID);\n    let nonceLock;\n    try {\n      this.setTxStatusApproved(transactionID);\n      const fromAddress = txMeta.transaction.from;\n      const {\n        customNonceValue\n      } = txMeta.transaction;\n      const customNonceValueNumber = Number(customNonceValue);\n      nonceLock = await this.nonceTracker.getNonceLock(fromAddress);\n      // add nonce to txParams\n      // if txMeta has previousGasParams then it is a retry at same nonce with\n      // higher gas settings and therefor the nonce should not be recalculated\n      const nonce = nonceLock.nextNonce;\n      const customOrNonce = customNonceValueNumber === 0 ? customNonceValue : customNonceValue || nonce;\n      txMeta.transaction.nonce = addHexPrefix(customOrNonce.toString(16));\n      // add nonce debugging information to txMeta\n      txMeta.nonceDetails = nonceLock.nonceDetails;\n      this.updateTransactionInState(txMeta, \"transactions#approveTransaction\");\n      // sign transaction\n      await this.signTransaction(transactionID, txMeta.isSignOnly);\n      // publish if not signOnly\n      if (!txMeta.isSignOnly) {\n        await this.publishTransaction(transactionID);\n      }\n      nonceLock.releaseLock();\n    } catch (err) {\n      try {\n        this.setTxStatusFailed(transactionID, err);\n      } catch (err2) {\n        log.error(err2);\n      }\n      // must set transaction to submitted/failed before releasing lock\n      if (nonceLock) {\n        nonceLock.releaseLock();\n      }\n      // continue with error chain\n      throw err;\n    } finally {\n      this.inProcessOfSigning.delete(transactionID);\n    }\n  }\n  async signTransaction(txId, isSignOnly) {\n    const txMeta = this.getTransaction(txId);\n    const chainId = this.getCurrentChainId();\n    const type = isEIP1559Transaction(txMeta) ? TRANSACTION_ENVELOPE_TYPES.FEE_MARKET : TRANSACTION_ENVELOPE_TYPES.LEGACY;\n    const txParams = {\n      type: Number.parseInt(type, 16),\n      chainId,\n      gasLimit: txMeta.transaction.gas,\n      accessList: txMeta.transaction.accessList,\n      data: txMeta.transaction.data,\n      gasPrice: txMeta.transaction.gasPrice,\n      maxFeePerGas: txMeta.transaction.maxFeePerGas,\n      maxPriorityFeePerGas: txMeta.transaction.maxPriorityFeePerGas,\n      nonce: Number.parseInt(txMeta.transaction.nonce, 16),\n      to: txMeta.transaction.to,\n      value: txMeta.transaction.value\n    };\n    const fromAddress = txMeta.transaction.from;\n    const tx = Transaction.from(txParams);\n    const signedEthTx = await this.signEthTx(tx, fromAddress);\n    txMeta.r = signedEthTx.signature.r;\n    txMeta.s = signedEthTx.signature.s;\n    txMeta.v = addHexPrefix(signedEthTx.signature.v.toString(16));\n    const rawTx = signedEthTx.serialized;\n    txMeta.rawTransaction = rawTx;\n    this.updateTransactionInState(txMeta, \"transactions#signTransaction: add r, s, v values and rawTx\");\n    this.setTxStatusSigned(txId, isSignOnly);\n    return rawTx;\n  }\n  async publishTransaction(txId) {\n    const txMeta = this.getTransaction(txId);\n    const rawTx = txMeta.rawTransaction;\n    let txHash;\n    try {\n      txHash = await this.provider.request({\n        method: METHOD_TYPES.ETH_SEND_RAW_TRANSACTION,\n        params: [rawTx]\n      });\n    } catch (error) {\n      if (error.message.toLowerCase().includes(\"known transaction\")) {\n        txHash = keccak256(addHexPrefix(rawTx));\n        txHash = addHexPrefix(txHash);\n      } else {\n        throw error;\n      }\n    }\n    this.setTxHash(txId, txHash);\n    this.setTxStatusSubmitted(txId);\n  }\n  async confirmTransaction(params) {\n    const {\n      txId,\n      txReceipt\n    } = params;\n    log.info(params, \"confirm params\");\n    const txMeta = this.getTransaction(txId);\n    if (!txMeta) return;\n    try {\n      txMeta.txReceipt = _objectSpread({}, txReceipt);\n      this.setTxStatusConfirmed(txId);\n      this.markNonceDuplicatesDropped(txId);\n      this.updateTransactionInState(txMeta, \"transactions#confirmTransaction - add txReceipt\");\n    } catch (error) {\n      log.error(error);\n    }\n  }\n  cancelTransaction(transactionID) {\n    throw new Error(`Method not implemented. ${transactionID}`);\n  }\n  async getEIP1559Compatibility(fromAddress) {\n    const currentNetworkIsCompatible = await this._getCurrentNetworkEIP1559Compatibility();\n    const fromAccountIsCompatible = await this._getCurrentAccountEIP1559Compatibility(fromAddress);\n    return currentNetworkIsCompatible && fromAccountIsCompatible;\n  }\n  async addTransactionGasDefaults(txMeta) {\n    // for user operation, if the dapp doesn't provide gas and fee, let bundler estimate them\n    // bundlers unfortunately have strict rules on fee prechecks  we will need to set a generous buffer\n    if (txMeta.isUserOperation) return txMeta;\n    let updateTxMeta = txMeta;\n    try {\n      updateTxMeta = await this.addTxGasDefaults(txMeta);\n    } catch (error) {\n      log.warn(error);\n      updateTxMeta = this.getTransaction(txMeta.id);\n      updateTxMeta.loadingDefaults = false;\n      this.updateTransactionInState(txMeta, \"Failed to calculate gas defaults.\");\n      throw error;\n    }\n    updateTxMeta.loadingDefaults = false;\n    this.updateTransactionInState(updateTxMeta, \"Added new unapproved transaction.\");\n    return updateTxMeta;\n  }\n  async addTxGasDefaults(txMeta) {\n    const eip1559Compatibility = txMeta.transaction.type !== TRANSACTION_ENVELOPE_TYPES.LEGACY && (await this.getEIP1559Compatibility());\n    const {\n      gasPrice: defaultGasPrice,\n      maxFeePerGas: defaultMaxFeePerGas,\n      maxPriorityFeePerGas: defaultMaxPriorityFeePerGas\n    } = await this.getDefaultGasFees(txMeta, eip1559Compatibility);\n    const {\n      gasLimit: defaultGasLimit,\n      simulationFails\n    } = await this.getDefaultGasLimit(txMeta);\n    txMeta = this.getTransaction(txMeta.id);\n    if (simulationFails) {\n      txMeta.simulationFails = simulationFails;\n    }\n    if (eip1559Compatibility) {\n      // If the dapp has suggested a gas price, but no maxFeePerGas or maxPriorityFeePerGas\n      //  then we set maxFeePerGas and maxPriorityFeePerGas to the suggested gasPrice.\n      if (txMeta.transaction.gasPrice && !txMeta.transaction.maxFeePerGas && !txMeta.transaction.maxPriorityFeePerGas) {\n        txMeta.transaction.maxFeePerGas = txMeta.transaction.gasPrice;\n        // If the dapp has suggested a gas price, but no maxFeePerGas or maxPriorityFeePerGas\n        // then we set maxFeePerGas to the suggested gasPrice.\n\n        txMeta.transaction.maxPriorityFeePerGas = bnLessThan(typeof defaultMaxPriorityFeePerGas === \"string\" ? stripHexPrefix(defaultMaxPriorityFeePerGas) : defaultMaxPriorityFeePerGas, typeof txMeta.transaction.gasPrice === \"string\" ? stripHexPrefix(txMeta.transaction.gasPrice) : txMeta.transaction.gasPrice) ? defaultMaxPriorityFeePerGas : txMeta.transaction.gasPrice;\n      } else {\n        if (defaultMaxFeePerGas && !txMeta.transaction.maxFeePerGas) {\n          // If the dapp has not set the gasPrice or the maxFeePerGas, then we set maxFeePerGas\n          // with the one returned by the gasFeeController, if that is available.\n          txMeta.transaction.maxFeePerGas = defaultMaxFeePerGas;\n        }\n        if (defaultMaxPriorityFeePerGas && !txMeta.transaction.maxPriorityFeePerGas) {\n          // If the dapp has not set the gasPrice or the maxPriorityFeePerGas, then we set maxPriorityFeePerGas\n          // with the one returned by the gasFeeController, if that is available.\n          txMeta.transaction.maxPriorityFeePerGas = defaultMaxPriorityFeePerGas;\n        }\n        if (defaultGasPrice && !txMeta.transaction.maxFeePerGas) {\n          // If the dapp has not set the gasPrice or the maxFeePerGas, and no maxFeePerGas is available\n          // from the gasFeeController, then we set maxFeePerGas to the defaultGasPrice, assuming it is\n          // available.\n          txMeta.transaction.maxFeePerGas = defaultGasPrice;\n        }\n        if (txMeta.transaction.maxFeePerGas && !txMeta.transaction.maxPriorityFeePerGas) {\n          // If the dapp has not set the gasPrice or the maxPriorityFeePerGas, and no maxPriorityFeePerGas is\n          // available from the gasFeeController, then we set maxPriorityFeePerGas to\n          // txMeta.transaction.maxFeePerGas, which will either be the gasPrice from the controller, the maxFeePerGas\n          // set by the dapp, or the maxFeePerGas from the controller.\n          txMeta.transaction.maxPriorityFeePerGas = txMeta.transaction.maxFeePerGas;\n        }\n      }\n\n      // We remove the gasPrice param entirely when on an eip1559 compatible network\n\n      delete txMeta.transaction.gasPrice;\n    } else {\n      // We ensure that maxFeePerGas and maxPriorityFeePerGas are not in the transaction params\n      // when not on a EIP1559 compatible network\n\n      delete txMeta.transaction.maxPriorityFeePerGas;\n      delete txMeta.transaction.maxFeePerGas;\n    }\n\n    // If we have gotten to this point, and none of gasPrice, maxPriorityFeePerGas or maxFeePerGas are\n    // set on transaction, it means that either we are on a non-EIP1559 network and the dapp didn't suggest\n    // a gas price, or we are on an EIP1559 network, and none of gasPrice, maxPriorityFeePerGas or maxFeePerGas\n    // were available from either the dapp or the network.\n    if (defaultGasPrice && !txMeta.transaction.gasPrice && !txMeta.transaction.maxPriorityFeePerGas && !txMeta.transaction.maxFeePerGas) {\n      txMeta.transaction.gasPrice = defaultGasPrice;\n    }\n    if (defaultGasLimit && !txMeta.transaction.gas) {\n      txMeta.transaction.gas = defaultGasLimit;\n    }\n    return txMeta;\n  }\n  setTxHash(txId, txHash) {\n    // Add the tx hash to the persisted meta-tx object\n    const txMeta = this.getTransaction(txId);\n    txMeta.transactionHash = txHash;\n    this.updateTransactionInState(txMeta, \"transactions#setTxHash\");\n  }\n  async getDefaultGasFees(txMeta, eip1559Compatibility) {\n    if (!eip1559Compatibility && txMeta.transaction.gasPrice || eip1559Compatibility && txMeta.transaction.maxFeePerGas && txMeta.transaction.maxPriorityFeePerGas) {\n      return {};\n    }\n    try {\n      const {\n        gasFeeEstimates,\n        gasEstimateType\n      } = await this.getEIP1559GasFeeEstimates();\n      if (eip1559Compatibility && gasEstimateType === GAS_ESTIMATE_TYPES.FEE_MARKET) {\n        // this is in dec gwei\n        const {\n          medium: {\n            suggestedMaxPriorityFeePerGas,\n            suggestedMaxFeePerGas\n          } = {}\n        } = gasFeeEstimates;\n        if (suggestedMaxPriorityFeePerGas && suggestedMaxFeePerGas) {\n          return {\n            // send to controller in hex wei\n            maxFeePerGas: addHexPrefix(decGWEIToHexWEI(new BigNumber(suggestedMaxFeePerGas)).toString(16)),\n            maxPriorityFeePerGas: addHexPrefix(decGWEIToHexWEI(new BigNumber(suggestedMaxPriorityFeePerGas)).toString(16))\n          };\n        }\n      } else if (gasEstimateType === GAS_ESTIMATE_TYPES.LEGACY) {\n        const {\n          medium\n        } = gasFeeEstimates;\n        // The LEGACY type includes low, medium and high estimates of\n        // gas price values.\n        return {\n          gasPrice: addHexPrefix(decGWEIToHexWEI(new BigNumber(medium)).toString(16))\n        };\n      } else if (gasEstimateType === GAS_ESTIMATE_TYPES.ETH_GASPRICE) {\n        const {\n          gasPrice\n        } = gasFeeEstimates;\n        // The ETH_GASPRICE type just includes a single gas price property,\n        // which we can assume was retrieved from eth_gasPrice\n        return {\n          gasPrice: addHexPrefix(decGWEIToHexWEI(new BigNumber(gasPrice)).toString(16))\n        };\n      }\n    } catch (error) {\n      log.error(error);\n    }\n    const gasPrice = await this.provider.request({\n      method: METHOD_TYPES.ETH_GET_GAS_PRICE\n    });\n    return {\n      gasPrice: gasPrice && addHexPrefix(gasPrice)\n    };\n  }\n  async getDefaultGasLimit(txMeta) {\n    const chainId = this.getCurrentChainId();\n    const customNetworkGasBuffer = CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP[chainId];\n    const chainType = getChainType(chainId);\n    if (txMeta.transaction.gas) {\n      return {};\n    }\n    if (txMeta.transaction.to && txMeta.transactionCategory === TRANSACTION_TYPES.SENT_ETHER && chainType !== \"custom\" && !txMeta.transaction.data) {\n      // This is a standard ether simple send, gas requirement is exactly 21k\n      return {\n        gasLimit: GAS_LIMITS.SIMPLE\n      };\n    }\n    const {\n      blockGasLimit,\n      estimatedGasHex,\n      simulationFails\n    } = await this.txGasUtil.analyzeGasUsage(txMeta);\n\n    // add additional gas buffer to our estimation for safety\n    const gasLimit = this.txGasUtil.addGasBuffer(addHexPrefix(estimatedGasHex), blockGasLimit, customNetworkGasBuffer);\n    return {\n      gasLimit,\n      simulationFails\n    };\n  }\n  async createTransaction(txParameters, req) {\n    const normalizedTxParameters = normalizeTxParameters(txParameters);\n    const eip1559Compatibility = await this.getEIP1559Compatibility(txParameters.from);\n    validateTxParameters(normalizedTxParameters, eip1559Compatibility);\n    let txMeta = this.generateTxMeta({\n      transaction: normalizedTxParameters,\n      origin: req.origin\n    });\n    const {\n      type,\n      category,\n      methodParams\n    } = await determineTransactionType(txParameters, this.provider);\n    txMeta.contractType = type;\n    txMeta.transactionCategory = category;\n    txMeta.methodParams = methodParams;\n    txMeta.isUserOperation = req.isUserOperation;\n    txMeta.isSignOnly = req.isSignOnly;\n    txMeta.transaction.value = txMeta.transaction.value ? addHexPrefix(txMeta.transaction.value) : \"0x0\";\n    this.emit(`${txMeta.id}:unapproved`, txMeta);\n    txMeta = this.addTransactionToState(txMeta);\n    txMeta = await this.addTransactionGasDefaults(txMeta);\n    this.emit(TX_EVENTS.TX_UNAPPROVED, {\n      txMeta,\n      req\n    });\n    return txMeta;\n  }\n  _setupListeners() {\n    this.setupBlockTrackerListener();\n    this.pendingTxTracker.on(TX_EVENTS.TX_WARNING, data => {\n      this.updateTransactionInState(data.txMeta);\n    });\n    this.pendingTxTracker.on(TX_EVENTS.TX_DROPPED, data => this.setTxStatusDropped(data.txId));\n    this.pendingTxTracker.on(TX_EVENTS.TX_BLOCK_UPDATE, ({\n      txMeta,\n      latestBlockNumber\n    }) => {\n      if (!txMeta.firstRetryBlockNumber) {\n        txMeta.firstRetryBlockNumber = latestBlockNumber;\n        this.updateTransactionInState(txMeta);\n      }\n    });\n    this.pendingTxTracker.on(TX_EVENTS.TX_RETRY, data => {\n      if (!(\"retryCount\" in data.txMeta)) {\n        data.txMeta.retryCount = 0;\n      }\n      data.txMeta.retryCount += 1;\n      this.updateTransactionInState(data.txMeta);\n    });\n    this.pendingTxTracker.on(TX_EVENTS.TX_FAILED, data => {\n      this.setTxStatusFailed(data.txId, data.error);\n    });\n    this.pendingTxTracker.on(TX_EVENTS.TX_CONFIRMED, data => this.confirmTransaction(data));\n  }\n  setupBlockTrackerListener() {\n    let listenersAreActive = false;\n    const latestBlockHandler = this.onLatestBlock.bind(this);\n    this.on(TX_EVENTS.TX_STATUS_UPDATE, () => {\n      const pendingTxs = this.getPendingTransactions();\n      if (!listenersAreActive && pendingTxs.length > 0) {\n        this.blockTracker.on(\"latest\", latestBlockHandler);\n        listenersAreActive = true;\n      } else if (listenersAreActive && !pendingTxs.length) {\n        this.blockTracker.removeListener(\"latest\", latestBlockHandler);\n        listenersAreActive = false;\n      }\n    });\n  }\n  async onLatestBlock(blockNumber) {\n    try {\n      await this.pendingTxTracker.updatePendingTxs();\n    } catch (error) {\n      log.error(error);\n    }\n    try {\n      await this.pendingTxTracker.resubmitPendingTxs(blockNumber);\n    } catch (error) {\n      log.error(error);\n    }\n  }\n  markNonceDuplicatesDropped(txId) {\n    const txMeta = this.getTransaction(txId);\n    const {\n      nonce,\n      from\n    } = txMeta.transaction;\n    const sameNonceTxs = this.getTransactions({\n      searchCriteria: {\n        from,\n        nonce\n      }\n    });\n    if (!sameNonceTxs.length) return;\n    sameNonceTxs.forEach(tx => {\n      if (tx.id === txId) return;\n      this.updateTransactionInState(txMeta, \"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce\");\n      if (tx.status !== TransactionStatus.failed) this.setTxStatusDropped(tx.id);\n    });\n  }\n}\n\nexport { TransactionController };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 7211, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/smartAccounts/BiconomySmartAccount.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { toBiconomySmartAccount } from 'permissionless/accounts';\nimport { entryPoint06Address } from 'viem/account-abstraction';\nimport { SMART_ACCOUNT } from '../../utils/constants.js';\n\nclass BiconomySmartAccount {\n  constructor(options) {\n    _defineProperty(this, \"name\", SMART_ACCOUNT.BICONOMY);\n    _defineProperty(this, \"options\", void 0);\n    this.options = options;\n  }\n  async getSmartAccount(params) {\n    var _this$options, _this$options2;\n    return toBiconomySmartAccount(_objectSpread(_objectSpread(_objectSpread({}, this.options || {}), {}, {\n      entryPoint: {\n        address: ((_this$options = this.options) === null || _this$options === void 0 || (_this$options = _this$options.entryPoint) === null || _this$options === void 0 ? void 0 : _this$options.address) || entryPoint06Address,\n        version: ((_this$options2 = this.options) === null || _this$options2 === void 0 || (_this$options2 = _this$options2.entryPoint) === null || _this$options2 === void 0 ? void 0 : _this$options2.version) || \"0.6\"\n      }\n    }, params), {}, {\n      owners: [params.walletClient],\n      client: params.client\n    }));\n  }\n}\n\nexport { BiconomySmartAccount };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM;IACJ,YAAY,OAAO,CAAE;QACnB,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ,sNAAa,CAAC,QAAQ;QACpD,IAAA,oLAAe,EAAC,IAAI,EAAE,WAAW,KAAK;QACtC,IAAI,CAAC,OAAO,GAAG;IACjB;IACA,MAAM,gBAAgB,MAAM,EAAE;QAC5B,IAAI,eAAe;QACnB,OAAO,IAAA,qNAAsB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG;YACnG,YAAY;gBACV,SAAS,CAAC,CAAC,gBAAgB,IAAI,CAAC,OAAO,MAAM,QAAQ,kBAAkB,KAAK,KAAK,CAAC,gBAAgB,cAAc,UAAU,MAAM,QAAQ,kBAAkB,KAAK,IAAI,KAAK,IAAI,cAAc,OAAO,KAAK,wMAAmB;gBACzN,SAAS,CAAC,CAAC,iBAAiB,IAAI,CAAC,OAAO,MAAM,QAAQ,mBAAmB,KAAK,KAAK,CAAC,iBAAiB,eAAe,UAAU,MAAM,QAAQ,mBAAmB,KAAK,IAAI,KAAK,IAAI,eAAe,OAAO,KAAK;YAC9M;QACF,GAAG,SAAS,CAAC,GAAG;YACd,QAAQ;gBAAC,OAAO,YAAY;aAAC;YAC7B,QAAQ,OAAO,MAAM;QACvB;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 7251, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/smartAccounts/KernelSmartAccount.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { toEcdsaKernelSmartAccount } from 'permissionless/accounts';\nimport { SMART_ACCOUNT } from '../../utils/constants.js';\n\nclass KernelSmartAccount {\n  constructor(options) {\n    _defineProperty(this, \"name\", SMART_ACCOUNT.KERNEL);\n    _defineProperty(this, \"options\", void 0);\n    this.options = options;\n  }\n  async getSmartAccount(params) {\n    return toEcdsaKernelSmartAccount(_objectSpread(_objectSpread(_objectSpread({}, this.options || {}), params), {}, {\n      owners: [params.walletClient],\n      client: params.client\n    }));\n  }\n}\n\nexport { KernelSmartAccount };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM;IACJ,YAAY,OAAO,CAAE;QACnB,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ,sNAAa,CAAC,MAAM;QAClD,IAAA,oLAAe,EAAC,IAAI,EAAE,WAAW,KAAK;QACtC,IAAI,CAAC,OAAO,GAAG;IACjB;IACA,MAAM,gBAAgB,MAAM,EAAE;QAC5B,OAAO,IAAA,yNAAyB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,SAAS,CAAC,GAAG;YAC/G,QAAQ;gBAAC,OAAO,YAAY;aAAC;YAC7B,QAAQ,OAAO,MAAM;QACvB;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 7283, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/smartAccounts/MetamaskSmartAccount.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { Implementation, toMetaMaskSmartAccount } from '@metamask/delegation-toolkit';\nimport { SMART_ACCOUNT } from '../../utils/constants.js';\n\nclass MetamaskSmartAccount {\n  constructor(options) {\n    _defineProperty(this, \"name\", SMART_ACCOUNT.METAMASK);\n    _defineProperty(this, \"options\", void 0);\n    this.options = options;\n  }\n  async getSmartAccount(input) {\n    var _this$options, _this$options2, _this$options3, _this$options4, _this$options5, _this$options6, _this$options7, _this$options$multiSi, _this$options8, _this$options9, _this$options$deployS, _this$options0, _this$options$impleme, _this$options1;\n    const hybridSignatory = {\n      walletClient: input.walletClient,\n      webAuthnAccount: (_this$options = this.options) === null || _this$options === void 0 || (_this$options = _this$options.hybridParams) === null || _this$options === void 0 ? void 0 : _this$options.webAuthnAccount,\n      keyId: (_this$options2 = this.options) === null || _this$options2 === void 0 || (_this$options2 = _this$options2.hybridParams) === null || _this$options2 === void 0 ? void 0 : _this$options2.keyId\n    };\n    const multiSigSignatory = [{\n      walletClient: input.walletClient\n    }, ...(((_this$options3 = this.options) === null || _this$options3 === void 0 || (_this$options3 = _this$options3.multiSigParams) === null || _this$options3 === void 0 ? void 0 : _this$options3.additionalSignerWalletClients) || [])];\n    const [eoaAddress] = await input.walletClient.getAddresses();\n    const hybridDeployParams = [eoaAddress, [...(((_this$options4 = this.options) === null || _this$options4 === void 0 || (_this$options4 = _this$options4.hybridParams) === null || _this$options4 === void 0 ? void 0 : _this$options4.p256KeyIds) || [])], [...(((_this$options5 = this.options) === null || _this$options5 === void 0 || (_this$options5 = _this$options5.hybridParams) === null || _this$options5 === void 0 ? void 0 : _this$options5.p256XValues) || [])], [...(((_this$options6 = this.options) === null || _this$options6 === void 0 || (_this$options6 = _this$options6.hybridParams) === null || _this$options6 === void 0 ? void 0 : _this$options6.p256YValues) || [])]];\n    const multiSigDeployParams = [[eoaAddress, ...(((_this$options7 = this.options) === null || _this$options7 === void 0 || (_this$options7 = _this$options7.multiSigParams) === null || _this$options7 === void 0 ? void 0 : _this$options7.additionalSignerAddresses) || [])], (_this$options$multiSi = (_this$options8 = this.options) === null || _this$options8 === void 0 || (_this$options8 = _this$options8.multiSigParams) === null || _this$options8 === void 0 ? void 0 : _this$options8.threshold) !== null && _this$options$multiSi !== void 0 ? _this$options$multiSi : BigInt(1 + (((_this$options9 = this.options) === null || _this$options9 === void 0 || (_this$options9 = _this$options9.multiSigParams) === null || _this$options9 === void 0 || (_this$options9 = _this$options9.additionalSignerWalletClients) === null || _this$options9 === void 0 ? void 0 : _this$options9.length) || 0))];\n    const baseParams = {\n      client: input.client,\n      deploySalt: (_this$options$deployS = (_this$options0 = this.options) === null || _this$options0 === void 0 ? void 0 : _this$options0.deploySalt) !== null && _this$options$deployS !== void 0 ? _this$options$deployS : \"0x0\"\n    };\n    const implementation = (_this$options$impleme = (_this$options1 = this.options) === null || _this$options1 === void 0 ? void 0 : _this$options1.implementation) !== null && _this$options$impleme !== void 0 ? _this$options$impleme : Implementation.Hybrid;\n    if (implementation === Implementation.Hybrid) {\n      const params = _objectSpread(_objectSpread({}, baseParams), {}, {\n        implementation,\n        deployParams: hybridDeployParams,\n        signer: hybridSignatory\n      });\n      return toMetaMaskSmartAccount(params);\n    } else if (implementation === Implementation.MultiSig) {\n      const params = _objectSpread(_objectSpread({}, baseParams), {}, {\n        implementation,\n        deployParams: multiSigDeployParams,\n        signer: multiSigSignatory\n      });\n      return toMetaMaskSmartAccount(params);\n    } else {\n      throw new Error(`MetamaskSmartAccount - unsupported implementation: ${implementation}`);\n    }\n  }\n}\n\nexport { MetamaskSmartAccount };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 7364, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/smartAccounts/NexusSmartAccount.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { toNexusSmartAccount } from 'permissionless/accounts';\nimport { entryPoint07Address } from 'viem/account-abstraction';\nimport { SMART_ACCOUNT } from '../../utils/constants.js';\n\nclass NexusSmartAccount {\n  constructor(options) {\n    _defineProperty(this, \"name\", SMART_ACCOUNT.NEXUS);\n    _defineProperty(this, \"options\", void 0);\n    this.options = options;\n  }\n  async getSmartAccount(params) {\n    var _this$options, _this$options2, _this$options3;\n    return toNexusSmartAccount(_objectSpread(_objectSpread(_objectSpread({}, this.options || {}), {}, {\n      entryPoint: {\n        address: ((_this$options = this.options) === null || _this$options === void 0 || (_this$options = _this$options.entryPoint) === null || _this$options === void 0 ? void 0 : _this$options.address) || entryPoint07Address,\n        version: ((_this$options2 = this.options) === null || _this$options2 === void 0 || (_this$options2 = _this$options2.entryPoint) === null || _this$options2 === void 0 ? void 0 : _this$options2.version) || \"0.7\"\n      },\n      version: ((_this$options3 = this.options) === null || _this$options3 === void 0 ? void 0 : _this$options3.version) || \"1.0.0\"\n    }, params), {}, {\n      owners: [params.walletClient],\n      client: params.client\n    }));\n  }\n}\n\nexport { NexusSmartAccount };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM;IACJ,YAAY,OAAO,CAAE;QACnB,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ,sNAAa,CAAC,KAAK;QACjD,IAAA,oLAAe,EAAC,IAAI,EAAE,WAAW,KAAK;QACtC,IAAI,CAAC,OAAO,GAAG;IACjB;IACA,MAAM,gBAAgB,MAAM,EAAE;QAC5B,IAAI,eAAe,gBAAgB;QACnC,OAAO,IAAA,4MAAmB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG;YAChG,YAAY;gBACV,SAAS,CAAC,CAAC,gBAAgB,IAAI,CAAC,OAAO,MAAM,QAAQ,kBAAkB,KAAK,KAAK,CAAC,gBAAgB,cAAc,UAAU,MAAM,QAAQ,kBAAkB,KAAK,IAAI,KAAK,IAAI,cAAc,OAAO,KAAK,wMAAmB;gBACzN,SAAS,CAAC,CAAC,iBAAiB,IAAI,CAAC,OAAO,MAAM,QAAQ,mBAAmB,KAAK,KAAK,CAAC,iBAAiB,eAAe,UAAU,MAAM,QAAQ,mBAAmB,KAAK,IAAI,KAAK,IAAI,eAAe,OAAO,KAAK;YAC9M;YACA,SAAS,CAAC,CAAC,iBAAiB,IAAI,CAAC,OAAO,MAAM,QAAQ,mBAAmB,KAAK,IAAI,KAAK,IAAI,eAAe,OAAO,KAAK;QACxH,GAAG,SAAS,CAAC,GAAG;YACd,QAAQ;gBAAC,OAAO,YAAY;aAAC;YAC7B,QAAQ,OAAO,MAAM;QACvB;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 7405, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/smartAccounts/SafeSmartAccount.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { toSafeSmartAccount } from 'permissionless/accounts';\nimport { entryPoint07Address } from 'viem/account-abstraction';\nimport { SMART_ACCOUNT } from '../../utils/constants.js';\n\nclass SafeSmartAccount {\n  constructor(options) {\n    _defineProperty(this, \"name\", SMART_ACCOUNT.SAFE);\n    _defineProperty(this, \"options\", void 0);\n    this.options = options;\n  }\n  async getSmartAccount(params) {\n    var _this$options, _this$options2, _this$options3;\n    return toSafeSmartAccount(_objectSpread(_objectSpread(_objectSpread({}, this.options || {}), {}, {\n      entryPoint: {\n        address: ((_this$options = this.options) === null || _this$options === void 0 || (_this$options = _this$options.entryPoint) === null || _this$options === void 0 ? void 0 : _this$options.address) || entryPoint07Address,\n        version: ((_this$options2 = this.options) === null || _this$options2 === void 0 || (_this$options2 = _this$options2.entryPoint) === null || _this$options2 === void 0 ? void 0 : _this$options2.version) || \"0.7\"\n      },\n      version: ((_this$options3 = this.options) === null || _this$options3 === void 0 ? void 0 : _this$options3.version) || \"1.4.1\"\n    }, params), {}, {\n      owners: [params.walletClient],\n      client: params.client\n    }));\n  }\n}\n\nexport { SafeSmartAccount };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM;IACJ,YAAY,OAAO,CAAE;QACnB,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ,sNAAa,CAAC,IAAI;QAChD,IAAA,oLAAe,EAAC,IAAI,EAAE,WAAW,KAAK;QACtC,IAAI,CAAC,OAAO,GAAG;IACjB;IACA,MAAM,gBAAgB,MAAM,EAAE;QAC5B,IAAI,eAAe,gBAAgB;QACnC,OAAO,IAAA,yMAAkB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG;YAC/F,YAAY;gBACV,SAAS,CAAC,CAAC,gBAAgB,IAAI,CAAC,OAAO,MAAM,QAAQ,kBAAkB,KAAK,KAAK,CAAC,gBAAgB,cAAc,UAAU,MAAM,QAAQ,kBAAkB,KAAK,IAAI,KAAK,IAAI,cAAc,OAAO,KAAK,wMAAmB;gBACzN,SAAS,CAAC,CAAC,iBAAiB,IAAI,CAAC,OAAO,MAAM,QAAQ,mBAAmB,KAAK,KAAK,CAAC,iBAAiB,eAAe,UAAU,MAAM,QAAQ,mBAAmB,KAAK,IAAI,KAAK,IAAI,eAAe,OAAO,KAAK;YAC9M;YACA,SAAS,CAAC,CAAC,iBAAiB,IAAI,CAAC,OAAO,MAAM,QAAQ,mBAAmB,KAAK,IAAI,KAAK,IAAI,eAAe,OAAO,KAAK;QACxH,GAAG,SAAS,CAAC,GAAG;YACd,QAAQ;gBAAC,OAAO,YAAY;aAAC;YAC7B,QAAQ,OAAO,MAAM;QACvB;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 7446, "column": 0}, "map": {"version":3,"sources":["file:///Users/yashparikh/projects/xstocks-ui/node_modules/%40toruslabs/ethereum-controllers/dist/lib.esm/AccountAbstraction/smartAccounts/TrustSmartAccount.js"],"sourcesContent":["import _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { toTrustSmartAccount } from 'permissionless/accounts';\nimport { entryPoint06Address } from 'viem/account-abstraction';\nimport { SMART_ACCOUNT } from '../../utils/constants.js';\n\nclass TrustSmartAccount {\n  constructor(options) {\n    _defineProperty(this, \"name\", SMART_ACCOUNT.TRUST);\n    _defineProperty(this, \"options\", void 0);\n    this.options = options;\n  }\n  async getSmartAccount(params) {\n    var _this$options, _this$options2;\n    return toTrustSmartAccount(_objectSpread(_objectSpread(_objectSpread({}, this.options || {}), {}, {\n      entryPoint: {\n        address: ((_this$options = this.options) === null || _this$options === void 0 || (_this$options = _this$options.entryPoint) === null || _this$options === void 0 ? void 0 : _this$options.address) || entryPoint06Address,\n        version: ((_this$options2 = this.options) === null || _this$options2 === void 0 || (_this$options2 = _this$options2.entryPoint) === null || _this$options2 === void 0 ? void 0 : _this$options2.version) || \"0.6\"\n      }\n    }, params), {}, {\n      owner: params.walletClient,\n      client: params.client\n    }));\n  }\n}\n\nexport { TrustSmartAccount };\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM;IACJ,YAAY,OAAO,CAAE;QACnB,IAAA,oLAAe,EAAC,IAAI,EAAE,QAAQ,sNAAa,CAAC,KAAK;QACjD,IAAA,oLAAe,EAAC,IAAI,EAAE,WAAW,KAAK;QACtC,IAAI,CAAC,OAAO,GAAG;IACjB;IACA,MAAM,gBAAgB,MAAM,EAAE;QAC5B,IAAI,eAAe;QACnB,OAAO,IAAA,4MAAmB,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,IAAA,mLAAa,EAAC,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG;YAChG,YAAY;gBACV,SAAS,CAAC,CAAC,gBAAgB,IAAI,CAAC,OAAO,MAAM,QAAQ,kBAAkB,KAAK,KAAK,CAAC,gBAAgB,cAAc,UAAU,MAAM,QAAQ,kBAAkB,KAAK,IAAI,KAAK,IAAI,cAAc,OAAO,KAAK,wMAAmB;gBACzN,SAAS,CAAC,CAAC,iBAAiB,IAAI,CAAC,OAAO,MAAM,QAAQ,mBAAmB,KAAK,KAAK,CAAC,iBAAiB,eAAe,UAAU,MAAM,QAAQ,mBAAmB,KAAK,IAAI,KAAK,IAAI,eAAe,OAAO,KAAK;YAC9M;QACF,GAAG,SAAS,CAAC,GAAG;YACd,OAAO,OAAO,YAAY;YAC1B,QAAQ,OAAO,MAAM;QACvB;IACF;AACF","ignoreList":[0]}}]
}