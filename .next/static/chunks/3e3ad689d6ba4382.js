(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,65703,(e,t,r)=>{t.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw TypeError("need wrapper function");return Object.keys(t).forEach(function(e){i[e]=t[e]}),i;function i(){for(var e=Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var i=t.apply(this,e),n=e[e.length-1];return"function"==typeof i&&i!==n&&Object.keys(n).forEach(function(e){i[e]=n[e]}),i}}},80072,(e,t,r)=>{var i=e.r(65703);function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)};return t.onceError=(e.name||"Function wrapped with `once`")+" shouldn't be called more than once",t.called=!1,t}t.exports=i(n),t.exports.strict=i(o),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},99846,(e,t,r)=>{var i=e.i(47167),n=e.r(80072),o=function(){},s=e.g.Bare?queueMicrotask:i.default.nextTick.bind(i.default),a=function(e,t,r){if("function"==typeof t)return a(e,null,t);t||(t={}),r=n(r||o);var i=e._writableState,l=e._readableState,d=t.readable||!1!==t.readable&&e.readable,u=t.writable||!1!==t.writable&&e.writable,f=!1,c=function(){e.writable||h()},h=function(){u=!1,d||r.call(e)},m=function(){d=!1,u||r.call(e)},g=function(t){r.call(e,t?Error("exited with error code: "+t):null)},p=function(t){r.call(e,t)},w=function(){s(y)},y=function(){if(!f&&(d&&!(l&&l.ended&&!l.destroyed)||u&&!(i&&i.ended&&!i.destroyed)))return r.call(e,Error("premature close"))},b=function(){e.req.on("finish",h)};return e.setHeader&&"function"==typeof e.abort?(e.on("complete",h),e.on("abort",w),e.req?b():e.on("request",b)):u&&!i&&(e.on("end",c),e.on("close",c)),e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length&&e.on("exit",g),e.on("end",m),e.on("finish",h),!1!==t.error&&e.on("error",p),e.on("close",w),function(){f=!0,e.removeListener("complete",h),e.removeListener("abort",w),e.removeListener("request",b),e.req&&e.req.removeListener("finish",h),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",h),e.removeListener("exit",g),e.removeListener("end",m),e.removeListener("error",p),e.removeListener("close",w)}};t.exports=a},35991,(e,t,r)=>{var i,n=e.i(47167),o=e.r(80072),s=e.r(99846);try{i={}}catch(e){}var a=function(){},l=void 0!==n.default&&/^v?\.0/.test(n.default.version),d=function(e){return"function"==typeof e},u=function(e,t,r,n){n=o(n);var u=!1;e.on("close",function(){u=!0}),s(e,{readable:t,writable:r},function(e){if(e)return n(e);u=!0,n()});var f=!1;return function(t){if(!u&&!f){if(f=!0,l&&i&&(e instanceof(i.ReadStream||a)||e instanceof(i.WriteStream||a))&&d(e.close))return e.close(a);if(e.setHeader&&d(e.abort))return e.abort();if(d(e.destroy))return e.destroy();n(t||Error("stream was destroyed"))}}},f=function(e){e()},c=function(e,t){return e.pipe(t)};t.exports=function(){var e,t=Array.prototype.slice.call(arguments),r=d(t[t.length-1]||a)&&t.pop()||a;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw Error("pump requires two streams per minimum");var i=t.map(function(n,o){var s=o<t.length-1;return u(n,s,o>0,function(t){e||(e=t),t&&i.forEach(f),s||(i.forEach(f),r(e))})});return t.reduce(c)}},29801,(e,t,r)=>{"use strict";t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=i;0!=n--;){var i,n,o,s=o[n];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},17951,e=>{"use strict";let t,r;e.s([],92206),e.i(92206);var i,n,o=e.i(65273),s=e.i(9428),a=e.i(11577);e.i(47167),e.i(67034);var l=e.i(44314),d=e.i(70525),u=e.i(40965);let f=BigInt(0),c=BigInt(1);function h(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function m(e){if(!h(e))throw Error("Uint8Array expected")}function g(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}function p(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function w(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?f:BigInt("0x"+e)}let y="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,b=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function v(e){if(m(e),y)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=b[e[r]];return t}function E(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function _(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(y)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=E(e.charCodeAt(n)),o=E(e.charCodeAt(n+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+o}return i}function S(e){return w(v(e))}function A(e){return m(e),w(v(Uint8Array.from(e).reverse()))}function I(e,t){return _(e.toString(16).padStart(2*t,"0"))}function O(e,t){return I(e,t).reverse()}function x(e,t,r){let i;if("string"==typeof t)try{i=_(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(h(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}function B(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];m(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}let T=e=>"bigint"==typeof e&&f<=e;function P(e,t,r){return T(e)&&T(t)&&T(r)&&t<=e&&e<r}function C(e,t,r,i){if(!P(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let N=e=>(c<<BigInt(e))-c,R=e=>new Uint8Array(e),U={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||h(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function q(e,t,r={}){let i=(t,r,i)=>{let n=U[r];if("function"!=typeof n)throw Error("invalid validator function");let o=e[t];if((!i||void 0!==o)&&!n(o,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function M(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let o=e(r,...i);return t.set(r,o),o}}let L=BigInt(0),k=BigInt(1),D=BigInt(2),j=BigInt(3),H=BigInt(4),F=BigInt(5),W=BigInt(8);function z(e,t){let r=e%t;return r>=L?r:t+r}function V(e,t,r){let i=e;for(;t-- >L;)i*=i,i%=r;return i}function $(e,t){if(e===L)throw Error("invert: expected non-zero number");if(t<=L)throw Error("invert: expected positive modulus, got "+t);let r=z(e,t),i=t,n=L,o=k,s=k,a=L;for(;r!==L;){let e=i/r,t=i%r,l=n-s*e,d=o-a*e;i=r,r=t,n=s,o=a,s=l,a=d}if(i!==k)throw Error("invert: does not exist");return z(n,t)}let Z=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Y(e){return q(e,Z.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function G(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),o=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),o),i}function K(e,t){let r=function(e,t){let r=(e.ORDER-k)/D,i=e.pow(t,r),n=e.eql(i,e.ONE),o=e.eql(i,e.ZERO),s=e.eql(i,e.neg(e.ONE));if(!n&&!o&&!s)throw Error("Cannot find square root: probably non-prime P");return n?1:o?0:-1}(e,t);return 0===r||1===r}function J(e,t){void 0!==t&&(0,d.anumber)(t);let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function Q(e,t,r=!1,i={}){let n;if(e<=L)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:o,nByteLength:s}=J(e,t);if(s>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:e,isLE:r,BITS:o,BYTES:s,MASK:N(o),ZERO:L,ONE:k,create:t=>z(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return L<=t&&t<e},is0:e=>e===L,isOdd:e=>(e&k)===k,neg:t=>z(-t,e),eql:(e,t)=>e===t,sqr:t=>z(t*t,e),add:(t,r)=>z(t+r,e),sub:(t,r)=>z(t-r,e),mul:(t,r)=>z(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<L)throw Error("invalid exponent, negatives unsupported");if(r===L)return e.ONE;if(r===k)return t;let i=e.ONE,n=t;for(;r>L;)r&k&&(i=e.mul(i,n)),n=e.sqr(n),r>>=k;return i})(a,e,t),div:(t,r)=>z(t*$(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>$(t,e),sqrt:i.sqrt||(t=>(n||(n=e%H===j?function(t,r){let i=t.pow(r,(e+k)/H);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}:e%W===F?function(t,r){let i=t.mul(r,D),n=t.pow(i,(e-F)/W),o=t.mul(r,n),s=t.mul(t.mul(o,D),n),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}:function(e){let t=e-k,r=0;for(;t%D===L;)t/=D,r++;let i=D,n=Q(e);for(;i<e&&K(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r){let t=(e+k)/H;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let o=(t+k)/D;return function(e,n){if(!K(e,n))throw Error("Cannot find square root");let s=r,a=e.pow(e.mul(e.ONE,i),t),l=e.pow(n,o),d=e.pow(n,t);for(;!e.eql(d,e.ONE);){if(e.eql(d,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(d);t<s&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(a,k<<BigInt(s-t-1));a=e.sqr(r),l=e.mul(l,r),d=e.mul(d,a),s=t}return l}}(e)),n(a,t))),toBytes:e=>r?O(e,s):I(e,s),fromBytes:e=>{if(e.length!==s)throw Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?A(e):S(e)},invertBatch:e=>G(a,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(a)}function X(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function ee(e){let t=X(e);return t+Math.ceil(t/2)}let et=BigInt(0),er=BigInt(1);function ei(e,t){let r=t.negate();return e?r:t}function en(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function eo(e,t){en(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:N(e),maxNumber:n,shiftBy:BigInt(e)}}function es(e,t,r){let{windowSize:i,mask:n,maxNumber:o,shiftBy:s}=r,a=Number(e&n),l=e>>s;a>i&&(a-=o,l+=er);let d=t*i,u=d+Math.abs(a)-1,f=0===a;return{nextN:l,offset:u,isZero:f,isNeg:a<0,isNegF:t%2!=0,offsetF:d}}let ea=new WeakMap,el=new WeakMap;function ed(e){return el.get(e)||1}function eu(e){return Y(e.Fp),q(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...J(e.n,e.nBitLength),...e,...{p:e.Fp.ORDER}})}function ef(e){void 0!==e.lowS&&g("lowS",e.lowS),void 0!==e.prehash&&g("prehash",e.prehash)}let ec={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=ec;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=p(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let o=i>127?p(n.length/2|128):"";return p(e)+o+n+t},decode(e,t){let{Err:r}=ec,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],o=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let s=t.subarray(i,i+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of s)o=o<<8|e;if(i+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=n;let s=t.subarray(i,i+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(i+o)}}},_int:{encode(e){let{Err:t}=ec;if(e<eh)throw new t("integer: negative integers are not allowed");let r=p(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=ec;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return S(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=ec,n=x("signature",e),{v:o,l:s}=i.decode(48,n);if(s.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:l}=i.decode(2,o),{v:d,l:u}=i.decode(2,l);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(d)}},hexFromSig(e){let{_tlv:t,_int:r}=ec,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},eh=BigInt(0),em=BigInt(1),eg=BigInt(2),ep=BigInt(3),ew=BigInt(4),ey=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),eb=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ev=BigInt(1),eE=BigInt(2),e_=(e,t)=>(e+t/eE)/t,eS=Q(ey,void 0,void 0,{sqrt:function(e){let t=BigInt(3),r=BigInt(6),i=BigInt(11),n=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),l=e*e*e%ey,d=l*l*e%ey,u=V(d,t,ey)*d%ey,f=V(u,t,ey)*d%ey,c=V(f,eE,ey)*l%ey,h=V(c,i,ey)*c%ey,m=V(h,n,ey)*h%ey,g=V(m,s,ey)*m%ey,p=V(g,a,ey)*g%ey,w=V(p,s,ey)*m%ey,y=V(w,t,ey)*d%ey,b=V(y,o,ey)*h%ey,v=V(b,r,ey)*l%ey,E=V(v,eE,ey);if(!eS.eql(eS.sqr(E),e))throw Error("Cannot find square root");return E}}),eA=(i={a:BigInt(0),b:BigInt(7),Fp:eS,n:eb,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-ev*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=BigInt("0x100000000000000000000000000000000"),o=e_(t*e,eb),s=e_(-r*e,eb),a=z(e-o*t-s*i,eb),l=z(-o*r-s*t,eb),d=a>n,u=l>n;if(d&&(a=eb-a),u&&(l=eb-l),a>n||l>n)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:a,k2neg:u,k2:l}}}},n=l.sha256,{...(t=e=>(function(e){let t,r=(q(t=eu(e),{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})),{Fp:i,n:n}=r,o=i.BYTES+1,s=2*i.BYTES+1;function a(e){return z(e,n)}let{ProjectivePoint:l,normPrivateKeyToScalar:d,weierstrassEquation:u,isWithinCurveOrder:m}=function(e){var t;let r=function(e){let t=eu(e);q(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:n}=t;if(r){if(!i.eql(n,i.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:i}=r,n=Q(r.n,r.nBitLength),o=r.toBytes||((e,t,r)=>{let n=t.toAffine();return B(Uint8Array.from([4]),i.toBytes(n.x),i.toBytes(n.y))}),s=r.fromBytes||(e=>{let t=e.subarray(1);return{x:i.fromBytes(t.subarray(0,i.BYTES)),y:i.fromBytes(t.subarray(i.BYTES,2*i.BYTES))}});function a(e){let{a:t,b:n}=r,o=i.sqr(e),s=i.mul(o,e);return i.add(i.add(s,i.mul(e,t)),n)}if(!i.eql(i.sqr(r.Gy),a(r.Gx)))throw Error("bad generator point: equation left != right");function l(e){let t,{allowedPrivateKeyLengths:i,nByteLength:n,wrapPrivateKey:o,n:s}=r;if(i&&"bigint"!=typeof e){if(h(e)&&(e=v(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*n,"0")}try{t="bigint"==typeof e?e:S(x("private key",e,n))}catch(t){throw Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return o&&(t=z(t,s)),C("private key",t,em,s),t}function d(e){if(!(e instanceof p))throw Error("ProjectivePoint expected")}let u=M((e,t)=>{let{px:r,py:n,pz:o}=e;if(i.eql(o,i.ONE))return{x:r,y:n};let s=e.is0();null==t&&(t=s?i.ONE:i.inv(o));let a=i.mul(r,t),l=i.mul(n,t),d=i.mul(o,t);if(s)return{x:i.ZERO,y:i.ZERO};if(!i.eql(d,i.ONE))throw Error("invZ was invalid");return{x:a,y:l}}),m=M(e=>{if(e.is0()){if(r.allowInfinityPoint&&!i.is0(e.py))return;throw Error("bad point: ZERO")}let{x:t,y:n}=e.toAffine();if(!i.isValid(t)||!i.isValid(n))throw Error("bad point: x or y not FE");let o=i.sqr(n),s=a(t);if(!i.eql(o,s))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class p{constructor(e,t,r){if(null==e||!i.isValid(e))throw Error("x required");if(null==t||!i.isValid(t)||i.is0(t))throw Error("y required");if(null==r||!i.isValid(r))throw Error("z required");this.px=e,this.py=t,this.pz=r,Object.freeze(this)}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof p)throw Error("projective point not allowed");let n=e=>i.eql(e,i.ZERO);return n(t)&&n(r)?p.ZERO:new p(t,r,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=G(i,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(p.fromAffine)}static fromHex(e){let t=p.fromAffine(s(x("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(l(e))}static msm(e,t){return function(e,t,r,i){if(!Array.isArray(r))throw Error("array expected");r.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)});if(!Array.isArray(i))throw Error("array of scalars expected");if(i.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)}),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let n=e.ZERO,o=function(e){let t;for(t=0;e>f;e>>=c,t+=1);return t}(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=N(s),l=Array(Number(a)+1).fill(n),d=Math.floor((t.BITS-1)/s)*s,u=n;for(let e=d;e>=0;e-=s){l.fill(n);for(let t=0;t<i.length;t++){let n=Number(i[t]>>BigInt(e)&a);l[n]=l[n].add(r[t])}let t=n;for(let e=l.length-1,r=n;e>0;e--)r=r.add(l[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<s;e++)u=u.double()}return u}(p,n,e,t)}_setWindowSize(e){y.setWindowSize(this,e)}assertValidity(){m(this)}hasEvenY(){let{y:e}=this.toAffine();if(i.isOdd)return!i.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){d(e);let{px:t,py:r,pz:n}=this,{px:o,py:s,pz:a}=e,l=i.eql(i.mul(t,a),i.mul(o,n)),u=i.eql(i.mul(r,a),i.mul(s,n));return l&&u}negate(){return new p(this.px,i.neg(this.py),this.pz)}double(){let{a:e,b:t}=r,n=i.mul(t,ep),{px:o,py:s,pz:a}=this,l=i.ZERO,d=i.ZERO,u=i.ZERO,f=i.mul(o,o),c=i.mul(s,s),h=i.mul(a,a),m=i.mul(o,s);return m=i.add(m,m),u=i.mul(o,a),u=i.add(u,u),l=i.mul(e,u),d=i.mul(n,h),d=i.add(l,d),l=i.sub(c,d),d=i.add(c,d),d=i.mul(l,d),l=i.mul(m,l),u=i.mul(n,u),h=i.mul(e,h),m=i.sub(f,h),m=i.mul(e,m),m=i.add(m,u),u=i.add(f,f),f=i.add(u,f),f=i.add(f,h),f=i.mul(f,m),d=i.add(d,f),h=i.mul(s,a),h=i.add(h,h),f=i.mul(h,m),l=i.sub(l,f),u=i.mul(h,c),u=i.add(u,u),new p(l,d,u=i.add(u,u))}add(e){d(e);let{px:t,py:n,pz:o}=this,{px:s,py:a,pz:l}=e,u=i.ZERO,f=i.ZERO,c=i.ZERO,h=r.a,m=i.mul(r.b,ep),g=i.mul(t,s),w=i.mul(n,a),y=i.mul(o,l),b=i.add(t,n),v=i.add(s,a);b=i.mul(b,v),v=i.add(g,w),b=i.sub(b,v),v=i.add(t,o);let E=i.add(s,l);return v=i.mul(v,E),E=i.add(g,y),v=i.sub(v,E),E=i.add(n,o),u=i.add(a,l),E=i.mul(E,u),u=i.add(w,y),E=i.sub(E,u),c=i.mul(h,v),u=i.mul(m,y),c=i.add(u,c),u=i.sub(w,c),c=i.add(w,c),f=i.mul(u,c),w=i.add(g,g),w=i.add(w,g),y=i.mul(h,y),v=i.mul(m,v),w=i.add(w,y),y=i.sub(g,y),y=i.mul(h,y),v=i.add(v,y),g=i.mul(w,v),f=i.add(f,g),g=i.mul(E,v),u=i.mul(b,u),u=i.sub(u,g),g=i.mul(b,w),c=i.mul(E,c),new p(u,f,c=i.add(c,g))}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return y.wNAFCached(this,e,p.normalizeZ)}multiplyUnsafe(e){let{endo:t,n:n}=r;C("scalar",e,eh,n);let o=p.ZERO;if(e===eh)return o;if(this.is0()||e===em)return this;if(!t||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,e,p.normalizeZ);let{k1neg:s,k1:a,k2neg:l,k2:d}=t.splitScalar(e),u=o,f=o,c=this;for(;a>eh||d>eh;)a&em&&(u=u.add(c)),d&em&&(f=f.add(c)),c=c.double(),a>>=em,d>>=em;return s&&(u=u.negate()),l&&(f=f.negate()),f=new p(i.mul(f.px,t.beta),f.py,f.pz),u.add(f)}multiply(e){let t,n,{endo:o,n:s}=r;if(C("scalar",e,em,s),o){let{k1neg:r,k1:s,k2neg:a,k2:l}=o.splitScalar(e),{p:d,f:u}=this.wNAF(s),{p:f,f:c}=this.wNAF(l);d=y.constTimeNegate(r,d),f=y.constTimeNegate(a,f),f=new p(i.mul(f.px,o.beta),f.py,f.pz),t=d.add(f),n=u.add(c)}else{let{p:r,f:i}=this.wNAF(e);t=r,n=i}return p.normalizeZ([t,n])[0]}multiplyAndAddUnsafe(e,t,r){let i=p.BASE,n=(e,t)=>t!==eh&&t!==em&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),o=n(this,t).add(n(e,r));return o.is0()?void 0:o}toAffine(e){return u(this,e)}isTorsionFree(){let{h:e,isTorsionFree:t}=r;if(e===em)return!0;if(t)return t(p,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:t}=r;return e===em?this:t?t(p,this):this.multiplyUnsafe(r.h)}toRawBytes(e=!0){return g("isCompressed",e),this.assertValidity(),o(p,this,e)}toHex(e=!0){return g("isCompressed",e),v(this.toRawBytes(e))}}p.BASE=new p(r.Gx,r.Gy,i.ONE),p.ZERO=new p(i.ZERO,i.ONE,i.ZERO);let w=r.nBitLength,y=(t=r.endo?Math.ceil(w/2):w,{constTimeNegate:ei,hasPrecomputes:e=>1!==ed(e),unsafeLadder(e,t,r=p.ZERO){let i=e;for(;t>et;)t&er&&(r=r.add(i)),i=i.double(),t>>=er;return r},precomputeWindow(e,r){let{windows:i,windowSize:n}=eo(r,t),o=[],s=e,a=s;for(let e=0;e<i;e++){a=s,o.push(a);for(let e=1;e<n;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,r,i){let n=p.ZERO,o=p.BASE,s=eo(e,t);for(let e=0;e<s.windows;e++){let{nextN:t,offset:a,isZero:l,isNeg:d,isNegF:u,offsetF:f}=es(i,e,s);i=t,l?o=o.add(ei(u,r[f])):n=n.add(ei(d,r[a]))}return{p:n,f:o}},wNAFUnsafe(e,r,i,n=p.ZERO){let o=eo(e,t);for(let e=0;e<o.windows&&i!==et;e++){let{nextN:t,offset:s,isZero:a,isNeg:l}=es(i,e,o);if(i=t,!a){let e=r[s];n=n.add(l?e.negate():e)}}return n},getPrecomputes(e,t,r){let i=ea.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&ea.set(t,r(i))),i},wNAFCached(e,t,r){let i=ed(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let n=ed(e);return 1===n?this.unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)},setWindowSize(e,r){en(r,t),el.set(e,r),ea.delete(e)}});return{CURVE:r,ProjectivePoint:p,normPrivateKeyToScalar:l,weierstrassEquation:a,isWithinCurveOrder:function(e){return P(e,em,r.n)}}}({...r,toBytes(e,t,r){let n=t.toAffine(),o=i.toBytes(n.x);return(g("isCompressed",r),r)?B(Uint8Array.from([t.hasEvenY()?2:3]),o):B(Uint8Array.from([4]),o,i.toBytes(n.y))},fromBytes(e){let t=e.length,r=e[0],n=e.subarray(1);if(t===o&&(2===r||3===r)){let e,t=S(n);if(!P(t,em,i.ORDER))throw Error("Point is not on curve");let o=u(t);try{e=i.sqrt(o)}catch(e){throw Error("Point is not on curve"+(e instanceof Error?": "+e.message:""))}return(1&r)==1!=((e&em)===em)&&(e=i.neg(e)),{x:t,y:e}}if(t===s&&4===r)return{x:i.fromBytes(n.subarray(0,i.BYTES)),y:i.fromBytes(n.subarray(i.BYTES,2*i.BYTES))};throw Error("invalid Point, expected length of "+o+", or uncompressed "+s+", got "+t)}}),p=e=>v(I(e,r.nByteLength)),w=(e,t,r)=>S(e.slice(t,r));class y{constructor(e,t,r){C("r",e,em,n),C("s",t,em,n),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){let t=r.nByteLength;return new y(w(e=x("compactSignature",e,2*t),0,t),w(e,t,2*t))}static fromDER(e){let{r:t,s:r}=ec.toSig(x("DER",e));return new y(t,r)}assertValidity(){}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){let{r:t,s:o,recovery:s}=this,d=T(x("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let u=2===s||3===s?t+r.n:t;if(u>=i.ORDER)throw Error("recovery id 2 or 3 invalid");let f=(1&s)==0?"02":"03",c=l.fromHex(f+p(u)),h=$(u,n),m=a(-d*h),g=a(o*h),w=l.BASE.multiplyAndAddUnsafe(c,m,g);if(!w)throw Error("point at infinify");return w.assertValidity(),w}hasHighS(){return this.s>n>>em}normalizeS(){return this.hasHighS()?new y(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return _(this.toDERHex())}toDERHex(){return ec.hexFromSig(this)}toCompactRawBytes(){return _(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}function b(e){let t=h(e),r="string"==typeof e,i=(t||r)&&e.length;return t?i===o||i===s:r?i===2*o||i===2*s:e instanceof l}let E=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=S(e),i=8*e.length-r.nBitLength;return i>0?t>>BigInt(i):t},T=r.bits2int_modN||function(e){return a(E(e))},U=N(r.nBitLength);function L(e){return C("num < 2^"+r.nBitLength,e,eh,U),I(e,r.nByteLength)}let D={lowS:r.lowS,prehash:!1},j={lowS:r.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(b(e))throw Error("first arg must be private key");if(!b(t))throw Error("second arg must be public key");return l.fromHex(t).multiply(d(e)).toRawBytes(r)},sign:function(e,t,o=D){let{seed:s,k2sig:u}=function(e,t,o=D){if(["recovered","canonical"].some(e=>e in o))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:u}=r,{lowS:f,prehash:c,extraEntropy:h}=o;null==f&&(f=!0),e=x("msgHash",e),ef(o),c&&(e=x("prehashed msgHash",s(e)));let g=T(e),p=d(t),w=[L(p),L(g)];if(null!=h&&!1!==h){let e=!0===h?u(i.BYTES):h;w.push(x("extraEntropy",e))}return{seed:B(...w),k2sig:function(e){var t;let r=E(e);if(!m(r))return;let i=$(r,n),o=l.BASE.multiply(r).toAffine(),s=a(o.x);if(s===eh)return;let d=a(i*a(g+s*p));if(d===eh)return;let u=2*(o.x!==s)|Number(o.y&em),c=d;return f&&d>n>>em&&(c=(t=d)>n>>em?a(-t):t,u^=1),new y(s,c,u)}}}(e,t,o);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=R(e),n=R(e),o=0,s=()=>{i.fill(1),n.fill(0),o=0},a=(...e)=>r(n,i,...e),l=(e=R(0))=>{let t;if(n=a((t=[0],Uint8Array.from(t)),e),i=a(),0!==e.length){let t;n=a((t=[1],Uint8Array.from(t)),e),i=a()}},d=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(i=a()).slice();r.push(t),e+=i.length}return B(...r)};return(e,t)=>{let r;for(s(),l(e);!(r=t(d()));)l();return s(),r}})(r.hash.outputLen,r.nByteLength,r.hmac)(s,u)},verify:function(e,t,i,o=j){let s,d;t=x("msgHash",t),i=x("publicKey",i);let{lowS:u,prehash:f,format:c}=o;if(ef(o),"strict"in o)throw Error("options.strict was renamed to lowS");if(void 0!==c&&"compact"!==c&&"der"!==c)throw Error("format must be compact or der");let m="string"==typeof e||h(e),g=!m&&!c&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!m&&!g)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g&&(d=new y(e.r,e.s)),m){try{"compact"!==c&&(d=y.fromDER(e))}catch(e){if(!(e instanceof ec.Err))throw e}d||"der"===c||(d=y.fromCompact(e))}s=l.fromHex(i)}catch(e){return!1}if(!d||u&&d.hasHighS())return!1;f&&(t=r.hash(t));let{r:p,s:w}=d,b=T(t),v=$(w,n),E=a(b*v),_=a(p*v),S=l.BASE.multiplyAndAddUnsafe(s,E,_)?.toAffine();return!!S&&a(S.x)===p},ProjectivePoint:l,Signature:y,utils:{isValidPrivateKey(e){try{return d(e),!0}catch(e){return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let e=ee(r.n);return function(e,t,r=!1){let i=e.length,n=X(t),o=ee(t);if(i<16||i<o||i>1024)throw Error("expected "+o+"-1024 bytes of input, got "+i);let s=z(r?A(e):S(e),t-k)+k;return r?O(s,n):I(s,n)}(r.randomBytes(e),r.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}})({...i,...{hash:e,hmac:(t,...r)=>(0,u.hmac)(e,t,(0,d.concatBytes)(...r)),randomBytes:d.randomBytes}}))(n),create:t}),eI=(BigInt(0),{});eA.ProjectivePoint;let eO=(r=[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e))).map(e=>Array.from(e).reverse()),(e,t)=>{let[i,n,o,s]=r.map(t=>t.reduce((t,r)=>eS.add(eS.mul(t,e),r))),[a,l]=G(eS,[n,s],!0);return e=eS.mul(i,a),t=eS.mul(t,eS.mul(o,l)),{x:e,y:t}}),ex=function(e,t){if(Y(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=function(e,t){let r=e.ORDER,i=eh;for(let e=r-em;e%eg===eh;e/=eg)i+=em;let n=i,o=eg<<n-em-em,s=o*eg,a=(r-em)/s,l=(a-em)/eg,d=s-em,u=e.pow(t,a),f=e.pow(t,(a+em)/eg),c=(t,r)=>{let i=u,s=e.pow(r,d),a=e.sqr(s);a=e.mul(a,r);let c=e.mul(t,a);c=e.pow(c,l),c=e.mul(c,s),s=e.mul(c,r),a=e.mul(c,t);let h=e.mul(a,s);c=e.pow(h,o);let m=e.eql(c,e.ONE);s=e.mul(a,f),c=e.mul(h,i),a=e.cmov(s,a,m),h=e.cmov(c,h,m);for(let t=n;t>em;t--){let r=t-eg;r=eg<<r-em;let n=e.pow(h,r),o=e.eql(n,e.ONE);s=e.mul(a,i),i=e.mul(i,i),n=e.mul(h,i),a=e.cmov(s,a,o),h=e.cmov(n,h,o)}return{isValid:m,value:a}};if(e.ORDER%ew===ep){let r=(e.ORDER-ep)/ew,i=e.sqrt(e.neg(t));c=(t,n)=>{let o=e.sqr(n),s=e.mul(t,n);o=e.mul(o,s);let a=e.pow(o,r);a=e.mul(a,s);let l=e.mul(a,i),d=e.mul(e.sqr(a),n),u=e.eql(d,t),f=e.cmov(l,a,u);return{isValid:u,value:f}}}return c}(e,t.Z);if(!e.isOdd)throw Error("Fp.isOdd is not implemented!");return i=>{let n,o,s,a,l,d,u,f;n=e.sqr(i),n=e.mul(n,t.Z),o=e.sqr(n),o=e.add(o,n),s=e.add(o,e.ONE),s=e.mul(s,t.B),a=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),a=e.mul(a,t.A),o=e.sqr(s),d=e.sqr(a),l=e.mul(d,t.A),o=e.add(o,l),o=e.mul(o,s),d=e.mul(d,a),l=e.mul(d,t.B),o=e.add(o,l),u=e.mul(n,s);let{isValid:c,value:h}=r(o,d);f=e.mul(n,i),f=e.mul(f,h),u=e.cmov(u,s,c),f=e.cmov(f,h,c);let m=e.isOdd(i)===e.isOdd(f);f=e.cmov(e.neg(f),f,m);let g=G(e,[a],!0)[0];return{x:u=e.mul(u,g),y:f}}}(eS,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:eS.create(BigInt("-11"))});!function(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined")}(eA.ProjectivePoint,e=>{let{x:t,y:r}=ex(eS.create(e[0]));return eO(t,r)},(eS.ORDER,l.sha256));var eB=e.i(74891);function eT(e){let t=e.startsWith("0x")?e.substring(2):e;return(0,d.hexToBytes)(t)}function eP(e){return t=>((0,eB.abytes)(t),e(t))}let eC=eP(l.sha256);e.s(["addHexPrefix",()=>e5,"bigInt64ToBytes",()=>tc,"bigIntMax",()=>tt,"bigIntMin",()=>tr,"bigIntToAddressBytes",()=>tn,"bigIntToBytes",()=>eK,"bigIntToHex",()=>te,"bigIntToUnpaddedBytes",()=>ti,"bitsToBytes",()=>tg,"bytesToBigInt",()=>e$,"bytesToBigInt64",()=>tu,"bytesToBits",()=>tm,"bytesToHex",()=>ez,"bytesToInt",()=>eZ,"bytesToInt32",()=>td,"bytesToUnprefixedHex",()=>eH,"compareBytes",()=>ts,"concatBytes",()=>tl,"equalsBits",()=>ty,"fromSigned",()=>e4,"hexToBigInt",()=>th,"hexToBytes",()=>eF,"int32ToBytes",()=>tf,"intToBytes",()=>eG,"intToHex",()=>eY,"intToUnpaddedBytes",()=>to,"matchingBitsLength",()=>tw,"matchingBytesLength",()=>tp,"randomBytes",()=>ta,"setLengthLeft",()=>eQ,"setLengthRight",()=>eX,"short",()=>e7,"toBytes",()=>e8,"toUnsigned",()=>e6,"unpadArray",()=>e2,"unpadBytes",()=>e1,"unpadHex",()=>e3,"unprefixedHexToBytes",()=>eW,"validateNoLeadingZeroes",()=>e9],44958);class eN extends Error{constructor(e,t,r){super(t??e.code),this.type=e,void 0!==r&&(this.stack=r)}getMetadata(){return this.type}toObject(){return{type:this.getMetadata(),message:this.message??"",stack:this.stack??"",className:this.constructor.name}}}function eR(e,t){return new eN({code:"ETHEREUMJS_DEFAULT_ERROR_CODE"},e,t)}Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function eU(e,t){return"string"==typeof e&&!!e.match(/^0x[0-9A-Fa-f]*$/)&&(void 0===t||!(t>0)||e.length===2+2*t)}let eq=e=>{if("string"!=typeof e)throw eR(`[stripHexPrefix] input must be type 'string', received ${typeof e}`);return eU(e)?e.slice(2):e};function eM(e){let t=e;if("string"!=typeof t)throw eR(`[padToEven] value must be type 'string', received ${typeof t}`);return t.length%2&&(t=`0${t}`),t}let eL=function(e){if(!eU(e))throw eR(`This method only supports 0x-prefixed hex strings but input was: ${e}`)},ek=function(e){if(!(e instanceof Uint8Array))throw eR(`This method only supports Uint8Array but input was: ${e}`)},eD=function(e){if(!Array.isArray(e))throw eR(`This method only supports number arrays but input was: ${e}`)},ej=BigInt(0),eH=d.bytesToHex,eF=e=>{if(!e.startsWith("0x"))throw eR("input string must be 0x prefixed");return eT(eM(eq(e)))},eW=e=>{if(e.startsWith("0x"))throw eR("input string cannot be 0x prefixed");return eT(eM(e))},ez=e=>{let t=eH(e);return`0x${t}`},eV=[];for(let e=0;e<=65535;e++)eV[e]=BigInt(e);let e$=(e,t=!1)=>{t&&e.reverse();let r=ez(e);return"0x"===r?ej:4===r.length?eV[e[0]]:6===r.length?eV[256*e[0]+e[1]]:BigInt(r)},eZ=e=>{let t=Number(e$(e));if(!Number.isSafeInteger(t))throw eR("Number exceeds 53 bits");return t},eY=e=>{if(!Number.isSafeInteger(e)||e<0)throw eR(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`},eG=e=>eF(eY(e)),eK=(e,t=!1)=>{let r=eF(`0x${eM(e.toString(16))}`);return t?r.reverse():r},eJ=(e,t,r)=>r?e.length<t?new Uint8Array([...e,...new Uint8Array(t-e.length)]):e.subarray(0,t):e.length<t?new Uint8Array([...new Uint8Array(t-e.length),...e]):e.subarray(-t),eQ=(e,t)=>(ek(e),eJ(e,t,!1)),eX=(e,t)=>(ek(e),eJ(e,t,!0)),e0=e=>{let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},e1=e=>(ek(e),e0(e)),e2=e=>(eD(e),e0(e)),e3=e=>(eL(e),`0x${e0(eq(e))}`),e8=e=>{if(null==e)return new Uint8Array;if(Array.isArray(e)||e instanceof Uint8Array)return Uint8Array.from(e);if("string"==typeof e){if(!eU(e))throw eR(`Cannot convert string to Uint8Array. toBytes only supports 0x-prefixed hex strings and this string was given: ${e}`);return eF(e)}if("number"==typeof e)return eG(e);if("bigint"==typeof e){if(e<ej)throw eR(`Cannot convert negative bigint to Uint8Array. Given: ${e}`);let t=e.toString(16);return t.length%2&&(t="0"+t),eW(t)}if(void 0!==e.toBytes)return e.toBytes();throw eR("invalid type")},e4=e=>BigInt.asIntN(256,e$(e)),e6=e=>eK(BigInt.asUintN(256,e)),e5=e=>"string"!=typeof e||eU(e)?e:`0x${e}`,e7=(e,t=50)=>{let r=e instanceof Uint8Array?ez(e):e,i="0x"===r.slice(0,2)?t+2:t;return r.length<=i?r:r.slice(0,i)+"â€¦"},e9=e=>{for(let[t,r]of Object.entries(e))if(void 0!==r&&r.length>0&&0===r[0])throw eR(`${t} cannot have leading zeroes, received: ${ez(r)}`)},te=e=>`0x${e.toString(16)}`,tt=(...e)=>e.reduce((e,t)=>t>e?t:e),tr=(...e)=>e.reduce((e,t)=>t<e?t:e),ti=e=>e1(eK(e)),tn=(e,t=!0)=>{let r=eK(e);if(t&&r.length>20)throw Error(`Invalid address bytes length=${r.length} strict=${t}`);return eQ(r,20)},to=e=>e1(eG(e)),ts=(e,t)=>{let r=e$(e),i=e$(t);return r>i?1:r<i?-1:0},ta=e=>(0,d.randomBytes)(e),tl=(...e)=>{if(1===e.length)return e[0];let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0));for(let r=0,i=0;r<e.length;r++){let n=e[r];t.set(n,i),i+=n.length}return t};function td(e,t=!1){return e.length<4&&(e=eJ(e,4,t)),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,t)}function tu(e,t=!1){return e.length<8&&(e=eJ(e,8,t)),new DataView(e.buffer,e.byteOffset,e.byteLength).getBigUint64(0,t)}function tf(e,t=!1){let r=new ArrayBuffer(4);return new DataView(r).setUint32(0,e,t),new Uint8Array(r)}function tc(e,t=!1){let r=new ArrayBuffer(8);return new DataView(r).setBigUint64(0,e,t),new Uint8Array(r)}function th(e){return e$(eF(eU(e)?e:`0x${e}`))}function tm(e,t){let r=[];for(let i=0;i<(t??8*e.length);i++){let t=Math.floor(i/8),n=7-i%8;r.push(e[t]>>n&1)}return r}function tg(e){let t=new Uint8Array(Math.ceil(e.length/8));for(let r=0;r<e.length;r++){let i=Math.floor(r/8),n=7-r%8;t[i]|=e[r]<<n}return t}function tp(e,t){let r=0,i=Math.min(e.length,t.length);for(let n=0;n<i;n++)if(e[n]===t[n])r++;else break;return r}function tw(e,t){let r=0,i=Math.min(e.length,t.length);for(let n=0;n<i;n++)if(e[n]===t[n])r++;else break;return r}function ty(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}BigInt("0xffffffffffffffff"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),eA.CURVE.n,eA.CURVE.n,BigInt(2),BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),eF("0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470"),eF("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),eF("0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"),eC(new Uint8Array),Uint8Array.from([128]),BigInt(-1),BigInt(0),BigInt(1),BigInt(2),BigInt(3),BigInt(7),BigInt(8),BigInt(27),BigInt(28),BigInt(31),BigInt(32),BigInt(64),BigInt(128),BigInt(255),BigInt(256),BigInt(96),BigInt(100),BigInt(160),BigInt(224),BigInt(7922816251426434e13),BigInt(1461501637330903e33),BigInt(2695994666715064e52),BigInt(1e9),BigInt(1e18);var tb=e.i(45535);eP(tb.keccak_224),eP(tb.keccak_256).create=tb.keccak_256.create,eP(tb.keccak_384),eP(tb.keccak_512),new Uint8Array(0),eF("0x05");eG(0),eG(1),BigInt(256),BigInt(31),e.i(44958),e.i(6170).default,e.i(28073);let tv=()=>Math.random().toString(36).slice(2);function tE({width:e,height:t}){let r=void 0!==window.screenLeft?window.screenLeft:window.screenX,i=void 0!==window.screenTop?window.screenTop:window.screenY,n=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=Math.abs((n-e)/2/1+r),a=Math.abs((o-t)/2/1+i);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${t/1},width=${e/1},top=${a},left=${s}`}let t_={POPUP:"popup",MODAL:"modal",AUTO_APPROVE:"auto-approve",DEFAULT:"default"},tS={height:660,width:375},tA={height:700,width:1200},tI={height:700,width:450},tO="light";var tx=e.i(56227),tB=e.i(19298);function tT(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout(()=>{throw e})}}class tP extends tB.EventEmitter{emit(e,...t){let r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;let r=Error(`Unhandled error.${e?` (${e.message})`:""}`);throw r.context=e,r}let n=i[e];if(void 0===n)return!1;if("function"==typeof n)tT(n,this,t);else{let e=n.length,r=function(e){let t=e.length,r=Array(t);for(let i=0;i<t;i+=1)r[i]=e[i];return r}(n);for(let i=0;i<e;i+=1)tT(r[i],this,t)}return!0}}var tC=e.i(84723);class tN extends Error{constructor({code:e,message:t,data:r}){if(!Number.isInteger(e))throw Error("code must be an integer");if(!t||"string"!=typeof t)throw Error("message must be string");super(t),(0,a.default)(this,"code",void 0),(0,a.default)(this,"data",void 0),this.code=e,void 0!==r&&(this.data=r)}toString(){return(0,tC.default)({code:this.code,message:this.message,data:this.data,stack:this.stack})}}let tR=(e,t,r=!0)=>(i,n)=>{i||n.error?t(i||n.error):!r||Array.isArray(n)?e(n):e(n.result)};var tU=tx;function tq(){}class tM extends tU.Duplex{constructor({name:e,target:t,targetWindow:r=window,targetOrigin:i="*"}){if(super({objectMode:!0}),(0,a.default)(this,"_init",void 0),(0,a.default)(this,"_haveSyn",void 0),(0,a.default)(this,"_name",void 0),(0,a.default)(this,"_target",void 0),(0,a.default)(this,"_targetWindow",void 0),(0,a.default)(this,"_targetOrigin",void 0),(0,a.default)(this,"_onMessage",void 0),(0,a.default)(this,"_synIntervalId",void 0),!e||!t)throw Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=e,this._target=t,this._targetWindow=r,this._targetOrigin=i,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write("BRK",null,tq),this._haveSyn=!1,this._init=!1}_handShake(){this._write("SYN",null,tq),this.cork()}_onData(e){if(this._init)if("BRK"===e)this._break();else try{this.push(e)}catch(e){this.emit("error",e)}else"SYN"===e?(this._haveSyn=!0,this._write("ACK",null,tq)):"ACK"===e&&(this._init=!0,this._haveSyn||this._write("ACK",null,tq),this.uncork())}_postMessage(e){let t=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:e},t)}onMessage(e){let t=e.data;("*"===this._targetOrigin||e.origin===this._targetOrigin)&&e.source===this._targetWindow&&"object"==typeof t&&t.target===this._name&&t.data&&this._onData(t.data)}_read(){}_write(e,t,r){this._postMessage(e),r()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}let tL=-32600,tk=-32603,tD={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};var tj=function(e,t){if(null==e)throw TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)};let tH=tk;function tF(e){return Number.isInteger(e)}function tW(e){return"string"==typeof e&&e.length>0}function tz(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function tV(e){return!!e&&!!tF(e.code)&&!!tW(e.message)&&(!e.stack||!!tW(e.stack))}function t$(e,t="Unspecified error message. This is a bug, please report it."){if(tF(e)){let t=e.toString();if(tj(tD,t))return tD[t].message;if(e>=-32099&&e<=-32e3)return"Unspecified server error."}return t}let tZ={code:tH,message:t$(tH)};function tY(e){try{JSON.parse(JSON.stringify(e,(e,t)=>{if("__proto__"===e||"constructor"===e||"function"==typeof t||"symbol"==typeof t)throw Error("Not valid json");return t}),(e,t)=>{if("__proto__"!==e&&"constructor"!==e)return t})}catch{return!1}return!0}function tG(e){return Object.getOwnPropertyNames(e).reduce((t,r)=>{let i=e[r];return tY(i)&&(t[r]=i),t},{})}function tK(e){return Array.isArray(e)?e.map(e=>tY(e)?e:tz(e)?tG(e):null):tz(e)?tG(e):tY(e)?e:null}function tJ(e,{fallbackError:t=tZ,shouldIncludeStack:r=!0}={}){if(!tV(t))throw Error("Must provide fallback error with integer number code and string message.");let i=function(e,t){if(e&&"object"==typeof e&&"serialize"in e&&"function"==typeof e.serialize)return e.serialize();if(tV(e))return e;let r=tK(e);return(0,s.default)((0,s.default)({},t),{},{data:{cause:r}})}(e,t);return r||delete i.stack,i}var tQ=function(e,t){if(null==e)throw TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)};function tX(e,t){if("[Circular]"!==t)return t}class t0 extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw Error('"message" must be a non-empty string.');!function(e){return tz(e)&&tj(e,"cause")&&tz(e.cause)}(r)?(super(t),(0,a.default)(this,"cause",void 0),(0,a.default)(this,"code",void 0),(0,a.default)(this,"data",void 0)):(super(t,{cause:r.cause}),(0,a.default)(this,"cause",void 0),(0,a.default)(this,"code",void 0),(0,a.default)(this,"data",void 0),tQ(this,"cause")||Object.assign(this,{cause:r.cause})),void 0!==r&&(this.data=r),this.code=e,this.cause=null==r?void 0:r.cause}serialize(){let e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data,function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch{return!1}}(this.data)&&(e.data.cause=tK(this.data.cause))),this.stack&&(e.stack=this.stack),e}toString(){return(0,tC.default)(this.serialize(),{replacer:tX,space:2})}}class t1 extends t0{constructor(e,t,r){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}var t2=e.i(86325),t3=e.i(99846),t8=e.i(80072),t4=e.i(35991),t6=tx,t5=tx;class t7 extends t5.Duplex{constructor({parent:e,name:t}){super({objectMode:!0}),(0,a.default)(this,"_parent",void 0),(0,a.default)(this,"_name",void 0),this._parent=e,this._name=t}_read(){}_write(e,t,r){this._parent.push({name:this._name,data:e}),r()}}let t9=Symbol("IGNORE_SUBSTREAM");class re extends t6.Duplex{constructor(e={}){super((0,s.default)((0,s.default)({},e),{},{objectMode:!0})),(0,a.default)(this,"_substreams",void 0),(0,a.default)(this,"getStream",void 0),this._substreams={}}createStream(e){var t,r;let i;if(!e)throw Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw Error(`ObjectMultiplex - Substream for name "${e}" already exists`);let n=new t7({parent:this,name:e});return this._substreams[e]=n,t=this,r=e=>n.destroy(e||void 0),i=(0,t8.default)(r),(0,t3.default)(t,{readable:!1},i),(0,t3.default)(t,{writable:!1},i),n}ignoreStream(e){if(!e)throw Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=t9}_read(){}_write(e,t,r){let{name:i,data:n}=e;if(!i)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),r();let o=this._substreams[i];return o?o!==t9&&o.push(n):window.console.warn(`ObjectMultiplex - orphaned data for stream "${i}"`),r()}}let rt=t2.default.getLogger("auth");function rr(e){let{message:t="",code:r=-32603,stack:i="Stack trace is not available.",data:n=""}=e,o=parseInt((null==r?void 0:r.toString())||"-32603");return{message:t||(null==e?void 0:e.toString())||t$(o),code:o,stack:i,data:n||t||(null==e?void 0:e.toString())}}rt.setLevel("error");class ri extends tP{constructor(){super(),(0,a.default)(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,r){let i=[],n=null,o=!1;for(let s of r)if([n,o]=await ri._runMiddleware(e,t,s,i),o)break;return[n,o,i.reverse()]}static _runMiddleware(e,t,r,i){return new Promise(n=>{let o=e=>{let r=e||t.error;r&&("object"==typeof r&&!1===Object.keys(r).includes("stack")&&(r.stack="Stack trace is not available."),rt.error(r),t.error=tJ(r,{shouldIncludeStack:!0,fallbackError:rr(r)})),n([r,!0])};try{r(e,t,e=>{t.error?o(t.error):(e&&("function"!=typeof e&&o(new tN({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),i.push(e)),n([null,!1]))},o)}catch(e){o(e)}})}static async _runReturnHandlers(e){for(let t of e)await new Promise((e,r)=>{t(t=>t?r(t):e())})}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new tN({code:-32603,message:"Response has no error or result for request"});if(!r)throw new tN({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,i)=>{try{let[n,o,s]=await ri._runAllMiddleware(e,t,this._middleware);if(o)return await ri._runReturnHandlers(s),i(n);return r(async e=>{try{await ri._runReturnHandlers(s)}catch(t){return e(t)}return e()})}catch(e){return i(e)}}}async _handleBatch(e,t){try{let r=await Promise.all(e.map(this._promiseHandle.bind(this)));if(t)return t(null,r);return r}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise((t,r)=>{this._handle(e,(e,i)=>{e&&void 0===i?r(e):t(i)}).catch(r)})}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){let e=new tN({code:-32603,message:"request must be plain object"});return t(e,{id:void 0,jsonrpc:"2.0",error:e})}if("string"!=typeof e.method){let r=new tN({code:-32603,message:"method must be string"});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}let r=(0,s.default)({},e),i={id:r.id,jsonrpc:r.jsonrpc},n=null;try{await this._processRequest(r,i)}catch(e){n=e}return n&&(delete i.result,i.error||("object"==typeof n&&!1===Object.keys(n).includes("stack")&&(n.stack="Stack trace is not available."),rt.error(n),i.error=tJ(n,{shouldIncludeStack:!0,fallbackError:rr(n)}))),t(n,i)}async _processRequest(e,t){let[r,i,n]=await ri._runAllMiddleware(e,t,this._middleware);if(ri._checkForCompletion(e,t,i),await ri._runReturnHandlers(n),r)throw r}}let rn=e=>(function(e,t){let[r,i]=function(e){if(e){if("string"==typeof e)return[e];else if("object"==typeof e&&!Array.isArray(e)){let{message:t,data:r}=e;if(t&&"string"!=typeof t)throw Error("Must specify string message.");return[null!=t?t:void 0,r]}}return[]}(t);return new t0(e,null!=r?r:t$(e),i)})(tL,e);function ro(e){return null!==e&&"object"==typeof e&&"function"==typeof e.pipe}var rs=()=>"Web3Auth: Lost connection to Web3Auth.",ra=()=>"Web3Auth: Disconnected from iframe. Page reload required.",rl=()=>"Must provide a Node.js-style duplex stream.",rd=()=>"Expected a single, non-array, object argument.",ru=()=>"'args.method' must be a non-empty string.",rf=()=>"'args.params' must be an object or array if provided.",rc=e=>`Web3Auth: Connected to chain with ID "${e}".`,rh=t2.default.getLogger("ws-embed");let rm=["eth_subscription"];class rg extends tP{constructor(e,{maxEventListeners:t=100,jsonRpcStreamName:r="provider"}){var i;if(super(),(0,a.default)(this,"rpcEngine",void 0),(0,a.default)(this,"jsonRpcConnectionEvents",void 0),(0,a.default)(this,"isWeb3Auth",void 0),(0,a.default)(this,"state",void 0),!function(e){var t;return ro(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState&&ro(t=e)&&!1!==t.readable&&"function"==typeof t._read&&"object"==typeof t._readableState}(e))throw Error(rl());this.isWeb3Auth=!0,this.setMaxListeners(t),this.handleConnect=this.handleConnect.bind(this),this.handleDisconnect=this.handleDisconnect.bind(this),this.handleStreamDisconnect=this.handleStreamDisconnect.bind(this),this.rpcRequest=this.rpcRequest.bind(this),this.initializeState=this.initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this),this.send=this.send.bind(this);const n=new re;(0,t4.default)(e,n,e,this.handleStreamDisconnect.bind(this,"Web3Auth")),n.ignoreStream("phishing");const o=function(){let e={},t=new tP,r=new tx.Duplex({objectMode:!0,read:function(){return!1},write:function(r,i,n){let o;try{if(r.id){let t=e[r.id];if(!t)throw Error(`StreamMiddleware - Unknown response id "${r.id}"`);delete e[r.id],Object.assign(t.res,r),setTimeout(t.end)}else t.emit("notification",r)}catch(e){o=e}n(o)}});return{events:t,middleware:(t,i,n,o)=>{r.push(t),e[t.id]={req:t,res:i,next:n,end:o}},stream:r}}();(0,t4.default)(o.stream,n.createStream(r),o.stream,this.handleStreamDisconnect.bind(this,"Web3Auth RpcProvider"));const l=new ri;l.push((e,t,r,i)=>{let n=e.id,o=Math.random().toString(36).slice(2);e.id=o,t.id=o,r(r=>{e.id=n,t.id=n,r()})}),l.push((e,t,r)=>{"string"==typeof e.method&&e.method||(t.error=rn({message:"The request 'method' must be a non-empty string.",data:(0,s.default)((0,s.default)({},e||{}),{},{cause:"The request 'method' must be a non-empty string."})})),r(e=>{let{error:r}=t;return r&&rh.error(`Ws-Embed - RPC Error: ${r.message}`,r),e()})}),l.push((i={origin:location.origin},function(e,t,r){r(r=>{t.error&&t2.default.warn("Error in RPC response:\n",t),e.isTorusInternal||(t2.default.info(`RPC (${i.origin}):`,e,"->",t),r())})})),l.push(o.middleware),this.rpcEngine=l,this.jsonRpcConnectionEvents=o.events}async request(e){if(!e||"object"!=typeof e||Array.isArray(e))throw rn({message:rd(),data:(0,s.default)((0,s.default)({},e||{}),{},{cause:rd()})});let{method:t,params:r}=e;if("string"!=typeof t||0===t.length)throw rn({message:ru(),data:(0,s.default)((0,s.default)({},e||{}),{},{cause:rd()})});if(void 0!==r&&!Array.isArray(r)&&("object"!=typeof r||null===r))throw rn({message:rf(),data:(0,s.default)((0,s.default)({},e||{}),{},{cause:rd()})});return new Promise((e,i)=>{this.rpcRequest({method:t,params:r},tR(e,i))})}send(e,t){this.rpcRequest(e,t)}sendAsync(e){return new Promise((t,r)=>{this.rpcRequest(e,tR(t,r))})}handleStreamDisconnect(e,t){let r;r=`Web3Auth: Lost connection to "${e}".`,null!=t&&t.stack&&(r+=`
${t.stack}`),rh.warn(r),this&&this.listenerCount("error")>0&&this.emit("error",r),this.handleDisconnect(!1,t?t.message:void 0)}}let rp={PRODUCTION:"production",STAGING:"staging",DEVELOPMENT:"development",TESTING:"testing"},rw={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"};class ry extends tP{constructor({url:e,target:t,features:r,timeout:i=3e4}){super(),(0,a.default)(this,"url",void 0),(0,a.default)(this,"target",void 0),(0,a.default)(this,"features",void 0),(0,a.default)(this,"window",void 0),(0,a.default)(this,"windowTimer",void 0),(0,a.default)(this,"iClosedWindow",void 0),(0,a.default)(this,"timeout",void 0),this.url=e,this.target=t||"_blank",this.features=r||tE(tA),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=i,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),void 0===this.window&&clearInterval(this.windowTimer)},500))}open(){var e;this.window=window.open(this.url.href,this.target,this.features),null!=(e=this.window)&&e.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}class rb extends rg{constructor(e,{maxEventListeners:t=100,jsonRpcStreamName:r="provider"},i){super(e,{maxEventListeners:t,jsonRpcStreamName:r}),(0,a.default)(this,"tryWindowHandle",void 0),(0,a.default)(this,"windowRefs",void 0),(0,a.default)(this,"iframeUrl",void 0),(0,a.default)(this,"iframeId",void 0),this.state=(0,s.default)((0,s.default)({},rb.defaultState),i),this.iframeUrl="",this.iframeId="",this.windowRefs=new Map,this.on("connect",()=>{this.state.isConnected=!0});const n=e=>{let{method:t,params:r}=e;if("iframe_status"===t){let{isFullScreen:e,rid:t}=r;this.displayIframe({isFull:e,rid:t},!0)}else if("close_window"===t)this.handleCloseWindow(r);else if("user_logged_in"===t){let{currentAuthConnection:e}=r;this.state.isLoggedIn=!0,this.state.currentAuthConnection=e}else if("user_logged_out"===t)this.state.isLoggedIn=!1,this.state.currentAuthConnection=null,this.displayIframe({isFull:!1},!0);else if("toggle_widget_button"===t){let{show:e}=r;this.state.widgetVisibility=e,this.displayIframe()}else if("allow_wallet_service"===t){let{allow:e}=r;this.state.allowWalletService=e}};this.jsonRpcConnectionEvents.on("notification",n)}get isLoggedIn(){return this.state.isLoggedIn}get isIFrameFullScreen(){return this.state.isIFrameFullScreen}get allowWalletService(){return this.state.allowWalletService}isConnected(){return this.state.isConnected}async initializeState(e){try{let{torusUrl:t,torusIframeId:r}=e;this.iframeUrl=t,this.iframeId=r;let{currentAuthConnection:i,isLoggedIn:n}=await this.request({method:"get_provider_state",params:[]});n&&this.handleConnect(i,n)}catch(e){rh.error("Web3Auth: Failed to get initial state. Please report this bug.",e)}finally{rh.info("initialized communication state"),this.state.initialized=!0}}displayIframe({isFull:e=!1,rid:t=""}={},r=!1){let i={};if(e)i.display="block",i.width="100%",i.height="100%",i.top="0px",i.right="0px",i.left="0px",i.bottom="0px";else switch(i.display=this.state.widgetVisibility?"block":"none",i.height=this.state.widgetVisibility?"70px":"0px",i.width=this.state.widgetVisibility?"70px":"0px",this.state.buttonPosition){case rw.TOP_LEFT:i.top="0px",i.left="0px",i.right="auto",i.bottom="auto";break;case rw.TOP_RIGHT:i.top="0px",i.right="0px",i.left="auto",i.bottom="auto";break;case rw.BOTTOM_RIGHT:i.bottom="0px",i.right="0px",i.top="auto",i.left="auto";break;case rw.BOTTOM_LEFT:default:i.bottom="0px",i.left="0px",i.top="auto",i.right="auto"}Object.assign(document.getElementById(this.iframeId).style,i),this.state.isIFrameFullScreen=e,r||this.request({method:"iframe_status",params:{isIFrameFullScreen:e,rid:t}})}async handleWindow(e,{url:t,target:r,features:i,timeout:n}={}){let o=new URL(t||`${this.iframeUrl}/redirect?windowId=${e}&sessionNamespace=${window.location.hostname}`),s=new ry({url:o,target:r,features:i,timeout:n});if(s.open(),!s.window){this.displayIframe({isFull:!0}),this.request({method:"window_blocked",params:{windowId:e,finalUrl:o.href}});return}this.windowRefs.set(e,s),s.once("close",()=>{this.windowRefs.delete(e),this.request({method:"closed_window",params:{windowId:e}})})}rpcRequest(e,t){Array.isArray(e)||e.jsonrpc||(e.jsonrpc="2.0"),this.rpcEngine.handle(e,t)}handleConnect(e,t){this.state.isConnected||(this.state.isConnected=!0,this.emit("connect",{currentAuthConnection:e,isLoggedIn:t}),rh.debug(rc(e)))}handleDisconnect(e,t){if(this.state.isConnected||!this.state.isPermanentlyDisconnected&&!e){let r;this.state.isConnected=!1,e?(r=new t1(1013,t||rs()),rh.debug(r)):(r=new t1(1011,t||ra()),rh.error(r),this.state.currentAuthConnection=null,this.state.isLoggedIn=!1,this.state.widgetVisibility=!1,this.state.isIFrameFullScreen=!1,this.state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}handleCloseWindow(e){let{windowId:t}=e;this.windowRefs.has(t)&&(this.windowRefs.get(t).close(),this.windowRefs.delete(t))}}(0,a.default)(rb,"defaultState",{buttonPosition:"bottom-left",currentAuthConnection:null,isIFrameFullScreen:!1,widgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1,hasEmittedConnection:!1,allowWalletService:!1});var rv=e.i(29801);class rE extends rg{constructor(e,{maxEventListeners:t=100,jsonRpcStreamName:r="provider"}){super(e,{maxEventListeners:t,jsonRpcStreamName:r}),(0,a.default)(this,"chainId",void 0),(0,a.default)(this,"selectedAddress",void 0),(0,a.default)(this,"tryWindowHandle",void 0),this.state=(0,s.default)({},rE.defaultState),this.selectedAddress=null,this.chainId=null,this.handleAccountsChanged=this.handleAccountsChanged.bind(this),this.handleChainChanged=this.handleChainChanged.bind(this),this.handleUnlockStateChanged=this.handleUnlockStateChanged.bind(this),this.on("connect",()=>{this.state.isConnected=!0});const i=e=>{let{method:t,params:r}=e;"wallet_accounts_changed"===t?this.handleAccountsChanged(r):"wallet_unlock_state_changed"===t?this.handleUnlockStateChanged(r):"wallet_chain_changed"===t?this.handleChainChanged(r):rm.includes(t)&&(this.emit("data",e),this.emit("notification",r.result),this.emit("message",{type:t,data:r}))};this.jsonRpcConnectionEvents.on("notification",i)}isConnected(){return this.state.isConnected}async initializeState(){try{let{accounts:e,chainId:t,isUnlocked:r}=await this.request({method:"wallet_get_provider_state",params:[]});this.emit("connect",{chainId:t}),this.handleChainChanged({chainId:t}),this.handleUnlockStateChanged({accounts:e,isUnlocked:r}),this.handleAccountsChanged(e)}catch(e){rh.error("WsEmbed: Failed to get initial state. Please report this bug.",e)}finally{rh.info("initialized provider state"),this.state.initialized=!0}}rpcRequest(e,t,r=!1){let i=t;if(!Array.isArray(e)){if(e.jsonrpc||(e.jsonrpc="2.0"),[o.EVM_METHOD_TYPES.GET_ACCOUNTS,o.EVM_METHOD_TYPES.ETH_REQUEST_ACCOUNTS,o.SOLANA_METHOD_TYPES.SOLANA_REQUEST_ACCOUNTS,o.SOLANA_METHOD_TYPES.GET_ACCOUNTS].includes(e.method))i=(i,n)=>{this.handleAccountsChanged(n.result||[],"eth_accounts"===e.method,r),t(i,n)};else if("wallet_getProviderState"===e.method)return void this.rpcEngine.handle(e,i)}this.tryWindowHandle(e,i)}handleConnect(e){this.state.isConnected||(this.state.isConnected=!0,this.emit("connect",{chainId:e}),rh.debug(rc(e)))}handleDisconnect(e,t){if(this.state.isConnected||!this.state.isPermanentlyDisconnected&&!e){let r;this.state.isConnected=!1,e?(r=new t1(1013,t||rs()),rh.debug(r)):(r=new t1(1011,t||ra()),rh.error(r),this.chainId=null,this.state.accounts=null,this.selectedAddress=null,this.state.isUnlocked=!1,this.state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}handleAccountsChanged(e,t=!1,r=!1){let i=e;for(let t of(Array.isArray(i)||(rh.error("WsEmbed: Received non-array accounts parameter. Please report this bug.",i),i=[]),e))if("string"!=typeof t){rh.error("WsEmbed: Received non-string account. Please report this bug.",e),i=[];break}(0,rv.default)(this.state.accounts,i)||(t&&Array.isArray(this.state.accounts)&&this.state.accounts.length>0&&!r&&rh.error('WsEmbed: "eth_accounts" unexpectedly updated accounts. Please report this bug.',i),this.state.accounts=i,this.emit("accountsChanged",i)),this.selectedAddress!==i[0]&&(this.selectedAddress=i[0]||null)}handleChainChanged({chainId:e}={}){e?"loading"===e?this.handleDisconnect(!0):(this.handleConnect(e),e!==this.chainId&&(this.chainId=e,this.state.initialized&&this.emit("chainChanged",this.chainId))):rh.error("WsEmbed: Received invalid network parameters. Please report this bug.",{chainId:e})}handleUnlockStateChanged({accounts:e,isUnlocked:t}={}){"boolean"!=typeof t?rh.error("WsEmbed: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t}):t!==this.state.isUnlocked&&(this.state.isUnlocked=t,this.handleAccountsChanged(e||[]))}}function r_(e){return new Promise((t,r)=>{try{let r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(e){r(e)}})}async function rS(e){try{let{document:t}=e,r=t.querySelector('head > link[rel="shortcut icon"]');if(r&&await r_(r.href)||(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(e=>!!e.href))&&await r_(r.href))return r.href;return""}catch{return""}}(0,a.default)(rE,"defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});let rA=async()=>({name:(e=>{let{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;let i=t.querySelector('head > meta[name="title"]');return i?i.content:t.title&&t.title.length>0?t.title:e.location.hostname})(window),icon:await rS(window)}),rI=`v${"5.3.0".split(".")[0]}`,rO={[rp.TESTING]:{url:"https://develop-wallet.web3auth.io",logLevel:"debug"},[rp.DEVELOPMENT]:{url:"http://localhost:4050",logLevel:"debug"},[rp.STAGING]:{url:`https://staging-wallet.web3auth.io/${rI}`,logLevel:"debug"},[rp.PRODUCTION]:{url:`https://wallet.web3auth.io/${rI}`,logLevel:"error"}};!async function(){try{if("undefined"==typeof document)return;let e=document.createElement("link"),{url:t}=rO.production;e.href=`${t}/frame`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){rh.warn(e)}}();let rx=new Set([o.SOLANA_METHOD_TYPES.SEND_TRANSACTION,o.SOLANA_METHOD_TYPES.SIGN_MESSAGE,o.SOLANA_METHOD_TYPES.SIGN_TRANSACTION,o.SOLANA_METHOD_TYPES.SIGN_ALL_TRANSACTIONS,o.EVM_METHOD_TYPES.ETH_SIGN,o.EVM_METHOD_TYPES.ETH_SIGN_TYPED_DATA_V4,o.EVM_METHOD_TYPES.PERSONAL_SIGN,o.EVM_METHOD_TYPES.ETH_TRANSACTION,o.EVM_METHOD_TYPES.ADD_CHAIN,o.EVM_METHOD_TYPES.SWITCH_CHAIN,"wallet_switchChain"]);class rB{constructor({modalZIndex:e=99999,web3AuthClientId:t,web3AuthNetwork:r}){(0,a.default)(this,"isInitialized",void 0),(0,a.default)(this,"modalZIndex",void 0),(0,a.default)(this,"provider",void 0),(0,a.default)(this,"communicationProvider",void 0),(0,a.default)(this,"buttonPosition",void 0),(0,a.default)(this,"web3AuthClientId",void 0),(0,a.default)(this,"web3AuthNetwork",void 0),(0,a.default)(this,"isPluginMode",void 0),(0,a.default)(this,"confirmationStrategy",void 0),(0,a.default)(this,"buildEnv",void 0),(0,a.default)(this,"embedNonce",tv()),this.isInitialized=!1,this.modalZIndex=e,this.web3AuthClientId=t,this.web3AuthNetwork=r}get isLoggedIn(){var e;return(null==(e=this.communicationProvider)?void 0:e.isLoggedIn)||!1}get getBuildEnv(){return this.buildEnv}async init({buildEnv:e=rp.PRODUCTION,enableLogging:t=!1,chains:r,chainId:i,walletUrls:n,whiteLabel:o,confirmationStrategy:a=t_.DEFAULT,accountAbstractionConfig:l,enableKeyExport:d=!1}){var u;let f;if(this.isInitialized)throw Error("Already initialized");this.buildEnv=e,this.confirmationStrategy=a;let{url:c,logLevel:h}=n&&n[e]?(0,s.default)((0,s.default)({},rO[e]),n[e]):rO[e];rh.info(c,"url loaded"),rh.setDefaultLevel(h),t?rh.enableAll():rh.disableAll();let m=new URL(c);m.pathname.endsWith("/")?m.pathname+="frame":m.pathname+="/frame";let g=new URLSearchParams;g.append("origin",window.location.origin),g.append("nonce",this.embedNonce),m.hash=g.toString();let p=this.getTheme((null==o?void 0:o.mode)||tO),w=(u=`<iframe
        id="walletIframe-${this.embedNonce}"
        class="walletIframe-${this.embedNonce}"
        sandbox="allow-popups allow-scripts allow-same-origin allow-forms allow-modals allow-downloads"
        src="${m.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()};
        color-scheme: ${p}"
        allow="clipboard-write"
      ></iframe>`,(f=window.document.createElement("template")).innerHTML=u.trim(),f.content.firstChild);this.buttonPosition=(null==o?void 0:o.buttonPosition)||rw.BOTTOM_LEFT;let y=await rA();return new Promise((e,n)=>{try{window.document.body.appendChild(w);let n=async s=>{if(s.origin!==m.origin)return;let{message:u,nonce:f}=s.data||{};"setup_complete"===u&&f===this.embedNonce&&(window.removeEventListener("message",n),w.contentWindow.postMessage({chains:r,chainId:i,dappMetadata:y,enableLogging:t,web3AuthClientId:this.web3AuthClientId,web3AuthNetwork:this.web3AuthNetwork,whiteLabel:o,confirmationStrategy:a,accountAbstractionConfig:l,enableKeyExport:d},m.origin),await this.setupWeb3({torusUrl:c,walletIframe:w}),this.isInitialized=!0,e())};window.addEventListener("message",n)}catch(e){n(e)}})}async login(e={}){if(!this.isInitialized)throw Error("Call init() first");let t=this.communicationProvider.isIFrameFullScreen;try{e.authConnection||t||this.communicationProvider.displayIframe({isFull:!0});let r=await new Promise((t,r)=>{let i=Object.values(o.SOLANA_CHAIN_IDS).includes(this.provider.chainId)?o.SOLANA_METHOD_TYPES.SOLANA_REQUEST_ACCOUNTS:o.EVM_METHOD_TYPES.ETH_REQUEST_ACCOUNTS;this.provider.rpcRequest({method:i,params:[e.authConnection,e.login_hint]},tR(t,r))});if(rh.info("check: res",r),Array.isArray(r)&&r.length>0)return this.confirmationStrategy===t_.AUTO_APPROVE&&rh.warn("Confirmation strategy auto approve is not allowed on Embed Mode, using Default instead."),r;throw Error("Login failed")}catch(e){throw rh.error("login failed",e),e}finally{t||this.communicationProvider.displayIframe({isFull:!1})}}async loginWithSessionId(e){if(!this.isInitialized)throw Error("Call init() first");if(!e.sessionId)throw Error("sessionId is required");try{let t=await this.communicationProvider.request({method:"login_with_session_id",params:[e.sessionId,e.sessionNamespace||""]});if(rh.info("check: res",t),t.success)return this.isPluginMode=!0,this.confirmationStrategy===t_.POPUP&&rh.warn("Confirmation strategy popup is not allowed on Plugin Mode, using Default instead."),t.success;throw Error("Login failed")}catch(e){throw rh.error("login with session id failed",e),e}}async logout(){if(!this.communicationProvider.isLoggedIn)throw Error("Not logged in");await this.communicationProvider.request({method:"logout",params:[]})}async cleanUp(){var e;null!=(e=this.communicationProvider)&&e.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){let e=window.document.getElementById(`walletIframe-${this.embedNonce}`);(e instanceof Element||e instanceof Document)&&e.remove(),this.isInitialized=!1}async getUserInfo(){return await this.communicationProvider.request({method:"user_info",params:[]})}async showWalletConnectScanner(e){let t=!e||e.show;this.communicationProvider.displayIframe({isFull:t});try{await this.communicationProvider.request({method:"show_wallet_connect",params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showWalletUi(e){let t=!e||e.show;this.communicationProvider.displayIframe({isFull:t});try{await this.communicationProvider.request({method:"show_wallet_ui",params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showFunding(e){let t=!e||e.show;this.communicationProvider.displayIframe({isFull:t});try{await this.communicationProvider.request({method:"show_funding",params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showCheckout(e){let t=!e||e.show;this.communicationProvider.displayIframe({isFull:t});try{await this.communicationProvider.request({method:"show_checkout",params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showReceive(e){let t=!e||e.show;this.communicationProvider.displayIframe({isFull:t});try{await this.communicationProvider.request({method:"show_receive",params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showSwap(e){let t=!e||e.show;this.communicationProvider.displayIframe({isFull:t});try{await this.communicationProvider.request({method:"show_swap",params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}getConfirmationStrategyFinal(e){let t=this.confirmationStrategy;return!Array.isArray(e)&&rx.has(e.method)&&this.confirmationStrategy!==t_.MODAL&&!this.isPluginMode&&(t=t_.POPUP),t}getTheme(e){return e===tO?"light":"dark"===e||window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}async setupWeb3(e){rh.info("setupWeb3 running");let t=new tM({name:"embed_torus",target:"iframe_torus",targetWindow:e.walletIframe.contentWindow,targetOrigin:new URL(e.torusUrl).origin}),r=new tM({name:"embed_communication",target:"iframe_communication",targetWindow:e.walletIframe.contentWindow,targetOrigin:new URL(e.torusUrl).origin}),i=new rE(t,{}),n=new rb(r,{},{buttonPosition:this.buttonPosition});i.tryWindowHandle=(e,t)=>{let r=this.getConfirmationStrategyFinal(e),{allowWalletService:o}=n;if(r===t_.POPUP&&o){let t=tv();n.handleWindow(t,{target:"_blank",features:tE(tI),timeout:500}),e.windowId=t}i.rpcEngine.handle(e,t)},n.tryWindowHandle=(e,t)=>{let r=this.getConfirmationStrategyFinal(e),{allowWalletService:i}=n;if(r===t_.POPUP&&i){let t=tv();n.handleWindow(t,{target:"_blank",features:tE(tS),timeout:500}),e.params.windowId=t}n.rpcEngine.handle(e,t)};let a=e=>{let t=i[e],r=this;i[e]=function(e,i){let{method:n,params:s=[]}=e;if(n===o.EVM_METHOD_TYPES.ETH_REQUEST_ACCOUNTS||n===o.SOLANA_METHOD_TYPES.SOLANA_REQUEST_ACCOUNTS){if(!i)return r.login({authConnection:s[0]});r.login({authConnection:s[0]}).then(e=>i(null,e)).catch(e=>i(e))}return t.apply(this,[e,i])}};a("request"),a("sendAsync"),a("send");let l=new Proxy(i,{deleteProperty:()=>!0}),d=new Proxy(n,{deleteProperty:()=>!0});this.provider=l,this.communicationProvider=d,rh.info("test setupWeb3 "),await Promise.all([i.initializeState(),n.initializeState((0,s.default)((0,s.default)({},e),{},{torusIframeId:e.walletIframe.id}))]),rh.debug("WsEmbed - injected provider")}}e.s(["BUTTON_POSITION",()=>rw,"CONFIRMATION_STRATEGY",()=>t_,"EVM_METHOD_TYPES",()=>o.EVM_METHOD_TYPES,"SOLANA_CHAIN_IDS",()=>o.SOLANA_CHAIN_IDS,"SOLANA_METHOD_TYPES",()=>o.SOLANA_METHOD_TYPES,"TorusInPageProvider",()=>rE,"WS_EMBED_BUILD_ENV",()=>rp,"default",()=>rB],17951)}]);