module.exports=[51084,a=>{"use strict";a.s([],40778),a.i(40778);var b=a.i(95851),c=a.i(41415),d=a.i(96238),e=a.i(66259),f=a.i(22215),g=a.i(27549),h=a.i(55539),i=a.i(92911),j=a.i(84617),k=a.i(58515),l=a.i(97295),m=a.i(83346),n=a.i(30861);async function o({eoaProvider:a,handlers:c}){let[e]=await a.request({method:d.METHOD_TYPES.GET_ACCOUNTS});async function g(a,b){if("string"==typeof a&&a.length>0){let d=(await c.getAccounts(b)).map(a=>a.toLowerCase()),e=a.toLowerCase();if(d.includes(e))return e}throw f.rpcErrors.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}async function h(a,b){if(a.toLowerCase()===e.toLowerCase())return e;let[d]=await c.getAccounts(b);if(a.toLowerCase()===d.toLowerCase())return e;throw f.rpcErrors.invalidParams({message:"Invalid parameters: must provide valid sender address."})}async function i(a,b){b.result=await c.getAccounts(a)}async function j(a,b){if(!c.getPrivateKey)throw f.rpcErrors.methodNotSupported();b.result=await c.getPrivateKey(a)}async function k(a,b){if(!c.processTransaction)throw f.rpcErrors.methodNotSupported();let d=a.params[0]||{from:""};d.from=await g(d.from,a),b.result=c.processTransaction(d,a)}async function l(a,b){let d=a.params[0]||{from:""};d.from&&(d.from=await h(d.from,a)),b.result=await c.processSignTransaction(d,a)}async function m(a,d){let e=a.params,f=a.params[2]||{};if(Array.isArray(a.params)){if(2!==a.params.length)throw Error(`WalletMiddleware - incorrect params for ${a.method} method. expected [address, message]`);let b=a.params;e={from:b[0],data:b[1]}}e=(0,b.default)((0,b.default)({},f),e),d.result=await c.processEthSignMessage(e,a)}async function o(a,b){if(!(null!=a&&a.params))throw Error("WalletMiddleware - missing params");let d=a.params;if(Array.isArray(a.params)){if(2!==a.params.length)throw Error(`WalletMiddleware - incorrect params for ${a.method} method. expected [address, typedData]`);let b=a.params;d={from:b[0],data:b[1]}}b.result=await c.processTypedMessageV4(d,a)}async function p(a,d){let e=a.params,f=a.params[2]||{};if(Array.isArray(a.params)){if(!(a.params.length>=2))throw Error(`WalletMiddleware - incorrect params for ${a.method} method. expected [message, address]`);let b=a.params;if("object"==typeof b[0]){let{challenge:a,address:c}=b[0];e={from:c,data:a}}else{let a=b[0];e={from:b[1],data:a}}}e=(0,b.default)((0,b.default)({},f),e),d.result=await c.processPersonalMessage(e,a)}async function q(a,b){if(!c.getPublicKey)throw f.rpcErrors.methodNotSupported();b.result=await c.getPublicKey(a)}return(0,n.createScaffoldMiddleware)({eth_accounts:(0,n.createAsyncMiddleware)(i),eth_requestAccounts:(0,n.createAsyncMiddleware)(i),eth_private_key:(0,n.createAsyncMiddleware)(j),private_key:(0,n.createAsyncMiddleware)(j),eth_public_key:(0,n.createAsyncMiddleware)(q),public_key:(0,n.createAsyncMiddleware)(q),eth_sendTransaction:(0,n.createAsyncMiddleware)(k),eth_signTransaction:(0,n.createAsyncMiddleware)(l),eth_sign:(0,n.createAsyncMiddleware)(m),eth_signTypedData_v4:(0,n.createAsyncMiddleware)(o),personal_sign:(0,n.createAsyncMiddleware)(p)})}async function p({aaProvider:a}){async function b(b,c){let[,e]=await a.request({method:d.METHOD_TYPES.GET_ACCOUNTS});c.result=[e]}async function c(b,c){let[,e]=await a.request({method:d.METHOD_TYPES.ETH_REQUEST_ACCOUNTS});c.result=[e]}return(0,n.createScaffoldMiddleware)({eth_accounts:(0,n.createAsyncMiddleware)(b),eth_requestAccounts:(0,n.createAsyncMiddleware)(c)})}function q(a){return async(b,c,d,e)=>{try{return c.result=await a.request(b),e()}catch(a){return e(a)}}}a.i(37966);var r=a.i(56308),s=a.i(47497),t=a.i(72568),u=a.i(84699),v=a.i(38013),w=a.i(62738);class x extends u.BaseProvider{constructor({config:a,state:b}){super({config:a,state:b}),(0,c.default)(this,"PROVIDER_CHAIN_NAMESPACE",v.CHAIN_NAMESPACES.EIP155),(0,c.default)(this,"_smartAccount",void 0),(0,c.default)(this,"_publicClient",void 0),(0,c.default)(this,"_bundlerClient",void 0),(0,c.default)(this,"_paymasterClient",void 0),(0,c.default)(this,"_useProviderAsTransport",void 0),this.update({chainId:a.chain.chainId})}get smartAccount(){return this._smartAccount}get bundlerClient(){return this._bundlerClient}get paymasterClient(){return this._paymasterClient}get publicClient(){return this._publicClient}async enable(){if(!this.state.eoaProvider)throw f.providerErrors.custom({message:"eoaProvider is not found in state, please pass it",code:4902});return await this.setupProvider(this.state.eoaProvider),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(a){var c,n;let{currentChain:p}=this,{chainNamespace:u}=p;if(u!==this.PROVIDER_CHAIN_NAMESPACE)throw w.WalletInitializationError.incompatibleChainNameSpace("Invalid chain namespace");let v=this.config.smartAccountChainsConfig.find(a=>a.chainId===p.chainId);if(!v)throw w.WalletInitializationError.invalidProviderConfigError(`Bundler and paymaster config not found for chain ${p.chainId}`);let{bundlerConfig:x,paymasterConfig:y}=v,z=(0,g.defineChain)({id:Number.parseInt(p.chainId,16),name:p.displayName,rpcUrls:{default:{http:[p.rpcTarget],webSocket:[p.wsTarget]}},blockExplorers:p.blockExplorerUrl?{default:{name:"explorer",url:p.blockExplorerUrl}}:void 0,nativeCurrency:{name:p.tickerName,symbol:p.ticker,decimals:p.decimals||18}});this._publicClient=(0,h.createPublicClient)({chain:z,transport:(0,i.http)(p.rpcTarget)});let[A]=await a.request({method:d.METHOD_TYPES.ETH_REQUEST_ACCOUNTS}),B=(0,j.createWalletClient)({account:A,chain:z,transport:(0,k.custom)(a)});this._smartAccount=await this.config.smartAccountInit.getSmartAccount({walletClient:B,client:this._publicClient}),y&&(this._paymasterClient=(0,l.createPaymasterClient)((0,b.default)((0,b.default)({},y),{},{transport:this._useProviderAsTransport?(0,k.custom)(a):null!=(n=y.transport)?n:(0,i.http)(y.url)}))),this._bundlerClient=(0,m.createBundlerClient)((0,b.default)((0,b.default)({},x),{},{account:this.smartAccount,client:this._publicClient,transport:this._useProviderAsTransport?(0,k.custom)(a):null!=(c=x.transport)?c:(0,i.http)(x.url),paymaster:this._paymasterClient}));let C=function({bundlerClient:a,smartAccount:c,chain:d,eoaProvider:e}){let g=(0,j.createWalletClient)({account:c,chain:d,transport:(0,i.http)()});return{getAccounts:async a=>{let[b,d]=await Promise.all([c.getAddress(),e.request({method:"eth_accounts"})]);return t.log.info("smartAccounts",b),t.log.info("eoaAccounts",d),[b,...d]},getPrivateKey:async a=>{throw f.providerErrors.custom({message:"Smart accounts do not have private key",code:4903})},getPublicKey:async a=>{throw f.providerErrors.custom({message:"Smart accounts do not have a public key. Use address instead.",code:4903})},processTransaction:async b=>{b.input&&!b.data&&(b.data=(0,s.addHexPrefix)(b.input));let{to:d,value:e,data:g}=b,h={account:c,calls:[{to:d,value:BigInt(e),data:g}]},i=await a.sendUserOperation(h),j=await a.waitForUserOperationReceipt({hash:i});if(!j.success)throw f.providerErrors.custom({message:j.reason,code:4905});return j.receipt.transactionHash},processSignTransaction:async b=>{let{to:d,value:e,data:f}=b,g=await a.prepareUserOperation({account:c,calls:[{to:d,value:BigInt(e),data:f}]});return await c.signUserOperation({callData:g.callData,callGasLimit:g.callGasLimit,maxFeePerGas:g.maxFeePerGas,maxPriorityFeePerGas:g.maxPriorityFeePerGas,nonce:g.nonce,preVerificationGas:g.preVerificationGas,verificationGasLimit:g.verificationGasLimit,signature:g.signature})},processEthSignMessage:async(a,b)=>e.request(b),processPersonalMessage:async(a,b)=>{let d=a.data;return g.signMessage({account:c,message:(0,r.isHexString)(d)?{raw:d}:d})},processTypedMessageV4:async(a,d)=>{try{let d="string"==typeof a.data?JSON.parse(a.data):a.data;return await g.signTypedData({account:c,domain:(0,b.default)((0,b.default)({},d.domain),{},{verifyingContract:d.domain.verifyingContract,salt:d.domain.salt,chainId:Number(d.domain.chainId)}),primaryType:d.primaryType,types:d.types,message:d.message})}catch(a){throw f.providerErrors.custom({message:a instanceof Error?a.message:"Failed to sign typed data",code:4905})}}}}({bundlerClient:this._bundlerClient,smartAccount:this._smartAccount,chain:z,eoaProvider:a}),D=new e.JRPCEngine,E=await o({eoaProvider:a,handlers:C});D.push(E);let F=q(a);D.push(F);let G=(0,e.providerFromEngine)(D);this.updateProviderEngineProxy(G),a.once("chainChanged",a=>{this.update({chainId:a}),this.setupChainSwitchMiddleware(),this.emit("chainChanged",a)})}async updateAccount(a){throw f.providerErrors.unsupportedMethod("updateAccount. Please call it on eoaProvider")}async switchChain(a){throw f.providerErrors.unsupportedMethod("switchChain. Please call it on eoaProvider")}async lookupNetwork(){throw f.providerErrors.unsupportedMethod("lookupNetwork. Please call it on eoaProvider")}async setupChainSwitchMiddleware(){return this.setupProvider(this.state.eoaProvider)}}(0,c.default)(x,"getProviderInstance",async a=>{let b=new x({config:a});return b._useProviderAsTransport=a.useProviderAsTransport,await b.setupProvider(a.eoaProvider),b.update({eoaProvider:a.eoaProvider}),b});let y=async({accountAbstractionConfig:b,chain:c,chains:e,provider:f,useProviderAsTransport:g})=>{let h,{smartAccountType:i,chains:j}=b,{smartAccountConfig:k}=j.find(a=>a.chainId===c.chainId)||{};switch(i){case d.SMART_ACCOUNT.BICONOMY:{let{BiconomySmartAccount:b}=await a.A(57626);h=new b(k);break}case d.SMART_ACCOUNT.KERNEL:{let{KernelSmartAccount:b}=await a.A(57626);h=new b(k);break}case d.SMART_ACCOUNT.NEXUS:{let{NexusSmartAccount:b}=await a.A(57626);h=new b(k);break}case d.SMART_ACCOUNT.SAFE:{let{SafeSmartAccount:b}=await a.A(57626);h=new b(k);break}case d.SMART_ACCOUNT.TRUST:{let{TrustSmartAccount:b}=await a.A(57626);h=new b(k);break}case d.SMART_ACCOUNT.METAMASK:{let{MetamaskSmartAccount:b}=await a.A(57626);h=new b(k);break}default:throw Error("Smart account type not supported")}return x.getProviderInstance({eoaProvider:f,smartAccountInit:h,chain:c,chains:e,smartAccountChainsConfig:j,useProviderAsTransport:g})},z=async a=>{let b=new e.JRPCEngine,c=await p({aaProvider:a});return b.push(c),b.push(q(a)),(0,e.providerFromEngine)(b)};var A=a.i(36785),B=a.i(61098),C=a.i(59841),D=a.i(41702),E=a.i(58541),F=a.i(37242);a.s(["BiconomySmartAccount",()=>A.BiconomySmartAccount,"KernelSmartAccount",()=>B.KernelSmartAccount,"MetamaskSmartAccount",()=>C.MetamaskSmartAccount,"NexusSmartAccount",()=>D.NexusSmartAccount,"SMART_ACCOUNT",()=>d.SMART_ACCOUNT,"SafeSmartAccount",()=>E.SafeSmartAccount,"TrustSmartAccount",()=>F.TrustSmartAccount,"accountAbstractionProvider",()=>y,"toEoaProvider",()=>z],51084)},15875,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_viem__esm_utils_ccip_a50bb541.js","server/chunks/ssr/node_modules_175afbec._.js"].map(b=>a.l(b))).then(()=>b(29782)))},60611,a=>{a.v(b=>Promise.all(["server/chunks/ssr/8ee3c_@noble_curves_esm_secp256k1_99c559c9.js"].map(b=>a.l(b))).then(()=>b(92288)))},57626,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_viem_32abbc9f._.js","server/chunks/ssr/8ee3c_@noble_curves_esm_secp256k1_99c559c9.js","server/chunks/ssr/node_modules_a78aaf00._.js","server/chunks/ssr/node_modules_94472f80._.js","server/chunks/ssr/node_modules_3a3562e4._.js"].map(b=>a.l(b))).then(()=>b(59352)))}];

//# sourceMappingURL=node_modules_283f0313._.js.map