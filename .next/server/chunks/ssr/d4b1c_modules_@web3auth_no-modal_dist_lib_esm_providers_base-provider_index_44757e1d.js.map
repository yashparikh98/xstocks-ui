{"version":3,"sources":["../../../../node_modules/%40web3auth/no-modal/dist/lib.esm/providers/base-provider/commonPrivateKeyProvider.js","../../../../node_modules/%40web3auth/no-modal/node_modules/%40web3auth/auth/dist/lib.esm/ed25519/utils.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { JRPCEngine, providerFromEngine, createScaffoldMiddleware, createAsyncMiddleware } from '@web3auth/auth';\nimport { BaseProvider } from './baseProvider.js';\n\nvar _CommonPrivateKeyProvider;\nclass CommonPrivateKeyProvider extends BaseProvider {\n  constructor({\n    config,\n    state\n  }) {\n    super({\n      config,\n      state\n    });\n    // should be Assigned in setupProvider\n    _defineProperty(this, \"_providerEngineProxy\", null);\n  }\n  get provider() {\n    return this._providerEngineProxy;\n  }\n  set provider(_) {\n    throw new Error(\"Method not implemented.\");\n  }\n  async setupProvider(privKey) {\n    const privKeyMiddleware = this.getPrivKeyMiddleware(privKey);\n    const engine = new JRPCEngine();\n    engine.push(privKeyMiddleware);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n  }\n  async switchChain(_) {\n    return Promise.resolve();\n  }\n  getProviderEngineProxy() {\n    return this._providerEngineProxy;\n  }\n  async lookupNetwork() {\n    return Promise.resolve(\"\");\n  }\n  getPrivKeyMiddleware(privKey) {\n    const middleware = {\n      getPrivatekey: async () => {\n        if (!this.config.keyExportEnabled) throw new Error(\"Exporting private key is disabled. Please enable it in the provider config\");\n        return privKey;\n      }\n    };\n    return this.createPrivKeyMiddleware(middleware);\n  }\n  createPrivKeyMiddleware({\n    getPrivatekey\n  }) {\n    async function getPrivatekeyHandler(_, res) {\n      try {\n        res.result = await getPrivatekey();\n      } catch (error) {\n        res.error = error instanceof Error ? error.message : error;\n      }\n    }\n    return createScaffoldMiddleware({\n      private_key: createAsyncMiddleware(getPrivatekeyHandler)\n    });\n  }\n}\n_CommonPrivateKeyProvider = CommonPrivateKeyProvider;\n_defineProperty(CommonPrivateKeyProvider, \"getProviderInstance\", async params => {\n  const providerFactory = new _CommonPrivateKeyProvider({\n    config: {\n      chain: params.chain,\n      chains: params.chains\n    }\n  });\n  await providerFactory.setupProvider(params.privKey);\n  return providerFactory;\n});\n\nexport { CommonPrivateKeyProvider };\n","import nacl from '@toruslabs/tweetnacl-js';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst l = nacl.lowlevel;\nfunction getED25519Key(privateKey) {\n  let privKey;\n  if (typeof privateKey === \"string\") {\n    privKey = Buffer.from(privateKey, \"hex\");\n  } else {\n    privKey = privateKey;\n  }\n  // Implementation copied from tweetnacl\n\n  const d = new Uint8Array(64);\n  const p = [l.gf(), l.gf(), l.gf(), l.gf()];\n  const sk = new Uint8Array([...new Uint8Array(privKey), ...new Uint8Array(32)]);\n  const pk = new Uint8Array(32);\n  l.crypto_hash(d, sk, 32);\n  d[0] &= 248;\n  d[31] &= 127;\n  d[31] |= 64;\n  l.scalarbase(p, d);\n  l.pack(pk, p);\n  for (let i = 0; i < 32; i += 1) sk[i + 32] = pk[i];\n  return {\n    sk: Buffer.from(sk),\n    pk: Buffer.from(pk)\n  };\n}\n\nexport { getED25519Key };\n"],"names":[],"mappings":"8FAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,UAIA,OAAM,UAAiC,EAAA,YAAY,CACjD,YAAY,QACV,CAAM,OACN,CAAK,CACN,CAAE,CACD,KAAK,CAAC,QACJ,EACA,OACF,GAEA,CAAA,EAAA,EAAA,OAAA,AAAe,EAAC,IAAI,CAAE,uBAAwB,KAChD,CACA,IAAI,UAAW,CACb,OAAO,IAAI,CAAC,oBAAoB,AAClC,CACA,IAAI,SAAS,CAAC,CAAE,CACd,MAAU,AAAJ,MAAU,0BAClB,CACA,MAAM,cAAc,CAAO,CAAE,CAC3B,IAAM,EAAoB,IAAI,CAAC,oBAAoB,CAAC,GAC9C,EAAS,IAAI,EAAA,UAAU,CAC7B,EAAO,IAAI,CAAC,GACZ,IAAM,EAAW,CAAA,EAAA,EAAA,kBAAA,AAAkB,EAAC,GACpC,IAAI,CAAC,yBAAyB,CAAC,EACjC,CACA,MAAM,YAAY,CAAC,CAAE,CACnB,OAAO,QAAQ,OAAO,EACxB,CACA,wBAAyB,CACvB,OAAO,IAAI,CAAC,oBACd,AADkC,CAElC,MAAM,eAAgB,CACpB,OAAO,QAAQ,OAAO,CAAC,GACzB,CACA,qBAAqB,CAAO,CAAE,CAO5B,OAAO,IAAI,CAAC,uBAAuB,CANhB,AAMiB,CALlC,cAAe,UACb,GAAI,CAAC,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,MAAU,AAAJ,MAAU,8EACnD,OAAO,CACT,CACF,EAEF,CACA,wBAAwB,eACtB,CAAa,CACd,CAAE,CACD,eAAe,EAAqB,CAAC,CAAE,CAAG,EACxC,GAAI,CACF,EAAI,MAAM,CAAG,MAAM,GACrB,CAAE,MAAO,EAAO,CACd,EAAI,KAAK,CAAG,aAAiB,MAAQ,EAAM,OAAO,CAAG,CACvD,CACF,CACA,MAAO,CAAA,EAAA,EAAA,wBAAA,AAAwB,EAAC,CAC9B,YAAa,CAAA,EAAA,EAAA,qBAAA,AAAqB,EAAC,EACrC,EACF,CACF,CAEA,CAAA,EAAA,EAAA,OAAA,AAAe,EAAC,EAA0B,sBAAuB,MAAM,IACrE,IAAM,EAAkB,IAFE,AAEE,EAA0B,CACpD,OAAQ,CACN,MAAO,EAAO,KAAK,CACnB,OAAQ,EAAO,MAAM,AACvB,CACF,GAEA,OADA,MAAM,EAAgB,aAAa,CAAC,EAAO,OAAO,EAC3C,CACT,oBCtEA,IAAM,EAHN,AAGU,EAHV,CAAA,CAAA,MAGU,OAAI,CAAC,QAAQ,CACvB,SAAS,EAAc,CAAU,MAC3B,EAEF,EADwB,UAAtB,AAAgC,OAAzB,EACC,OAAO,IAAI,CAAC,EAAY,OAExB,EAIZ,IAAM,EAAI,IAAI,WAAW,IACnB,EAAI,CAAC,EAAE,EAAE,GAAI,EAAE,EAAE,GAAI,EAAE,EAAE,GAAI,EAAE,EAAE,GAAG,CACpC,EAAK,IAAI,WAAW,IAAI,IAAI,WAAW,MAAa,IAAI,WAAW,IAAI,EACvE,EAAK,IAAI,WAAW,IAC1B,EAAE,WAAW,CAAC,EAAG,EAAI,IACrB,CAAC,CAAC,EAAE,EAAI,IACR,CAAC,CAAC,GAAG,EAAI,IACT,CAAC,CAAC,GAAG,EAAI,GACT,EAAE,UAAU,CAAC,EAAG,GAChB,EAAE,IAAI,CAAC,EAAI,GACX,IAAK,IAAI,EAAI,EAAG,EAAI,GAAI,GAAK,EAAG,CAAE,CAAC,EAAI,GAAG,CAAG,CAAE,CAAC,EAAE,CAClD,MAAO,CACL,GAAI,OAAO,IAAI,CAAC,GAChB,GAAI,OAAO,IAAI,CAAC,EAClB,CACF","ignoreList":[0,1]}